<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1055;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1077; 9. &#1056;&#1072;&#1073;&#1086;&#1090;&#1072; &#1089; XBase</title>
		<LINK REL="stylesheet" href="/db/content/v8310doc/src/руководство разработчика/style.css?_=1496848987">
		<script charset="windows-1251" src="/db/content/v8310doc/src/руководство разработчика/script.js?_=1496848987" TYPE="text/javascript"></script>
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="/db/content/v8310doc/src/руководство разработчика/приложение 9. работа с xbase.htm" rel="canonical">
<link href="/static/its.content.css?_=1490872753" type="text/css" rel="stylesheet">
<script charset="windows-1251" type="text/javascript" src="/static/its.content.js?_=1489758009"></script>
<!--[if lt IE 9]><script charset="windows-1251" type="text/javascript" src="/static/html5shiv.js?_=1484636606"></script><![endif]-->

</head>
	<body class="v8310doc">
<a id="TI000001292" class="bookmark"><h1>Приложение 9.  Работа с XBase</h1></a>

<p class="MsoNormal">В данном разделе
приводится пояснение терминов, использованных при описании средства встроенного
языка для работы с базами данных – объекта <span class="Term">XBase</span>.</p>

<a id="TI000001293" class="bookmark" name="issogl1_9.1_поля_и_записи"><h2>9.1. Поля и записи</h2></a>

<p class="MsoNormal">Хорошим примером
базы данных может служить телефонный справочник организации. Он содержит
фамилии, номера телефонов и номера комнат всех сотрудников организации. Каждая
строка справочника соответствует одной записи, а каждая колонка – полю. Каждое
поле имеет наименование и характеристики информации, для хранения которой оно
предназначено: тип, длина, точность. Содержимое поля для конкретной записи
называется значением поля. Например, телефонный справочник может быть организован
в виде таблицы с колонками (полями) <span class="Interface">Фамилия</span> <span class="Interface">Имя</span> <span class="Interface">Отчество</span>, <span class="Interface">№ комнаты</span>, <span class="Interface">Телефон</span>. Каждая строка (запись) содержит информацию об
одном абоненте.</p>

<a id="TI000001294" class="bookmark" name="issogl1_9.2_таблица_структура_таблицы_файл_базы_данных"><h2>9.2. Таблица, структура таблицы, файл базы данных</h2></a>

<p class="MsoNormalCxSpFirst">Весь
справочник целиком в терминах баз данных называется таблицей. Состав входящих в
таблицу полей определяет структуру таблицы, а состав входящих в таблицу записей –
ее содержание. Каждая запись в таблице состоит из того же набора полей, что и
таблица целиком, поэтому иногда употребляется термин <span class="Bold">структура
записи</span>. Это понятие адекватно структуре таблицы, хотя употребление
первого термина представляется более корректным, т. к. таблица имеет
структуру независимо от того, имеется ли в ней хотя бы одна запись.</p>

<p class="MsoNormalCxSpLast">Реализация
баз данных формата DBF подразумевает, что каждая таблица хранится в отдельном
файле. Поэтому в дальнейшем мы будем применять термин «файл базы данных» или
«файл БД», имея в виду таблицу базы данных.</p>

<a id="TI000001295" class="bookmark" name="issogl1_9.3_индексы_выражения_индекса_и_фильтра_индексный_файл"><h2>9.3. Индексы, выражения индекса и фильтра, индексный файл</h2></a>

<p class="MsoNormalCxSpFirst">Для
организации упорядочивания содержимого файла базы данных и поиска в ней по
значению одного или нескольких полей применяется механизм индексов. Его
применение можно сравнить с сортировкой картотеки по определенному признаку
(совокупности признаков). Однако, в отличие от картотеки, файл базы данных
может иметь сразу несколько индексов и, соответственно, являться упорядоченным
одновременно по нескольким признакам. Каждый индекс имеет наименование, признак
уникальности, выражение индекса и фильтр. Наименование индекса используется для
идентификации индекса. Выражение индекса и фильтр представляют собой написанные
на специальном языке выражения, вычисление значения которых для каждой записи
позволяют определить ее место при упорядочивании и необходимость помещения ее в
упорядоченный список (индекс может содержать упоминание не обо всех записях
таблицы, а только об удовлетворяющих выражению фильтра). Уникальный индекс
(имеющий установленный признак уникальности) позволяет иметь в индексе ссылки
на записи только с различным значением индексного выражения.</p>

<p class="MsoNormalCxSpLast">Индексы хранятся
в индексном файле. Индексный файл может содержать информацию более чем об одном
индексе.</p>

<a id="TI000001296" class="bookmark" name="issogl1_9.4_запись_изменений_в_базу_данных"><h2>9.4. Запись изменений в базу данных</h2></a>

<p class="MsoNormal">Каждый объект
представляет собой структуру данных, расположенных в памяти компьютера. И
изменение содержимого свойств объекта не вызывает немедленного изменения в
файлах базы данных. При включенном режиме автосохранения запись содержимого
объекта в файлы базы данных происходит при изменении позиционирования (переход
к следующей записи, поиск по ключу и т. д.). При выключенном режиме
автосохранения запись изменений происходит только при вызове соответствующего
метода объекта.</p>

<a id="TI000001297" class="bookmark" name="issogl1_9.5_работа_с_индексными_файлами"><h2>9.5. Работа с индексными файлами</h2></a>

<p class="MsoNormal">Следует иметь в
виду, что объект <span class="Term">XBase</span>
одновременно может быть связан не более чем с одним индексным файлом. Все изменения
в базе данных, сделанные в сеансе работы с одним индексным файлом, никак не
отражаются на остальных. Поэтому не рекомендуется иметь более одного индексного
файла для базы данных. В противном случае после каждого открытия базы данных с
индексным файлом, отличным от открытого в предыдущем сеансе работы с базой,
следует производить переиндексацию (обновление содержимого индексного файла).</p>

<a id="TI000001298" class="bookmark" name="issogl1_9.6_удаление_записей"><h2>9.6. Удаление записей</h2></a>

<p class="MsoNormalCxSpFirst">Удаление
записи из базы данных не приводит к физическому уничтожению ее на диске. В этом
случае в специальном служебном поле записи, недоступном обычными средствами,
ставится пометка об удалении. На записи, помеченной удаленной, позиционирования
не происходит, если не включен специальный режим просмотра удаленных записей.
Имеется свойство, управляющее специальным режимом просмотра, а также набор
методов для определения, является ли спозиционированная запись удаленной, и
восстановления удаленной записи.</p>

<p class="MsoNormalCxSpLast">Метод
сжатия базы вызывает физическое уничтожение записей, помеченных как удаленные.
Метод очистки базы вызывает физическое уничтожение всех записей. После применения
этих методов восстановление удаленных записей становится невозможным.</p>

<a id="TI000001299" class="bookmark" name="issogl1_9.7_создание_базы_данных_индекса_индексного_файла"><h2>9.7. Создание базы данных, индекса, индексного файла</h2></a>

<p class="MsoNormal">Помимо работы с
существующими базами данных, объект XBase имеет набор методов, позволяющих
создать новую базу данных произвольной структуры, новые индексы и новый
индексный файл. Следует отметить, что если использование методов, изменяющих
структуру базы данных, возможно только для объектов, не связанных с
существующей базой данных (т. е. для вновь создаваемых баз данных), то
создание новых индексов и индексного файла возможно как для создаваемых баз
данных, так и для уже существующих и открытых.</p>

<a id="TI000001300" class="bookmark" name="issogl1_9.8_ограничения"><h2>9.8. Ограничения</h2></a>

<p class="MsoNormalCxSpFirst">Основное
назначение объектов <span class="Term">XBase</span> –
организация экспорта-импорта информации в/из внешних файлов формата DBF.</p>

<p class="MsoNormalCxSpMiddle">Объекты <span class="Term">XBase</span> не поддерживают поля типа <span class="Term">memo</span>. Объекты <span class="Term">XBase</span>
поддерживают только монопольный доступ к файлам. Объекты XBase поддерживают
индексные файлы в формате <span class="Interface">CDX</span>. Однако использование внешними программами (например,
<span class="Interface">FoxBase</span>)
индексных файлов, созданных с помощью объектов XBase, так же как и использование
объектами индексных файлов, созданных внешними программами, не рекомендуется из-за
возможной несовместимости версий.</p>

<p class="MsoNormalCxSpMiddle"> </p>

<br>
	</body>
</html>