<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1043;&#1083;&#1072;&#1074;&#1072; 14. &#1040;&#1085;&#1072;&#1083;&#1080;&#1079; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1080; &#1087;&#1088;&#1086;&#1075;&#1085;&#1086;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;</title>
		<LINK REL="stylesheet" href="style.css?_=1496848987">
		<SCRIPT src="script.js?_=1496848987" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js?_=1496848987" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="/db/content/v8310doc/src/руководство разработчика/глава 14. анализ данных и прогнозирование.htm" rel="canonical">
<link href="/static/its.content.css?_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="/static/its.content.js?_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="/static/html5shiv.js?_=1484636606"></script><![endif]-->

</head>
	<body class="v8310doc">
<a name="_ref351996880"></a><a name="_ref349214358"></a><a name="_ref349214357"></a><a id="TI000000690" class="bookmark"><h1>Глава 14.  Анализ данных и прогнозирование</h1></a>

<a id="TI000001834" class="bookmark" name="issogl1_14.1_общая_информация"><h2>14.1. Общая информация</h2></a>

<p class="MsoNormalCxSpFirst">Механизм анализа данных и прогнозирования позволяет
реализовывать в прикладных решениях различные средства для выявления
закономерностей, которые обычно скрываются за большими объемами информации.</p>

<p class="MsoNormalCxSpMiddle">Например, проанализировав данные о продажах
товаров, можно выявить группы товаров, которые обычно покупаются вместе. В
дальнейшем (один из многочисленных вариантов) эта информация может
использоваться при раскладке товара в розничном магазине. Товары могут
располагаться рядом (пришел покупатель за мангалом, увидел рядом жидкость для
растопки, угли, мясо, удочки, резиновую лодку… в итоге купил все), могут
располагаться в разных углах торгового зала (пришел покупатель за молоком, пока
дойдет до хлеба, пройдет через весь магазин и еще чего-нибудь купит).</p>

<p class="MsoNormalCxSpMiddle">Другим примером использования механизма анализа
данных является прогнозирование поведения контрагента, исходя из имеющихся
данных о нем. Проведя такой анализ, можно выяснить, как зависит объем их
закупок от территориального расположения, размера компании, времени
сотрудничества и прочих показателей. На основании этих зависимостей можно
спрогнозировать поведение нового контрагента и выбрать соответствующую
стратегию для работы с ним.</p>

<p class="MsoNormalCxSpMiddle">Используя возможность построения прогнозов, можно
планировать закупочную кампанию. Рассмотрим пример: в прошлом месяце зоомагазин
продал 100 морских свинок. Нужно спланировать закупку товара на следующий
месяц. Одним из вариантов (очень часто используемых) является ввод поправочного
коэффициента на продажи прошлых периодов. Считаем, что поправочный коэффициент
(коэффициент повышения спроса) равен 1,5. В итоге при планировании закупок
описанным методом будем к следующему месяцу планировать закупку 150 морских
свинок. Но если проанализировать, что обычно покупают клиенты после покупки
таких питомцев, то можно прийти к совершенно другому выводу. Воспользовавшись
возможностью проведения анализа данных, построения прогноза по этому анализу,
можно прийти к выводу, что закупать на следующий месяц нужно корм, различные наполнители,
сено и другие «аксессуары».</p>

<p class="MsoNormalCxSpLast">Следует отметить, что материал данной главы в первую
очередь будет посвящен обзору механизмов «1С:Предприятия» и только косвенно
будет касаться (на простых примерах) способов использования полученной информации.</p>

<a id="TI000000691" class="bookmark" name="issogl1_14.2_схема_механизма"><h2>14.2. Схема механизма</h2></a>

<p class="Regularbeforepicture">Общую схему работы механизма анализа и
прогнозирования данных можно представить следующим образом:</p>

<p class="Picture"><IMG src="_img/img00416.gif?_=1496848987" WIDTH="584" ALT HEIGHT="472"></p>

<p class="MsoCaption">Рис. 418.
Схема взаимодействия элементов механизма анализа данных</p>

<p class="MsoNormalCxSpFirst">Механизм позволяет работать как с данными,
полученными из информационной базы, так и с данными, полученными из другого
источника, предварительно загруженными в таблицу значений или табличный
документ.</p>

<p class="MsoNormalCxSpMiddle">Применяя к исходным данным один из видов анализа,
можно получить результат анализа. Результат анализа представляет собой некую
модель поведения данных; может быть отображен в итоговом документе или сохранен
для дальнейшего использования.</p>

<p class="MsoNormalCxSpMiddle">Дальнейшее использование результата анализа
заключается в том, что на его основе может быть создана модель прогноза, позволяющая
прогнозировать поведение новых данных в соответствии с имеющейся моделью.</p>

<p class="MsoNormalCxSpLast">Например, можно проанализировать, какие товары
приобретаются вместе (в одной накладной), и сохранить созданную на основе
данного анализа модель прогноза в базе данных. В дальнейшем при создании
очередной накладной ранее сохраненную модель прогноза можно извлечь из
информационной базы, подать ей на вход новые данные, содержащиеся в этой
накладной, и на выходе получить прогноз – список товаров, которые
очередной клиент тоже приобретет (с определенной долей вероятности), если их
ему предложить.</p>

<a id="TI000000692" class="bookmark" name="issogl2_14.2.1_основные_объекты_механизма"><h3>14.2.1. Основные объекты механизма</h3></a>

<p class="RegularbeforepictureCxSpFirst">Схематично взаимосвязь основных объектов
механизма анализа данных и</p>

<p class="RegularbeforepictureCxSpLast">прогнозирования можно показать следующим
образом:</p>

<p class="Picture"><IMG src="_img/img00417.gif?_=1496848987" WIDTH="800" ALT HEIGHT="443"></p>

<p class="MsoCaption">Рис. 419.
Взаимосвязь основных объектов</p>

<p class="MsoNormal"><span class="Bold">Анализ данных</span> – объект,
непосредственно выполняющий анализ данных. Ему устанавливается источник данных,
задаются параметры и исходные данные. Результатом работы данного объекта
является <span class="Bold">результат анализа данных</span>, причем для каждого
типа анализа существует свой объект для работы с результатом анализа:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">РезультатАнализаДанныхОбщаяСтатистика</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">РезультатАнализаДанныхПоискАссоциаций</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">РезультатАнализаДанныхПоискПоследовательностей</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">РезультатАнализаДанныхДеревоРешений</span>,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">РезультатАнализаДанныхКластеризация</span>.</p>

<p class="MsoNormalCxSpFirst"><span class="Bold">Настройка колонок анализа данных</span> –
коллекция входных колонок анализа данных. Для каждой колонки указывается тип данных,
содержащихся в ней, роль, выполняемая колонкой, дополнительные настройки,
зависящие от типа производимого анализа.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Параметры анализа данных</span> –
набор параметров производимого анализа данных. Состав параметров зависит от типа
анализа. Например, для кластерного анализа указывается количество кластеров, на
которые необходимо разбить исходные объекты, тип измерения расстояния между
объектами и т. п.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Источник данных</span> –
исходные данные для анализа. В качестве источника данных может выступать
результат запроса, область ячеек табличного документа, таблица значений.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Результат анализа данных</span> –
специальный объект, содержащий информацию о результате анализа. Для каждого
вида анализа предусмотрен свой результат. Например, результатом анализа данных <span class="Interface">Дерево решений</span> будет объект типа <span class="Term">РезультатАнализаДанныхДеревоРешений</span>.
В дальнейшем результат может быть выведен в табличный документ при помощи <span class="Bold">построителя отчета анализа данных</span>, может быть выведен
посредством программного доступа к его содержимому, может быть использован для
создания <span class="Bold">модели прогноза</span>. Любой результат анализа
данных может быть сохранен для последующего использования.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Модель прогноза</span> –
специальный объект, позволяющий выполнять прогноз на основании входных данных
(выборка для прогноза, настройки колонок выборки и результата, результат
анализа). Тип модели прогноза зависит от типа результата анализа данных.
Например, модель, созданная для типа анализа <span class="Interface">Поиск
ассоциаций</span>, будет иметь тип <span class="Term">МодельПрогнозаПоискАссоциаций</span>. Такая модель
сможет выдавать прогнозы типа: т. к. данный покупатель купил заданный
набор товаров, то с определенной вероятностью он должен купить и другой набор
товаров. На вход модели прогноза передается <span class="Bold">источник данных
для прогноза</span>. Результатом является таблица значений, содержащая
прогнозируемые значения.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Настройка входных колонок</span> –
набор специальных объектов, показывающих соответствие между колонками модели
прогноза и колонками выборки прогноза. Например, колонке модели прогноза с
именем <span class="Interface">Товар</span> может соответствовать колонка выборки
<span class="Term">Номенклатура</span>.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Настройка колонок результата</span> –
позволяет управлять тем, какие колонки будут помещены в результирующую таблицу
модели прогноза. Например, для поиска ассоциаций можно вывести в результат
номенклатуру, которую, скорее всего, приобретет клиент, и вероятность подобной
покупки.</p>

<p class="MsoNormalCxSpLast"><span class="Bold">Колонки результата</span> –
таблица значений, состоящая из колонок, указанных в настройках результирующих
колонок, и содержащая прогнозируемые данные. Конкретное содержимое определяется
типом анализа.</p>

<a id="TI000000693" class="bookmark" name="issogl2_14.2.2_типы_анализа_данных"><h3>14.2.2. Типы анализа данных</h3></a>

<p class="MsoNormal">В механизме анализа данных и прогнозирования реализовано
несколько типов анализа данных:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
общая статистика,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
поиск ассоциаций,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
поиск последовательностей,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
кластерный анализ,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
дерево решений.</p>

<a id="TI000000694" class="bookmark" name="issogl3_14.2.2.1_общая_статистика"><h4>14.2.2.1. Общая статистика</h4></a>

<p class="MsoNormalCxSpFirst">Тип анализа <span class="Interface">Общая статистика</span>
представляет собой механизм для сбора общей информации о данных, находящихся в
полученном источнике данных. Этот тип анализа предназначен для предварительного
исследования анализируемой информации.</p>

<p class="MsoNormalCxSpLast">Анализ показывает ряд характеристик дискретных и
непрерывных полей. При выводе отчета в табличный документ заполняются круговые
диаграммы для отображения состава полей.</p>

<a id="TI000000695" class="bookmark" name="issogl3_14.2.2.2_поиск_ассоциаций"><h4>14.2.2.2. Поиск ассоциаций</h4></a>

<p class="MsoNormalCxSpFirst">Данный тип анализа осуществляет поиск часто
встречаемых вместе групп объектов или значений характеристик, а также производит
поиск правил ассоциаций. Поиск ассоциаций может использоваться, например, для
определения часто приобретаемых вместе товаров или услуг.</p>

<p class="MsoNormalCxSpLast">Этот тип анализа может работать с иерархическими
данными, что позволяет, например, находить правила не только для конкретных
товаров, но и для их групп. Важной особенностью этого типа анализа является
возможность работать как с объектным источником данных, в котором каждая
колонка содержит некоторую характеристику объекта, так и с событийным
источником, где характеристики объекта располагаются в одной колонке.</p>

<a id="TI000000696" class="bookmark" name="issogl3_14.2.2.3_поиск_последовательностей"><h4>14.2.2.3. Поиск последовательностей</h4></a>

<p class="MsoNormalCxSpFirst">Тип анализа <span class="Interface">Поиск
последовательностей</span> позволяет выявлять в источнике данных
последовательные цепочки событий. Например, это может быть цепочка товаров или
услуг, которые часто последовательно приобретают клиенты.</p>

<p class="MsoNormalCxSpLast">Этот тип анализа позволяет осуществлять поиск по
иерархии, что дает возможность отслеживать не только последовательности
конкретных событий, но и последовательности родительских групп.</p>

<a id="TI000000697" class="bookmark" name="issogl3_14.2.2.4_кластерный_анализ"><h4>14.2.2.4. Кластерный анализ</h4></a>

<p class="MsoNormalCxSpFirst">Кластерный анализ позволяет разделить исходный
набор исследуемых объектов на группы объектов таким образом, чтобы каждый
объект был более схож с объектами из своей группы, чем с объектами других
групп. Анализируя в дальнейшем полученные группы, называемые кластерами, можно
определить, чем характеризуется та или иная группа, принять решение о методах
работы с объектами различных групп. Например, при помощи кластерного анализа
можно разделить клиентов, с которыми работает компания, на группы, для того,
чтобы применять различные стратегии при работе с ними.</p>

<p class="MsoNormalCxSpMiddle">При помощи параметров кластерного анализа
пользователь может настроить алгоритм, по которому будет производиться разбиение,
а также может динамически изменять состав характеристик, учитываемых при
анализе, настраивать для них весовые коэффициенты.</p>

<p class="MsoNormalCxSpLast">Результат кластеризации может быть выведен в
дендрограмму – специальный вид диаграммы, предназначенный для графического
отображения результатов кластерного анализа.</p>

<a id="TI000000698" class="bookmark" name="issogl3_14.2.2.5_дерево_решений"><h4>14.2.2.5. Дерево решений</h4></a>

<p class="MsoNormalCxSpFirst">Тип анализа <span class="Interface">Дерево решений</span>
позволяет построить иерархическую структуру классифицирующих правил,
представленную в виде дерева.</p>

<p class="MsoNormalCxSpMiddle">Для построения дерева решений необходимо выбрать
целевой атрибут, по которому будет строиться классификатор, и ряд входных
атрибутов, которые будут использоваться для создания правил. Целевой атрибут
может содержать, например, информацию о том, перешел ли клиент к другому
поставщику услуг, удачна ли была сделка, качественно ли была выполнена работа и т. д.
Входными атрибутами, например, могут выступать возраст сотрудника, стаж его
работы, материальное состояние клиента, количество сотрудников в компании и т. п.</p>

<p class="MsoNormalCxSpMiddle">Результат работы анализа представляется в виде
дерева, каждый узел которого содержит некоторое условие. Для принятия решения,
к какому классу следует отнести некий новый объект, необходимо, отвечая на
вопросы в узлах, пройти цепочку от корня до листа дерева, переходя к дочерним
узлам в случае утвердительного ответа и к соседнему узлу – в случае отрицательного.</p>

<p class="MsoNormalCxSpLast">Набор параметров анализа позволяет регулировать
точность полученного дерева.</p>

<a id="TI000000699" class="bookmark" name="issogl2_14.2.3_модели_прогноза"><h3>14.2.3. Модели прогноза</h3></a>

<p class="MsoNormalCxSpFirst">Модели прогноза, создаваемые механизмом,
представляют собой специальные объекты, которые создаются из результата анализа
данных и позволяют в дальнейшем автоматически выполнять прогноз для новых
данных.</p>

<p class="MsoNormalCxSpLast">Например, модель прогноза поиска ассоциаций,
построенная при анализе покупок клиентов, может быть использована при работе с
осуществляющим покупку клиентом, для того чтобы предложить ему товары, которые
он с определенной степенью вероятности приобретет вместе с выбранными им
товарами.</p>

<a id="TI000000700" class="bookmark" name="issogl1_14.3_тип_анализа_общая_статистика"><h2>14.3. Тип анализа «Общая статистика»</h2></a>

<p class="MsoNormalCxSpFirst">Тип анализа <span class="Interface">Общая статистика</span>
может использоваться для предварительного анализа данных (перед выполнением
другого вида анализа) и т. п.</p>

<p class="MsoNormalCxSpMiddle">В качестве источника данных, которые будут
подвергаться анализу, может использоваться результат запроса, таблица значений
или область ячеек табличного документа.</p>

<p class="MsoNormalCxSpMiddle">Данные в источнике (с точки зрения проводимого
анализа) могут иметь непрерывный или дискретный вид. К непрерывным относятся
такие типы, как <span class="Term">Число</span>,
<span class="Term">Дата</span>.
Остальные типы относятся к дискретным.</p>

<p class="MsoNormalCxSpMiddle">Для колонок разных видов предусмотрено получение
различной информации.</p>

<p class="MsoNormalCxSpLast">Дискретные данные:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Количество значений – количество значений,
встреченных в колонке источника данных (<span class="Term">NULL</span> значением не
считается);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Количество уникальных значений (с исключением
повторяющихся значений);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Мода – значение, которое в источнике данных
встречается наиболее часто. Если в данных несколько значений, встречаемых с
одинаковой частотой, в качестве моды берется первое найденное;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Частота – количество вхождений значения в
выборку данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Относительная частота – определяется как
отношение количества вхождения значения к общему количеству значений;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Накопленная частота – считается как сумма
частоты значения и сумма частот предыдущих значений выборки данных;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Накопленная относительная частота –
считается как сумма накопленной частоты значения и сумма относительных частот
предыдущих значений.</p>

<p class="MsoNormal">Непрерывные данные:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Количество значений;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Минимум значения;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Максимум значения;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Среднее;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Размах – разность между максимальным и
минимальным значениями;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Стандартное отклонение (среднеквадратичное
отклонение);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Медиана – значение, лежащее в середине
выборки.</p>

<p class="MsoNormalCxSpFirst">Следует отметить, что если анализируется
одновременно несколько полей различных видов, их анализ проводится вне зависимости
друг от друга (исключается взаимная корреляция).</p>

<p class="MsoNormalCxSpLast">Рассмотрим указанные характеристики на примере.</p>

<p class="Regularbeforetable">Выборка данных (источник анализа) имеет следующее
наполнение:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td>
   <p class="MsoNormalCxSpFirst"><span class="Bold">Номенклатура</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Количество</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  круглый</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «УЮТ»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Джинс»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «Джинс»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  «Kitchen» 0.9x1.7</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Комфорт»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  «Kitchen» 0.9x1.7</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стул
  «Summer»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «УЮТ»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  прямоугольный</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «УЮТ»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «УЮТ»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Шкаф
  «Wardrobe»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  прямоугольный</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  обеденный</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стул
  «Summer»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  круглый</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
 </tr>
</table>

<p class="Regularbeforetable">В результате анализа данных для поля <span class="Interface">Количество</span> (вид данных анализа <span class="Term">Непрерывные</span>) будут
рассчитаны следующие характеристики:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td>
   <p class="MsoNormalCxSpFirst"><span class="Bold">Характеристика</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Значение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значений</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">20</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Минимум</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Максимум</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Среднее</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1,6</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Размах</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стандартное
  отклонение</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0,8208</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Медиана</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
 </tr>
</table>

<p class="Regularbeforetable">Для поля <span class="Interface">Номенклатура</span>
будут получены следующие характеристики:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td>
   <p class="MsoNormalCxSpFirst"><span class="Bold">Характеристика</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Значение</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Количество
  значений</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">20</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Количество
  уникальных значений</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">12</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Мода</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpLast"> </p>

<p class="Regularbeforepicture">Таблица частот для значений номенклатуры будет
иметь следующий вид:</p>

<p class="Picture"><IMG src="_img/img00418.gif?_=1496848987" WIDTH="697" ALT HEIGHT="248"></p>

<p class="MsoCaption">Рис. 420.
Таблица частот</p>

<p class="Regularbeforepicture">Относительная частота в виде диаграммы
представлена далее:</p>

<p class="Picture"><IMG src="_img/img00419.gif?_=1496848987" WIDTH="589" ALT HEIGHT="376"></p>

<p class="MsoCaption">Рис. 421.
Диаграмма частот</p>

<p class="MsoNormal">Для выполнения данного анализа может использоваться фрагмент
кода, аналогичный приведенному:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ОбщаяСтатистика<span class="operator">(</span>Команда<span class="operator">)</span>
    Результат <span class="operator">=</span> АнализОбщаяСтатистика<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаСервереБезКонтекста</span>
<span class="keyword">Функция</span> АнализОбщаяСтатистика<span class="operator">(</span><span class="operator">)</span>
    Анализ <span class="operator">=</span> <span class="keyword">Новый</span> АнализДанных<span class="operator">;</span>
    Анализ<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхОбщаяСтатистика&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
    Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;</span>
<span class="string">        |ВЫБРАТЬ</span>
<span class="string">        |Продажи.Номенклатура,</span>
<span class="string">        |Продажи.Количество</span>
<span class="string">        |ИЗ</span>
<span class="string">        |РегистрНакопления.Продажи КАК Продажи&quot;</span><span class="operator">;</span>
    Анализ<span class="operator">.</span>ИсточникДанных <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    РезультатАнализа <span class="operator">=</span> Анализ<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель <span class="operator">=</span> <span class="keyword">Новый</span> ПостроительОтчетаАнализаДанных<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>Макет <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхОбщаяСтатистика&quot;</span><span class="operator">)</span><span class="operator">;</span>
    ТабДок <span class="operator">=</span> <span class="keyword">Новый</span> ТабличныйДокумент<span class="operator">;</span>
    Построитель<span class="operator">.</span>Вывести<span class="operator">(</span>РезультатАнализа<span class="operator">,</span> ТабДок<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Возврат</span> ТабДок<span class="operator">;</span>
<span class="keyword">КонецФункции</span></pre>

<p class="MsoNormalCxSpFirst">Работа по проведению анализа данных выполняется в
серверной внеконтекстной функции, которая возвращает на клиента табличный
документ с результатами анализа. Сначала создается сам объект <span class="Term">АнализДанных</span>.
После этого производится выбор типа проводимого анализа.</p>

<p class="MsoNormalCxSpMiddle">Далее по тексту определяется запрос. Результат
запроса устанавливается как источник данных анализа. Сам анализ выполняется в
процессе работы метода <span class="Term">Выполнить()</span>
объекта <span class="Term">АнализДанных</span>.</p>

<p class="MsoNormalCxSpMiddle">Сам анализ не имеет средств по визуализации
результата полученного анализа. Для этой цели используется объект <span class="Term">ПостроительОтчетаАнализаДанных</span>.
При создании данного объекта повторно указывается тип проводимого анализа.
Далее в качестве первого параметра метода <span class="Term">Вывести()</span>
передается результат полученного анализа, вторым параметром передается ранее
созданный объект <span class="Term">ТабличныйДокумент</span>.</p>

<p class="MsoNormalCxSpMiddle">В конце алгоритма табличный документ с результатом
анализа возвращается на клиента в реквизит обработки <span class="Term">Результат</span>, имеющий
тип <span class="Term">ТабличныйДокумент</span>.</p>

<p class="MsoNormalCxSpLast">В результате будут получены данные, аналогичные
рассмотренным выше.</p>

<a name="_ref302500067"></a><a id="TI000000701" class="bookmark" name="issogl1_14.4_тип_анализа_поиск_ассоциаций"><h2>14.4. Тип анализа «Поиск ассоциаций»</h2></a>

<p class="MsoNormal">Как уже было сказано ранее, данный тип анализа осуществляет
поиск часто встречаемых вместе комбинаций объектов или значений характеристик.
С его помощью можно определять группы одновременно закупаемых товаров, выявлять
наиболее привлекательные источники информации (в процессе «оптимизации» затрат
на них) и т. п.</p>

<p class="Regularbeforepicture">Схематично процесс проведения анализа <span class="Interface">Поиск ассоциаций</span> можно представить следующим образом:</p>

<p class="Picture"><IMG src="_img/img00420.gif?_=1496848987" WIDTH="523" ALT HEIGHT="616"></p>

<p class="MsoCaption">Рис. 422.
Схема выполнения анализа «Поиск ассоциаций»</p>

<p class="MsoNormal">В качестве источника данных может использоваться результат
запроса, таблица значений или область ячеек табличного документа. С точки
зрения данного типа анализа колонки источника можно разделить на следующие:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">НеИспользуемая</span> – игнорируются анализом;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Объект</span> – данные из этой колонки
используются как объекты (или события) проводимого анализа. Исходя из значения
данной колонки, значения другой колонки (<span class="Term">Элемент</span>) относятся
к одной ассоциируемой группе;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Элемент</span> – данные из этой колонки
используются для получения устойчивых групп значений, построения ассоциативных
правил.</p>

<p class="MsoNormal">Кроме настройки типов колонок, на результат проводимого
анализа влияют следующие параметры анализа:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">МинимальныйПроцентСлучаев</span> – определяется
минимальный процент случаев, в которых должна встречаться комбинация элементов.
Группы, у которых данное значение меньше указанного, не попадают в результат
анализа;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">МинимальнаяДостоверность</span> – показывает
минимальное значение процента случаев, когда правило соблюдается;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">МинимальнаяЗначимость</span> –<span class="Interface"> </span>группы, у которых данное значение меньше указанного, не
попадают в результат анализа;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ТипОтсеченияПравил</span> – один из вариантов
системного перечисления <span class="Term">ТипОтсеченияПравилАссоциации</span>:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">Избыточные</span> – отсекать избыточные правила,</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">Покрытые</span> – отсекать правила, покрытые
другими правилами.</p>

<p class="MsoNormal">В результате выполнения анализа получаем:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
информацию о данных (количество объектов,
количество элементов, среднее количество элементов в объекте, количество
найденных групп, количество найденных правил ассоциаций);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
найденные группы элементов – указывается
состав группы, количество случаев, процент случаев, в которых эта группа
встречается;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
найденные ассоциативные правила –
указывается исходный состав элементов, следствие (состав элементов), процент случаев,
достоверность, значимость правила.</p>

<p class="Regularbeforetable">Рассмотрим особенности проведения данного типа
анализа на следующей выборке данных (постараемся определить состав одновременно
закупаемых товаров):</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td>
   <p class="MsoNormalCxSpFirst"><span class="Bold">Регистратор</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Номенклатура</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000001</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  круглый</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000002</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «УЮТ»</p>
  </td>
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000003</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Джинс»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «Джинс»</p>
  </td>
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000005</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  «Kitchen» 0.9x1.7</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Комфорт»</p>
  </td>
 </tr>
 <tr>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000004</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  «Kitchen» 0.9x1.7</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стул
  «Summer»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «УЮТ»</p>
  </td>
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000006</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  прямоугольный</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000007</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «УЮТ»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000008</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «УЮТ»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000009</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Шкаф
  «Wardrobe»</p>
  </td>
 </tr>
 <tr>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000010</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  прямоугольный</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  обеденный</p>
  </td>
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Расходная
  накладная № 000000011</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стул
  «Summer»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  круглый</p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpMiddle">Признаком, по которому данные относятся к одной
группе, будем считать значение регистратора (номенклатура, указанная в одном
документе, считается закупленной одновременно). То есть <span class="Term">Регистратор</span> будет
объектом анализа, <span class="Term">Номенклатура</span> –
элементом.</p>

<p class="MsoNormalCxSpLast">Для проведения анализа будем использовать следующий
фрагмент кода:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПоискАссоциаций<span class="operator">(</span>Команда<span class="operator">)</span>
    Результат <span class="operator">=</span> АнализПоискАссоциаций<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаСервереБезКонтекста</span>
<span class="keyword">Функция</span> АнализПоискАссоциаций<span class="operator">(</span><span class="operator">)</span>
    Анализ <span class="operator">=</span> <span class="keyword">Новый</span> АнализДанных<span class="operator">;</span>
    Анализ<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхПоискАссоциаций&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
    Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;</span>
<span class="string">        |ВЫБРАТЬ</span>
<span class="string">        |Продажи.Регистратор,</span>
<span class="string">        |Продажи.Номенклатура</span>
<span class="string">        |ИЗ</span>
<span class="string">        |РегистрНакопления.Продажи КАК Продажи&quot;</span><span class="operator">;</span>
    Анализ<span class="operator">.</span>ИсточникДанных <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="comment">// Строка приводится в качестве примера,</span>
    <span class="comment">// такое значение типа колонки по умолчанию.</span>
    Анализ<span class="operator">.</span>НастройкаКолонок<span class="operator">.</span>Номенклатура<span class="operator">.</span>ТипКолонки <span class="operator">=</span> ТипКолонкиАнализаДанныхПоискАссоциаций<span class="operator">.</span>Элемент<span class="operator">;</span>
    <span class="comment">// Строка приводится в качестве примера,</span>
    <span class="comment">// такое значение типа отсечения по умолчанию.</span>
    Анализ<span class="operator">.</span>Параметры<span class="operator">.</span>ТипОтсеченияПравил<span class="operator">.</span>Значение <span class="operator">=</span> ТипОтсеченияПравилАссоциации<span class="operator">.</span>Избыточные<span class="operator">;</span>
    РезультатАнализа <span class="operator">=</span> Анализ<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель <span class="operator">=</span> <span class="keyword">Новый</span> ПостроительОтчетаАнализаДанных<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>Макет <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхПоискАссоциаций&quot;</span><span class="operator">)</span><span class="operator">;</span>
    ТабДок <span class="operator">=</span> <span class="keyword">Новый</span> ТабличныйДокумент<span class="operator">;</span>
    Построитель<span class="operator">.</span>Вывести<span class="operator">(</span>РезультатАнализа<span class="operator">,</span> ТабДок<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Возврат</span> ТабДок<span class="operator">;</span>
<span class="keyword">КонецФункции</span></pre>

<p class="Regularbeforepicture">Результат анализа будет выглядеть следующим
образом:</p>

<p class="Picture"><IMG src="_img/img00421.gif?_=1496848987" WIDTH="378" ALT HEIGHT="161"></p>

<p class="MsoCaption">Рис. 423.
Результат анализа «Поиск ассоциаций»</p>

<p class="Regularbeforetable">В выборе используются данные из одиннадцати
документов (ссылка содержится в поле <span class="Interface">Регистратор</span>),
количество различных номенклатурных позиций равно двенадцати:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td>
   <p class="MsoNormalCxSpFirst"><span class="Bold">Номенклатура</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  круглый</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «УЮТ»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Джинс»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «Джинс»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  «Kitchen» 0.9x1.7</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Комфорт»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стул
  «Summer»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  прямоугольный</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «УЮТ»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Шкаф
  «Wardrobe»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  обеденный</p>
  </td>
 </tr>
</table>

<p class="Regularbeforepicture">Найдена следующая группа товаров:</p>

<p class="Picture"><IMG src="_img/img00422.gif?_=1496848987" WIDTH="301" ALT HEIGHT="117"></p>

<p class="MsoCaption">Рис. 424.
Найденная группа товаров</p>

<p class="MsoNormal">Вся группа встречается в документе только в двух случаях из
одиннадцати (это и показано в колонках <span class="Interface">Количество случаев</span>
и <span class="Interface">Процент случаев</span>).</p>

<p class="Regularbeforepicture">Получены следующие ассоциативные правила:</p>

<p class="Picture"><IMG src="_img/img00423.gif?_=1496848987" WIDTH="698" ALT HEIGHT="141"></p>

<p class="MsoCaption">Рис. 425.
Ассоциативные правила</p>

<p class="MsoNormalCxSpFirst">Разберем второе из них. В двух случаях из
одиннадцати в документе вместе с позицией <span class="Interface">Стол кухонный
раскладной</span> встречалась позиция <span class="Interface">Табурет
прямоугольный</span>. Исходя из этого, был рассчитан процент случаев: (2 / 11 *
100 = 18,18 %).</p>

<p class="MsoNormalCxSpMiddle">Достоверность была рассчитана следующим образом:
обе номенклатурные позиции закупались в двух случаях, товарная позиция <span class="Interface">Стол кухонный раскладной </span>встречалась в покупках 3 раза.
Исходя из этого, достоверность равна: 2 / 3 * 100 = 66,67 %.</p>

<p class="MsoNormalCxSpLast">Значимость определяется как отношение достоверности
правила к проценту нахождения <span class="Interface">Табурет прямоугольный </span>в
закупаемых товарах. Эта позиция встречается в двух документах из одиннадцати
(18,18 %). Значимость равна: 66,67 % / 18,18 % = 3,67.</p>

<a id="TI000000702" class="bookmark" name="issogl2_14.4.1_типы_отсечения_правил"><h3>14.4.1. Типы отсечения правил</h3></a>

<p class="MsoNormal">Рассмотрим такой важный параметр данного типа анализа, как <span class="Term">ТипОтсеченияПравил</span>.
Возможные значения отсечения содержатся в системном перечислении <span class="Term">ТипОтсеченияПравилАссоциации</span>,
их состав:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Покрытые</span>,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Избыточные</span>.</p>

<p class="MsoNormalCxSpFirst">Перед тем как перейти к рассмотрению особенностей
вариантов отсечения, рассмотрим несколько общих моментов, применимых к правилам
ассоциации.</p>

<p class="MsoNormalCxSpLast">Любое правило состоит из <span class="Bold">предпосылки</span>
и <span class="Bold">следствия</span>. Например:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Предпосылка: <span class="Bold">Если</span> купили
Товар № 1.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Следствие: <span class="Bold">То</span> купят
Товар № 2.</p>

<p class="MsoNormal">При этом не нужно забывать, что следствие наступает с
определенной достоверностью. При отсечении правил вероятностные характеристики
могут рассматриваться, а могут и игнорироваться (важно только содержание
правила).</p>

<a id="TI000000703" class="bookmark" name="issogl3_14.4.1.1_отсечение_покрытых_правил"><h4>14.4.1.1. Отсечение покрытых правил</h4></a>

<p class="MsoNormalCxSpFirst">Рассмотрим вариант отсечения <span class="Interface">Покрытые</span>.</p>

<p class="MsoNormalCxSpLast">Правило может быть покрыто как по предпосылке, так и
по следствию. Например:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Правило № 1: <span class="Bold">Если</span> купили
товар № 1 и № 3, <span class="Bold">То</span> купят товар № 2.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Правило № 2: <span class="Bold">Если</span> купили
товар № 1, <span class="Bold">То</span> купят товар № 2.</p>

<p class="MsoNormalCxSpFirst">В этом случае правило № 1 будет считаться покрытым, т. к.
предпосылка первого правила получается «избыточной» по отношению к предпосылке
второго правила.</p>

<p class="MsoNormalCxSpLast">Пример покрытия по следствию:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Правило № 1: <span class="Bold">Если</span> купили
товар № 1, <span class="Bold">То</span> купят товар № 2, № 3.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Правило № 2: <span class="Bold">Если</span> купили
товар № 1, <span class="Bold">То</span> купят товар № 3.</p>

<p class="MsoNormal">Правило № 2 будет покрыто по следствию, так как следствие
правила № 1 более полное.</p>

<a id="TI000000704" class="bookmark" name="issogl3_14.4.1.2_отсечение_избыточных_правил"><h4>14.4.1.2. Отсечение избыточных правил</h4></a>

<p class="MsoNormalCxSpFirst">Покрытие не учитывает вероятностных характеристик
правил, они учитываются в случае, если используется вариант отсечения <span class="Term">Избыточные</span>.</p>

<p class="MsoNormalCxSpLast">Правило будет считаться избыточным по предпосылке,
если оно покрыто по предпосылке и его достоверность равна достоверности
покрывающего правила. Например:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Правило № 1: <span class="Bold">Если</span> купили
товар № 1 и № 3, <span class="Bold">То</span> купят товар № 2 с достоверностью 75 %.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Правило № 2 <span class="Bold">Если</span> купили
товар № 1, <span class="Bold">То</span> купят товар № 2 с достоверностью 75 %.</p>

<p class="MsoNormalCxSpFirst">Правило № 1 избыточно по отношению к правилу № 2
(оно содержит дополнительное условие, не вносящее «возмущения» в вероятностные
характеристики правила).</p>

<p class="MsoNormalCxSpLast">Правило № 1 будет считаться избыточным по следствию,
если количество случаев данного правила равно количеству случаев покрывающего
правила.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Правило № 1: <span class="Bold">Если</span> купили
товар № 1, <span class="Bold">То</span> купят товар № 2, № 3 в трех случаях.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Правило № 2: <span class="Bold">Если</span> купили
товар № 1, <span class="Bold">То</span> купят товар № 3 в трех случаях.</p>

<p class="MsoNormal">Правило № 2 будет считаться избыточным по отношению к
правилу № 1, так как оно содержит более простое следствие с теми же
вероятностными характеристиками.</p>

<a id="TI000000705" class="bookmark" name="issogl1_14.5_тип_анализа_поиск_последовательностей"><h2>14.5. Тип анализа «Поиск последовательностей»</h2></a>

<p class="MsoNormal">Данный тип анализа позволяет выявить цепочки возникающих
событий (шаблоны последовательностей). Он может использоваться тогда, когда
одним из важных анализируемых показателей является последовательность
наступления событий во времени. Например, можно выявить последовательность
товаров, которые закупаются друг за другом в течение какого-либо определенного
промежутка времени и т. п.</p>

<p class="Regularbeforepicture">Схематично процесс проведения анализа <span class="Interface">Поиск последовательностей</span> можно представить следующим
образом:</p>

<p class="Picture"><IMG src="_img/img00424.gif?_=1496848987" WIDTH="684" ALT HEIGHT="753"></p>

<p class="MsoCaption">Рис. 426.
Схема выполнения анализа «Поиск последовательностей»</p>

<p class="MsoNormal">В качестве источника данных может использоваться результат
запроса, таблица значений, область ячеек табличного документа. С точки зрения
данного типа анализа колонки источника можно разделить на следующие:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">НеИспользуемая</span> – игнорируются анализом;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Последовательность</span> – данные из этой
колонки используются для анализа как объект события последовательности. По
значению данной колонки анализ и ассоциирует данные с одной цепочкой событий;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Элемент</span> – данные из этой колонки
используются как элементы последовательности;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Время</span> – именно по данной колонке
определяется время наступления события. Наличие данной колонки обязательно при
проведении данного типа анализа.</p>

<p class="MsoNormal">Кроме настройки типов колонок, на результат проводимого
анализа влияют следующие параметры анализа:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">МинимальныйПроцентСлучаев</span> – минимальный
процент последовательностей, в которых наблюдается найденный шаблон
последовательности;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">МинимальныйИнтервал</span> – признак установки
минимального интервала последовательности (должна быть установлена единица
измерения интервала, кратность);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">МаксимальныйИнтервал</span> – признак установки
максимального интервала последовательности (должна быть установлена единица
измерения интервала, кратность);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ИнтервалЭквивалентностиВремени</span> – признак
установки интервала эквивалентности времени (должна быть установлена единица
интервала эквивалентности времени, ее кратность);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">МинимальнаяДлина</span> – минимальная длина искомых
последовательностей;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ПоискПоИерархии</span> – признак осуществления
поиска по иерархии (распространяется на колонки с типом <span class="Term">Элемент</span>).</p>

<p class="Regularbeforetable">Ряд свойств оперирует таким понятием, как <span class="Term">ТипЕдиницыИнтервалаВремениАнализаДанных</span>.
Данное системное перечисление содержит следующие значения:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><span class="Term">Секунда</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Минута</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущаяМинута</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Час</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущийЧас</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">День</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущийДень</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Неделя</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущаяНеделя</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Декада</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущаяДекада</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Месяц</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущийМесяц</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Квартал</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущийКвартал</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Полугодие</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущееПолугодие</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Год</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТекущийГод</span></p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpLast">Основным результатом анализа являются найденные
шаблоны последовательностей. Эти шаблоны содержат следующую информацию:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
состав шаблона последовательности;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
количество случаев, в которых наблюдалась данная
последовательность;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
максимальные интервалы между событиями (в
случае, если событий 2, то интервал один);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
минимальные интервалы между событиями (в случае,
если событий 2, то интервал один);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
процент случаев, когда данная последовательность
выполнилась;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
средние интервалы между событиями (в случае,
если событий 2, то интервал один).</p>

<p class="Regularbeforetable">Особенности выполнения данного типа анализа
рассмотрим на примере следующей выборки данных:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td>
   <p class="MsoNormalCxSpFirst"><span class="Bold">Контрагент</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Первая покупка</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Вторая покупка</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Третья покупка</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Интервал</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Бондарев
  В.И.</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «УЮТ»</p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «УЮТ»</p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">25
  дней, 31 день</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  круглый</p>
  </td>
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов
  И.П.</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Джинс»</p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «Джинс»</p>
  </td>
 </tr>
 <tr>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Петров
  Б.С.</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  «Kitchen» 0.9x1.7</p>
  </td>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Кресло
  «УЮТ»</p>
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">43
  дня</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стул
  «Summer»</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «УЮТ»</p>
  </td>
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Сидоров
  Г.О.</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  прямоугольный</p>
  </td>
 </tr>
 <tr>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Степанов
  В.К.</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  кухонный раскладной</p>
  </td>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td rowspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  прямоугольный</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  обеденный</p>
  </td>
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Федоров
  Д.Е.</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стол
  «Kitchen» 0.9x1.7</p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Шкаф
  «Wardrobe»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Стул
  «Summer»</p>
  </td>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">58
  дней, 29 дней</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Диван
  «Комфорт»</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Табурет
  круглый</p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpMiddle">Данные из колонки <span class="Term">Контрагент</span> будут
определять принадлежность к конкретной цепочке событий, т. е. они
определяют последовательность анализа. <span class="Term">Номенклатура</span> будет являться элементом
получаемой последовательности.</p>

<p class="MsoNormalCxSpLast">Для проведения анализа может использоваться фрагмент
кода, аналогичный приведенному ниже:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПоискПоследовательностей<span class="operator">(</span>Команда<span class="operator">)</span>
    Результат <span class="operator">=</span> АнализПоискПоследовательностей<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаСервереБезКонтекста</span>
<span class="keyword">Функция</span> АнализПоискПоследовательностей<span class="operator">(</span><span class="operator">)</span>
    Анализ <span class="operator">=</span> <span class="keyword">Новый</span> АнализДанных<span class="operator">;</span>
    Анализ<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхПоискПоследовательностей&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
    Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;</span>
<span class="string">        |ВЫБРАТЬ</span>
<span class="string">        |Продажи.Контрагент,</span>
<span class="string">        |Продажи.Номенклатура,</span>
<span class="string">        |Продажи.Период</span>
<span class="string">        |ИЗ</span>
<span class="string">        |РегистрНакопления.Продажи КАК Продажи&quot;</span><span class="operator">;</span>
    Анализ<span class="operator">.</span>ИсточникДанных <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Анализ<span class="operator">.</span>НастройкаКолонок<span class="operator">.</span>Период<span class="operator">.</span>ТипКолонки <span class="operator">=</span> ТипКолонкиАнализаДанныхПоискПоследовательностей<span class="operator">.</span>Время<span class="operator">;</span>
    РезультатАнализа <span class="operator">=</span> Анализ<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель <span class="operator">=</span> <span class="keyword">Новый</span> ПостроительОтчетаАнализаДанных<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>Макет <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхПоискПоследовательностей&quot;</span><span class="operator">)</span><span class="operator">;</span>
    ТабДок <span class="operator">=</span> <span class="keyword">Новый</span> ТабличныйДокумент<span class="operator">;</span>
    Построитель<span class="operator">.</span>Вывести<span class="operator">(</span>РезультатАнализа<span class="operator">,</span> ТабДок<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Возврат</span> ТабДок<span class="operator">;</span>
<span class="keyword">КонецФункции</span></pre>

<p class="MsoNormal">Поле <span class="Term">Период</span> определяется как <span class="Term">Время</span>
непосредственно из кода (самостоятельно анализом не определяется).</p>

<p class="Regularbeforepicture">Параметры анализа, установленные по умолчанию:</p>

<p class="Picture"><IMG src="_img/img00425.gif?_=1496848987" WIDTH="409" ALT HEIGHT="113"></p>

<p class="MsoCaption">Рис. 427.
Параметры анализа</p>

<p class="Regularbeforepicture">После проведения анализа получены следующие общие
данные:</p>

<p class="Picture"><IMG src="_img/img00426.gif?_=1496848987" WIDTH="413" ALT HEIGHT="127"></p>

<p class="MsoCaption">Рис. 428.
Общие данные анализа</p>

<p class="MsoNormal">Количество элементов равно двенадцати. Ровно столько
номенклатурных позиций встречается в приведенной выборке данных.</p>

<p class="Regularbeforepicture">Найдены две последовательности:</p>

<p class="Picture"><IMG src="_img/img00427.gif?_=1496848987" WIDTH="717" ALT HEIGHT="160"></p>

<p class="MsoCaption">Рис. 429.
Найденные последовательности</p>

<p class="MsoNormal">Первая последовательность встречается в двух случаях из
пяти. Исходя из этого, процент случаев равен 40 %. Так как глубина
последовательности равна 2, существует по одному значению каждого из приводимых
интервалов.</p>

<a id="TI000000706" class="bookmark" name="issogl1_14.6_тип_анализа_дерево_решений"><h2>14.6. Тип анализа «Дерево решений»</h2></a>

<p class="MsoNormal">С помощью данного типа анализа можно получить
причинно-следственную иерархию условий, приводящую к определенному решению.
Например, получить дерево условий, по которому (с определенной долей
вероятности) можно понять причину расторжения договоров с клиентами компании,
определения условий, влияющих на вариант заключаемого договора. Можно проводить
«профилирование» менеджеров компании по различным видам ее клиентов и т. п.</p>

<p class="Regularbeforepicture">Схематично процесс проведения анализа <span class="Interface">Дерево решений</span> можно представить следующим образом:</p>

<p class="Picture"><IMG src="_img/img00428.gif?_=1496848987" WIDTH="517" ALT HEIGHT="619"></p>

<p class="MsoCaption">Рис. 430.
Схема выполнения анализа «Дерево решений»</p>

<p class="MsoNormal">С точки зрения данного типа анализа колонки источника можно
разделить на следующие:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">НеИспользуемая</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Входная</span>,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Прогнозируемая</span>.</p>

<p class="MsoNormal">Используемые параметры анализа:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">МинимальноеКоличествоСлучаев</span> –
минимальное количество элементов в узле;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">МаксимальнаяГлубина</span> – максимальная
глубина дерева;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ТипУпрощения</span> – тип упрощения дерева
решений.</p>

<p class="MsoNormal">В результате проведенного анализа можно получить:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
дерево решений,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
ошибки классификации.</p>

<p class="Regularbeforetable">Разберемся с особенностью данного типа анализа на
примере следующей выборки данных:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <thead>
  <tr>
   <td>
   <p class="MsoNormalCxSpFirst"><span class="Bold">Контрагент</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Количество розничных точек</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Количество автомобилей</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Время работы организации</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Время заключения договора</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Вид договора</span></p>
   </td>
   <td>
   <p class="MsoNormalCxSpMiddle"><span class="Bold">Состояние взаимоотношений</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗАО
  Игорь</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дилер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Несоблюдение
  договора</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗАО
  ТогрМебель</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">15</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  трех до десяти лет</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дистрибьютор</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение
  контрагентом</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗАО
  ТогрМебель</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">10</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  трех до десяти лет</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  года до трех</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дистрибьютор</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение
  контрагентом</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ИЧП
  Дубрава</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  года до трех</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дилер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение
  контрагентом</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Магазин
  № 15</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Свыше
  десяти лет</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  трех до десяти лет</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный
  партнер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не
  прекращены</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ООО
  Гросс</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный
  партнер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не
  прекращены</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ООО
  Интарис</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">7</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  трех до десяти лет</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  года до трех</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный
  партнер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение
  контрагентом</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ООО
  ТогрТрест</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Свыше
  десяти лет</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От
  трех до десяти лет</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный
  партнер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не
  прекращены</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ПБОЮЛ
  Курочкин</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше
  года</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дилер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не
  прекращены</p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpLast">Для проведения анализа может использоваться фрагмент
кода, аналогичный приведенному ниже:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ДеревоРешений<span class="operator">(</span>Команда<span class="operator">)</span>
    Результат <span class="operator">=</span> АнализДеревоРешений<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаСервереБезКонтекста</span>
<span class="keyword">Функция</span> АнализДеревоРешений<span class="operator">(</span><span class="operator">)</span>
    Анализ <span class="operator">=</span> <span class="keyword">Новый</span> АнализДанных<span class="operator">;</span>
    Анализ<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхДеревоРешений&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Группа <span class="operator">=</span> Справочники<span class="operator">.</span>Контрагенты<span class="operator">.</span>НайтиПоНаименованию<span class="operator">(</span><span class="string">&quot;Юридические лица&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
    Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;</span>
<span class="string">        |ВЫБРАТЬ</span>
<span class="string">        |Контрагенты.Ссылка,</span>
<span class="string">        |Контрагенты.КоличествоРозничныхТочек,</span>
<span class="string">        |Контрагенты.КоличествоАвтомобилей,</span>
<span class="string">        |Контрагенты.ВремяРаботыОрганизации,</span>
<span class="string">        |Контрагенты.ВремяЗаключенияДоговора,</span>
<span class="string">        |Контрагенты.ВидДоговора,</span>
<span class="string">        |Контрагенты.ПрекращениеОтношений</span>
<span class="string">        |ИЗ</span>
<span class="string">        |Справочник.Контрагенты КАК Контрагенты</span>
<span class="string">        |ГДЕ</span>
<span class="string">        |(НЕ Контрагенты.ЭтоГруппа И Контрагенты.Родитель = &amp;Родитель)&quot;</span><span class="operator">;</span>
    Запрос<span class="operator">.</span>УстановитьПараметр<span class="operator">(</span><span class="string">&quot;Родитель&quot;</span><span class="operator">,</span> Группа<span class="operator">)</span><span class="operator">;</span>
    Анализ<span class="operator">.</span>ИсточникДанных <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Анализ<span class="operator">.</span>Параметры<span class="operator">.</span>ТипУпрощения<span class="operator">.</span>Значение <span class="operator">=</span> ТипУпрощенияДереваРешений<span class="operator">.</span>НеУпрощать<span class="operator">;</span>
    РезультатАнализа <span class="operator">=</span> Анализ<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель <span class="operator">=</span> <span class="keyword">Новый</span> ПостроительОтчетаАнализаДанных<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>Макет <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхДеревоРешений&quot;</span><span class="operator">)</span><span class="operator">;</span>
    ТабДок <span class="operator">=</span> <span class="keyword">Новый</span> ТабличныйДокумент<span class="operator">;</span>
    Построитель<span class="operator">.</span>Вывести<span class="operator">(</span>РезультатАнализа<span class="operator">,</span> ТабДок<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Возврат</span> ТабДок<span class="operator">;</span>
<span class="keyword">КонецФункции</span></pre>

<p class="Regularbeforepicture">В результате проведения анализа получено
следующее дерево решений:</p>

<p class="Picture"><IMG src="_img/img00429.gif?_=1496848987" WIDTH="708" ALT HEIGHT="286"></p>

<p class="MsoCaption">Рис. 431.
Дерево решений</p>

<p class="Regularbeforepicture">Данное дерево можно представить в виде следующей
схемы:</p>

<p class="Picture"><IMG src="_img/img00430.gif?_=1496848987" WIDTH="698" ALT HEIGHT="460"></p>

<p class="MsoCaption">Рис. 432.
Представление дерева решения в виде схемы</p>

<p class="Regularbeforepicture">Ошибки классификации показывают, в каких случаях
полученные правила расходятся с действительностью (исходной выборкой данных):</p>

<p class="Picture"><IMG src="_img/img00431.gif?_=1496848987" WIDTH="523" ALT HEIGHT="406"></p>

<p class="MsoCaption">Рис. 433.
Ошибки классификации</p>

<p class="MsoNormal">Исходя из приведенных данных, видно, что ошибок в полученной
классификации нет, то есть данные в фактической выборке совпадают с данными
классификации.</p>

<p class="Regularbeforepicture">Предыдущий пример получен, исходя из значения <span class="Term">НеУпрощать</span>
параметра анализа <span class="Term">ТипУпрощения</span>.
Данное значение параметра задано программно в примере выше. Если установить
значение <span class="Term">Упрощать</span>
параметра, дерево решений примет такой вид:</p>

<p class="Picture"><IMG src="_img/img00432.gif?_=1496848987" WIDTH="707" ALT HEIGHT="200"></p>

<p class="MsoCaption">Рис. 434.
Дерево решений</p>

<p class="MsoNormalCxSpFirst">Упрощение дерева заключается в том, что по
определенным правилам (формулам, которые будут рассмотрены ниже) узлы дерева
превращаются в листья (отсекается лишнее ветвление).</p>

<p class="MsoNormalCxSpLast">При принятии решения о том, будет ли произведено
преобразование узла в лист, учитываются следующие показатели:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Ошибок</span> – количество ошибок в узле;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ОшибокДочерних</span> – количество ошибок в
дочерних узлах;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Листов</span> – количество листов в узле;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Случаев</span> – количество случаев.</p>

<p class="Picture"><IMG src="_img/img00433.gif?_=1496848987" WIDTH="800" ALT HEIGHT="91"></p>

<p class="Regularbeforepicture">Решение о превращении узла в лист принимается в
случае выполнения условия:</p>

<p class="Picture"><IMG src="_img/img00434.gif?_=1496848987" WIDTH="674" ALT HEIGHT="69"></p>

<p class="MsoNormal">В нашем примере для узлов <span class="Interface">Время работы
организации</span> условие выполняется (0,5 &lt; 1).</p>

<p class="Regularbeforepicture">В связи с использованием упрощений появились и
ошибки в классификации, что показано в результате анализа:</p>

<p class="Picture"><IMG src="_img/img00435.gif?_=1496848987" WIDTH="525" ALT HEIGHT="408"></p>

<p class="MsoCaption">Рис. 435.
Ошибки классификации</p>

<p class="MsoNormal">Например, существует один случай, когда в реальной выборке
данных было значение <span class="Interface">Прекращение контрагентом</span>, а
по полученной классификации должно быть значение <span class="Interface">Не
прекращены</span> и т. п.</p>

<a id="TI000000707" class="bookmark" name="issogl1_14.7_тип_анализа_кластеризация"><h2>14.7. Тип анализа «Кластеризация»</h2></a>

<p class="MsoNormalCxSpFirst">Кластерный анализ – математическая процедура
многомерного анализа, позволяющая на основе множества показателей, характеризующих
ряд объектов, сгруппировать их в кластеры таким образом, чтобы объекты,
входящие в один кластер, были более однородными, сходными, по сравнению с
объектами, входящими в другие кластеры.</p>

<p class="MsoNormalCxSpLast">В основе данного анализа лежит вычисление расстояния
между объектами. Именно исходя из расстояний между объектами и производится их
группировка по кластерам. Определение расстояния может проводиться разными
способами (по разным метрикам). Поддерживаются следующие метрики:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Евклидова метрика,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Евклидова метрика в квадрате,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Метрика города,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Метрика доминирования.</p>

<p class="MsoNormal">После определения расстояний между объектами может
использоваться один из нескольких алгоритмов распределения объектов по
кластерам. Поддерживаются следующие методы кластеризации:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Ближняя связь,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Дальняя связь,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
k-средних,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Центр тяжести.</p>

<p class="Regularbeforepicture">Схематично механизм проведения кластерного
анализа можно представить следующим образом:</p>

<p class="Picture"><IMG src="_img/img00436.gif?_=1496848987" WIDTH="520" ALT HEIGHT="702"></p>

<p class="MsoCaption">Рис. 436.
Схема выполнения кластерного анализа</p>

<p class="MsoNormalCxSpFirst">На вход объекту <span class="Term">АнализДанных</span>
подается источник данных. В качестве источника может выступать результат
запроса, таблица значений, область ячеек табличного документа. Колонки
источника определяются как входные либо неиспользуемые. Следует отметить, что
все значения колонок содержатся в системном перечислении <span class="Term">ТипКолонкиАнализаДанныхКластеризация</span>.
В этом перечислении значений больше (не только неиспользуемые и входные), но
другие значения используются при построении прогнозов.</p>

<p class="MsoNormalCxSpMiddle">Анализ производится в соответствии с
установленными параметрами анализа.</p>

<p class="MsoNormalCxSpLast">В качестве примера, иллюстрирующего возможность
проведения кластерного анализа, будем использовать следующий фрагмент кода:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> КластерныйАнализ<span class="operator">(</span>Команда<span class="operator">)</span>
    Результат <span class="operator">=</span> АнализКластеризация<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаСервереБезКонтекста</span>
<span class="keyword">Функция</span> АнализКластеризация<span class="operator">(</span><span class="operator">)</span>
    Анализ <span class="operator">=</span> <span class="keyword">Новый</span> АнализДанных<span class="operator">;</span>
    Анализ<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхКластеризация&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Группа <span class="operator">=</span> Справочники<span class="operator">.</span>Контрагенты<span class="operator">.</span>НайтиПоНаименованию<span class="operator">(</span><span class="string">&quot;Юридические лица&quot;</span><span class="operator">)</span><span class="operator">;</span>
    Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
    Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;</span>
<span class="string">        |ВЫБРАТЬ</span>
<span class="string">        |Контрагенты.Ссылка,</span>
<span class="string">        |Контрагенты.КоличествоРозничныхТочек,</span>
<span class="string">        |Контрагенты.КоличествоАвтомобилей,</span>
<span class="string">        |Контрагенты.ВремяРаботыОрганизации,</span>
<span class="string">        |Контрагенты.ВремяЗаключенияДоговора,</span>
<span class="string">        |Контрагенты.ВидДоговора,</span>
<span class="string">        |Контрагенты.ПрекращениеОтношений</span>
<span class="string">        |ИЗ</span>
<span class="string">        |Справочник.Контрагенты КАК Контрагенты</span>
<span class="string">        |ГДЕ</span>
<span class="string">        |(НЕ Контрагенты.ЭтоГруппа И Контрагенты.Родитель = &amp;Родитель)&quot;</span><span class="operator">;</span>
    Запрос<span class="operator">.</span>УстановитьПараметр<span class="operator">(</span><span class="string">&quot;Родитель&quot;</span><span class="operator">,</span> Группа<span class="operator">)</span><span class="operator">;</span>
    Анализ<span class="operator">.</span>ИсточникДанных <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="comment">// Выбор метрики.</span>
    Анализ<span class="operator">.</span>Параметры<span class="operator">.</span>МераРасстояния<span class="operator">.</span>Значение <span class="operator">=</span>
ТипМерыРасстоянияАнализаДанных<span class="operator">.</span>ЕвклидоваМетрикаВКвадрате<span class="operator">;</span>
    <span class="comment">// Выбор метода кластеризации.</span>
    Анализ<span class="operator">.</span>Параметры<span class="operator">.</span>МетодКластеризации<span class="operator">.</span>Значение <span class="operator">=</span> МетодКластеризации<span class="operator">.</span>КСредних<span class="operator">;</span>
    РезультатАнализа <span class="operator">=</span> Анализ<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель <span class="operator">=</span> <span class="keyword">Новый</span> ПостроительОтчетаАнализаДанных<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>Макет <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
    Построитель<span class="operator">.</span>ТипАнализа <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;АнализДанныхКластеризация&quot;</span><span class="operator">)</span><span class="operator">;</span>
    ТабДок <span class="operator">=</span> <span class="keyword">Новый</span> ТабличныйДокумент<span class="operator">;</span>
    Построитель<span class="operator">.</span>Вывести<span class="operator">(</span>РезультатАнализа<span class="operator">,</span> ТабДок<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Возврат</span> ТабДок<span class="operator">;</span>
<span class="keyword">КонецФункции</span></pre>

<p class="MsoNormal">Запрос выполняется по справочнику <span class="Term">Контрагенты</span>. По
условию запроса выбираются только детальные записи справочника из группы <span class="Interface">Юридические лица</span>.</p>

<p class="Regularbeforepicture">Выполнение указанного кода приведет к тому, что в
качестве начальных установок анализа данных будут определены следующие значения
(часть установлена явно, часть – по умолчанию):</p>

<p class="Picture"><IMG src="_img/img00437.gif?_=1496848987" WIDTH="475" ALT HEIGHT="292"></p>

<p class="MsoCaption">Рис. 437.
Параметры анализа</p>

<p class="MsoNormal">Состав колонок определился, исходя из состава полей выборки
запроса. По умолчанию они определены с равным весом. Для типов <span class="Term">Число</span>
и <span class="Term">Дата</span>
определен вид данных <span class="Term">Непрерывные</span>,
для остальных типов – <span class="Term">Дискретные</span>. При необходимости изменить
параметры колонок это можно сделать по аналогии с приведенным фрагментом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Анализ<span class="operator">.</span>НастройкаКолонок<span class="operator">.</span>КоличествоАвтомобилей<span class="operator">.</span>ДополнительныеПараметры<span class="operator">.</span>Вес <span class="operator">=</span> <span class="number">2</span><span class="operator">;</span></pre>

<p class="MsoNormal">В данной строке для колонки <span class="Term">КоличествоАвтомобилей</span>
увеличен вес.</p>

<p class="Regularbeforetable">Выборка данных, для которых
будет произведен анализ, имеет следующее наполнение:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Контрагент</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Количество
  розничных точек</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Количество
  автомобилей</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Время
  работы организации</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Время
  заключения договора</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Вид
  договора</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Состояние
  взаимоотношений</b></p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗАО Игорь</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дилер</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Несоблюдение договора</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗАО ТогрМебель</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">15</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От трех до десяти лет</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дистрибьютор</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение контрагентом</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗАО ТогрМебель</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">10</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От трех до десяти лет</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От года до трех</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дистрибьютор</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение контрагентом</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ИЧП Дубрава</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От года до трех</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дилер</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение контрагентом</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Магазин № 15</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Свыше десяти лет</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От трех до десяти лет</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный партнер</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не прекращены</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ООО Гросс</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный партнер</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не прекращены</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ООО Интарис</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">7</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От трех до десяти лет</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От года до трех</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный партнер</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Прекращение контрагентом</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ООО ТогрТрест</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Свыше десяти лет</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">От трех до десяти лет</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Постоянный партнер</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не прекращены</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ПБОЮЛ Курочкин</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Меньше года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дилер</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Не прекращены</p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpMiddle"> </p>

<p class="MsoNormalCxSpLast"> </p>

<p class="Regularbeforepicture">Результат
анализа будет получен в следующем виде:</p>

<p class="Picture"><IMG src="_img/img00438.gif?_=1496848987" WIDTH="589" ALT HEIGHT="796"></p>

<p class="MsoCaption">Рис. 438.
Результат кластерного анализа</p>

<p class="MsoNormalCxSpFirst">Отметим тот факт, что в результате анализа
получаются данные именно о найденных кластерах (их количество, центры, расстояния
между ними). В результате анализа не получаются данные о том, какие объекты (в
нашем случае контрагенты) в какие кластеры входят. Подобное поведение
наблюдается в случае, если настройка параметров проводимого анализа не
проводится явным образом (а именно параметра <span class="Term">ТипЗаполненияТаблицы</span>).</p>

<p class="MsoNormalCxSpLast">Для того чтобы в результате анализа увидеть
распределение объектов по кластерам, необходимо перед выполнением анализа (но
после определения его типа) определить следующую строку кода:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Анализ<span class="operator">.</span>Параметры<span class="operator">.</span>ТипЗаполненияТаблицы<span class="operator">.</span>Значение <span class="operator">=</span> ТипЗаполненияТаблицыРезультатаАнализаДанных<span class="operator">.</span>ИспользуемыеПоля<span class="operator">;</span></pre>

<a id="TI000000708" class="bookmark" name="issogl2_14.7.1_используемые_метрики"><h3>14.7.1. Используемые метрики</h3></a>

<p class="MsoNormalCxSpFirst">Сразу отметим такой факт: несмотря на то, что в
предыдущем примере входные колонки имели непрерывный тип (для этого типа
очевидно понятие «расстояния»), при анализе могут использоваться и колонки дискретных
типов (ссылки на справочники, значения перечислений и т. п.).</p>

<p class="MsoNormalCxSpLast">Разберемся с метриками, которые могут использоваться
при проведении кластерного анализа.</p>

<a id="TI000000709" class="bookmark" name="issogl3_14.7.1.1_евклидова_метрика"><h4>14.7.1.1. Евклидова метрика</h4></a>

<p class="Regularbeforepicture">В данной метрике расстояние между двумя объектами
вычисляется по формуле:</p>

<p class="Picture"><IMG src="_img/img00439.gif?_=1496848987" WIDTH="560" ALT HEIGHT="66"></p>

<p class="MsoNormal">Где:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Xi, Yi – значения атрибутов двух объектов
(между которыми определяется расстояние);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Wi – весовой коэффициент атрибута
(устанавливается в колонке анализа);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
i – номер атрибута, от 1 до n;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
n – число атрибутов.</p>

<p class="Regularbeforepicture">Предположим, что объекты характеризуются одним
свойством, которое у одного объекта имеет значение 9, у другого – 5. Весовой
коэффициент данного атрибута равен единице. Расстояние между объектами будет
равно:</p>

<p class="Picture"><IMG src="_img/img00440.gif?_=1496848987" WIDTH="637" ALT HEIGHT="71"></p>

<a id="TI000000710" class="bookmark" name="issogl3_14.7.1.2_евклидова_метрика_в_квадрате"><h4>14.7.1.2. Евклидова метрика в квадрате</h4></a>

<p class="Regularbeforepicture">В данной метрике расстояние между двумя объектами
вычисляется по формуле:</p>

<p class="Picture"><IMG src="_img/img00441.gif?_=1496848987" WIDTH="539" ALT HEIGHT="59"></p>

<p class="MsoNormal">Где:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Xi, Yi – значения атрибутов двух объектов
(между которыми определяется расстояние);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Wi – весовой коэффициент атрибута
(устанавливается в колонке анализа);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
i – номер атрибута, от 1 до n;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
n – число атрибутов.</p>

<p class="Regularbeforepicture">Предположим, что объекты характеризуются одним
свойством, которое у одного объекта имеет значение 5, у другого – 3. Весовой
коэффициент данного атрибута равен двум. Расстояние между объектами будет
равно:</p>

<p class="Picture"><IMG src="_img/img00442.gif?_=1496848987" WIDTH="621" ALT HEIGHT="60"></p>

<a id="TI000000711" class="bookmark" name="issogl3_14.7.1.3_метрика_города"><h4>14.7.1.3. Метрика города</h4></a>

<p class="Regularbeforepicture">В данной метрике расстояние между двумя объектами
вычисляется по формуле:</p>

<p class="Picture"><IMG src="_img/img00443.gif?_=1496848987" WIDTH="517" ALT HEIGHT="59"></p>

<p class="MsoNormal">Где:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Xi, Yi – значения атрибутов двух объектов
(между которыми определяется расстояние);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Wi – весовой коэффициент атрибута
(устанавливается в колонке анализа);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
i – номер атрибута, от 1 до n;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
n – число атрибутов.</p>

<p class="Regularbeforepicture">Предположим, что объекты характеризуются двумя
атрибутами, которые имеют значения 3 и 5, 7 и 3. Вес первого равен 2, вес
второго равен 1:</p>

<p class="Picture"><IMG src="_img/img00444.gif?_=1496848987" WIDTH="538" ALT HEIGHT="219"></p>

<p class="MsoCaption"><a name="_ref340071251">Рис. </a>439. Характеристики объектов</p>

<p class="Picture"><IMG src="_img/img00445.gif?_=1496848987" WIDTH="800" ALT HEIGHT="41"></p>

<a id="TI000000712" class="bookmark" name="issogl3_14.7.1.4_метрика_доминирования"><h4>14.7.1.4. Метрика доминирования</h4></a>

<p class="Regularbeforepicture">В данной метрике расстояние между двумя объектами
вычисляется по формуле:</p>

<p class="Picture"><IMG src="_img/img00446.gif?_=1496848987" WIDTH="559" ALT HEIGHT="51"></p>

<p class="MsoNormal">Где:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Xi, Yi – значения атрибутов двух объектов
(между которыми определяется расстояние);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Wi – весовой коэффициент атрибута
(устанавливается в колонке анализа);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
i – номер атрибута, от 1 до n;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
n – число атрибутов.</p>

<p class="Regularbeforepicture">Предположим, что объекты характеризуются двумя
атрибутами, которые имеют значения 3 и 5, 7 и 3. Вес первого равен 2, вес
второго равен 1 (см. <a href="#_ref340071251">рис.
439</a>).</p>

<p class="Picture"><IMG src="_img/img00447.gif?_=1496848987" WIDTH="800" ALT HEIGHT="39"></p>

<a id="TI000000713" class="bookmark" name="issogl2_14.7.2_методы_кластеризации"><h3>14.7.2. Методы кластеризации</h3></a>

<p class="MsoNormalCxSpFirst">Вариант метода кластеризации определяет, исходя из
каких принципов объект соотносится к той или иной группе, по какому алгоритму
производится формирование кластеров.</p>

<p class="MsoNormalCxSpLast">Можно сказать, что целью любого алгоритма кластеризации
является:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
минимизация изменчивости внутри кластеров,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
максимизация изменчивости между кластерами.</p>

<p class="MsoNormal">Различия между методами будем рассматривать на объектах,
представленных на рисунке (см. <a href="#_ref340222852">рис.
440</a>).</p>

<p class="Regularbeforepicture">Будем считать, что объекты образуют две группы.
Первая состоит из объектов 1, 2 и 3. Вторая группа состоит из объектов 4, 5 и
6.</p>

<p class="Picture"><IMG src="_img/img00448.gif?_=1496848987" WIDTH="469" ALT HEIGHT="249"></p>

<p class="MsoCaption"><a name="_ref340222845"></a><a name="_ref340222852">Рис. </a>440. Группы объектов</p>

<a id="TI000000714" class="bookmark" name="issogl3_14.7.2.1_ближняя_связь"><h4>14.7.2.1. Ближняя связь</h4></a>

<p class="MsoNormalCxSpFirst">Метод кластеризации, в котором объект
присоединяется к той группе, для которой расстояние до ближайшего объекта минимально.</p>

<p class="MsoNormalCxSpLast">В рассматриваемом примере объект 7 будет включен в
группу, в которой находится объект 4. Самыми близкими объектами двух групп
являются объекты 4 и 3. Расстояние до объекта 4 минимально.</p>

<a id="TI000000715" class="bookmark" name="issogl3_14.7.2.2_дальняя_связь"><h4>14.7.2.2. Дальняя связь</h4></a>

<p class="MsoNormalCxSpFirst">Метод кластеризации, в котором объект
присоединяется к той группе, для которой расстояние до наиболее дальнего
объекта минимально.</p>

<p class="MsoNormalCxSpLast">В рассматриваемом примере объект 7 будет включен в
группу, в которой находится объект 5. Самыми дальними объектами двух групп
являются объекты 1 и 5. Расстояние до объекта 5 меньше.</p>

<a id="TI000000716" class="bookmark" name="issogl3_14.7.2.3_центр_тяжести"><h4>14.7.2.3. Центр тяжести</h4></a>

<p class="Regularbeforepicture">Метод
кластеризации, в котором объект присоединяется к той группе, для которой
расстояние до центра тяжести минимально:</p>

<p class="Picture"><IMG src="_img/img00449.gif?_=1496848987" WIDTH="657" ALT HEIGHT="322"></p>

<p class="MsoCaption">Рис. 441. Группы объектов</p>

<p class="MsoNormal">В примере,
рассмотренном на рисунке, объект 7 добавится в группу, содержащую объекты 4, 5
и 6. Расстояние до центра тяжести (некоего мифического объекта со средними
значениями атрибутов) минимально.</p>

<a id="TI000000717" class="bookmark" name="issogl3_14.7.2.4_k-средних"><h4>14.7.2.4. k-средних</h4></a>

<p class="MsoNormal">В данном методе выбираются объекты, находящиеся первыми в
выборке. Они считаются центрами кластеров. Далее выбирается следующий объект и,
в соответствии с расстоянием до центров кластеров, относится к тому или иному
кластеру. Центр кластера, к которому был добавлен объект, пересчитывается.</p>

<p class="Regularbeforepicture">Процедура повторяется до полного перебора всех
объектов. Далее опять производится новая выборка объектов (начиная с первого).
Процедура повторяется до тех пор, пока изменяются центры кластеров:</p>

<p class="Picture"><IMG src="_img/img00450.gif?_=1496848987" WIDTH="763" ALT HEIGHT="292"></p>

<p class="MsoCaption">Рис. 442.
Пример расположения объектов</p>

<p class="MsoNormalCxSpFirst">Предположим, что произвольно выбраны в качестве
центров кластеров объекты 1 и 2. Объект 3 добавляется к кластеру, центром
которого является объект 1. Центр первого кластера перерассчитывается (он
находится между объектом 1 и 3). Объект 4 добавляется ко второму кластеру (его
центр также перерассчитывается).</p>

<p class="MsoNormalCxSpMiddle">После перебора всех анализируемых объектов к
первому кластеру относятся объекты 1 и 3, ко второму – остальные объекты
(его центр предположительно находится в центре треугольника из объектов 4, 7,
6).</p>

<p class="MsoNormalCxSpMiddle">Далее опять производится выборка объектов и
распределение их по кластерам (относительно постоянно рассчитываемых центров
кластеров).</p>

<p class="MsoNormalCxSpMiddle">Где-то на третьей выборке объектов, скорее всего,
объект 2, который изначально был центром второго кластера, станет относиться к
первому кластеру.</p>

<p class="MsoNormalCxSpLast">В конце алгоритма к первому кластеру будут
относиться объекты 1, 2, 3. Ко второму – объекты 4, 5, 6, 7.</p>

<a id="TI000000718" class="bookmark" name="issogl3_14.7.2.5_вывод_данных_в_дендрограмму"><h4>14.7.2.5. Вывод данных в дендрограмму</h4></a>

<p class="Regularbeforepicture">При выводе данных кластерного анализа, если
используется алгоритм, отличный от алгоритма k-средних, результаты кластерного
анализа выводятся в виде дендрограммы (алгоритм анализа должен предусматривать
вывод распределения анализируемых объектов по кластерам):</p>

<p class="Picture"><IMG src="_img/img00451.gif?_=1496848987" WIDTH="686" ALT HEIGHT="436"></p>

<p class="MsoCaption">Рис. 443.
Дендрограмма</p>

<p class="MsoNormal"> </p>

<br>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>