<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1043;&#1083;&#1072;&#1074;&#1072; 23. &#1042;&#1085;&#1077;&#1096;&#1085;&#1080;&#1077; &#1080;&#1089;&#1090;&#1086;&#1095;&#1085;&#1080;&#1082;&#1080; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;</title>
		<LINK REL="stylesheet" href="style.css?_=1496848987">
		<SCRIPT src="script.js?_=1496848987" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js?_=1496848987" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="/db/content/v8310doc/src/руководство разработчика/глава 23. внешние источники данных.htm" rel="canonical">
<link href="/static/its.content.css?_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="/static/its.content.js?_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="/static/html5shiv.js?_=1484636606"></script><![endif]-->

</head>
	<body class="v8310doc">
<a name="_ref406512450"></a><a name="_ref406512439"></a><a name="_ref370293939"></a><a name="_ref353536991"></a><a name="_ref353536990"></a><a name="_ref322432937"></a><a name="_ref322432936"></a><a name="_ref322431997"></a><a name="_ref310422611"></a><a name="_ref310422610"></a><a id="TI000000837" class="bookmark"><h1>Глава 23.  Внешние источники данных</h1></a>

<a id="TI000001634" class="bookmark" name="issogl1_23.1_общая_информация"><h2>23.1. Общая информация</h2></a>

<p class="MsoNormal">При
эксплуатации информационной системы, построенной на базе «1С:Предприятия»,
могут возникать задачи, связанные с получением информации из внешних баз данных
(как реляционных, так и аналитических) и использованием этой информации в
«1С:Предприятии» различным образом, например, в виде отчетов или для каких-либо
расчетов. Для решения такого рода задач в «1С:Предприятии» существует объект
конфигурации <span class="Term">ВнешниеИсточникиДанных</span>.
В состав внешнего источника данных могут входить таблицы реляционного источника
данных и кубы аналитического источника данных. В прикладном решении может существовать
произвольное количество подключенных внешних источников данных. Далее будет
более подробно рассмотрена работа с каждым видом внешнего источника данных.</p>

<a id="TI000000838" class="bookmark" name="issogl1_23.2_работа_с_реляционными_внешними_источниками_данных"><h2>23.2. Работа с реляционными внешними источниками данных</h2></a>

<a name="_ref362879459"></a><a name="_ref362879458"></a><a name="_ref390687120"></a><a name="_ref390687119"></a><a id="TI000000839" class="bookmark" name="issogl2_23.2.1_общая_информация"><h3>23.2.1. Общая информация</h3></a>

<p class="MsoNormal">Объект,
описывающий внешний источник данных, подключенный к реляционной базе данных,
состоит из таблиц, а каждая таблица состоит из полей. Данные в таблицах могут
ссылать на другие таблицы – например, значение в поле таблицы может являться
идентификатором записи в другой таблице. Объект,
описывающий внешний источник данных, может быть использован следующим образом:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
в качестве источника данных для запросов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
в качестве источника данных в системе компоновки
данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
в качестве источника для динамических списков;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
входить в состав общих реквизитов
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref284330956">здесь</a>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
записи таблиц могут отображаться в управляемых формах
«1С:Предприятия» (не поддерживается использование обычных форм для объектов
внешних источников данных);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблицы внешнего источника данных могут
выступать в качестве типов реквизитов информационной базы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
к таблицам (и полям) внешних источников данных
можно применять права доступа и накладывать ограничения доступа к данным;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
доступ к таблицам и полям возможен из
встроенного языка;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблица внешнего источника данных может входить
в состав подсистем (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref9243524">здесь</a></span></span></span></span></span></span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблица внешнего источника данных может входить
в состав функциональных опций (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref292444461">здесь</a></span></span></span></span></span></span>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
для таблицы внешнего источника данных можно
создавать характеристики (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref45029020">здесь</a></span></span></span></span></span></span>).</p>

<p class="MsoNormal">Для получения доступа к внешним источникам
данных используется механизм ODBC. Данные внешних источников данных доступны как
для <span class="Bold">чтения</span>, так и для <span class="Bold">записи</span>.</p>

<p class="Note"><span class="Note">Внимание!</span> Механизм внешних
источников данных не должен использоваться для доступа к базам данных
«1С:Предприятия», так как модель данных «1С:Предприятия» не рассчитана на
работу с данными на уровне физических структур хранения в системах управления
базами данных (СУБД). Возможность записи во внешние источники данных не должна
использоваться для замены штатного механизма хранения данных прикладного
решения.</p>

<p class="MsoNormal">Возможности системы «1С:Предприятие» максимально
учитываются при использовании в качестве источника внешних данных следующих
СУБД (свойство <span class="Interface">Тип СУБД</span> параметров соединения с источником данных):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Microsoft SQL Server,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
IBM DB2,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
PostgreSQL,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Oracle
Database,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
MySQL.</p>

<p class="Note"><span class="Note">Примечание.</span> При работе с внешним
источником данных могут возникать ошибки в том случае, если свойство <span class="Interface">Тип СУБД</span> параметров соединения с внешним источником
данных содержит значение, которое не соответствует реально используемой системе.</p>

<p class="MsoNormalCxSpFirst">При использовании других СУБД возможности
работы с внешними источниками данных зависят от самой СУБД. Для таких источников
данных, следующие функции и выражения языка запросов: <span class="Term">ПОДСТРОКА</span>,
<span class="Term">ГОД</span>, <span class="Term">КВАРТАЛ</span>,
<span class="Term">МЕСЯЦ</span>, <span class="Term">ДЕНЬГОДА</span>,
<span class="Term">ДЕНЬ</span>, <span class="Term">НЕДЕЛЯ</span>,
<span class="Term">ДЕНЬНЕДЕЛИ</span>, <span class="Term">ЧАС</span>,
<span class="Term">МИНУТА</span>, <span class="Term">СЕКУНДА</span>,
<span class="Term">РАЗНОСТЬДАТ</span>, <span class="Term">ЕСТЬNULL</span>,
<span class="Term">ВЫРАЗИТЬ</span>, <span class="Term">СПЕЦСИМВОЛ</span>,
<span class="Term">СОЕДИНЕНИЕ</span>, <span class="Term">ЛЕВОЕ
СОЕДИНЕНИЕ</span>, <span class="Term">ПРАВОЕ
СОЕДИНЕНИЕ</span>, <span class="Term">ПОЛНОЕ
СОЕДИНЕНИЕ</span>, преобразуются в запрос к СУБД с использованием
управляющих последовательностей ODBC (ODBC Escape Sequences, <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms715364(v=vs.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/desktop/ms715364(v=vs.85).aspx</a>, на
английском языке).</p>

<p class="MsoNormalCxSpMiddle">В случае
использования внешнего источника данных в качестве источника для динамического
списка, следует помнить, что упорядочивание динамического списка выполняется с
использованием порядка сортировки, который установлен для базы данных, выступающей
в качестве внешнего источника данных. Порядок сортировки может не совпадать с
тем порядком сортировки, который используется в том случае, если база данных
используется собственно «1С:Предприятием». В связи с этим возможны ситуации,
когда результат упорядочивания в информационной базе и во внешнем источнике
данных будет отличаться (при одинаковых упорядочиваемых данных). Такое
поведение является нормальным.</p>

<p class="MsoNormalCxSpMiddle">Для осуществления подключения к внешнему
источнику данных следует сформировать строку подключения, которая может содержать
в себе либо все параметры подключения, необходимые для выбранного драйвера ODBC,
либо указание на сформированное описание источника данных DSN (Data Source Name). Подробнее о строке
подключения см. <a href="#_ref323731960">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Ниже приводятся примеры строк подключения.</p>

<p class="Lang-subheader">Строка соединения с указанием логина и
пароля доступа:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">DRIVER={SQL Server};SERVER=(local);UID=user;PWD=password;DATABASE=AdventureWorksLT2008</pre>

<p class="Lang-subheader">Логин и пароль доступа требуется указывать
дополнительно:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">DRIVER={SQL Server};SERVER=CASH-SERVER;DATABASE=CasheReceipts</pre>

<p class="Lang-subheader">Указание предварительно настроенного
источника данных (DSN):</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">DSN=MyDB</pre>

<p class="MsoNormal">Также следует помнить, что соединение с
внешним источником данных следует указывать не только в конфигураторе (если используется
механизм импорта структуры таблиц из внешнего источника данных), но и в режиме <span class="Interface">1С:Предприятие</span> для получения собственно данных.</p>

<a id="TI000000840" class="bookmark" name="issogl2_23.2.2_общая_схема_использования"><h3>23.2.2. Общая схема использования</h3></a>

<p class="MsoNormal">Для того чтобы использовать информацию из
внешних источников данных в системе на базе «1С:Предприятия», следует придерживаться
следующей общей схемы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Изучить структуру внешнего источника данных и
понять, какая информация (таблицы и поля) необходима для работы алгоритмов или
отчетов в «1С:Предприятии».</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Создать объект <span class="Interface">Внешние источники данных</span> в конфигураторе и для него
создать подчиненные таблицы и поля. Это можно сделать с помощью специального
помощника.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Реализовать использование созданных объектов в
прикладном решении.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Выполнить настройку параметров подключения к
внешнему источнику данных в той сети, где будет использоваться прикладное
решение. Эти параметры могут отличаться от тех, которые использовались при
загрузке структуры внешнего источника данных.</p>

<p class="Note">Примечание. Параметры доступа к внешнему источнику
данных, которые были заданы в конфигураторе, не будут использованы системой в
режиме 1С:Предприятие.</p>

<a id="TI000000841" class="bookmark" name="issogl2_23.2.3_редактирование_структуры_внешнего_источника_данных"><h3>23.2.3. Редактирование структуры внешнего источника данных</h3></a>

<a id="TI000001635" class="bookmark" name="issogl3_23.2.3.1_общая_информация"><h4>23.2.3.1. Общая информация</h4></a>

<p class="MsoNormal">Для работы с таблицами внешних источников
данных предназначена ветвь с именем соответствующего внешнего источника данных
ветви <span class="Interface">Внешние источники
данных – &lt;Имя внешнего источника данных&gt; – Таблицы</span>
дерева конфигурации. Определение внешнего источника данных состоит из следующих
шагов:</p>

<p class="MsoListNumberCxSpFirst">1. 
Определение собственно внешнего источника данных;</p>

<p class="MsoListNumberCxSpMiddle">2. 
Определение таблиц источника данных;</p>

<p class="MsoListNumberCxSpLast">3. 
Определение полей для каждой таблицы внешнего
источника данных.</p>

<p class="MsoNormalCxSpFirst">При этом в конфигурации может быть описано
меньшее количество таблиц и полей в них, чем есть в реальной базе данных, но
нельзя задать таблицу или поле, которое отсутствует в реальной базе данных.</p>

<p class="MsoNormalCxSpLast">Создание структуры внешнего источника данных
возможно как в ручном режиме, так и при загрузке этой структуры с помощью
специального конструктора.</p>

<a id="TI000000842" class="bookmark" name="issogl3_23.2.3.2_внешний_источник_данных"><h4>23.2.3.2. Внешний источник данных</h4></a>

<p class="MsoNormalCxSpFirst">При создании внешнего источника данных следует указать его
имя. Этот объект предназначен для идентификации группы таблиц при обращении к
данным, которые в нем содержатся. Источник данных состоит из одной или
нескольких таблиц, которые, в свою очередь, состоят из полей.</p>

<p class="MsoNormalCxSpLast">Если во внешний источник данных
предполагается запись, то следует установить нужное значение в свойстве <span class="Interface">Режим управления блокировкой данных</span>. Если для внешнего
источника данных режим управления блокировок установлен в значение <span class="Interface">Автоматический и управляемый</span>, то для каждой таблицы
режим блокировок определяется значением соответствующего свойства таблицы. Если
для внешнего источника данных выбран определенный конкретный режим управления
блокировками, то одноименное свойство таблицы внешнего источника данных
игнорируется.</p>

<a name="_ref324436136"></a><a name="_ref324436135"></a><a name="_ref380677346"></a><a id="TI000000843" class="bookmark" name="issogl3_23.2.3.3_таблица_внешнего_источника_данных"><h4>23.2.3.3. Таблица внешнего источника данных</h4></a>

<p class="MsoNormalCxSpFirst">При создании новой таблицы открывается окно редактирования
объекта (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 2. работа с конфигурацией.htm?_=1496848987#_ref292444555">здесь</a></span></span></span></span></span></span>).</p>

<p class="MsoNormalCxSpMiddle">Свойство таблицы <span class="Interface">Имя</span> служит для идентификации таблицы внутри прикладного
решения. Для того чтобы система знала, какой физической таблице внешнего
источника данных соответствует объект конфигурации, следует заполнить свойство <span class="Interface">Имя в источнике данных</span>. Значение в этом свойстве в
точности должно соответствовать имени таблицы внешнего источника данных. Не поддерживается
размещение в одной таблице прикладного решения данных из нескольких физических
таблиц внешнего источника данных.</p>

<p class="MsoNormalCxSpLast">Свойство <span class="Interface">Тип данных таблицы</span> определяет, какие сущности в этой
таблице хранятся: объектные или необъектные. Если в таблице можно выделить одно
поле, которое однозначно определяет запись в таблице, значит, таблица может
хранить объектные данные. Ближайшим аналогом таких таблиц может служить
справочник. Если запись в таблице идентифицируется несколькими ключевыми
полями, то такая таблица содержит необъектные данные. Ближайшим аналогом таких
таблиц служит регистр сведений. Ключевые поля таблицы необходимо указать в
свойстве <span class="Interface">Поля
ключа</span>.</p>

<p class="Note"><span class="Note">Примечание.</span> Не рекомендуется
использовать в качестве ключевых полей объектной таблицы внешнего источника
данных поля, которые содержат значения <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpFirst">Для таблиц, содержащих объектные данные,
можно указать поле, которое будет выступать в качестве представления объекта.
Это можно сделать с помощью свойства <span class="Interface">Поле представления</span>.</p>

<p class="MsoNormalCxSpMiddle">В зависимости от того, какой объект СУБД
описывает создаваемая объект в «1С:Предприятие», следует корректно установить
свойство <span class="Interface">Вид
таблицы</span>. Если свойство установлено в значение <span class="Interface">Таблица</span> – то объект конфигурации будет выступать
аналогом реальной таблицы базы данных или представления (view). В остальных случаях
свойство <span class="Interface">Вид
таблицы</span> следует установить в значение <span class="Interface">Выражение</span>. Если таблица внешнего источника данных имеет
вид <span class="Interface">Таблица</span>, то в
свойство <span class="Interface">Имя
в источнике данных</span> необходимо указать имя реальной таблицы или не
параметризованного представления, например <span class="Term">dbo.ErrorLog</span>.
Для таблицы вида <span class="Interface">Выражение</span>, следует указать свойство <span class="Interface">Выражение в источнике данных</span>. В простейшем случае это
будет вызов функции, возвращающей табличные данные, например <span class="Term">dbo.ufnGetContactInformation(&amp;1)</span>.
Если в это поле записывается выражение, то рекомендуется указать его в скобках,
для минимизации различных конфликтов при реальном выполнении запроса к СУБД.</p>

<p class="MsoNormalCxSpLast">Если таблица хранит иерархические данные, то
системе можно сообщить об этом с помощью свойств <span class="Interface">Поле родителя</span>, Признак незаполненного
родителя и <span class="Interface">Значение
незаполненного родителя</span>.
Эти свойства доступны только для таблиц, в которых хранятся объектные данные.
Свойство <span class="Interface">Поле
родителя</span> служит для указания поля таблицы базы данных, которое хранит
ссылку на родителя для данной записи. Поля, которые могут быть выбраны в данном
свойстве, должны иметь тип ссылки на используемую таблицу. Для таблицы <span class="Term">products</span>
из примера (см. <a href="#_ref324433859">здесь</a>) поле родителя должно иметь тип <span class="Term">ВнешнийИсточникДанныхТаблицаСсылка.DBF.products</span>.
Свойства <span class="Interface">Признак
незаполненного родителя</span> и <span class="Interface">Значение незаполненного родителя</span> определяют, какое
значение будет определять запись, у которой отсутствует родительская запись.
После указания данных свойств:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
система компоновки данных использует их при
работе с иерархическими группировками и при проверке условий иерархии;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
язык запросов использует их для работы
конструкции <span class="Term">В ИЕРАРХИИ</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
эти свойства используются при отображении
таблиц, хранящих иерархические данные (возможности отображения аналогичны
возможностям, которые используются при отображении иерархических справочников).</p>

<p class="MsoNormalCxSpFirst">Свойство <span class="Interface">Ввод по строке</span> (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref215985457">здесь</a></span></span></span></span></span></span>) позволяет указать имена
полей, по которым будет выполняться поиск в поле, тип данных которого указывает
на таблицу внешнего источника данных.</p>

<p class="MsoNormalCxSpMiddle">При ручном создании таблиц свойства <span class="Interface">Поле ключа</span>, <span class="Interface">Поле представления</span> и <span class="Interface">Ввод по строке</span> можно указать только после создания полей
таблицы внешнего источника данных.</p>

<p class="MsoNormalCxSpLast">За возможность записи в таблицу внешнего
источника данных отвечает флажок <span class="Interface">Только чтение</span>. Если флажок сброшен – в указанную
таблицу допускается запись информации. Флажок устанавливается в значение <span class="Term">Истина</span>
автоматически для таблиц, основанных на представлениях (view) и функциях
(см. <a href="#_ref422905463">здесь</a>). Для таблицы, в которую допустима запись информации,
следует обратить внимание на следующие свойства:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Уровень изоляции
транзакций</span> – определяет уровень изоляции транзакций, которые будет
устанавливаться при неявных транзакциях записи в эту таблицу
(см. <a href="#_ref380766776">здесь</a>).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Поле версии данных</span> –
в данном свойстве указывается поле внешнего источника данных, которое
увеличивает свое значение автоматически, при каждой записи в данную таблицу.
Если поле указано, то система при интерактивном изменении объекта опирается на
значение этого поля, При записи выполняется сравнение значения этого поля в
базе данных и в форме: если значения различаются, значит, объект изменен.</p>

<p class="Indentlist">Если поле не указано, то при интерактивном
открытии формы происходит считывание объекта в память, а при записи происходит
повторное чтение объекта и сравнение с копией в памяти. Если две копии
различаются, значит, объект изменен.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Поля блокировки данных</span> –
указывает поля, по которым можно выполнять блокировку данных. Подробнее
см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 9. работа с данными.htm?_=1496848987#_ref380681689">здесь</a>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Вводится на основании</span> –
указываются объекты конфигурации, на основании которых могут создаваться записи
в таблице.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Режим управления
блокировкой данных</span> – указывает, какой режим управления блокировками
будет применяться при записи в данную таблицу (см. <a href="#_ref380766776">здесь</a>).</p>

<a name="_ref322433552"></a><a name="_ref322433551"></a><a name="_ref380762674"></a><a id="TI000000844" class="bookmark" name="issogl3_23.2.3.4_поле_таблицы_внешнего_источника_данных"><h4>23.2.3.4. Поле таблицы внешнего источника данных</h4></a>

<p class="MsoNormalCxSpFirst">Поля таблицы описывают, какие данные физической таблицы
будут доступны из прикладного решения. Свойство поля <span class="Interface">Имя</span> служит для идентификации поля таблицы в прикладном
решении. Для указания соответствия между полем прикладного решения и полем
физической таблицы служит свойство <span class="Interface">Имя в источнике данных</span>. Значение в этом свойстве должно
в точности соответствовать имени колонки таблицы, указанному в свойстве <span class="Interface">Имя в источнике данных</span> родительского объекта данного
поля. Не поддерживается объединение в одном поле таблицы данных из нескольких
колонок одной или нескольких таблиц внешнего источника данных.</p>

<p class="MsoNormalCxSpMiddle">Если значение, находящееся в свойстве <span class="Interface">Имя в источнике данных</span> заключено в одинарные кавычки, то
в SQL-запрос к базе данных это значение попадает без преобразований, вне
зависимости от состава символов. Если значение в поле не заключено в одинарные
кавычки, то в SQL-запрос к базе данных это значение попадет заключенное в
двойные кавычки, если в имени содержатся спецсимволы.</p>

<p class="MsoNormalCxSpLast">Поле <span class="Interface">Тип</span> позволяет указать тип данного поля. Для выбора
доступен ограниченный набор типов. Типами поля могут быть:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Число</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Строка</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Дата</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Булево</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">УникальныйИдентификатор</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ДвоичныеДанные</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
типы, которые определяются таблицами внешних
источников данных.</p>

<p class="MsoNormalCxSpFirst">Если необходимо указать для поля составной
тип, то в таком составном типе могут участвовать только типы <span class="Term">Число</span>,
<span class="Term">Строка</span>, <span class="Term">Дата</span>,
<span class="Term">Булево</span>.</p>

<p class="MsoNormalCxSpMiddle">При получении данных из внешних источников
система автоматически преобразует эти данные к тому типу, который указан у
соответствующего поля в прикладном решении. Описание правил преобразования
см. <a href="#_ref289166429">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">Свойство <span class="Interface">Только чтение</span> указывает, что данное поле в таблице не
может быть записано. Это свойство следует устанавливать в значение <span class="Term">Истина</span>
для полей с автоматическим изменением, автоматически формируемые ключевые поля,
вычисляемых полей и т. д.</p>

<p class="MsoNormalCxSpMiddle">Однако при работе с внешним источником
данных возникает необходимость выполнять запись полей, которые в обычной работе
предназначены только для чтения, или наоборот. При этом такая необходимость
является временной, например, это необходимо для выполнения какой-либо
однократной или регламентной операции. Для изменения списка записываемых полей
следует использовать методы <span class="Term">ПолучитьИзменяемыеПоля()</span>
и <span class="Term">УстановитьИзменяемыеПоля()</span>. Таким образом,
состояние свойства <span class="Interface">Только чтение</span> описывает поведение поля по умолчанию, а с
помощью указанных методов можно в редких случаях изменять поведение поля.</p>

<p class="MsoNormalCxSpLast">Свойство <span class="Interface">Разрешить Null</span> указывает, можно или нет в поле таблицы
записать <span class="Term">NULL</span>. Если в поле
таблицы записано <span class="Term">NULL</span>,
то в форме это значение будет отображаться как <span class="Interface">Не заполнено</span>.</p>

<a id="TI000000845" class="bookmark" name="issogl3_23.2.3.5_прочие_свойства"><h4>23.2.3.5. Прочие свойства</h4></a>

<p class="MsoNormal">Форма,
используемая для отображения записи и списка таблицы внешнего источника данных,
может быть создана системой автоматически или прикладным разработчиком. При
этом следует помнить, что если таблицы является необъектной и не заданы
ключевые поля, то:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
отображение формы записи невозможно;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
невозможен доступ к объекту <span class="Term">ВнешнийИсточникДанныхТаблицаНаборЗаписей</span>.</p>

<p class="MsoNormal">Это
связано с тем, что невозможно однозначно идентифицировать необходимый набор
записей в таблице.</p>

<a name="_ref380766776"></a><a id="TI000001450" class="bookmark" name="issogl3_23.2.3.6_работа_с_транзакциями"><h4>23.2.3.6. Работа с транзакциями</h4></a>

<p class="MsoNormalCxSpFirst">При
записи во внешние источники данных могут использоваться как автоматические, так
и управляемые блокировки (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 9. работа с данными.htm?_=1496848987#_ref380766353">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Для
работы с транзакциями предназначены методы <span class="Term">НачатьТранзакцию()</span>, <span class="Term">ЗафиксироватьТранзакцию()</span>, <span class="Term">ОтменитьТранзакцию()</span> и <span class="Term">ТранзакцияАктивна()</span> менеджера внешнего
источника данных. В частности, это означает, что недоступны транзакции для
нескольких источников данных (распределенные транзакции).</p>

<p class="MsoNormalCxSpLast">Управление
блокировками осуществляется с помощью следующих свойств и объектов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Свойство <span class="Interface">Режим управления блокировкой данных</span> внешнего источника
данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Свойство <span class="Interface">Режим управления
блокировкой данных</span> таблицы внешнего источника данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Полями, указанными в свойстве <span class="Interface">Поля блокировки данных</span>
таблицы внешнего источника данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Свойством<span class="Interface"> Уровень изоляции
транзакций</span> таблицы внешнего источника данных;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Параметрами метода <span class="Term">НачатьТранзакцию()</span> менеджера внешних
источников данных.</p>

<p class="MsoNormal">Свойство
<span class="Interface">Режим управления блокировкой данных</span>
внешнего источника данных предназначено для установки по умолчанию режима
блокировок таблиц внешнего источника данных (аналогично свойству конфигурации <span class="Interface">Режим управления
блокировкой данных</span>, см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref370288523">здесь</a>). Данное свойство может принимать следующие значения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Автоматический</span> –
режим автоматических блокировок для всех таблиц внешнего источника данных. В
качестве уровня изоляции транзакций используется <span class="Interface">Упорядочиваемость</span>.
Такой режим позволяет использовать транзакции к базе данных внешнего источника
одновременно из платформы и из других клиентов. В
данном режиме одноименное свойство у таблицы внешнего источника данных
игнорируется.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Управляемый</span> –
режим управляемых блокировок для всех таблиц внешнего источника данных. В
качестве уровня изоляции транзакций используется <span class="Interface">Чтение зафиксированных</span>.
Такой режим можно использовать в том случае, когда к базе данных внешнего
источника имеет только система на базе «1С:Предприятие». В данном режиме игнорируется
одноименное свойство у таблицы внешнего источника данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Автоматический и управляемый</span> –
режим блокировок выбирается для каждой таблицы в зависимости от одноименного
свойства таблицы. Уровень изоляции транзакций выбирается в зависимости от
свойства <span class="Interface">Уровень изоляции транзакций</span>
таблицы внешнего источника данных.</p>

<p class="MsoNormalCxSpFirst">Если
свойство <span class="Interface">Уровень изоляции
транзакций</span> таблицы внешнего источника данных установлено в значение <span class="Interface">Авто</span>, то фактический
режим изоляции транзакций устанавливается в зависимости от свойства <span class="Interface">Режим управления
блокировкой данных</span> (описано выше). Если указано конкретное свойство –
будет использоваться именно оно. Если СУБД внешнего источника данных не поддерживает
указанный в этом свойстве уровень изоляции транзакций, то уровень будет
автоматически изменяться по следующей цепочке (до первого поддерживаемого): <span class="Interface">Чтение незафиксированных</span>
&quot; <span class="Interface">Чтение зафиксированных</span>
&quot; <span class="Interface">Повторяемое чтение</span>
&quot; <span class="Interface">Упорядочиваемость</span>.</p>

<p class="MsoNormalCxSpMiddle">При
работе в режиме управляемых блокировок, блокировки на уровне базы данных
накладываются установкой соответствующего уровня изоляции транзакций и
указанием выражения <span class="Term">ДЛЯ ИЗМЕНЕНИЯ</span> в запросах к базе данных.</p>

<p class="MsoNormalCxSpLast">Метод
<span class="Term">ТранзакцияАктивна()</span>
позволяет определить текущее состояние транзакции используемого внешнего
источника данных.</p>

<a name="_ref381273837"></a><a id="TI000001451" class="bookmark" name="issogl3_23.2.3.7_особенности_поведения_системы_при_записи_во_внешние_источники_данных"><h4>23.2.3.7. Особенности поведения системы при записи во внешние источники данных</h4></a>

<p class="MsoNormal">При
не интерактивной работе с внешним источником данных следует учитываться
следующие особенности поведения:</p>

<p class="MsoListBullet">&#9679; 
При создании записи в таблице внешнего источника
данных:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Изменить реквизиты записываемого объекта, у
которых свойство <span class="Term">ТолькоЧтение</span> установлено в значение <span class="Term">Истина</span>, невозможно.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Если у реквизита, входящего в состав полей
ключа, свойство <span class="Term">ТолькоЧтение</span>
установлено в значение <span class="Term">Истина</span>,
то такой реквизит может быть изменен только в результате вызова метода <span class="Term">УстановитьСсылкуНового()</span>. Если у такого реквизита
свойство <span class="Term">ТолькоЧтение</span> установлено в значение <span class="Term">Ложь</span>, то его значение можно изменять явным
образом (с помощью операции присваивания).</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Система не занимается автоматическим заполнением
значений реквизитов, участвующих в формировании ключа объекта (или набора
записей). Это означает, что запись будет завершена с ошибкой, если для
записываемого объекта не установлены значения ключевых реквизитов.</p>

<p class="MsoListBullet">&#9679; 
При изменении записи в таблице внешнего
источника данных:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Изменяются только те реквизиты, для которых
свойство <span class="Term">ТолькоЧтение</span> установлено в значение <span class="Term">Ложь</span>.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
При изменении ключевых полей изменяется значение
ссылки.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Если заполнен реквизит <span class="Term">ВерсияДанных</span>, то это значение используется в
выражении <span class="Term">WHERE</span> для запроса обновления данных. После
успешного выполнения запроса значение реквизита повторно считаывается из базы
данных.</p>

<p class="MsoListBullet">&#9679; 
При удалении записи из таблицы внешнего
источника данных:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Выполняется только непосредственное удаление.
Пометка удаления недоступна и не поддерживается.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
При удалении не выполняется контроль ссылочной
целостности.</p>

<a name="_ref381284619"></a><a id="TI000000846" class="bookmark" name="issogl3_23.2.3.8_загрузка_структуры_таблиц_из_внешнего_источника_данных"><h4>23.2.3.8. Загрузка структуры таблиц из внешнего источника данных</h4></a>

<p class="MsoNormalCxSpFirst">Существует возможность загрузки структуры
таблиц из внешнего источника данных, который доступен для разработчика (например,
копии реальной базы данных).</p>

<p class="MsoNormalCxSpLast">Для выполнения этой операции следует при
создании таблицы указать пункт <span class="Interface">Выбрать из списка таблиц внешнего источника данных</span> в
конструкторе таблиц внешнего источника данных. Затем нужно указать строку соединения
с внешней базой данных, воспользовавшись окном <span class="Interface">Подключение к источнику данных</span>. При формировании строки
подключения можно воспользоваться конструктором строки соединения с внешним
источником данных. Для этого следует нажать кнопку «<span class="Interface">…</span>» справа от поля <span class="Interface">Строка соединения</span>.</p>

<p class="Regularbeforepicture">После того как подключение к внешней базе
успешно выполнено, будет открыт список с перечнем таблиц и полей подключенного
источника данных. Затем следует выбрать те таблицы и поля, которые будут
использованы конфигуратором для создания структуры объектов, описывающих
текущий источник данных.</p>

<p class="Picture"><IMG src="_img/img00465.gif?_=1496848987" WIDTH="800" ALT HEIGHT="494"></p>

<p class="MsoCaption">Рис. 457. Конструктор таблиц
внешнего источника данных</p>

<p class="MsoNormal">При получении структуры внешнего источника
данных система выполняет следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Выполняет попытку определить тип таблицы с
данными: объектные или необъектные данные расположены в таблице. Таблица будет
считаться объектной, если для нее указано только одно ключевое поле, и
необъектной в противном случае. Если система ошиблась с указанием ключевых
полей, можно вручную изменить состав полей, которые образуют ключ таблицы. Если
таблица определена как объектная, у нее можно указать поле, которое формирует
представление данных такого типа. Поле представления необходимо указать
вручную.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Преобразует типы колонок источника данных в типы
«1С:Предприятия», которые будут использоваться для указания типов реквизитов
таблиц. Все типы из внешнего источника данных преобразуются к следующим типам
«1С:Предприятия»: число, строка, дата, булево, уникальный идентификатор,
двоичные данные и типы, связанные с объектными таблицами источников данных.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выполняет попытку определить типы для полей
таблиц. В этом случае система пытается определить, какого типа данные хранятся
в колонке таблицы, и в том случае, если это можно считать ссылкой на данные
другой таблицы, указывает в колонке соответствующий тип. Если система
неправильно выбрала тип колонки таблицы, его можно изменить вручную.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Во время настройки загрузки, имеется возможность
настроить следующие параметры загружаемой структуры данных:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Имя объекта в конфигурации – колонка <span class="Interface">Имя в конфигурации</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Тип загружаемого реквизита – колонка <span class="Interface">Тип</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Указать поля, входящие в состав ключа (для
объектных данных) – колонка <span class="Interface">Поле ключа</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Указать поле, хранящее представление объекта –
колонка <span class="Interface">Поле
представления</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Указать поле, хранящее версию объекта (для
осуществления оптимистической блокировки данных) – колонка <span class="Interface">Поле версии</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Указать, что таблица или реквизит доступны
только на чтение – колонка <span class="Interface">Только чтение</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Указать возможность указывать значение <span class="Term">NULL</span>
в реквизите – колонка <span class="Interface">Разрешить NULL</span>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Задать значение заполнения для реквизита – колонка
<span class="Interface">Значение заполнения</span>.</p>

<p class="MsoNormalCxSpFirst">Затем следует отметить флажками таблицы и
поля, которые будут перенесены в метаданные прикладного решения.</p>

<p class="MsoNormalCxSpMiddle">Если флажок <span class="Interface">Удалять из конфигурации таблицы и поля, отсутствующие во
внешнем источнике данных</span> установлен, то при завершении работы
конструктора таблиц из конфигурации будут удалены те таблицы и поля, которые
отсутствуют во внешнем источнике (например, во внешнем источнике таблицы или
поля были удалены) данных.</p>

<p class="MsoNormalCxSpLast">После нажатия кнопки <span class="Interface">Готово</span> произойдет загрузка структуры внешнего источника
данных.</p>

<a name="_ref324433859"></a><a id="TI000000847" class="bookmark" name="issogl2_23.2.4_пример_создания_внешнего_источника_данных"><h3>23.2.4. Пример создания внешнего источника данных</h3></a>

<p class="MsoNormalCxSpFirst">Допустим,
у нас существует база данных формата dbf, доступ к которой необходимо получить
из прикладного решения.</p>

<p class="MsoNormalCxSpLast">База
данных состоит из трех таблиц (файлов):</p>

<p class="MsoListBullet">&#9679; 
Таблица <span class="Term">products</span> (хранится в файле <span class="Interface">products.dbf</span>),
которая содержит информацию о товарах и состоит из следующих полей:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">id</span> – идентификатор товара (ключевое
поле). Тип: <span class="Term">Число</span>.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Term">code</span> – код товара. Тип: <span class="Term">Строка</span>.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Term">name</span> – наименование товара. Тип: <span class="Term">Строка</span>.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">article</span> – артикул товара. Тип: <span class="Term">Строка</span>.</p>

<p class="MsoListBullet">&#9679; 
Таблица <span class="Term">price</span> (хранится в файле <span class="Interface">price.dbf</span>),
которая содержит текущие цены на товары и состоит из следующих полей:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">product</span> – идентификатор товара, для
которого хранится цена. Тип: <span class="Term">Число</span>.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">price</span> – цена товара. Тип: <span class="Term">Число</span>.</p>

<p class="MsoListBullet">&#9679; 
Таблица <span class="Term">sales</span> (хранится в файле <span class="Interface">sales.dbf</span>),
которая содержит данные о каждой продаже товара с указанием цены, количества и
суммы. Таблица состоит из следующих полей:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">product</span> – идентификатор продаваемого
товара. Тип: <span class="Term">Число</span>.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Term">price</span> – отпускная цена товара. Тип: <span class="Term">Число</span>.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Term">qty</span> – количество проданного товара. Тип: <span class="Term">Число</span>.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">summa</span> – отпускная стоимость проданного
товара. Тип: <span class="Term">Число</span>.</p>

<p class="MsoNormalCxSpFirst">Создадим
необходимые объекты конфигурации, чтобы иметь доступ ко всем данным этих
таблиц.</p>

<p class="MsoNormalCxSpLast">Вначале
создадим собственно внешний источник данных. Назовем его <span class="Term">DBF</span>. Затем вручную создадим таблицы источника
данных. При этом следует помнить, что реальное имя физической таблицы внешнего
источника данных указывается в свойстве <span class="Interface">Имя в источнике данных</span>
создаваемого объекта. При создании таблиц назовем объекты конфигурации
следующим образом:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
таблица <span class="Term">products</span> будет отображаться в объект <span class="Term">Товары</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблица <span class="Term">price</span> будет отображаться в объект <span class="Term">Цены</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
таблица <span class="Term">sales</span> будет отображаться в объект <span class="Term">Продажи</span>.</p>

<p class="Picture"><IMG src="_img/img00466.gif?_=1496848987" WIDTH="391" ALT HEIGHT="295"></p>

<p class="MsoCaption">Рис.
458. Таблицы внешнего источника данных</p>

<p class="MsoNormal">Теперь
следует создать поля для каждой таблицы, указать типы полей и задать поля
ключей и представлений (если они есть).</p>

<p class="Regularbeforepicture">В
примере будет одна объектная таблица (таблица <span class="Term">Товары</span>). Остальные таблицы будут необъектные.
Соответствие полей физических таблиц и полей объекта конфигурации, а также типы
полей можно посмотреть на <a href="#_ref288493600">рис.
459</a>.</p>

<p class="Picture"><IMG src="_img/img00467.gif?_=1496848987" WIDTH="642" ALT HEIGHT="272"></p>

<p class="MsoCaption"><a name="_ref288493600">Рис. </a>459. Структура
таблиц в прикладном решении</p>

<p class="MsoNormal">Теперь
следует указать, в какую подсистему входят созданные таблицы и другие параметры
объектов конфигурации (при необходимости).</p>

<p class="Regularbeforepicture">Если
затем запустить систему в режиме 1С:Предприятие и корректно указать параметры
соединения с внешним источником данных, то в панели навигации будут
присутствовать созданные таблицы.</p>

<p class="Picture"><IMG src="_img/img00468.gif?_=1496848987" WIDTH="606" ALT HEIGHT="479"></p>

<p class="MsoCaption">Рис.
460. Динамический список внешнего источника данных</p>

<a name="_ref292450822"></a><a name="_ref292450821"></a><a name="_ref323731960"></a><a name="_ref303336200"></a><a name="_ref353537027"></a><a id="TI000000848" class="bookmark" name="issogl2_23.2.5_строка_соединения_odbc"><h3>23.2.5. Строка соединения ODBC</h3></a>

<a id="TI000001636" class="bookmark" name="issogl3_23.2.5.1_общая_информация"><h4>23.2.5.1. Общая информация</h4></a>

<p class="MsoNormal">Для осуществления подключения к внешнему
источнику данных следует сформировать строку соединения, которая может содержать
в себе либо все параметры подключения, необходимые для выбранного драйвера
ODBC, либо указание на сформированное описание источника данных DSN (Data
Source Name).</p>

<a id="TI000000849" class="bookmark" name="issogl3_23.2.5.2_полная_строка_соединения"><h4>23.2.5.2. Полная строка соединения</h4></a>

<p class="MsoNormal">Описание строки соединения можно получить по
следующему адресу (на английском языке): <a href="http://msdn.microsoft.com/en-us/library/ms722656.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/ms722656.aspx</a>.
Из этого описания следует выделить следующее:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Параметры строки соединения записываются парами <span class="Term">КлючевоеСлово=Значение</span>
и разделяются символом &quot;<span class="Term">;</span>&quot;.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если в строке соединения встречаются несколько
параметров с одинаковым ключевым словом, то использоваться будет последнее
указание параметра в строке соединения. Поэтому, если такие параметры как <span class="Interface">Имя пользователя</span> или <span class="Interface">Пароль</span> указаны и в строке соединения и в диалоге <span class="Interface">Параметры соединения</span> (см. <a href="#_ref303273502">здесь</a>), то будут использоваться значения из диалога <span class="Interface">Параметры соединения</span>, т. к. эти параметры
будут добавлены с правой стороны к указанной строке соединения.</p>

<p class="MsoNormal">Для упрощения формирования строки соединения
можно воспользоваться сайтом <a href="http://www.connectionstrings.com/" target="_blank">http://www.connectionstrings.com/</a>.</p>

<a id="TI000000850" class="bookmark" name="issogl3_23.2.5.3_описание_источника_данных"><h4>23.2.5.3. Описание источника данных</h4></a>

<p class="MsoNormal">Вместо указания полной строки соединения,
можно воспользоваться специальными утилитами, которые могут сформировать
описание источника данных (DSN) и указывая в параметрах соединения специальную
конструкцию вида <span class="Term">DSN=ИмяDSN</span>.
Описание источника данных могут быть пользовательскими и системными.
Пользовательские описания источников данных доступны на данном компьютере и
только тому пользователю, который создавал этого описание. Системное описание
создается системным администратором и доступно всем пользователем данного
компьютера (при наличии соответствующих разрешений).</p>

<a id="TI000000851" class="bookmark" name="issogl3_23.2.5.4_утилита_администрирования_источников_данных_odbc"><h4>23.2.5.4. Утилита администрирования источников данных ODBC</h4></a>

<p class="MsoNormalCxSpFirst">Для создания описания источника данных
следует воспользоваться утилитой администрирования источников данных ODBC. В ОС
Windows эта утилита
расположена следующим образом: <span class="Interface">Панель управления – Администрирование – Источники
данных (ODBC)</span>. При этом из панели управления Windows открывается утилита
администрирования, соответствующая версии операционной системы. В ОС Linux эта утилита называется <span class="Interface">ODBCConfig</span>
и доступна при установке соответствующего пакета (зависит от версии ОС Linux).</p>

<p class="MsoNormalCxSpMiddle">Следует помнить, что в 64-разрядной версии
ОС Windows драйвера и источники
данных различаются для 32-разрядного и 64-разрядного ODBC. Поэтому для создания
описания источника данных следует использовать версию утилиты администрирования,
соответствующую версии системы «1С:Предприятия», которая будет исполнять
запросы к внешнему источнику данных. Так, например, если обращение к ODBC
выполняется из 64-разрядной версия сервера «1С:Предприятия», то надо
использовать 64-разрядную версию утилиты администрирования. Если используется
файловая версия «1С:Предприятия» на 64-разрядной ОС Windows, то следует
использовать 32-разрядную версию утилиты администрирования, т. к.
клиентское приложение является 32-разрядным.</p>

<p class="MsoNormalCxSpLast">На 64-разрядной версии ОС Windows утилиты
администрирования расположены следующим образом:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
64-разрядная версия: <span class="Interface">%SYSTEMROOT%\System32\odbcad32.exe</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
32-разрядная версия: <span class="Interface">%SYSTEMROOT%\SysWOW64\odbcad32.exe</span>.</p>

<a name="_ref356473051"></a><a name="_ref356473050"></a><a id="TI000000852" class="bookmark" name="issogl1_23.3_работа_с_внешним_источником_данных_olap"><h2>23.3. Работа с внешним источником данных OLAP</h2></a>

<a name="_ref380677332"></a><a name="_ref380677331"></a><a id="TI000000853" class="bookmark" name="issogl2_23.3.1_общая_информация"><h3>23.3.1. Общая информация</h3></a>

<p class="MsoNormalCxSpFirst">OLAP – это технология обработки данных,
заключающаяся в подготовке агрегированной информации на основе больших массивов
данных, структурированных по многомерному принципу. Данные в аналитических
базах данных (OLAP-системах) формируются на основании данных систем
транзакционной обработки данных (также называемых OLTP-системами). Информация в
OLAP-системах представлена в виде пространства (называемого <span class="Bold">кубом</span>),
оси которого представляют собой <span class="Bold">измерения</span>, а в узлах
этого пространства располагаются некоторые <span class="Bold">меры</span> (measures). Каждое измерение
куба характеризуется определенными <span class="Bold">членами</span> (members) измерения.</p>

<p class="MsoNormalCxSpMiddle">Ближайшим (но не точным!) аналогом хранения
данных в OLAP-системах можно считать регистр накопления, где сам регистр
подобен кубу, измерение типа <span class="Term">СправочникСсылка</span>
подобно измерению куба, сам справочник содержит члены измерения, а ресурсы
регистра подобны мерам куба.</p>

<p class="MsoNormalCxSpLast">В системе «1С:Предприятие» куб OLAP-системы
представлен в виде модели, где:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Куб представлен кубом в конфигурации;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Измерения и члены измерений представлены в виде
двух объектов:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Измерения являются аналогом измерений,</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Таблицы измерений служат для описания коллекции
членов измерений.</p>

<p class="MsoListBullet">&#9679; 
Меры представлены ресурсами.</p>

<p class="MsoNormalCxSpFirst">Таким образом, в состав внешнего источника,
который подключается к OLAP-системе, входят кубы, каждый куб состоит из таблиц
измерений, собственно измерений и ресурсов. Таблицы измерений, в свою очередь,
состоят из полей. Ресурсы кубов могут быть числовыми или строковыми.</p>

<p class="MsoNormalCxSpLast">Объект,
описывающий внешний источник данных, может быть использован следующим образом:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
в качестве источника данных для запросов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
в качестве источника данных в системе компоновки
данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
в качестве источника для динамических списков;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
входить в состав общих реквизитов
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref284330956">здесь</a>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
записи таблиц измерений и кубов могут
отображаться в управляемых формах «1С:Предприятия» (не поддерживается использование
обычных форм для объектов внешних источников данных);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблицы измерений внешнего источника данных
могут выступать в качестве типов реквизитов информационной базы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
к кубам, таблицам измерений, полям таблицы
измерений, измерениям и ресурсам внешних источников данных можно применять
права доступа;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
доступ к кубам, таблицам
измерений, полям таблицы измерений, измерениям и ресурсам возможен из
встроенного языка;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
кубы и таблицы измерений внешнего источника
данных могут входить в состав подсистем (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref9243524">здесь</a>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
кубы, таблицы измерений и измерения внешнего
источника данных может входить в состав функциональных опций
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref292444461">здесь</a>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
для кубов внешнего источника данных можно
создавать характеристики (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref45029020">здесь</a>).</p>

<p class="MsoNormalCxSpFirst">Для
работы с многомерными внешними источниками данных используется механизм XML для
аналитики (XML for Analysis, XMLA). Платформа получает
доступ к данным с помощью HTTP-запросов к веб-серверу, который может быть внешним
(по отношению к OLAP-системе) или встроенным в OLAP-сервер. Вопросы настройки
доступа к данным OLAP-сервера следует искать в документации к используемой
системе.</p>

<p class="MsoNormalCxSpMiddle">Строка
соединения с аналитическим внешним источником данных представляет собой
комбинацию URL поставщика XMLA (для данной OLAP-системы) и параметров, которые
используются «1С:Предприятием» для работы с источником. Данные внешних
источников данных доступны только для чтения.</p>

<p class="MsoNormalCxSpLast">Возможности
системы «1С:Предприятие» максимально учитываются при использовании в качестве
внешнего источника данных следующих OLAP-систем (свойство <span class="Interface">Тип СУБД</span>
параметров соединения с источником данных):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
IBM
Infosphere Warehouse,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Microsoft
SQL Server Analysis Services,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Oracle
Essbase.</p>

<p class="Note">Примечание. При работе с внешним источником данных могут
возникать ошибки в том случае, если свойство <span class="Interface">Тип СУБД</span> параметров соединения с внешним источником
данных содержит значение, которое не соответствует реально используемой системе.</p>

<p class="MsoNormalCxSpFirst">При
использовании других СУБД возможности работы с внешними источниками данных
зависят от самой СУБД. Для осуществления подключения к внешнему источнику
данных следует сформировать строку подключения. Подробнее о строке подключения
см. <a href="#_ref353540252">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">Также
следует помнить, что соединение с внешним источником данных следует указывать
не только в конфигураторе (если используется механизм импорта структуры таблиц
из внешнего источника данных), но и в режиме 1С:Предприятие для получения
собственно данных.</p>

<p class="MsoNormalCxSpLast">Документация
по OLAP-системам:</p>

<p class="MsoListBullet">&#9679; 
IBM Infosphere Warehouse:</p>

<p class="MsoListBullet2">&#9679; 
<a href="http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.dwe.navigate.doc/welcome_db2warehouse.html" target="_blank">http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/topic/com.ibm.dwe.navigate.doc/welcome_db2warehouse.html</a> (на английском языке).</p>

<p class="MsoListBullet">&#9679; 
Microsoft
SQL Server Analysis Services:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Версия 2008: <a href="http://technet.microsoft.com/ru-ru/library/bb522607(v=sql.100).aspx" target="_blank">http://technet.microsoft.com/ru-ru/library/bb522607(v=sql.100).aspx</a>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Версия 2008 R2: <a href="http://technet.microsoft.com/ru-ru/library/bb522607(v=sql.105).aspx" target="_blank">http://technet.microsoft.com/ru-ru/library/bb522607(v=sql.105).aspx</a>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Версия 2012: <a href="http://technet.microsoft.com/ru-ru/library/bb522607(v=sql.110).aspx" target="_blank">http://technet.microsoft.com/ru-ru/library/bb522607(v=sql.110).aspx</a>.</p>

<p class="MsoListBullet">&#9679; 
Oracle Essbase:</p>

<p class="MsoListBullet2">&#9679; 
<a href="http://docs.oracle.com/cd/E17236_01/nav/portal_3.htm" target="_blank">http://docs.oracle.com/cd/E17236_01/nav/portal_3.htm</a> (на английском языке).</p>

<a id="TI000000854" class="bookmark" name="issogl2_23.3.2_общая_схема_использования"><h3>23.3.2. Общая схема использования</h3></a>

<p class="MsoNormal">Для
того чтобы использовать информацию из внешних источников данных в системе на
базе «1С:Предприятия», следует придерживаться следующей общей схемы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Изучить структуру внешнего источника данных и
понять, какая информация (кубы, таблицы измерений, измерения и ресурсы)
необходима для работы алгоритмов или отчетов в «1С:Предприятии».</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Создать объект <span class="Interface">Внешние источники
данных</span> в конфигураторе и для него создать требуемую структур. Это можно
сделать с помощью специального помощника.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Реализовать использование созданных объектов в
прикладном решении.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Выполнить настройку параметров подключения к
внешнему источнику данных в той сети, где будет использоваться прикладное решение.
Эти параметры могут отличаться от тех, которые использовались при загрузке
структуры внешнего источника данных.</p>

<p class="Note">Примечание. Параметры доступа к внешнему источнику
данных, которые были заданы в конфигураторе, не будут использованы системой в
режиме 1С:Предприятие.</p>

<a name="_ref353540252"></a><a id="TI000000855" class="bookmark" name="issogl2_23.3.3_редактирование_структуры_внешнего_источника_данных"><h3>23.3.3. Редактирование структуры внешнего источника данных</h3></a>

<a id="TI000001637" class="bookmark" name="issogl3_23.3.3.1_общая_информация"><h4>23.3.3.1. Общая информация</h4></a>

<p class="MsoNormal">Для работы с таблицами внешних источников
данных предназначена ветвь с именем соответствующего внешнего источника данных
ветви <span class="Interface">Внешние источники данных – &lt;Имя внешнего источника
данных&gt; – Кубы</span> дерева конфигурации. Определение внешнего
источника данных состоит из нескольких шагов:</p>

<p class="MsoListNumberCxSpFirst">1. 
Определение собственно внешнего источника
данных.</p>

<p class="MsoListNumberCxSpMiddle">2. 
Определение кубов;</p>

<p class="MsoListNumberCxSpMiddle">3. 
Определение таблиц измерений и полей для каждой
таблицы измерений;</p>

<p class="MsoListNumberCxSpMiddle">4. 
Определение измерений для куба;</p>

<p class="MsoListNumberCxSpLast">5. 
Определение ресурсов для куба.</p>

<p class="MsoNormalCxSpFirst">При этом в конфигурации может быть описано
меньшее количество объектов, чем есть в реальной базе данных, но нельзя создать
объект, которое отсутствует в реальной базе данных.</p>

<p class="MsoNormalCxSpLast">Создание структуры внешнего источника данных
возможно как в ручном режиме, так и при загрузке этой структуры с помощью
специального конструктора.</p>

<a id="TI000000856" class="bookmark" name="issogl3_23.3.3.2_внешний_источник_данных"><h4>23.3.3.2. Внешний источник данных</h4></a>

<p class="MsoNormal">При создании внешнего источника данных
следует указать его имя. Этот объект предназначен для идентификации группы кубов
при обращении к данным, которые в нем содержатся. Источник данных состоит из
одного или нескольких кубов, которые, в свою очередь, состоят из других
объектов (таблицы измерений, измерения, ресурсы).</p>

<a id="TI000000857" class="bookmark" name="issogl3_23.3.3.3_куб_внешнего_источника_данных"><h4>23.3.3.3. Куб внешнего источника данных</h4></a>

<p class="MsoNormalCxSpFirst">При создании нового куба открывается окно редактирования
объекта (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 2. работа с конфигурацией.htm?_=1496848987#_ref292444555">здесь</a></span></span></span></span></span></span></span></span>).</p>

<p class="MsoNormalCxSpLast">Свойство таблицы <span class="Interface">Имя</span> служит для идентификации куба внутри прикладного
решения. Для того чтобы система знала, какой физический куб внешнего источника
данных соответствует объект конфигурации, следует заполнить свойство <span class="Interface">Имя в источнике данных</span>. Значение в этом свойстве в
точности должно соответствовать имени куба внешнего источника данных. Не поддерживается
размещение в одном кубе прикладного решения данных из нескольких кубов внешнего
источника данных.</p>

<a id="TI000000858" class="bookmark" name="issogl3_23.3.3.4_таблица_измерения"><h4>23.3.3.4. Таблица измерения</h4></a>

<p class="MsoNormalCxSpFirst">Таблица измерения описывает члены (members)
измерения куба OLAP-системы. Свойство <span class="Interface">Имя в источнике данных</span> содержит точное имя измерения или
уровня иерархии в источнике данных. Свойство <span class="Interface">Поле представления</span> содержит имя свойства измерения или
уровня иерархии, которое система «1С:Предприятие» использует для формирования
представления элемента таблицы измерения.</p>

<p class="MsoNormalCxSpLast">Если измерение является иерархическим, то
для такого измерения может быть использована иерархическая таблица измерения. Иерархическая
таблица измерения описывается с помощью следующих свойств:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Иерархическая</span> –
содержит признак того, что таблица измерения описывает иерархию в источнике
данных.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Имя иерархии в источнике
данных</span> – указывает имя иерархии, к которой относится таблица
измерения, описывающая данный уровень.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Номер уровня</span> –
в том случае, если таблица описывает какой-либо уровень иерархии, данное
свойство содержит номер этого уровня. Для собственно иерархической таблицы
значение этого свойства равно 0, а свойство <span class="Interface">Имя иерархии в источнике данных</span> совпадает со значением
свойства <span class="Interface">Имя в источнике данных</span>.</p>

<p class="MsoNormal">Свойства <span class="Interface">Признак незаполненного родителя</span> и <span class="Interface">Значение незаполненного родителя</span> позволяют указать
системе «1С:Предприятие», каким образом идентифицировать значения самого
верхнего уровня иерархии.</p>

<a id="TI000000859" class="bookmark" name="issogl3_23.3.3.5_поле_таблицы_измерений"><h4>23.3.3.5. Поле таблицы измерений</h4></a>

<p class="MsoNormalCxSpFirst">Поля таблицы измерений описывают, какие свойства
измерений будут доступны из прикладного решения. Свойство поля <span class="Interface">Имя</span> служит для идентификации свойства (поля таблицы
измерения) в прикладном решении. Для указания соответствия между полем
прикладного решения и атрибутом измерения служит свойство <span class="Interface">Имя в источнике данных</span>. Значение в этом свойстве должно
в точности соответствовать имени атрибута измерения, указанного в свойстве <span class="Interface">Имя в источнике данных</span> родительского объекта данного
поля. Не поддерживается объединение в одном поле
таблицы измерений данных из нескольких атрибутов одного или нескольких измерений
внешнего источника данных.</p>

<p class="MsoNormalCxSpLast">Поле <span class="Interface">Тип</span> позволяет указать тип данного поля. Для выбора
доступен ограниченный набор типов. Типами поля могут быть:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Число</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Строка</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Дата</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Булево</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">УникальныйИдентификатор</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ДвоичныеДанные</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
типы, которые определяются таблицами измерений внешних
источников данных.</p>

<p class="MsoNormalCxSpFirst">Если необходимо указать для поля составной
тип, то в таком составном типе могут участвовать только типы <span class="Term">Число</span>,
<span class="Term">Строка</span>, <span class="Term">Дата</span>,
<span class="Term">Булево</span>.</p>

<p class="MsoNormalCxSpLast">При получении данных из внешних источников
система автоматически преобразует эти данные к тому типу, который указан у
соответствующего поля в прикладном решении. Описание правил преобразования
см. <a href="#_ref289166429">здесь</a>.</p>

<a id="TI000000860" class="bookmark" name="issogl3_23.3.3.6_измерения"><h4>23.3.3.6. Измерения</h4></a>

<p class="MsoNormalCxSpFirst">Измерение внешнего источника данных
описывает измерение куба OLAP-системы. Типом измерения может быть только ссылка
на соответствующую таблицу измерения. Фактически, таблицы измерений и сами
измерения, соотносятся один к одному: одно измерение описывается одной таблицей
измерения.</p>

<p class="MsoNormalCxSpLast">Не поддерживается объединение в одном поле измерения
данных из нескольких измерений внешнего источника данных.</p>

<a id="TI000000861" class="bookmark" name="issogl3_23.3.3.7_ресурсы"><h4>23.3.3.7. Ресурсы</h4></a>

<p class="MsoNormalCxSpFirst">Ресурс внешнего источника данных описывает
факт куба OLAP-системы. Ресурс куба может быть числовым или строковым. Именно
значения ресурсов рассчитываются по значениям измерений куба. Свойство <span class="Interface">Имя в источнике данных</span> должно совпадать с именем факта
(ресурса) куба внешнего источника данных.</p>

<p class="MsoNormalCxSpLast">Не поддерживается объединение в одном ресурсе
данных из нескольких фактов (ресурсов) внешнего источника данных.</p>

<a id="TI000000862" class="bookmark" name="issogl3_23.3.3.8_загрузка_структуры_куба_из_внешнего_источника_данных"><h4>23.3.3.8. Загрузка структуры куба из внешнего источника данных</h4></a>

<p class="MsoNormalCxSpFirst">Существует возможность загрузки структуры куба
из внешнего источника данных, который доступен для разработчика (например, копии
реальной базы данных).</p>

<p class="MsoNormalCxSpLast">Для выполнения этой операции следует при
создании куба указать пункт <span class="Interface">Выбрать из списка кубов внешнего источника данных</span> в конструкторе
кубов внешнего источника данных. Затем нужно указать строку соединения с
внешней базой данных, воспользовавшись окном <span class="Interface">Подключение к источнику данных</span>. При формировании строки
подключения можно воспользоваться конструктором строки соединения с внешним
источником данных. Для этого следует нажать кнопку «<span class="Interface">…</span>» справа от поля <span class="Interface">Строка соединения</span>.</p>

<p class="Regularbeforepicture">После того как подключение к внешней базе
успешно выполнено, будет открыт список с перечнем кубов, таблиц измерений, полей
таблиц измерений и ресурсов подключенного источника данных. Затем следует
выбрать требуемый куб, а также таблицы измерений, поля и ресурсы, которые будут
использованы конфигуратором для создания структуры объектов, описывающих текущий
источник данных.</p>

<p class="Picture"><IMG src="_img/img00469.gif?_=1496848987" WIDTH="800" ALT HEIGHT="424"></p>

<p class="MsoCaption">Рис. 461. Конструктор кубов
внешнего источника данных</p>

<p class="MsoNormal">При получении структуры внешнего источника
данных система выполняет следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Выполняет попытку определить поля, формирующие
представления для таблиц измерений. Если система ошиблась, поле представления можно
указать вручную.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Преобразует типы колонок источника данных в типы
«1С:Предприятия», которые будут использоваться для указания типов реквизитов объектов.
Все типы из внешнего источника данных преобразуются к следующим типам
«1С:Предприятия»: число, строка, дата, булево, уникальный идентификатор,
двоичные данные и типы, связанные с таблицами измерений источника данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Выполняет попытку определить типы для полей
таблиц измерений. В этом случае система пытается определить, какого типа данные
хранятся в колонке таблицы измерения, и в том случае, если это можно считать
ссылкой на данные другой таблицы измерения, указывает в колонке соответствующий
тип. Если система неправильно выбрала тип колонки таблицы, его можно изменить
вручную.</p>

<p class="MsoNormalCxSpFirst">Затем следует отметить флажками объекты,
которые будут перенесены в метаданные прикладного решения.</p>

<p class="MsoNormalCxSpMiddle">Если флажок <span class="Interface">Удалять из конфигурации объекты, отсутствующие во внешнем
источнике данных</span> установлен, то при завершении работы конструктора кубов
из конфигурации будут удалены те объекты (кубы, таблицы измерений, поля таблицы
измерений, измерения, ресурсы), которые отсутствуют во внешнем источнике (например,
во внешнем источнике куб или ресурс были удалены) данных.</p>

<p class="MsoNormalCxSpLast">После нажатия кнопки <span class="Interface">Готово</span> произойдет загрузка структуры внешнего источника
данных.</p>

<a id="TI000000863" class="bookmark" name="issogl2_23.3.4_ограничения_языка_запросов_при_использовании_аналитического_внешнего_источника_данных"><h3>23.3.4. Ограничения языка запросов при использовании аналитического внешнего источника данных</h3></a>

<p class="Regularbeforetable">При работе с кубами и таблицами измерений в
языке запросов, следует учитывать следующие ограничения:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Выражение</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Microsoft SQL Server Analysis Services</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Oracle Essbase</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>IBM Infosphere Warehouse</b></p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">РАЗРЕШЕННЫЕ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">РАЗЛИЧНЫЕ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СГРУППИРОВАТЬ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИМЕЮЩИЕ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СОЕДИНЕНИЕ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ОБЪЕДИНИТЬ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Подзапросы</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЛЯ ИЗМЕНЕНИЯ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПУСТАЯТАБЛИЦА</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ГОД</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КВАРТАЛ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">МЕСЯЦ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЕНЬГОДА</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЕНЬ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">НЕДЕЛЯ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЕНЬНЕДЕЛИ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЧАС</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">МИНУТА</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СЕКУНДА</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">НАЧАЛОПЕРИОДА</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КОНЕЦПЕРИОДА</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДОБАВИТЬКДАТЕ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">РАЗНОСТЬДАТ</span></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Да</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">–</p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpLast">Где,</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Bold">–</span> – указанное
выражение не поддерживается при работе с соответствующей OLAP-системой;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Bold">Да</span> – указанное
выражение поддерживается при работе с соответствующей OLAP-системой.</p>

<a id="TI000000864" class="bookmark" name="issogl2_23.3.5_строка_соединения_с_olap-сервером"><h3>23.3.5. Строка соединения с OLAP-сервером</h3></a>

<p class="MsoNormal">Строка
соединения с OLAP-сервером имеет вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">httр://&lt;Адрес хоста OLAP&gt;:&lt;порт&gt;/&lt;источник&gt;?&lt;параметры&gt;</pre>

<p class="MsoNormal">Где:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">адрес хоста OLAP</span>, <span class="Interface">порт</span>, <span class="Interface">источник</span> –
адрес доступа к OLAP-системе, сформированный по правилам, описанным в документации
конкретной OLAP-системе.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">параметры</span> – параметры,
используемые «1С:Предприятием» для доступа к данным OLAP-системы. Параметры
задаются в виде <span class="Term">Параметр=Значение</span>. Параметры разделяются
символом <span class="Interface">&amp;</span>.
Используются следующие параметры:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">ProviderName</span> – имя сервиса XMLA
OLAP-источника;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Term">DataSourceName</span> – имя OLAP-источника;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">Catalog</span> – имя каталога, или базы данных,
OLAP-источника.</p>

<p class="MsoNormal">Примеры
строк соединения приведены ниже:</p>

<p class="Lang-subheader">Для Microsoft SQL Server Analysis Services:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">http://localhost:80/msolap/msmdpump.dll?ProviderName=Microsoft Analysis Services&amp; DataSourceName=host&amp;Catalog=Adventure Works DW</pre>

<p class="Lang-subheader">Для Oracle Essbase:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">http://localhost:13080/aps/XMLA?ProviderName=Essbase XML for Analysis&amp;DataSourceName=host&amp;Catalog=Sample</pre>

<a name="_ref303273502"></a><a name="_ref422905463"></a><a name="_ref423605173"></a><a name="_ref423605172"></a><a id="TI000001638" class="bookmark" name="issogl1_23.4_работа_с_процедурами_и_функциями_внешних_источников_данных"><h2>23.4. Работа с процедурами и функциями внешних источников данных</h2></a>

<a id="TI000001639" class="bookmark" name="issogl2_23.4.1_общая_информация"><h3>23.4.1. Общая информация</h3></a>

<p class="MsoNormalCxSpFirst">Состав
языка запросов (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 8. работа с запросами.htm?_=1496848987#_ref422907131">здесь</a>) и системы компоновки данных (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 10. система компоновки данных.htm?_=1496848987#_ref166301231">здесь</a>) предоставляет широкие возможности по обработки
данных, но не включает в себя специфические возможности различных СУБД, к
которым можно отнести функции, последовательности, хранимые процедуры и
различные специфические конструкции СУБД. В тоже время, применение
специфических возможностей СУБД может оказаться критически важным при работе с
внешними источниками данных. В качестве примера можно привести объектную
таблицу СУБД, ключ которой получается из последовательности. Функции и
процедуры могут ничего не возвращать (процедура), а также возвращать одиночное
значение или таблицу.</p>

<p class="MsoNormalCxSpLast">Для
работы с такими объектами СУБД в «1С:Предприятии» существует понятие <span class="Bold">функции внешнего источника данных</span>. Функции в «1С:Предприятии»
могут быть следующих видов:</p>

<p class="MsoListNumberCxSpFirst">1.  Таблица
вида выражение в реляционном источнике данных;</p>

<p class="MsoListNumberCxSpMiddle">2.  Функция,
которая не возвращает значения (процедура);</p>

<p class="MsoListNumberCxSpLast">3.  Функция,
которая возвращает какое-либо значение.</p>

<p class="MsoNormalCxSpFirst">Любая
из вышеописанных функций может принимать параметры, количество параметров может
быть как фиксированным, так и переменным. Функция внешнего источника данных
может выступать как прослойкой между реальной функцией (или сохраненной
процедурой) СУБД, так и явным образом описывать некоторую конструкцию, которая
будет подставлена в выполняемый запрос.</p>

<p class="MsoNormalCxSpLast">Функции
могут использоваться во встроенном языке, языке запросов и системе компоновки
данных. Для функций можно указывать права доступа, регламентирующие
использование этих функций.</p>

<a id="TI000001640" class="bookmark" name="issogl2_23.4.2_общая_схема_использования"><h3>23.4.2. Общая схема использования</h3></a>

<p class="MsoNormal">Для
того чтобы использовать функции внешних источников данных в системе на базе
«1С:Предприятия», следует придерживаться следующей общей схемы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Изучить структуру внешнего источника данных и
понять, какие функции, процедуры или конструкции на языке СУБД необходимы для
работы алгоритмов или отчетов в «1С:Предприятии».</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Создать объект <span class="Interface">Внешние источники
данных</span> в конфигураторе и для него создать подчиненные функции. Это можно
сделать с помощью специального помощника.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Реализовать использование созданных объектов в
прикладном решении.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Выполнить настройку параметров подключения к
внешнему источнику данных в той сети, где будет использоваться прикладное
решение. Эти параметры могут отличаться от тех, которые использовались при
загрузке структуры внешнего источника данных.</p>

<p class="Note"><span class="Note">Примечание</span>. Параметры доступа к внешнему источнику
данных, которые были заданы в конфигураторе, не будут использованы системой в
режиме 1С:Предприятие.</p>

<a id="TI000001641" class="bookmark" name="issogl2_23.4.3_редактирование_функций"><h3>23.4.3. Редактирование функций</h3></a>

<a id="TI000001642" class="bookmark" name="issogl3_23.4.3.1_общая_информация"><h4>23.4.3.1. Общая информация</h4></a>

<p class="MsoNormal">Для
работы с функциями внешних источников данных предназначена ветвь с именем
соответствующего внешнего источника данных ветви <span class="Interface">Внешние источники
данных – &lt;Имя внешнего источника данных&gt; – Функции</span>
дерева конфигурации. Определение внешнего источника данных состоит из следующих
шагов:</p>

<p class="MsoListNumberCxSpFirst">1.  Определение
собственно внешнего источника данных;</p>

<p class="MsoListNumberCxSpMiddle">2.  Определение
функций источника данных;</p>

<p class="MsoListNumberCxSpLast">3.  Если
во внешнем источнике данных существуют процедуры, возвращающие таблицы, то
необходимо также определить таблицы внешнего источника данных вида выражение.</p>

<p class="MsoNormal">При
этом в конфигурации может быть описано меньшее количество функций и процедур,
чем есть в реальной базе данных. Также можно написать некоторую функцию (на
языке используемой СУБД), которая отсутствует в реальной базе данных. При этом
надо учитывать следующие особенности:</p>

<p class="MsoListBullet">&#9679; 
Если для функции (как объекта конфигурации)
указано, что выражение возвращает значение, то:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
При использовании во встроенном языке – выражение
подставляется в конструкцию <span class="Term">select &lt;выражение&gt;</span>.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
При использовании в языке запросов (и системе
компоновки данных) – происходит замена вызова функции на собственно
выражение.</p>

<p class="MsoListBullet">&#9679; 
Если для функции (как объекта конфигурации)
указано, что она не возвращает значение, то:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
При использовании во встроенном языке – в
зависимости от СУБД, может использоваться либо вызов с использованием
конструкции <span class="Term">select &lt;выражение&gt;</span>, либо будет
использована управляющая последовательность ODBC <span class="Term">call</span>. В силу этого, не рекомендуется
использование произвольного выражения для функции, не возвращающей значение, с
целью максимальной совместимости с различными СУБД.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
При использовании в языке запросов (или системе
компоновки данных) – не поддерживается.</p>

<p class="MsoNormal">Создание
структуры внешнего источника данных возможно как в ручном режиме, так и при
загрузке этой структуры с помощью специального конструктора.</p>

<a id="TI000001643" class="bookmark" name="issogl3_23.4.3.2_внешний_источник_данных"><h4>23.4.3.2. Внешний источник данных</h4></a>

<p class="MsoNormalCxSpFirst">При
создании внешнего источника данных следует указать его имя. Этот объект
предназначен для идентификации функций при обращении. Источник данных состоит
из одной или нескольких функций, также возможна ситуация, когда во внешнем
источнике данных располагаются таблицы-выражения.</p>

<p class="MsoNormalCxSpLast">Если
объект внешнего источника данных служит исключительно для обращений к
процедурам и функциям, то значение свойства <span class="Interface">Режим управления
блокировкой данных</span> не имеет смысла. Если для внешнего источника данных
режим управления блокировок установлен в значение <span class="Interface">Автоматический и
управляемый</span>, то для каждой таблицы режим блокировок определяется
значением соответствующего свойства таблицы. Если для внешнего источника данных
выбран определенный конкретный режим управления блокировками, то одноименное
свойство таблицы внешнего источника данных игнорируется.</p>

<a id="TI000001644" class="bookmark" name="issogl3_23.4.3.3_функция_внешнего_источника_данных"><h4>23.4.3.3. Функция внешнего источника данных</h4></a>

<p class="MsoNormalCxSpFirst">При
создании новой функции открывается окно конструктора функции внешнего источника
данных. Если выбран ручной режим создания – будет открыта палитра свойств
созданной функции внешнего источника данных (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 2. работа с конфигурацией.htm?_=1496848987#_ref370229282">здесь</a></span></span></span></span></span></span></span></span></span>).</p>

<p class="MsoNormalCxSpMiddle">Свойство
функции <span class="Interface">Имя</span> служит для
идентификации функции при обращении к ней. Свойство <span class="Interface">Выражение в источнике
данных</span> будет содержать в себе выражение, которое будет использоваться в
реальном запросе в базе данных при использовании функции. В данном свойстве
можно указать не только обращение к реальной функции или сохраненной процедуры
базы данных, но и написать выражение на языке СУБД внешнего источника данных.</p>

<p class="MsoNormalCxSpLast">Свойство
<span class="Interface">Возвращает значение</span>
фактически указывает, что описывается в объекте конфигурации:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Истина</span> – описывается функция или
выражение, возвращающее значение. В этом случае также необходимо указать,
какого типа значение будет возвращаться данным выражением.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Ложь</span> – процедура или выражение, не
возвращающее значение.</p>

<p class="MsoNormalCxSpFirst">Процедура
или функция может принимать параметры. Подробнее про параметры
см. <a href="#_ref422911116">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Функцией
может выступать выражение на языке СУБД, например функция, которое получает
следующее значение последовательности (<span class="Term">SimpleSequence</span>), будет иметь следующий вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">NEXT VALUE FOR dbo.SimpleSequence</pre>

<p class="MsoNormal">Если
нужно получить следующее значение последовательности из встроенного языка, то
это будет выглядеть следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЗначениеКлюча <span class="operator">=</span> ВнешниеИсточникиДанных<span class="operator">.</span>ВнешниеДанные<span class="operator">.</span>СледующееЗначениеКлюча<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">В
данном примере <span class="Term">ВнешниеДанные</span> – имя внешнего источника
данных, в котором описана функция <span class="Term">СледующееЗначениеКлюча()</span>. Функция <span class="Term">СледующееЗначениеКлюча()</span> описана выше.</p>

<p class="MsoNormalCxSpLast">Также
функция может быть написана на языке используемой СУБД. При этом рекомендуется
выражение заключать в круглые скобки, чтобы избежать различных побочных
эффектов во время исполнения реального запроса. Следует помнить, что при
трансформации запроса из языка запросов платформы «1С:Предприятие», в диалект
SQL конкретной СУБД, функции подставляются непосредственно в текст
получающегося запроса (с автоматической подстановкой параметров функций).</p>

<a id="TI000001645" class="bookmark" name="issogl3_23.4.3.4_таблица_вида_выражение_внешнего_источника_данных"><h4>23.4.3.4. Таблица вида выражение внешнего источника данных</h4></a>

<p class="MsoNormal">Функции
могут возвращать не только значения, но и таблицы. В этом случае функцию
необходимо создавать как <span class="Bold">таблицу вида выражение</span>. Действия,
которые необходимо выполнить при создании таблицы внешнего источника данных, см. <a href="#_ref380677346">здесь</a>. Также необходимо описать поля возвращаемых данных,
аналогично обычным полям таблицы внешнего источника данных (см. <a href="#_ref380762674">здесь</a>).</p>

<a id="TI000001646" class="bookmark" name="issogl3_23.4.3.5_загрузка_функций_из_внешнего_источника_данных"><h4>23.4.3.5. Загрузка функций из внешнего источника данных</h4></a>

<p class="MsoNormalCxSpFirst">Существует
возможность загрузки структуры таблиц из внешнего источника данных, который
доступен для разработчика (например, копии реальной базы данных).</p>

<p class="MsoNormalCxSpLast">Для
выполнения этой операции следует при создании таблицы указать пункт <span class="Interface">Выбрать из списка функций
внешнего источника данных</span> в конструкторе функции внешнего источника
данных. Затем нужно указать строку соединения с внешней базой данных,
воспользовавшись окном <span class="Interface">Подключение к
источнику данных</span>. При формировании строки подключения можно
воспользоваться конструктором строки соединения с внешним источником данных.
Для этого следует нажать кнопку «<span class="Interface">…</span>» справа от
поля <span class="Interface">Строка соединения</span>.</p>

<p class="Regularbeforepicture">После
того как подключение к внешней базе успешно выполнено, будет открыт список с
перечнем процедур, функций и последовательностей подключенного источника
данных. Затем следует выбрать те объекты, которые будут использованы конфигуратором
для создания структуры объектов, описывающих текущий источник данных.</p>

<p class="Picture"><IMG src="_img/img00470.gif?_=1496848987" WIDTH="797" ALT HEIGHT="422"></p>

<p class="MsoCaption">Рис.
462. Конструктор функций внешнего источника данных</p>

<p class="MsoNormalCxSpFirst">Имеется
возможность указать, под каким именем функция будет создана в конфигурации «1С:Предприятия».</p>

<p class="MsoNormalCxSpMiddle">Если
флажок <span class="Interface">Удалять из
конфигурации функции, отсутствующие во внешнем источнике данных</span>
установлен, то при завершении работы конструктора функций из конфигурации будут
удалены те функции, которые отсутствуют во внешнем источнике (например, во
внешнем источнике функции были удалены) данных.</p>

<p class="MsoNormalCxSpLast">После
нажатия кнопки <span class="Interface">Готово</span>
произойдет загрузка структуры функций внешнего источника данных.</p>

<a name="_ref422911116"></a><a id="TI000001647" class="bookmark" name="issogl3_23.4.3.6_параметры_функций_внешнего_источника_данных"><h4>23.4.3.6. Параметры функций внешнего источника данных</h4></a>

<p class="MsoNormal">Формальные
параметры функций внешнего источника данных описываются как <span class="Term">&amp;n</span>, где <span class="Term">n</span> – номер параметра. Нумерация параметров
начинается с 1. Если параметры являются необязательными, то параметры
заключается в фигурные скобки (<span class="Term">{}</span>). Наличие необязательных параметров определяется
каждый раз при фактическом вызове процедуры или функции. На место отсутствующих
в необязательном блоке фактических параметров при вызове подставляется <span class="Term">NULL</span> (для каждого необязательного параметра).</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
// функция с двумя параметрами
dbo.uspGetWhereUsedProductID(&amp;1, &amp;2)
// функция в двумя необязательными параметрами
dbo.uspGetWhereUsedProductID(&amp;1{, &amp;2, &amp;3})
</pre>

<p class="MsoNormal">Если
процедура или функция может принимать переменное число параметров, то такая
конструкция описывается как <span class="Term">&amp;n[]</span>. В этом случае фактические параметры
будут подставлены в выражение на место конструкции <span class="Term">&amp;n[]</span> через запятую. Указание на
возможность передачи переменного числа параметров может быть только последним в
списке формальных параметров.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
// функция, куда может быть передано от 2 до количества параметров,
// ограниченных используемой СУБД
dbo.uspGetWhereUsedProductID(&amp;1, &amp;2[])
</pre>

<a id="TI000000865" class="bookmark" name="issogl1_23.5_управление_внешними_источниками_данных"><h2>23.5. Управление внешними источниками данных</h2></a>

<p class="Regularbeforepicture">Перед
тем как начать использование данных из внешних источников в прикладном решении,
следует настроить параметры подключения используемых внешних источников. Для
этого служит стандартная функция <span class="Interface">Управление внешними
источниками данных</span>, которая вызывается из окна <span class="Interface">Все функции – Стандартные
функции</span>.</p>

<p class="Picture"><IMG src="_img/img00471.gif?_=1496848987" WIDTH="473" ALT HEIGHT="205"></p>

<p class="MsoCaption">Рис.
463. Управление внешними источниками данных</p>

<p class="MsoNormalCxSpFirst">В
данной форме перечислены все внешние источники данных, созданные в
конфигураторе и доступные пользователю, который открыл форму.</p>

<p class="MsoNormalCxSpLast">Колонка
<span class="Interface">Подключен</span> указывает состояние
подключения к источнику данных в этом сеансе.</p>

<p class="Regularbeforepicture">С
помощью меню <span class="Interface">Администрирование</span>
можно указать общие параметры подключения (команда <span class="Interface">Изменить общие
параметры…</span>) и параметры подключения конкретных пользователей в том
случае, если эти параметры отличаются от общих параметров (команда <span class="Interface">Изменить параметры
пользователей…</span>).</p>

<p class="Picture"><IMG src="_img/img00472.gif?_=1496848987" WIDTH="348" ALT HEIGHT="277"></p>

<p class="MsoCaption">Рис.
464. Параметры соединения</p>

<p class="MsoNormal">Флажок
в левой части формы (перед именами параметров) означает, что данный параметр
используется в данном наборе параметров соединения. При этом параметры
анализируются в следующем порядке:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
параметры, установленные для сеанса с помощью
метода <span class="Term">УстановитьПараметрыСоединенияСеанса()</span>
менеджера внешнего источника данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
параметры, указанные для пользователя при
интерактивной настройке или с помощью метода <span class="Term">УстановитьПараметрыСоединенияПользователя()</span> менеджера
внешнего источника данных;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
общие параметры, заданные интерактивно или с
помощью вызова метода <span class="Term">УстановитьОбщиеПараметрыСоединения()</span> менеджера
внешнего источника данных.</p>

<p class="MsoNormalCxSpFirst">Результирующий
набор параметров будет использован для соединения с внешним источником данных.
Если какой-то параметр указан в нескольких настройках, будет использован то
значение параметра, которое встретится в вышеописанной цепочке раньше.</p>

<p class="MsoNormalCxSpLast">Например,
можно следующим образом комбинировать параметры подключения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
в параметрах соединения сеанса указывается
пользователь и его пароль;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
в общих параметрах указывается строка соединения
с базой данных внешнего источника;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
в параметр конкретного пользователя указывается
другая строка соединения, которая может использоваться для тестирования прикладного
решения.</p>

<p class="RegularbeforepictureCxSpFirst">При
указании строки соединения следует помнить, что доступ к внешним данным будет
выполняться не с компьютера, где происходит настройка, а с другого компьютера
(описание того, с какого компьютера выполняется запрос к внешнему источнику данных,
см. <a href="#_ref289166700">здесь</a>). Подробнее о строке соединения см. <a href="#_ref303336200">здесь</a>.</p>

<p class="RegularbeforepictureCxSpLast">Нажатие
кнопки <span class="Interface">Подключиться</span> открывает диалог, в
котором можно задать (или уточнить) параметры подключения к выбранному внешнему
источнику данных.</p>

<p class="Picture"><IMG src="_img/img00473.gif?_=1496848987" WIDTH="676" ALT HEIGHT="215"></p>

<p class="MsoCaption">Рис.
465. Параметры подключения</p>

<p class="MsoNormalCxSpFirst">Необходимость
указания пользователя и пароля в данном диалоге зависит от драйвера ODBC и
содержания строки соединения. Возможны ситуации, когда ввод логина и пароля не
требуется. Если пользователь не является администратором внешнего источника
данных, то кнопки <span class="Interface">Общие параметры…</span>
и <span class="Interface">Параметры пользователя…</span> для него
недоступны.</p>

<p class="MsoNormalCxSpMiddle">Флажок
<span class="Interface">Использовать аутентификацию операционной
системы</span> доступен только в том случае, если у пользователя имеется право <span class="Term">ИзменениеАутентификацииОССеанса</span>.</p>

<p class="MsoNormalCxSpMiddle">После
нажатия кнопки <span class="Interface">Подключиться</span>
происходит подключение к внешнему источнику данных. В случае успешного подключения
изменяется содержимое колонки <span class="Interface">Подключен</span>
списка внешних источников данных.</p>

<p class="MsoNormalCxSpLast">Нажатие
кнопки <span class="Interface">Отключиться</span> приведет к отключению
«1С:Предприятия» от выбранного внешнего источника данных.</p>

<a id="TI000000866" class="bookmark" name="issogl1_23.6_подключение_к_внешнему_источнику_данных_в_режиме_1с_предприятие"><h2>23.6. Подключение к внешнему источнику данных в режиме «1С:Предприятие»</h2></a>

<p class="MsoNormalCxSpFirst">При
выполнении любой операции, в ходе которой необходимо получать данные из
внешнего источника данных, происходит попытка подключения, если подключение к
этому источнику данных еще не было выполнено. Если подключение выполнено успешно,
то выполняемые действия продолжаются. Если подключение не выполнено, вызывается
исключение.</p>

<p class="MsoNormalCxSpLast">В
случае если в клиентском приложении возникает исключение, связанное с
подключением к внешнему источнику данных, пользователю предлагается диалог, в
котором можно уточнить параметры подключения (если пользователь имеет права на
изменение параметров) и повторить подключение. Если подключение выполнено
успешно, то пользователю будет предложено повторить действие, во время которого
произошла ошибка подключения.</p>

<p class="Note"><span class="Note">Примечание.</span> В режиме совместимости с версией 8.2.13,
при работе с динамическим списком, в некоторых случаях диалог подключения к
внешним данным может не показываться.</p>

<p class="MsoNormal">Также
имеется возможность выполнить подключение вручную. Для этого предназначена
стандартная функция <span class="Interface">Управление внешними
источниками данных</span>.</p>

<a id="TI000000867" class="bookmark" name="issogl1_23.7_особенности_использования_внешних_источников_данных"><h2>23.7. Особенности использования внешних источников данных</h2></a>

<a name="_ref289166700"></a><a id="TI000000868" class="bookmark" name="issogl2_23.7.1_место_исполнения_запросов_к_внешним_источникам_данных"><h3>23.7.1. Место исполнения запросов к внешним источникам данных</h3></a>

<p class="MsoNormal">Исполнение
запросов к внешним источникам данных выполняется:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
в файловом варианте – на компьютере с
клиентским приложением;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
в файловом варианте с доступом через
веб-сервер – на компьютере, где выполняется расширение веб-сервера;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
в клиент-серверном варианте – на
компьютере, где выполняется:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
сервис работы с внешними источниками данных
через ODBC – для доступа к реляционными источникам данных;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
сервис работы с внешними источниками данных
через XMLA – для доступа к аналитическим источникам данных (OLAP-системы).</p>

<a name="_ref324432352"></a><a name="_ref324432351"></a><a id="TI000000869" class="bookmark" name="issogl2_23.7.2_использование_внешних_источников_данных"><h3>23.7.2. Использование внешних источников данных</h3></a>

<p class="MsoNormal">В том случае, если
один внешний источник данных содержит в своем составе и данные реляционных
источников данных и данные аналитических источников данных, их одновременное
использование не поддерживается. Это связано с тем, что один внешний источник
данных может быть в один момент времени подключен или к реляционной или к
аналитической СУБД.</p>

<a id="TI000000870" class="bookmark" name="issogl3_23.7.2.1_в_запросах"><h4>23.7.2.1. В запросах</h4></a>

<a id="TI000000871" class="bookmark" name="issogl4_23.7.2.1.1_к_реляционным_внешним_источникам"><h5>23.7.2.1.1. К реляционным внешним источникам</h5></a>

<p class="MsoNormal">Таблицы
внешних источников данных могут выступать в качестве источников запросов. При
этом таблица внешнего источника данных описывается следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ВнешнийИсточникДанных.&lt;Имя источника&gt;.Таблица.&lt;Имя таблицы&gt;</pre>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Товары<span class="operator">.</span>Код<span class="operator">,</span>
    Товары<span class="operator">.</span>Наименование<span class="operator">,</span>
    Товары<span class="operator">.</span>Артикул
<span class="keyword">ИЗ</span>
    ВнешнийИсточникДанных<span class="operator">.</span>DBF<span class="operator">.</span>Таблица<span class="operator">.</span>Товары <span class="keyword">КАК</span> Товары</pre>

<p class="MsoNormalCxSpFirst">В
данном примере происходит выборка полей <span class="Term">Код</span>, <span class="Term">Наименование</span> и <span class="Term">Артикул</span> из таблицы <span class="Term">Товары</span> внешнего источника данных <span class="Term">DBF</span>.</p>

<p class="MsoNormalCxSpLast">В
запросе к внешнему источнику данных возможно использование временных таблиц.
При этом производится попытка создания временной таблицы непосредственно в базе
данных, связанной с внешним источником данных. Если СУБД не поддерживает создание
внешних источников данных – будет вызвано исключение. Имя временной
таблице, при обращении к ней, формируется следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ВнешнийИсточникДанных.&lt;Имя внешнего источника данных&gt;.ВременнаяТаблица.&lt;Имя временной таблицы&gt;</pre>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ВЫБРАТЬ Name, ProductID
ПОМЕСТИТЬ ВнешнийИсточникДанных.AdventureWorks.ВременнаяТаблица.Остатки
ИЗ &amp;ТаблицаЗначений
ВЫБРАТЬ Name, ProductID
ПОМЕСТИТЬ ВнешнийИсточникДанных.AdventureWorks.ВременнаяТаблица.Остатки
ИЗ ВнешнийИсточникДанных.AdventureWorks.Таблица.Production_Balance
</pre>

<p class="MsoNormal">При
использовании в запросах внешних источников данных нужно помнить следующие
ограничения:</p>

<p class="MsoListBullet">&#9679; 
В одном запросе можно использовать один источник
данных. Не поддерживается одновременное использование, например, внешнего
источника данных и данных информационной базы «1С:Предприятия».</p>

<a id="TI000000872" class="bookmark" name="issogl4_23.7.2.1.2_к_аналитическим_внешним_источникам"><h5>23.7.2.1.2. К аналитическим внешним источникам</h5></a>

<p class="MsoNormal">Объекты
аналитических внешних источников данных могут выступать в качестве источников
запросов. При этом куб внешнего источника данных описывается следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ВнешнийИсточникДанных.&lt;Имя источника&gt;.Куб.&lt;Имя куба&gt;</pre>

<p class="MsoNormal">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> ПЕРВЫЕ <span class="number">10</span>
AdventureWorks<span class="operator">.</span>InternetSalesAmount
<span class="keyword">ИЗ</span>
ВнешнийИсточникДанных<span class="operator">.</span>OLAP<span class="operator">.</span>Куб<span class="operator">.</span>AdventureWorks <span class="keyword">КАК</span> AdventureWorks</pre>

<p class="MsoNormal">В данном примере выполняется получение 10
первых ресурсов <span class="Term">InternetSalesAmount</span>
из куба <span class="Term">AdventureWorks</span>
внешнего источника данных <span class="Term">OLAP</span>.</p>

<p class="Note"><span class="Note">Внимание!</span> Не рекомендуется
получать <span class="Bold">все</span> записи из куба внешнего источника данных.
Количество записей очень велико и может привести к перегрузке системы.</p>

<p class="MsoNormal">Таблица измерений куба внешнего источника
данных описывается следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ВнешнийИсточникДанных.&lt;Имя источника&gt;.Куб.&lt;Имя куба&gt;.ТаблицаИзмерений.&lt;Имя таблицы измерений&gt;</pre>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ВЫБРАТЬ
AdventureWorksТаблицаИзмеренияProduct.Ссылка
ИЗ
ВнешнийИсточникДанных.OLAP.Куб.AdventureWorks.ТаблицаИзмерения.Product КАК AdventureWorksТаблицаИзмеренияProduct
</pre>

<p class="MsoNormalCxSpFirst">В
данном примере происходит получения списка ссылок на членов таблицы измерения <span class="Term">Product</span> из куба <span class="Term">AdventureWorks</span> внешнего источника данных <span class="Term">OLAP</span>.</p>

<p class="MsoNormalCxSpLast">В
запросе к внешнему источнику данных возможно использование временных таблиц.
При этом производится попытка создания временной таблицы непосредственно в базе
данных, связанной с внешним источником данных. Если СУБД не поддерживает создание
внешних источников данных – будет вызвано исключение. Имя временной
таблице, при обращении к ней, формируется следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ВнешнийИсточникДанных.&lt;Имя внешнего источника данных&gt;.ВременнаяТаблица.&lt;Имя временной таблицы&gt;</pre>

<p class="MsoNormal">При
использовании в запросах внешних источников данных нужно помнить следующие
ограничения:</p>

<p class="MsoListBullet">&#9679; 
В одном запросе можно использовать один источник
данных. Не поддерживается одновременное использование, например, внешнего
источника данных и данных информационной базы «1С:Предприятия».</p>

<a id="TI000000873" class="bookmark" name="issogl3_23.7.2.2_в_системе_компоновки_данных"><h4>23.7.2.2. В системе компоновки данных</h4></a>

<p class="MsoNormalCxSpFirst">В системе компоновки данных возможно использование наборов
данных, получающих данные из разных однотипных источников данных. Так, можно
создать набор данных, описывающий список товаров. Данные в этом наборе будут
получены из информационной базы «1С:Предприятия». Другой набор данных может
описывать данные, полученные из внешнего источника данных, например таблица
продаж товаров из внешней базы данных.</p>

<p class="MsoNormalCxSpLast">Затем
можно настроить связи наборов данных в конструкторе схемы компоновки данных и
получать в отчет информацию одновременно из «1С:Предприятия» и внешнего
источника данных.</p>

<a name="_ref289166429"></a><a name="_ref418091596"></a><a name="_ref418091595"></a><a id="TI000000874" class="bookmark" name="issogl2_23.7.3_правила_преобразования_значений"><h3>23.7.3. Правила преобразования значений</h3></a>

<p class="MsoNormal">При
получении данных из внешних источников система автоматически преобразует эти
данные к тому типу, который указан у соответствующего поля в прикладном
решении. Преобразование выполняется по следующим правилам:</p>

<p class="MsoListBullet">&#9679; 
Тип <span class="Term">Строка</span>:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Строковое значение преобразуется в строковое
значение.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Числовое значение преобразуется в строковое
значение (для преобразования используются региональные настройки операционной
системы на том компьютере, где происходит выполнение запроса к внешнему
источнику данных).</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Значение даты преобразуется в строковое значение
(для преобразования используются региональные настройки операционной системы на
том компьютере, где происходит выполнение запроса к внешнему источнику данных).</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Значение уникального идентификатора
преобразуется в строковое представление уникального идентификатора.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Двоичные данные (и данные других типов)
преобразуются в строку, которая является текстовым представлением преобразуемых
данных в шестнадцатеричном виде.</p>

<p class="MsoListBullet">&#9679; 
Тип <span class="Term">Число</span>:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Числовое значение преобразуется в число.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Для строкового значения выполняется попытка
преобразования строки в число в соответствии с региональными настройками
операционной системы компьютера, на котором выполняется запрос к внешнему
источнику данных.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Для полей, у которых точность в базе источника
превышает точность типов платформы, рекомендуется либо явно использовать <span class="Term">ВЫРАЗИТЬ</span> в запросах, либо создавать представление
(view) в базе, так, чтобы точность полей соответствовала точности в
конфигураторе.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Для остальных типов возникает исключение.</p>

<p class="MsoListBullet">&#9679; 
Тип <span class="Term">Булево</span>:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Числовое значение преобразуется в значение <span class="Term">Ложь</span>, если его значение равно <span class="Term">0</span> и в значение <span class="Term">Истина</span> – для любого другого значения во
внешнем источнике.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Двоичные данные преобразуются по значению
первого байта данных. Если первый байт равен значению <span class="Term">0</span>, то результатом преобразования является значение
<span class="Term">Ложь</span>
и значение <span class="Term">Истина</span> в случае любого другого значения.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Для остальных типов возникает исключение.</p>

<p class="MsoListBullet">&#9679; 
Тип <span class="Term">ДвоичныеДанные</span>:</p>

<p class="MsoListBullet2">&#9679; 
В двоичные данные преобразуются значения любых
типов.</p>

<p class="MsoListBullet">&#9679; 
Тип <span class="Term">Дата</span>:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Значение даты преобразуется в значение типа <span class="Term">Дата</span>.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Для остальных типов возникает исключение.</p>

<a name="_ref322432960"></a><a id="TI000000875" class="bookmark" name="issogl2_23.7.4_внешний_источник_данных_входящий_в_состав_разделителя"><h3>23.7.4. Внешний источник данных, входящий в состав разделителя</h3></a>

<p class="MsoNormal">Если
внешний источник данных входит в состав общего реквизита, то следует учитывать
следующие особенности:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Изменение структуры таблиц внешнего источника
данных не производится, поэтому собственно данные не разделяются.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Параметры соединения с внешним источником данных
хранятся в разрезе значений разделителей, в состав которых входит внешний
источник данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Неиспользуемый разделитель является отдельным
значением, в разрезе которого хранятся параметры соединения с внешним источником
данных.</p>

<p class="MsoNormal">Таким
образом, включая внешний источник данных в состав разделителя, появляется
возможность реализовать один из следующих сценариев использования:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Данные, доступные для пользователей различных
областей данных, расположены в разных базах данных, которые совпадают по структуре
таблиц. Т.к. параметры соединения хранятся в разрезе значений разделителя,
имеется возможность для каждой области данных настроить работу с необходимой
базой данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Данные, доступные для пользователей различных
областей расположены в одной базе данных, но доступ к данным регулируется
средствами СУБД (имя и пароль пользователя). В этом случае имеется возможность
для каждой области данных указать свои имя и пароль пользователя, от имени
которого выполняется доступ к данным.</p>

<p class="MsoNormalCxSpFirst">Приведенные
сценарии не являются единственными. Они приведены как пример использования
внешних источников данных, входящих в состав разделителей.</p>

<p class="MsoNormalCxSpMiddle"> </p>

<br>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>