<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1043;&#1083;&#1072;&#1074;&#1072; 25. &#1056;&#1072;&#1079;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1072; &#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1081; &#1076;&#1083;&#1103; &#1084;&#1086;&#1073;&#1080;&#1083;&#1100;&#1085;&#1086;&#1081; &#1087;&#1083;&#1072;&#1090;&#1092;&#1086;&#1088;&#1084;&#1099;</title>
		<LINK REL="stylesheet" href="style.css?_=1496848987">
		<SCRIPT src="script.js?_=1496848987" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js?_=1496848987" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="/db/content/v8310doc/src/руководство разработчика/глава 25. разработка решений для мобильной платформы.htm" rel="canonical">
<link href="/static/its.content.css?_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="/static/its.content.js?_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="/static/html5shiv.js?_=1484636606"></script><![endif]-->

</head>
	<body class="v8310doc">
<a name="_ref335129928"></a><a id="TI000000900" class="bookmark"><h1>Глава 25.  Разработка решений для мобильной платформы</h1></a>

<a name="_ref423086219"></a><a name="_ref423086218"></a><a id="TI000000901" class="bookmark" name="issogl1_25.1_общая_информация"><h2>25.1. Общая информация</h2></a>

<p class="MsoNormalCxSpFirst">Система программ «1С:Предприятие» позволяет
разрабатывать приложения, функционирующие на мобильных устройствах (смартфоны,
планшетные компьютеры). <span class="Bold">Мобильное приложение</span> – прикладное
решение, предназначенное для выполнения на мобильной платформе
«1С:Предприятия». <span class="Bold">Мобильная платформа</span> – это
специальная версия «1С:Предприятия», предназначенная для исполнения мобильных
приложений на мобильных устройствах, которые функционируют под управлением
операционных систем iOS (<a href="http://www.apple.com/ios/" target="_blank">http://www.apple.com/ios/</a>), Android (<a href="http://www.android.com/" target="_blank">http://www.android.com/</a>) и
Windows (<a href="https://www.windowsphone.com/" target="_blank">https://www.windowsphone.com</a>). Для
ОС Windows обеспечивается функцонирование как на мобильных телефонах (ОС
Windows Phone), так и на других устройствах с сенсорным экраном (ОС Windows). В
дальнейшем при использовании термина «ОС Windows» будут пониматься обе эти
операционные системы, если явно не указана конкретная ОС. Мобильная платформа
реализована в архитектуре тонкого клиента, работающего с файловым вариантом информационной
базы, расположенной на мобильном устройстве. Для функционирования мобильного
приложения не требуется наличие постоянного канала связи с каким-либо
компонентом внешней сетевой инфраструктуры. В случае необходимости, можно
реализовать внешнее взаимодействие с помощью различных механизмов мобильной
платформы.</p>

<p class="MsoNormalCxSpLast">Разработку мобильного приложения можно
условно разбить на следующие этапы:</p>

<p class="MsoListBullet">&#9679; 
Принимается решение, каким будет мобильное
приложение:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Независимо от каких-либо прикладных решений на удаленной
системе. В этом случае структура данных мобильного приложения определяется только
областью применения приложения. Скорее всего, никакой обмен данными не потребуется.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Автономное рабочее место некоторого прикладного
решения, расположенного на удаленной системе. В этом случае структура данных в
основном определяется прикладным решением, но будут изменения, определяемые как
областью применения, так и особенностями мобильного приложения. Протокол обмена
данными, скорее всего, будет представлять собой специализированный протокол
обмена конкретного прикладного решения с конкретным мобильным приложением.
Протокол обмена не ориентирован на обмен с другими решениями.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Универсальное автономное рабочее место. В этом
случае структура данных должна учитывать специфику всех прикладных решений, с
которыми должно взаимодействовать мобильное приложение. Также необходимо
учитывать особенности мобильного приложения. Протокол обмена должен быть
достаточно универсальным и стандартизированным.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Уточняется, мобильное решение должно работать
только на мобильном устройстве или оно также может работать и на персональном
компьютере (например, на ноутбуке).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выполняется реализация мобильного приложения и
его отладка на персональном компьютере (включая механизмы обмена данными). При
этом необходимо понимать, что мобильная платформа имеет ряд отличий и
особенностей, в силу чего невозможно полностью проверить работоспособность
мобильного приложения на персональном компьютере. Однако код на встроенном
языке можно отлаживать только на персональном компьютере.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
На мобильном устройстве (одном или нескольких)
выполняется окончательная проверка и отладка интерфейса и функциональности приложения.</p>

<p class="Note"><span class="Note">Совет.</span> Рекомендуется выбирать для
разработки вариант автономного рабочего места, которое может функционировать и
на мобильном устройстве и на персональном компьютере.</p>

<p class="MsoNormalCxSpFirst">При разработке механизма обмена данными
необходимо учитывать, что обмениваться данными должны приложения с разными
версиями интерфейса обмена. Это не должно вызывать проблем при обмене. Связано
это с тем, что обновление приложения сразу для всей инфраструктуры практически
невозможно. Также следует отметить, что синхронизация данных по устаревшей
версии протокола обмена может использоваться для выполнения операций резервного
копирования перед обновлением конфигурации мобильного приложения.</p>

<p class="MsoNormalCxSpLast">При разработке мобильного приложения необходимо
учитывать ограничения, которые накладывает мобильная платформа по сравнению с
платформой «1С:Предприятие» для персонального компьютера:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Ограниченный перечень доступных объектов
конфигурации и механизмов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Ограниченный набор свойств реквизитов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Ограниченный набор элементов управляемых форм;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Упрощенная реализация некоторых механизмов
(например, права доступа или начальная страница);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Отсутствие обычных форм и обычного режима
запуска;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Отсутствие средств отладки мобильного
приложения;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Полный список особенностей см. <A href="/db/content/v8310doc/src/руководство разработчика/приложение 7. особенности поведения системы в различных режимах.htm?_=1496848987#_ref335130545">здесь</a>.</p>

<p class="Regularbeforetable">Также следует
учитывать, что мобильная платформа и платформа для персонального компьютера,
при совпадении версий различаются по предоставляемой функциональности. Ниже
приведено функциональное соответствие версий платформы для мобильного
устройства и персонального компьютера:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Мобильная
  платформа</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Платформа
  для персонального компьютера</b></p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.10</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.10</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.9</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.9</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.8</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.7</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.7</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.6</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.6</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.5</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.5</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.4</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.4</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.2</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.3</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8.3.2</p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpLast">В
документации, которая разрабатывается для мобильного приложения, прикладной
разработчик может не описывать поведение стандартных механизмов системы, а
ссылаться на «Руководство пользователя мобильного приложения», которое
расположено по адресу <a href="http://v8.1c.ru/mobile_user_guide/" target="_blank">http://v8.1c.ru/mobile_user_guide/</a>.</p>

<a name="_ref412792979"></a><a name="_ref412792978"></a><a id="TI000000902" class="bookmark" name="issogl1_25.2_интерфейс_приложения"><h2>25.2. Интерфейс приложения</h2></a>

<p class="MsoNormal">Интерфейс приложения
является аналогом интерфейса <span class="Interface">Такси</span>, с
возможностью переключения между окнами с помощью главного меню приложения. Навигация
в приложении зависит от того, какая форма активна в данный момент:</p>

<p class="MsoListBullet">&#9679; 
Форма, для которой не установлен владелец и не
сохраняющая данные.</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Например: форма списка, форма обработки.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Форма открывается командой из меню функций –
в левой части заголовка окна находится кнопка открытия главного меню
приложения. Главное меню приложения доступно с помощью жеста с левой стороны
экрана устройства или специальной кнопки.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Форма открывается другими командами или из
встроенного языка – в левой части заголовка окна находится кнопка возврата
в предыдущее окно (<span class="Interface">&lt;</span>). При
закрытии такой формы будет активизирована та форма, которая была активной в тот
момент, когда была вызвана команда открытия закрываемой формы. Главное меню
приложения доступно с помощью жеста с левой стороны экрана устройства.</p>

<p class="MsoListBullet">&#9679; 
Форма с установленным владельцем.</p>

<p class="MsoListBullet2">&#9679; 
Например: форма выбора, форма объекта, открытая
из списка.</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
При последовательно открытии таких окон
образуется цепочка открытых окон, в которой пользователю доступна только самая
последняя открытая форма. При этом закрытие текущей формы приводит к
активизации предыдущей формы цепочки, т. е. той формы, откуда была
открыта закрываемая форма. Следует понимать, что возврат может произойти не в
ту форму, в которой пользователь находился до того, как переключился на закрываемую
форму.</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
В левой части заголовка окна находится кнопка возврата
в предыдущее окно (<span class="Interface">&lt;</span>). При этом
текущее окно будет закрыто.</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
Главное меню приложения доступно с помощью жеста
с левой стороны экрана устройства.</p>

<p class="MsoListBullet2">&#9679; 
Форма, для которой не установлен владелец и
сохраняющая данные.</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
Например: форма создания объекта, вызванная из
главного меню приложения или с помощью встроенного языка.</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
При закрытии такой формы будет активизирована та
форма, которая была активной в тот момент, когда была вызвана команда открытия
закрываемой формы.</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
В левой части заголовка окна находится кнопка
возврата в предыдущее окно (<span class="Interface">&lt;</span>). При этом
текущее окно будет закрыто.</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
Главное меню приложения доступно с помощью жеста
с левой стороны экрана устройства.</p>

<p class="MsoListBullet2">&#9679; 
Формы, блокирующие интерфейс.</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
Например: форма, для которой свойство <span class="Interface">Режим открытия окна</span>
установлено в значение <span class="Interface">Блокировать окно
владельца</span> или <span class="Interface">Блокировать весь
интерфейс</span>.</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
В заголовке окна находится кнопка, связанная с
командой формы:</p>

<p class="MsoListBullet4CxSpFirst">&#9679; 
При наличии сохраняемых данных (признак
реквизита <span class="Interface">Сохраняемые данные</span>) –
стандартная кнопка <span class="Interface">Отмена</span>.</p>

<p class="MsoListBullet4CxSpMiddle">&#9679; 
При отсутствии сохраняемых данных – стандартная
кнопка <span class="Interface">Закрыть</span>.</p>

<p class="MsoListBullet4CxSpLast">&#9679; 
Если форма содержит команду <span class="Interface">Отмена</span>, <span class="Interface">Закрыть</span>, <span class="Interface">Нет</span> – отображается
эта команда.</p>

<p class="MsoListBullet3">&#9679; 
Главное меню приложения недоступно для формы,
блокирующей весь интерфейс. Для формы, блокирующей окно владельца, главное меню
приложения доступно с помощью жеста с левой стороны устройства.</p>

<p class="MsoNormal">При
запуске мобильного приложения отображается полноэкранная картинка, заданная
разработчиком приложения. В определенный момент времени в нижней части экрана
появляется логотип и копирайт фирмы «1С», перекрывая часть заставки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
В портретной ориентации – примерно 10% площади
экрана.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
В ландшафтной ориентации – примерно 15% площади
экрана.</p>

<a id="TI000000903" class="bookmark" name="issogl1_25.3_особенности_использования"><h2>25.3. Особенности использования</h2></a>

<a name="_ref412793057"></a><a name="_ref412793056"></a><a id="TI000000904" class="bookmark" name="issogl2_25.3.1_глобальный_командный_интерфейс"><h3>25.3.1. Глобальный командный интерфейс</h3></a>

<p class="MsoNormal">Интерфейс мобильной
платформы ориентирован на то, что в один момент времени на экране отображается
одна форма. Под нее освобождается максимум свободного места на экране. Поэтому,
команды, которые на персональном компьютере формируют командный интерфейс
основного раздела (панели навигации и действий), собраны в главное меню
приложения. Также это меню содержит команду возврата на начальную страницу, список
разделов (команды каждого раздела отображаются в виде подменю), а также команды
отображения информации о программе и перехода к списку приложений. Вызов
главного меню приложения осуществляется жестом с левой стороны экрана (если
доступно) или с помощью специальной кнопки <span class="Interface">&#8801;</span>,
расположенной в левой части заголовка окна.</p>

<p class="Note"><span class="Note">Совет.</span> При разработке командного интерфейса
рекомендуется ориентироваться на возможности мобильной платформы.</p>

<p class="MsoNormal">Существует
возможность настраивать ролевую видимость командного интерфейса
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 27. инструменты разработки.htm?_=1496848987#_ref374982623">здесь</a>).</p>

<a name="_ref412793068"></a><a id="TI000001554" class="bookmark" name="issogl2_25.3.2_начальная_страница"><h3>25.3.2. Начальная страница</h3></a>

<p class="MsoNormal">На начальной странице поддерживается
отображение только одной формы. Выбор этой формы выполняется по следующим правилам:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Из списка форм, указанных в настройках рабочей
области начальной страницы исключаются формы, которые недоступны в соответствии
с правами доступа;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Затем из оставшегося списка исключаются формы,
которые отключены функциональными опциями;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Из оставшихся форм выбирается первая видимая форма,
при этом обход форм рабочего стола идет сверху вниз, вначале левая колонка,
затем правая (если задано расположение форм начальной страницы в две колонки).</p>

<p class="MsoNormalCxSpFirst">Кроме формы, на начальной странице может
располагаться командный интерфейс основного раздела. Состав командного интерфейса
основного раздела на мобильной платформе аналогичен таковому на платформе для
персонального компьютера (кроме группы <span class="Interface">См.также</span>). Он отображается в виде матрицы кнопок (каждая
кнопка связана с одной командой), сгруппированной по страницам. Картинка на
кнопке получается из связанной команды. Если команда не обладает настраиваемой
картинкой, используется стандартная картинка для данной группы команд.</p>

<p class="MsoNormalCxSpLast">Команды выводятся так чтобы максимально
заполнить рабочую область окна. Группы команд размещается на страницах так,
чтобы избежать переноса между страницами, т. е. если после одной группы
команд вторая не помещается полностью в оставшееся место, то она начинается с
новой страницы. Если все команды не помещаются на экран, то они размещаются на
нескольких страницах, которые можно пролистывать.</p>

<a name="_ref412793080"></a><a name="_ref412793079"></a><a id="TI000000905" class="bookmark" name="issogl2_25.3.3_сообщения_пользователю"><h3>25.3.3. Сообщения пользователю</h3></a>

<p class="MsoNormalCxSpFirst">Отображение сообщений пользователю зависит
от того, сколько не просмотренных сообщений имеется в настоящий момент. Первое
не просмотренное сообщение отображается в виде диалога с текстом сообщения и
кнопкой <span class="Interface">ОК</span>.
После прихода второго сообщения в диалоге дополнительно появляется кнопка <span class="Interface">Все сообщения</span>. В кнопке <span class="Interface">Все сообщения</span> имеется подпись с полным количеством
пришедших сообщений.</p>

<p class="MsoNormalCxSpLast">По нажатию на кнопку <span class="Interface">Все сообщения</span> открывается панель сообщений, которая
содержит все непрочитанные сообщения. Если в диалоге нажата кнопка <span class="Interface">ОК</span> или закрывается панель сообщений, то список сообщений
очищается. Нажатие на сообщение приводит к активации элемента формы, если
сообщение связано с таковым. Для повторного открытия списка сообщений следует повторно
вызвать действие, приводящее к открытию списка.</p>

<a name="_ref335933717"></a><a name="_ref335933698"></a><a name="_ref412793098"></a><a name="_ref412793097"></a><a id="TI000000906" class="bookmark" name="issogl2_25.3.4_форма"><h3>25.3.4. Форма</h3></a>

<a id="TI000001555" class="bookmark" name="issogl3_25.3.4.1_общая_информация"><h4>25.3.4.1. Общая информация</h4></a>

<p class="MsoNormalCxSpFirst">Для тех механизмов или объектов
конфигурации, которые не поддерживаются мобильной платформой, будут недоступны свойства
элементов формы, связанные с этим механизмом или объектом. Например, свойство <span class="Interface">Сочетание клавиш</span> или события, связанные с
перетаскиванием.</p>

<p class="MsoNormalCxSpLast">Принципы и правила формирования формы для
мобильной платформы в основном совпадают с таковыми для тонкого клиента,
однако, есть некоторые особенности, которые следует учитывать при разработке
форм мобильного приложения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Экраны смартфонов, в основном, ориентированы на
вертикальное расположение (портретная ориентация), поэтому форма существенно
ограничена по своей ширине и слабо ограничена по высоте.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для мобильных устройств не принята прокрутка
формы по горизонтали, т. к. полосы прокрутки
на мобильных устройствах не отображаются постоянно, поэтому пользователь может
не обратить внимания на то, что форма (отчет или таблица) показывают только
фрагмент информации. В связи с этим, при формировании форм, разработчик
обязан сам предпринимать усилия для того, чтобы все элементы формы помещались в
ней по ширине, например, используя группы с группировкой <span class="Interface">Горизонтальная если возможно</span>. Если таких усилий не
предпринято, то форма будет ограниченно работоспособна, т. к. горизонтальная
полоса прокрутки в формах на мобильной платформе не поддерживается.</p>

<a id="TI000001556" class="bookmark" name="issogl3_25.3.4.2_доступные_элементы_формы"><h4>25.3.4.2. Доступные элементы формы</h4></a>

<p class="MsoNormal">В форме мобильного приложения можно
использовать следующие элементы формы:</p>

<p class="MsoListBullet">&#9679; 
Поля следующих видов:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Поле ввода;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Поле надписи;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Поле переключателя;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Поле картинки;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Поле флажка;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Поле индикатора;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Поле полосы регулирования;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Поле диаграммы;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Поле табличного документа.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Кнопка;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Таблица;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Декорация: надпись и картинка;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Группы всех видов.</p>

<a id="TI000001557" class="bookmark" name="issogl3_25.3.4.3_расположение_элементов_формы"><h4>25.3.4.3. Расположение элементов формы</h4></a>

<p class="MsoNormal">Группы, включая саму форму, и большая часть
элементов формы, отображаются в виде списков, как это принято в мобильных
интерфейсах. Элементы формы условно делятся на три типа:</p>

<p class="MsoListNumber">1. 
Обязательно располагаются в строке списка. В эту
группу входят следующие элементы:</p>

<p class="MsoListNumber2CxSpFirst">1. 
Поле ввода;</p>

<p class="MsoListNumber2CxSpMiddle">2. 
Поле надписи;</p>

<p class="MsoListNumber2CxSpMiddle">3. 
Поле переключателя;</p>

<p class="MsoListNumber2CxSpMiddle">4. 
Кнопка;</p>

<p class="MsoListNumber2CxSpLast">5. 
Поле диаграммы.</p>

<p class="MsoListNumberCxSpFirst">2. 
Могут располагаться в строке списка. В группу
входит декорация.</p>

<p class="MsoListNumberCxSpLast">3. 
Не могу располагаться в строке списка. В эту
группу входят все остальные элементы.</p>

<p class="MsoNormal">Под фразой «отображение списком» понимается
следующее:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Группа имеет фон, отличающийся от цвета формы.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Строкой списка выступает либо элемент формы,
либо группа с горизонтальной группировкой элементов.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Элементы, расположенные в группе с
горизонтальной группировкой, располагаются в одной строке.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Элементы, расположенные в группе с вертикальной
группировкой, располагаются каждый на своей строке.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если в группе с вертикальной группировкой
находятся элементы, которые не могут располагаться в строке списка, то в списке
отображается разрыв.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если группа обладает отображаемым заголовком, то
перед группой формируется отступ.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Визуальными разделителями строк являются
горизонтальные линии, отображением которых нельзя управлять.</p>

<p class="MsoNormalCxSpFirst">Особенностью поведения элементов 2 типа
является то, что они располагаются в строке списка, только если сгруппированы с
элементами 1 типа. Сами по себе элементы 2 типа в список не оформляются.</p>

<p class="MsoNormalCxSpLast">Многие элементы формы не имеют рамок (поля
ввода и кнопки, у которых цвет рамки установлен в значение <span class="Interface">Авто</span>). В связи с этим, выравнивание полей ввода на форме
(как на платформе для персонального компьютера) не имеет практического смысла.
Вместо него используется алгоритм выравнивания значений в полях ввода. В
зависимости от наличия и расположения заголовка у поля ввода, информация в нем
выравнивается по-разному:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Заголовок поля отсутствует или отображается не
слева, то числовые значения выравниваются вправо, а остальные – влево.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Заголовок поля находится слева:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
В полях с редактированием текста – текст
выравнивается влево.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Числовые значения выравниваются вправо.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Выравнивание полей остальных типов зависит от
того, есть в группе с этими полями поле для редактирования текста или нет. Если
такое поле есть, то выравнивание остальных полей осуществляется аналогично
выравниванию этого поля. В противном случае – вправо.</p>

<p class="MsoNormal">Заголовок формы отображается только в
заголовке окна и не дублируется на самой форме.</p>

<a id="TI000001558" class="bookmark" name="issogl3_25.3.4.4_особенности_отображения_элементов_формы"><h4>25.3.4.4. Особенности отображения элементов формы</h4></a>

<a id="TI000001559" class="bookmark" name="issogl4_25.3.4.4.1_общие_особенности"><h5>25.3.4.4.1. Общие особенности</h5></a>

<p class="MsoNormalCxSpFirst">На форме не отображается отметка незаполненного
как для элементов, расположенных на форме, так и для элементов, расположенных в
таблице.</p>

<p class="MsoNormalCxSpLast">Заголовки полей выводятся без символов
&quot;<span class="Interface">:</span>&quot; в конце
текста.</p>

<a name="_ref423086278"></a><a id="TI000001651" class="bookmark" name="issogl4_25.3.4.4.2_форма"><h5>25.3.4.4.2. Форма</h5></a>

<p class="MsoNormalCxSpFirst">Свойство <span class="Term">ТекущийЭлемент</span>
позволяет получить и установить текущий элемент формы. Однако установка
текущего элемента формы не приводит к переходу этого элемента в режим
редактирования и никак не отображается визуально. Чтобы перевести элемент формы
в режим редактирования, следует воспользоваться методом <span class="Term">НачатьРедактированиеЭлемента()</span>.</p>

<p class="MsoNormalCxSpLast">Если при открытии формы выполняются
какие-либо действия, то следует учитывать тот факт, что до окончания работы
всех обработчиков формы не будет выполняться обновления экрана мобильного
устройства.</p>

<a name="_ref423086364"></a><a id="TI000001560" class="bookmark" name="issogl4_25.3.4.4.3_поле_ввода"><h5>25.3.4.4.3. Поле ввода</h5></a>

<p class="MsoNormalCxSpFirst">Для облегчения работы с полем ввода с
помощью сенсорных экранов мобильных устройств, во всех полях, кроме полей ввода
текста и полей, где используется автоподбор, редактирование значения
непосредственно в поле ввода не предполагается. Поле ввода ведет себя как
кнопка, заголовок которой отображает представление текущего значения, а нажатие
этой кнопки открывает специализированный редактор. В том случае, если в поле
ввода используется автоподбор, имеется возможность очистить значение с помощью
кнопки <span class="Interface">Очистить</span>,
расположенной в левой части заголовка окна.</p>

<p class="MsoNormalCxSpMiddle">Длинное нажатие в поле ввода приводит к
появлению контекстного меню, которое состоит из стандартных команд системы и
команд, которые добавлены в это меню во время разработки.</p>

<p class="MsoNormalCxSpLast">Для отображения кнопок очистки, открытия и
регулирования, следует установить в значение <span class="Interface">Да</span> соответствующее свойство поле ввода. Кроме этого,
имеется дополнительная возможность по управлению видимостью кнопок очистки и
открытия, которые отображаются непосредственно в поле ввода. Эта возможность
предоставляется с помощью свойств <span class="Term">АвтоОтображениеКнопкиОчистки</span>
и <span class="Term">АвтоОтображениеКнопкиОткрытия</span>. Данные свойства
обрабатываются только в том случае, если соответствующее свойство поля ввода
установлено в значение <span class="Interface">Да</span>. Возможны следующие варианты поведения (значения
свойств <span class="Term">АвтоОтображениеКнопкиОчистки</span>
и <span class="Term">АвтоОтображениеКнопкиОткрытия</span>):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Только для заполненного</span> –
в этом случае кнопка будет отображаться только в том случае, если значение в
поле отличается от значения по умолчанию для используемого типа или если
данные, отображаемые полем ввода, имеют составной тип.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Всегда</span> –
кнопка очистки отображается всегда.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Авто</span> –
поведение зависит от свойства:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
свойство <span class="Term">АвтоОтображениеКнопкиОчистки</span> –
аналогично значению <span class="Interface">Только для заполненного</span>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
свойство <span class="Term">АвтоОтображениеКнопкиОткрытия</span> –
аналогично значению <span class="Interface">Всегда</span>.</p>

<p class="MsoNormalCxSpFirst">Кнопка выбора всегда не отображается, при
этом событие <span class="Term">НачалоВыбора</span>
срабатывает в момент нажатия на само поле ввода. Если для редактирования
значения поля используется отдельная форма, то рядом с полем размещается
специальный маркер (<span class="Interface">&gt;</span>), нажатие на который приведет к открытию этой
формы. Расположение и внешний вид редакторов отличается на планшете и телефоне.</p>

<p class="MsoNormalCxSpLast">Многострочное поле ввода всегда работает в
режиме ввода текста. Такое поле ввода не поддерживает выбор значений и автоподбор.
Если поле ввода связано с данными, отличными от типа <span class="Term">Строка</span>,
то для такого поля ввода игнорируется значение флажка <span class="Term">МногострочныйРежим</span>.
Многострочное поле ввода может отображаться тремя различными способами:</p>

<p class="MsoListNumberCxSpFirst">1. 
Автоматическая подстройка высоты поля под высоту
текст (чтобы избежать прокрутки). Происходит когда поле занимает всю ширину
формы, не указана высота поля (свойство <span class="Term">Высота</span>)
и поле может растягиваться по вертикали (свойство <span class="Term">РастягиватьПоВертикали</span>).</p>

<p class="MsoListNumberCxSpMiddle">2. 
Поле имеет заданную высоту и допустима
вертикальная прокрутка внутри поля. Происходит когда указана высота поля (свойство
<span class="Term">Высота</span>) и поле не может растягиваться по
вертикали (свойство <span class="Term">РастягиватьПоВертикали</span>).</p>

<p class="MsoListNumberCxSpLast">3. 
Поле занимает максимально возможное место на
форме. Происходит когда указана высота поля (свойство <span class="Term">Высота</span>)
и поле может растягиваться по вертикали (свойство <span class="Term">РастягиватьПоВертикали</span>).</p>

<p class="MsoNormalCxSpFirst">Значение свойства <span class="Interface">Подсказка ввода</span> не отображается в многострочном поле
ввода.</p>

<p class="MsoNormalCxSpLast">Для мобильной платформы также актуальны
дополнительные свойства поля ввода, которые позволят более эффективно использовать
прикладное решение. Эти свойства позволяют дополнительно настроить поле ввода (только
в том случае, если поле ввода отображает данные типа <span class="Term">Строка</span>)для
выполнения некоторых специфических задач:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Свойство <span class="Term">АвтоИсправлениеПриВводеТекста</span> –
позволяет включить автоматическое исправление вводимого текста. Поведение
зависит от настроек используемой виртуальной клавиатуры. Значение <span class="Interface">Авто</span> означает, что для многострочных полей ввода
автоматическое исправление работает, а для обычных (однострочных) – нет.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Свойство <span class="Term">ПроверкаПравописанияПриВводеТекста</span> –
позволяет включить проверку правописания при вводе текста. При работе под
управлением ОС Android данное свойство
игнорируется, т. к. данная возможность управляется системой и зависит
от других настроек.</p>

<p class="IndentlistCxSpFirst">При работе под управлением ОС Windows данное свойство и
свойство <span class="Term">АвтоИзменениеРегистраПриВводеТекста</span>
всегда включаются одновременно. При установке свойства <span class="Term">ПроверкаПравописанияПриВводеТекста</span>
в значение <span class="Interface">Использовать</span>,
операционной системой будет автоматически включено изменение регистра вначале
предложения при вводе текста. Это изменение будет выполнено вне зависимости от
значения свойства <span class="Term">АвтоИзменениеРегистраПриВводеТекста</span>.
Значение свойства <span class="Term">АвтоИзменениеРегистраПриВводеТекста</span>
будет использоваться при работе под управлением других операционных систем.</p>

<p class="IndentlistCxSpLast">Значение <span class="Interface">Авто</span> означает, что для многострочных полей ввода
автоматическая проверка работает, а для обычных (однострочных) – нет.</p>

<p class="MsoListBullet">&#9679; 
Свойство <span class="Term">АвтоИзменениеРегистраПриВводеТекста</span> –
позволяет управлять автоматическим изменением регистра символов при вводе
текста. Поведение зависит от используемой операционной системы и настроек
используемой виртуальной клавиатуры.</p>

<p class="IndentlistCxSpFirst">При работе под управлением ОС Windows данное свойство и
свойство <span class="Term">АвтоИзменениеРегистраПриВводеТекста</span>
всегда включаются одновременно. При установке свойства <span class="Term">ПроверкаПравописанияПриВводеТекста</span>
в значение <span class="Interface">Использовать</span>,
операционной системой будет автоматически включено изменение регистра вначале
предложения при вводе текста. Это изменение будет выполнено вне зависимости от
значения свойства <span class="Term">АвтоИзменениеРегистраПриВводеТекста</span>.
Значение свойства <span class="Term">АвтоИзменениеРегистраПриВводеТекста</span>
будет использоваться при работе под управлением других операционных систем.</p>

<p class="IndentlistCxSpLast">Может принимать следующие значения:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Interface">Нет</span> –
автоматическое изменение регистра символов не выполняется.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">Слова</span> –
автоматически делается заглавной первая буква каждого слова.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">Предложения</span> –
автоматически делается заглавной первая буква каждого предложения.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">Все символы</span> –
автоматически делаются заглавными все вводимые символы.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Interface">Авто</span> – для
многострочных полей ввода аналогично значению <span class="Interface">Предложения</span>, а для обычных (однострочных) – <span class="Interface">Нет</span>.</p>

<p class="MsoListBullet">&#9679; 
Свойство <span class="Term">СпециальныйРежимВводаТекста</span> –
позволяет задать специальный вид виртуальной клавиатуры при вводе в поле ввода:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Interface">Нет</span> –
используется вирутальная клавиатура по умолчанию.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">Цифры и пунктуация</span> –
используется виртуальная клавиатура для ввода цифр и смиволов пунктуации.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">URL</span> – используется
виртуальная клавиатура для ввода URL.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">Email</span> –
используется вирутальная клавиатура для ввода адреса электронной почты. На
клавиатуре будет присутствовать символ <span class="Interface">@</span>.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">Номер телефона</span> –
используется виртуальная клавиатура для ввода номера телефона, которая содержит
цифры и клавиши <span class="Interface">*</span> и <span class="Interface">#</span>.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Interface">Цифры</span> –
используется экранная клавиатура для ввода чисел.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Interface">Авто</span> –
используется аналогично значению <span class="Interface">Нет</span>.</p>

<p class="Indentlist">При работе на планшетах под управлением ОС Android, все виды виртуальных
клавиатур, кроме клавиатуры вида <span class="Interface">Номер телефона</span>, могут выглядеть одинаково, в связи с
наличием большого количества свободного места на экране.</p>

<p class="MsoNormal">При разработке форм, предполагающих ввод
различной информации (номера телефонов, адреса электронной почты и т. д.),
может возникать необходимость специальным образом именовать кнопку завершения
ввода на используемой виртуальной клавиатуре. Это должно помочь пользователю
понять, какое действие будет выполнено после нажатия этой кнопки. Для этого
существует свойство поля ввода <span class="Term">ТекстКнопкиВводаЭкраннойКлавиатуры</span>.
Значение данного свойства обозначают текст, который будет отображаться на
кнопке завершения ввода. При работе под управлением ОС Android при указании значения
<span class="Interface">Продолжить</span>
будет отображаться <span class="Interface">Далее</span>, а при указании значения <span class="Interface">Подключиться</span> – <span class="Interface">Ввод</span>. Под управлением ОС Windows значение данного
свойства будет игнорироваться. Управление текстом на кнопки ввода не
поддерживается.</p>

<a name="_ref423088159"></a><a id="TI000001561" class="bookmark" name="issogl4_25.3.4.4.4_поле_флажка"><h5>25.3.4.4.4. Поле флажка</h5></a>

<p class="MsoNormal">Флажок может отображать только два
состояния. При работе под управлением ОС iOS флажок всегда отображается в виде
тумблера.</p>

<a id="TI000001562" class="bookmark" name="issogl4_25.3.4.4.5_поле_переключателя"><h5>25.3.4.4.5. Поле переключателя</h5></a>

<p class="MsoNormalCxSpFirst">Поле переключателя вида <span class="Interface">Переключатель</span> всегда выводится в отдельной вертикальной группе
(количество колонок не настраивается). Поле переключателя вида <span class="Interface">Переключатель</span> не комбинируется с другими элементами в
одной строке.</p>

<p class="MsoNormalCxSpLast">Поле переключателя вида <span class="Interface">Тумблер</span> всегда выводится в одной строке (количество
колонок не настраивается).</p>

<a name="_ref423086583"></a><a id="TI000001652" class="bookmark" name="issogl4_25.3.4.4.6_кнопка"><h5>25.3.4.4.6. Кнопка</h5></a>

<p class="MsoNormal">В
том случае, когда кнопка расположена в вертикальной группе, она растягивается
до ширины родительской группы. Текст внутри кнопки выравнивается по левому краю
кнопки, кроме случая, когда цвет рамки кнопки отличается от значения по умолчанию –
в этом случае текст выравнивается по центру кнопки.</p>

<a name="_ref423086288"></a><a id="TI000001650" class="bookmark" name="issogl4_25.3.4.4.7_группа"><h5>25.3.4.4.7. Группа</h5></a>

<p class="MsoNormalCxSpFirst">При отображении групп управляемой формы
поддерживается только отступ для групп с режимом отображения <span class="Interface">Обычное выделение</span> и <span class="Interface">Сильное выделение</span>.</p>

<p class="MsoNormalCxSpLast">При
отображении свертываемой группы (свойство группы <span class="Interface">Поведение</span> установлено в значение <span class="Interface">Свертываемая</span>), имеется ряд особенностей:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Заголовок свертываемой группы (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 7. формы.htm?_=1496848987#_ref419713226">здесь</a>) отображается в виде нажимаемой строки;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Свертываемая группа всегда отображается с
вариантом отображения <span class="Interface">Картинка</span> и его (варианта отображения) настройка
игнорируется.</p>

<a name="_ref459737040"></a><a id="TI000001563" class="bookmark" name="issogl4_25.3.4.4.8_страницы"><h5>25.3.4.4.8. Страницы</h5></a>

<p class="MsoNormal">Группа вида <span class="Interface">Страницы</span> позволяет реализовать несколько вариантов
панели с закладками. Вид панели (и ее поведение) зависит от значения свойства <span class="Interface">Отображение закладок</span>:</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Закладки сверху</span>.</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Закладки отображаются в виде тумблера. Если
текст заголовка не помещается в отведенное место, то он сокращается так, что в
конце текст отображается символ <span class="Interface">…</span>. Картинки в заголовках не отображаются.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Страницы расположены внутри группы под списком
закладок.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Активная закладка отображается инверсией
заголовка.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Закладки снизу</span>.</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Закладки отображаются в виде панели кнопок. Если
текст заголовка не помещается в отведенное место, то он сокращается так, что в
конце текст отображается символ <span class="Interface">…</span>. Картинки в заголовках отображаются, при этом текст
всегда отображается под картинкой.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Страницы расположены внутри группы над списком
закладок.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Если на экране не хватает места для отображения заголовков
всех страниц группы, то в конец списка добавляется кнопка <span class="Interface">Еще</span>. Нажатие на эту кнопку открывает список заголовков
всех страниц группы.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Закладки слева</span>.</p>

<p class="MsoListBullet2">&#9679; 
Закладки выводятся в виде списка. Нажатие на
закладку приводит к открытию нового окна с содержимым закладки, которое
замещает текущую форму (со списком закладок). Для возврата к списку закладок
служит специальная кнопка (<span class="Interface">&lt;</span>), расположенная в левой верхней части заголовка
страницы.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Пролистывание</span>.</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Закладки выводятся в виде точек под страницами.
Текст и картинки не отображаются. Переключение между страницами выполняется
жестом слева-направо или справа-налево в области страниц.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Страницы расположены внутри группы над точками,
описывающими количество закладок.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
В платформе для персонального компьютера данное
значение интерпретируется как значение <span class="Interface">Закладки слева</span>.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Закладки справа</span>.</p>

<p class="MsoListBullet2">&#9679; 
Не поддерживается мобильной платформой.</p>

<a name="_ref423086378"></a><a id="TI000001564" class="bookmark" name="issogl4_25.3.4.4.9_таблица"><h5>25.3.4.4.9. Таблица</h5></a>

<p class="MsoNormalCxSpFirst">Главным отличием таблицы в мобильном
приложении от таблицы в платформе для персонального компьютера является работа
с текущей строкой. В таблице на платформе для персонального компьютера всегда
существует текущая строка. На мобильной платформе текущая строка появляется
только на время обработки интерактивного действия пользователя, которое
выполняется с этой таблицей. Это отличие обуславливает большинство различий в
поведении мобильной платформы, которые описаны далее.</p>

<p class="MsoNormalCxSpLast">Свойства <span class="Term">ТекущаяСтрока</span>,
<span class="Term">ТекущийЭлемент</span>, <span class="Term">ТекущиеДанные</span>
определены только во время выполнения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
обработчика контекстной команды;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
событий активизации строки или ячейки;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
событий редактирования строки.</p>

<p class="MsoNormalCxSpFirst">В остальное время эти свойства таблицы имеют
значение <span class="Term">Неопределено</span>.</p>

<p class="MsoNormalCxSpLast">Свойство <span class="Term">ТекущийРодитель</span>
определено в следующих случаях:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
в иерархических списках – всегда;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
при отображении дерева – только в тех
случаях, когда определено свойство <span class="Term">ТекущаяСтрока</span>.</p>

<p class="MsoNormalCxSpFirst">При выборе строки одиночным нажатием на нее,
вызываются события активизации (строки, ячейки, поля). Если при этом свойство
таблицы <span class="Term">РежимВыбора</span>
установлено в значение <span class="Term">Истина</span>,
то после события активизации строки также вызывается событие <span class="Term">ВыборЗначения</span>.</p>

<p class="MsoNormalCxSpLast">Таблица в мобильной платформе никогда не
имеет горизонтальной прокрутки. В связи с этим:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
игнорируется фиксация колонок в таблице;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
значение свойства <span class="Term">ГоризонтальнаяПолосаПрокрутки</span>
игнорируется;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
колонки, которые не помещаются в видимой части
таблицы, не отображаются.</p>

<p class="MsoNormal">Таблица в мобильном приложении может
отображаться в трех режимах:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
основной режим;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
режим выбора нескольких строк;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
режим сортировки строк.</p>

<p class="MsoNormal">Основной режим аналогичен режиму отображения
таблицы на платформе для персонального компьютера, за исключением отображения
текущей и выбранных строк. В мобильной платформе эти строки не отображаются.
Исключением служит кратковременная подсветка текущей строки таблицы при
открытии формы. Таблица формы автоматически подстраивается под размер содержимого
в том случае, если одновременно выполняются следующие условия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
таблица занимается всю ширину формы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
не задана фиксированная высота таблицы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблица растягивается по вертикали;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
в объекте, который отображается таблица,
содержится менее 100 строк данных. Если строк более 100 – будет доступна
прокрутка.</p>

<p class="MsoNormalCxSpFirst">Режим выбора нескольких строк
характеризуется специальной колонкой с флажками, с помощью которых и
выполняется выбор. Колонка всегда отображается самой первой. В этом режиме
контекстные команды таблицы доступны и действуют на все выделение сразу.</p>

<p class="MsoNormalCxSpMiddle">Режим сортировки строк характеризуется
наличием специальной колонки с маркером, за который можно таскать строку. Эта
колонка всегда отображается самой последней. В этом режиме недоступны
контекстные команды таблицы.</p>

<p class="MsoNormalCxSpMiddle">Режим множественного выделения в таблице
(свойство <span class="Term">РежимВыделения</span>
установлено в значение <span class="Term">Множественный</span>)
на мобильной платформе визуально никак не отображается. Признаком его
существования служит специальная команда <span class="Interface">Выбор нескольких</span>, которая доступна в командной панели,
связанной с таблицей. При выборе этой команды таблица переходит в режим выбора
нескольких строк.</p>

<p class="MsoNormalCxSpMiddle">Если установлен режим множественного выбора
(свойство <span class="Term">МножественныйВыбор</span>
установлено в значение <span class="Term">Истина</span>),
то таблица сразу находится в режиме выбора нескольких строк, при этом команда
перехода в этот режим в командной панели отсутствует.</p>

<p class="MsoNormalCxSpMiddle">Если в таблице доступно изменение порядка
строк (например, табличная часть документа), то для активизации этого режима
необходимо выполнить специальную команду <span class="Interface">Перестановка строк</span>, которая доступна в командной панели,
связанной с таблицей. В этом случае таблица переходит в режим сортировки строк,
и сбрасываются выделенные строки (если они были).</p>

<p class="MsoNormalCxSpMiddle">Для таблицы поддерживаются только два режима
ввода строк (свойство <span class="Term">РежимВводаСтрок</span>):
в конце списка и в конце окна. Всегда используется режим выделения строки –
<span class="Interface">Строка</span>
(свойство <span class="Term">РежимВыделенияСтроки</span>).
Фактическое значение свойства игнорируется.</p>

<p class="MsoNormalCxSpMiddle">Таблица формы поддерживает использование
контекстного меню, которое открывается жестом от правой границы таблицы или
длительным нажатием на строку.</p>

<p class="MsoNormalCxSpMiddle">Заполнение командной панели и контекстного
меню имеет важные отличия от платформы для персонального компьютера. На
платформе для персонального компьютера вопрос распределения команд между
командной панелью и контекстным меню – это вопрос дизайна формы. На
мобильной платформе (в силу отсутствия текущей строки) это вопрос
функциональной модели. Если команда использует свойства таблицы, связанные с
текущей строкой, то такая команда должна располагаться в контекстном меню. Если
такая команда размещена разработчиком в другом месте, то система может принудительно
переместить ее в контекстное меню. Исключением из этого правила выступает
случай, когда команда может выполнять свою работу как в связи с текущей
строкой, так и без таковой. В качестве примера можно привести команду <span class="Term">Создать</span>
динамического списка, отображающего данные иерархического справочника.
Внеконтекстное использование команды предполагает создание элемента в корне
справочника, а контекстное – в текущей группе.</p>

<p class="MsoNormalCxSpLast">Для того чтобы указать системе, что команда
оперируется данными текущей строки, предназначено свойство команды формы <span class="Term">ИспользованиеТекущейСтроки</span>.
Для того чтобы связать команду формы с таблицей, чьи данные она должна
обрабатывать, служит свойство команды <span class="Term">ИспользуемаяТаблица</span>.
Использование данного свойства означает, что на мобильной платформе невозможно
реализовать команду, оперирующую одновременно данными более одной таблицы. Для
управления размещением команды существует свойство команды <span class="Term">ОтображениеВКонтекстномМеню</span>:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Авто</span> – команда, которая использует данные
текущей строки, всегда располагается в контекстном меню. Команда, которая не
использует данные текущей строки – всегда располагается в командной панели
таблицы.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ТолькоВКонтекстномМеню</span> – команда всегда
расположена в контекстном меню.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ДополнительноВКонтекстномМеню</span> – команда
располагается в контекстном меню и в командной панели таблицы.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Нет</span> – команда располагается только в
командной панели таблицы.</p>

<p class="MsoNormal">Управление расположением строки поиска также
отличается от платформы для персонального компьютера. В зависимости от значения
свойства таблицы <span class="Term">ПоложениеСтрокиПоиска</span>,
возможно следующее поведение:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Авто</span> – строка
поиска доступна по нажатию кнопки командной панели (если таблица отображает
динамический список и этот динамический список является основным реквизитом
формы) или появляется при жесте вниз по заголовку таблицы (в остальных случаях);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Верх</span>, <span class="Interface">Командная панель</span> – строка поиска расположена между
командной панелью таблицы и заголовком таблицы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Потянуть сверху</span> –
строка поиска появляется при жесте вниз по заголовку таблицы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Заголовок формы –</span>
строка поиска расположена в заголовке формы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Низ</span> – строка
поиска отсутствует;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Нет</span> – строка
поиска отсутствует.</p>

<p class="MsoNormalCxSpFirst">В том случае, если у двух и более таблиц
формы свойство <span class="Term">ПоложениеСтрокиПоиска</span>
установлено в значение <span class="Interface">Заголовок формы</span>, то фактическое поведение будет аналогично
тому, как если у каждой из таких таблиц данное свойства установлено в значение <span class="Interface">Верх</span>.</p>

<p class="MsoNormalCxSpLast">Обновление данных, отображаемых таблицей,
можно осуществлять в стиле, принятом на мобильных устройствах: путем попытки
потянуть список вниз или вверх при достижении первой или последней
(соответственно) строки отображаемых данных (pull to refresh). Для управления
данной возможностью предназначено свойство таблицы <span class="Term">ЗапросОбновления</span>:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Нет</span> – обновление
можно выполнить только через команду командной панели таблицы;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Любое другое значение означает, что обновление
можно инициировать попыткой потянуть список в соответствующую сторону. При этом
в области таблицы за пределами данных отображается анимация вращающейся звезды.</p>

<p class="MsoNormalCxSpFirst">При выполнении обновления списка, таким образом,
будет вызван обработчик таблицы <span class="Term">ОбработкаЗапросаОбновления</span>.
В том случае, если таблица адаптируется под содержимое (условия адаптации
описаны выше в данном разделе), то обработчик таблицы <span class="Term">ОбработкаЗапросаОбновления</span>
вызываться не будет.</p>

<p class="MsoNormalCxSpMiddle">Если динамический список, связанной с
таблицей, не содержит отображаемых данных, то внутри таблицы отображается
надпись <span class="Interface">Нет
данных для отображения</span>. Таблица, не связанная с динамическим списком, не
отображает никакого текста при отсутствии данных для отображения.</p>

<p class="MsoNormalCxSpMiddle">При прокрутке таблицы, связанной с
динамическим списком, в ее верхней и нижней частях появляются полупрозрачные
кнопки, нажатие на которые приводит к переходу в начало или конец списка.</p>

<p class="MsoNormalCxSpLast">Для управления высотой таблицы управляемой
формы предназначено свойство <span class="Term">ВариантУправленияВысотойЭлемента</span>:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">В строках формы</span> –
в этом случае высота таблицы задается с помощью свойства <span class="Term">Высота</span>
таблицы управляемой формы. Если значение этого свойства равно 0, то высота
таблицы будет равна 8 единицам для таблицы, отображающей динамический список и
4 единицам – во всех остальных случаях.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">В строках таблицы</span> –
в этом случае высота таблицы задается с помощью свойства <span class="Term">ВысотаВСтрокахТаблицы</span>
таблицы управляемой формы. Если значение этого свойства равно 0, то высота
таблицы будет равна 7 строкам для таблицы, отображающей динамический список и 3
строкам – во всех остальных случаях.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">По содержимому</span> –
если таблица связана с динамическим списком, то высота таблицы задается
значением свойства <span class="Term">ВысотаВСтрокахТаблицы</span>.
Если значение этого свойства равно 0, то высота таблицы определяется значением
свойства <span class="Term">ВысотаВСтрокахТаблицы</span>.</p>

<p class="IndentlistCxSpFirst">Если таблица не связана с динамическим
списком, то полностью отображаются все строки таблицы, но не менее 3 и не более
100 строк. При добавлении 101-й строки таблица сжимается до высоты, указанной в
свойстве <span class="Term">ВысотаВСтрокахТаблицы</span>.
Если это свойство установлено в значение 0, то для определения высоты
используетс свойство <span class="Term">Высота</span>.
При этом содержимое таблицы начинает прокручиваться по вертикали. При удалении
101-й строки таблица растягивается по высоте до размера, достаточно для
размещения 100 строк таблицы.</p>

<p class="IndentlistCxSpLast">Значение <span class="Interface">По содержимому</span> рекомендуется использовать для таблиц,
отображающих небольшое количество строк.</p>

<p class="MsoListBullet">&#9679; 
<span class="Interface">Авто</span> –
аналогично значению <span class="Interface">По содержимому</span>.</p>

<a name="_ref423086389"></a><a id="TI000001565" class="bookmark" name="issogl4_25.3.4.4.10_отображение_строк_таблиц"><h5>25.3.4.4.10. Отображение строк таблиц</h5></a>

<p class="MsoNormal">Вместо редактирования данных в строке
таблицы, связанной с табличной частью или таблицей значений, мобильная
платформа предоставляет специальную системную форму. Эта форма содержит все
отображаемые на родительской форме колонки текущей строки таблицы. При
использовании этой формы необходимо помнить о следующих особенностях:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Колонки, для которых установлено свойство <span class="Interface">Только просмотр</span>, отображаются в системной форме также
без возможности редактирования;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В системной форме не отображаются поля типа
картинка и надпись;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
На системную форму действует условное оформление
формы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Вызываются все обработчики событий;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Системная форма не редактируется в конфигураторе
и ее нельзя модифицировать из встроенного языка.</p>

<p class="MsoNormal">После возврата из режима редактирования,
редактируемая строка кратковременно подсвечивается.</p>

<a id="TI000001566" class="bookmark" name="issogl3_25.3.4.5_динамический_список"><h4>25.3.4.5. Динамический список</h4></a>

<p class="MsoNormal">Динамический список, используемый в
мобильной платформе, имеет следующие особенности:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Поддерживается управление настройками динамического
списка с помощью встроенного языка. Для интерактивной настройки необходимо
самостоятельно реализовать соответствующие формы настройки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Не поддерживается интерактивный вывод списка;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Имеется возможность выполнять сортировку по
нажатию на заголовок. По нескольким колонкам таким образом сортировать нельзя.</p>

<a name="_ref432003307"></a><a id="TI000001567" class="bookmark" name="issogl3_25.3.4.6_панели_формы"><h4>25.3.4.6. Панели формы</h4></a>

<p class="MsoNormalCxSpFirst">Панель
навигации формы реализована с помощью специального меню, которое отображается в
нижней части формы в виде переключателя. Нажатие кнопки переключателя приводит
к открытию соответствующей формы.</p>

<p class="MsoNormalCxSpLast">Командная
панель формы:</p>

<p class="MsoListBullet">&#9679; 
В режиме отображения сверху:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Командная панель находится в заголовке формы,
правее текста.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Если командная панель содержит стандартные пары
команд <span class="Interface">ОК</span>-<span class="Interface">Отмена</span> и <span class="Interface">Да</span>-<span class="Interface">Нет</span>, то кнопка с отрицательным действием переносится в левую
часть заголовка формы, а положительная отображается в командной панели формы. В
меню <span class="Interface">Еще</span>
присутствуют все команды, кроме команды с отрицательным действием, которая была
перенесена в заголовок формы.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Если командная панель не содержит вышеуказанных
пар команд, но содержит стандартную команду формы <span class="Interface">Отмена</span>, <span class="Interface">Нет</span> или <span class="Interface">Закрыть</span>, то кнопка с такой командой переносится в панель
в заголовке слева.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Команда, которая размещена в левой части
заголовка формы, будет отображаться специальным символом (<span class="Interface">&lt;</span>), но будет выполнять свою изначальную функцию.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
При отображении кнопки в командной панели формы
учитывается свойство <span class="Interface">Отображение</span> этой кнопки. Свойства команды, связанной с
этой кнопкой, игнорируются при определении режима отображения кнопки.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Если командная панель содержит кнопку по
умолчанию, то она всегда отображается в заголовке первой.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Если свободного места в правой части заголовка
достаточно для отображения оставшихся команд – они отображаются там. В
противном случае отображается кнопка <span class="Interface">Еще</span> и система пытается сделать так, чтобы кнопка <span class="Interface">Еще</span> не была единственной: если команда, отображаемая в
правой части заголовка еще не определена, то ей станет первая команда из списка
оставшихся команд, а остальные будут расположены в меню <span class="Interface">Еще</span>.</p>

<p class="MsoListBullet">&#9679; 
В режиме отображения снизу:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Фиксируется при прокрутке формы.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
При появлении клавиатуры не отображается.</p>

<p class="MsoNormalCxSpFirst">В список стандартных команд не включаются
команды непосредственного удаления (для объектов ссылочного типа), вызова
справки, вывода списка, изменения формы. Стандартные команды <span class="Interface">Записать и закрыть</span> и <span class="Interface">Провести и закрыть</span> отображаются в командных панелях с
заголовком <span class="Interface">Готово</span>.</p>

<p class="MsoNormalCxSpMiddle">Для прикладных
решений, работающих под управлением ОС iOS, необходимо помнить о том, что системные
механизмы закрытия формы не задают пользователю вопрос о необходимости
сохранения данных в том случае, когда закрывается форма с модифицированными
данными.</p>

<p class="MsoNormalCxSpLast">Командная
панель, связанная с таблицей, располагается сверху или снизу таблицы и по
ширине не превышает ширины самой таблицы. При прокрутке таблицы командная
панель всегда остается в видимой области.</p>

<a name="_ref451945527"></a><a name="_ref451945526"></a><a id="TI000000907" class="bookmark" name="issogl2_25.3.5_работа_с_файлами"><h3>25.3.5. Работа с файлами</h3></a>

<p class="MsoNormalCxSpFirst">Все приложения на мобильных устройствах
работают в рамках специального механизма, обеспечивающего безопасное исполнение
программ («песочница», sandbox). В рамках этого
механизма, приложениям предоставляется ограниченный доступ к файловой системе
мобильного устройства. При разработке мобильного приложения может требоваться
доступ к файловой системе, например для промежуточного хранения данных или
записи документов, сформированных в системе, для последующего обмена с другими
компьютерами.</p>

<p class="MsoNormalCxSpLast">Для получения доступа к таким местам
файловой системы предназначены специальные функции:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">КаталогВременныхФайлов()</span> – возвращает
каталог временных файлов данного приложения. При необходимости каталог может
быть очищен операционной системой.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">РабочийКаталогДанныхПользователя()</span> – возвращает
каталог, в котором рекомендуется хранить «долговременные» данные пользователя.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
КаталогДокументов<span class="Term">()</span> –
каталог документов, которые предназначены для обмена с внешним (по отношению к
мобильному приложению) окружением.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">КаталогБиблиотекиМобильногоУстройства()</span> –
возвращает каталог библиотеки мобильного устройства. Вид библиотеки
определяется параметром метода. Доступны следующие виды библиотек: аудиофайлы,
видеофайлы и картинки.</p>

<p class="MsoNormalCxSpFirst">Вне зависимости от реальных возможностей
мобильной ОС, не рекомендуется использовать для работы любые другие каталоги
файловой системы мобильного устройства из соображений безопасности, а также
требований разработчиков мобильных ОС к прикладным приложениям.</p>

<p class="MsoNormalCxSpMiddle">Если в прикладном решении требуется каким-то
образом использовать файл, расположенный на мобильном устройстве, то для выбора
файла можно использовать объект <span class="Term">ДиалогВыбораФайла</span>.
Данный диалог поддерживает работу только в режиме выбора существующего файла (<span class="Term">РежимДиалогаВыбораФайла.Открытие</span>)
и не поддерживает режим работы <span class="Term">РежимДиалогаВыбораФайла.Сохранение</span>.
Если требуется сохранить файл на мобильном устройстве, следует использовать
интерактивный вариант метода <span class="Term">ПолучитьФайл()</span>.</p>

<p class="MsoNormalCxSpMiddle">На мобильном устройстве имя файла в
библиотеке может не соответствовать тому, как этот файл отображается системными
приложениями. При этом представление файла не может быть использовано для
идентификации файла, передачи в качестве параметров методов работы с файлами и т. д.
Представление предназначено исключительно для отображения пользователю. Для получения
представления следует использовать метод <span class="Term">Файл.ПолучитьПредставлениеФайлаБиблиотекиМобильногоУстройства()</span>.</p>

<p class="MsoNormalCxSpLast">Следующий пример иллюстрирует выбор и
отображение произвольного каталога на мобильном устройстве:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Диалог <span class="operator">=</span> <span class="keyword">Новый</span> ДиалогВыбораФайла<span class="operator">(</span>РежимДиалогаВыбораФайла<span class="operator">.</span>ВыборКаталога<span class="operator">)</span><span class="operator">;</span>
Диалог<span class="operator">.</span>Каталог <span class="operator">=</span> КаталогБиблиотекиМобильногоУстройства<span class="operator">(</span>ТипКаталогаБиблиотекиМобильногоУстройства<span class="operator">.</span>Аудио<span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Если</span> Диалог<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
    Сообщить<span class="operator">(</span><span class="string">&quot;Выбран каталог: &quot;</span> <span class="operator">+</span> Диалог<span class="operator">.</span>Каталог<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЕсли</span><span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">Следует помнить, что в каталоги библиотек
мобильного устройства (в общем случае) невозможно выполнить запись файлов
обычным способом. Запись возможна только с помощью методов <span class="Term">ПолучитьФайл()</span>
или <span class="Term">ПолучитьФайлы()</span>.</p>

<p class="MsoNormalCxSpLast">В результате можно сформулировать следующую
рекомендацию по работе с файлами на мобильном устройстве:</p>

<p class="MsoListNumberCxSpFirst">1. 
Если путь к каталогу (или файлу) начинается со
строки <span class="Term">content:</span>, то для
записи в такой каталог допустимо использовать только методы <span class="Term">ПолучитьФайл()</span>
или <span class="Term">ПолучитьФайлы()</span>. Также допустимо использовать
такие пути в конструкторах следующих объектов: <span class="Term">Файл</span>,
<span class="Term">ДвоичныеДанные</span>, <span class="Term">Картинка</span>,
<span class="Term">ЗапускПриложенияМобильногоУстройства</span> и в
качестве параметров следующих методов: <span class="Term">ЗапуститьПриложение()</span>,
<span class="Term">ПерейтиПоНавигационнойСсылке()</span>, <span class="Term">КопироватьФайл()</span>,
<span class="Term">ПереместитьФайл()</span>, <span class="Term">УдалитьФайлы()</span>,
<span class="Term">НайтиФайлы()</span>.</p>

<p class="MsoListNumberCxSpMiddle">2. 
Если путь к каталогу (или файлу) не начинается
со строки <span class="Term">content:</span>, то для
работы с такими файлами и путями можно использовать все возможности мобильной
платформы по работе с файлами. Следует помнить, что мобильные ОС работают с
разными файловыми системами. Следовательно, разделители путей и маски всех
файлов отличаются на разных мобильных ОС.</p>

<p class="MsoListNumberCxSpLast">3. 
Для того чтобы получить эти маску всех файлов и
разделитель пути универсальным способом, который учитывает используемую
операционную систему и место исполнения кода, необходимо использовать
специальные методы <span class="Term">ПолучитьМаскуВсеФайлы()</span>
и <span class="Term">ПолучитьРазделительПути()</span>. Эти методы
учитывают не только операционную систему, под управлением которой работает
прикладное решение, но и то, где исполняется прикладной код: на стороне клиентского
приложения или на стороне сервера. Для унификации с кодом прикладного решения
для персонального компьютера, можно использовать методы, которые возвращают
указанные параметры отдельно для клиентской и серверной частей прикладного
решения: <span class="Term">ПолучитьМаскуВсеФайлыКлиента()</span>/<span class="Term">Сервера()</span>
и <span class="Term">ПолучитьРазделительПутиКлиента()</span>/<span class="Term">Сервера()</span>.</p>

<p class="MsoNormal">При отображении информации из библиотек
мобильного устройства может потребоваться показывать не полноценные изображения,
а уменьшенные копии (preview, картинка представления). В результате снижается
вероятность получения ошибки нехватки памяти при работе с мобильным
приложением, которое активно использует картинки или видео-файлы из библиотек
мобильного устройства. Для того, что получить картинку представления для файла,
расположенного в библиотеке мобильного устройства, следует использовать метод <span class="Term">Файл.ПолучитьКартинкуПредставленияФайлаБиблиотекиМобильногоУстройства()</span>.
При использовании данного метода следует помнить, что для получения картинки
представления, путь к обрабатываемому файлу должен принадлежать схеме <span class="Term">content</span>
(начинаться со строки <span class="Term">content:</span>).</p>

<a id="TI000000913" class="bookmark" name="issogl2_25.3.6_отчеты"><h3>25.3.6. Отчеты</h3></a>

<p class="MsoNormal">Формирование
отчетов на мобильной платформе возможно двумя разными способами:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Обработка существующих данных и формирование
собственно отчета на встроенном языке;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реализация на мобильной платформе некоторой
формы, с помощью которой можно задать параметры формирования отчета (отборы и т. д.),
а само формирование передать в удаленную систему, которая вернет табличный
документ для отображения на мобильном устройстве.</p>

<p class="MsoNormal">Выбор
одного из этих вариантов зависит от некоторого набора факторов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Содержит или нет информационная база мобильного
приложения все данные, которые необходимы для построения отчета;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Наличие и качество канала связи между мобильным
устройством и удаленной системой;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Какова сложность отчета;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Каким образом построен обмен с удаленной
системой;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Каким образом предполагается работа с отчетом;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
И т. д.</p>

<p class="MsoNormalCxSpFirst">Если
принято решение формировать отчет на мобильном устройстве, то необходимо
помнить об особенностях мобильной платформы (см. <A href="/db/content/v8310doc/src/руководство разработчика/приложение 7. особенности поведения системы в различных режимах.htm?_=1496848987#_ref335130545">здесь</a>). Для получения данных доступны выборки, а для
построения отчета доступно программное формирование табличного документа (на
основании макета) и диаграмм (если таковые требуются).</p>

<p class="MsoNormalCxSpMiddle">Если
для мобильного приложения доступны постоянные высокоскоростные каналы связи с удаленной
системой, которое обладает всеми необходимыми данными для формирования
требуемого отчета, то возможным вариантом может служить реализация на мобильном
приложении только интерфейсной части отчета (задание отборов, обработка
расшифровки и т. д.). Собственно формирование отчета в этом случае
будет происходить в удаленном приложении, а возвращаться будет готовый отчет
для отображения на устройстве.</p>

<p class="MsoNormalCxSpMiddle">При
этом возможны и все промежуточные варианты, например, если реализован
периодический обмен, можно настройки отчета сформировать на мобильном
устройстве и передать на удаленную систему во время сеанса обмена, а обратно получить
сформированный отчет для отображения.</p>

<p class="MsoNormalCxSpMiddle">Для
взаимодействия с удаленным приложением можно использовать Web-сервис (который
предоставляет удаленное приложение), обмен данными с помощью плана обмена и т. д.</p>

<p class="MsoNormalCxSpLast">При
необходимости реализации расшифровки отчета, нужно понимать, что мобильное
приложение самостоятельно может выполнить только просмотр значений, указанных в
качестве расшифровки ячейки отчета. Остальные действия необходимо реализовывать
на встроенном языке, включая получение нового варианта отчета с учетом
наложенных отборов и т. д.</p>

<a name="_ref350955688"></a><a name="_ref378865284"></a><a id="TI000000914" class="bookmark" name="issogl2_25.3.7_работа_с_картинками"><h3>25.3.7. Работа с картинками</h3></a>

<p class="MsoNormalCxSpFirst">Для
мобильных устройств используется обычная картинка с вариантами, которая
используется платформой для персонального компьютера. Описание формата картинки
и ее манифеста см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref397005389">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Для
устройств на ОС iOS используются следующие картинки из набора:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
обычные экраны – картинка mdpi;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
экраны Retina – картинки xdpi.</p>

<p class="MsoNormal">Для
устройств на ОС Android
используются картинки, соответствующие разрешению экрана используемого
устройства.</p>

<a name="_ref370809817"></a><a id="TI000001307" class="bookmark" name="issogl2_25.3.8_работа_с_ролями_и_пользователями"><h3>25.3.8. Работа с ролями и пользователями</h3></a>

<p class="MsoNormalCxSpFirst">При
работе с ролями в мобильном приложении следует помнить, что из всех прав
доступа, которые предоставляет платформа для персонального компьютера, на
мобильной платформе доступен только ограниченный набор. Этот набор прав призван
обеспечить функционирование различных механизмов, обеспечивающих интерфейс
мобильного приложения. Права, которые могут использовать на мобильной
платформе, отмечены символом «*» в полном списке прав (см. <A href="/db/content/v8310doc/src/руководство разработчика/приложение 6. описание прав доступа.htm?_=1496848987#_ref370810088">здесь</a>).</p>

<p class="MsoNormalCxSpLast">Также
имеется возможность выполнять ролевую настройку формы (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 27. инструменты разработки.htm?_=1496848987#_ref374982339">здесь</a>), настраивать ролевую видимость командного интерфейса
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 27. инструменты разработки.htm?_=1496848987#_ref374982623">здесь</a>).</p>

<p class="Note"><span class="Note">Внимание!</span> Права для доступа к данным (<span class="Term">Чтение</span>, <span class="Term">Добавление</span>, <span class="Term">Изменение</span>, <span class="Term">Удаление</span> и т. д.) не поддерживаются
мобильной платформой.</p>

<p class="MsoNormalCxSpFirst">Методы
управления привилегированным режимом в мобильной платформе используются для
совместимости с платформой для персонального компьютера. Сами вызовы методов
работы с привилегированным режимом мобильной платформой игнорируются и никаких
действий мобильная платформа не выполняет.</p>

<p class="MsoNormalCxSpMiddle">При
определении прав пользователя действует стандартная схема: если в
информационной базе не заданы пользователи, то для определения прав доступа
используется свойство конфигурации <span class="Term">ОсновныеРоли</span> (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref370811599">здесь</a>). Если для доступа к данным мобильного приложения
используется пользователь, то права доступа определяются по составу ролей этого
пользователя.</p>

<p class="MsoNormalCxSpLast">Мобильная платформа имеет ограниченный набор средств
работы с пользователями информационной базы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
В информационной базе может существовать только
один пользователь. Попытка создать более одного пользователя приводит к
генерации исключения.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Пользователь может быть создан только с помощью
программного кода. Интерактивное создание пользователей в конфигураторе не
приведет к передаче пользователя на мобильное устройство.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Мобильная платформа не предлагает средств
аутентификации при старте мобильного приложения. Если пользователь указан в
списке пользователей, то этот пользователь автоматически будет установлен в
качестве пользователя текущего сеанса.</p>

<p class="MsoNormal">В
результате можно рекомендовать следующую схему работы от лица пользователей с
разными правами:</p>

<p class="MsoListNumberCxSpFirst">1.  Выполняется
создание пользователя с нужным набором ролей или выполняется изменение набора
ролей у существующего пользователя.</p>

<p class="MsoListNumberCxSpLast">2.  Выполняется
перезапуск мобильного приложения с помощью конструкции <span class="Term">ЗавершитьРаботуСистемы(Ложь, Истина);</span>.</p>

<a name="_ref400109708"></a><a id="TI000001489" class="bookmark" name="issogl2_25.3.9_полнотекстовый_поиск"><h3>25.3.9. Полнотекстовый поиск</h3></a>

<p class="MsoNormal">Описание
особенностей использования полнотекстового поиска в мобильной платформе
см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 19. механизм полнотекстового поиска в данных.htm?_=1496848987#_ref400108144">здесь</a>.</p>

<a name="_ref452045177"></a><a id="TI000001865" class="bookmark" name="issogl2_25.3.10_внешние_компоненты"><h3>25.3.10. Внешние компоненты</h3></a>

<p class="MsoNormalCxSpFirst">В
мобильном приложении допускается использовать только компоненты, разработанные
по технологии Native API, которые могут быть как отдельными файлами, так и
упакованными в zip-архивы
особого вида.</p>

<p class="MsoNormalCxSpMiddle">Во
внешних компонентах, разработанных для использования совместно с мобильным
приложением, запрещается использовать работу с пользовательским интерфейсом.</p>

<p class="MsoNormalCxSpMiddle">Внешняя
компонента должна быть скомпилирована с учетом всех процессоров, архитекту и
операционных систем, используемых на мобильных устройствах. Рекомендуется
функциональные модули внешней компоненты реализовывать платформонезависимым
образом.</p>

<p class="MsoNormalCxSpMiddle">Если
внешняя компонента использует дополнительные модули, это рекомендуется
указывать в документации к компоненте. Используемые не системные библиотеки
должны быть статически включены в результирующий файл внешней компоненты.</p>

<p class="MsoNormalCxSpLast">Отладка
прикладного решения, с применением внешних компонент, различается для разных
мобильных ОС:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Для ОС iOS – отладка возможна с использованием платформы
разработчика, путем публикации прикладного решения на веб-сервере (подробнее
см. <a href="#_ref374633853">здесь</a>).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для ОС Android – отладка возможна с использованием платформы
разработчика, путем публикации прикладного решения на веб-сервере (подробнее
см. <a href="#_ref374633853">здесь</a>) или при работе через Android Debug Bridge (подробнее
см. <a href="#_ref459648773">здесь</a>).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для ОС Windows – допустимо использование только собранного
мобильного приложения (с помощью сборщика мобильных приложений).</p>

<p class="MsoNormalCxSpFirst">Для
того чтобы использовать внешнюю компоненту с мобильным приложением, необходимо
загрузить ее в конфигурацию, в макет с типом <span class="Interface">Внешняя компонента</span>
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 1. концепция системы.htm?_=1496848987#_ref422322131">здесь</a>).</p>

<p class="MsoNormalCxSpLast">Для
того чтобы собрать мобильное приложение с включением внешних компонент,
необходимо выгружать конфигурацию (для сборщика мобильных приложений) в виде zip-архива (<span class="Interface">1cema.zip</span>).
Если конфигурация содержит внешние компонентиы, то при выполнении команды <span class="Interface">Главное меню –
Конфигурация – Мобильное приложение – Записать в файл</span> будет
автоматически предложен именно такой вариант сохранения. Сборщик мобильных
приложений автоматически будет учитывать наличие внешних компонент при загрузке
мобильной конфигурации и последующей сборке мобильного приложения.</p>

<a name="_ref441581704"></a><a name="_ref441581703"></a><a id="TI000000908" class="bookmark" name="issogl1_25.4_специальные_возможности"><h2>25.4. Специальные возможности</h2></a>

<a name="_ref451354161"></a><a name="_ref451354160"></a><a id="TI000000909" class="bookmark" name="issogl2_25.4.1_работа_с_телефонией"><h3>25.4.1. Работа с телефонией</h3></a>

<p class="MsoNormalCxSpFirst">Мобильная
платформа предоставляет набор возможностей, которые позволяют выполнять звонки
из мобильных приложений. Звонки можно выполнять как с подтверждением
пользователя, так и без такового. Также система предоставляет доступ к журналу
звонков и возможность обрабатывать события, возникающие при получении или
совершении телефонных звонков. Прикладное решение может определить возможности
по работе с телефонией. Для этого предназначены методы <span class="Term">ПоддерживаетсяНаборНомера()</span>, <span class="Term">ПоддерживаетсяЖурналЗвонков()</span> и <span class="Term">ПоддерживаетсяОбработкаЗвонков()</span> объекта <span class="Term">СредстваТелефонии</span>. При работе мобильного
приложения на ОС iOS, невозможно получить доступ к журналу звонков. Обработка
звонков возможна только на ОС Android.</p>

<p class="MsoNormalCxSpLast">Набор
номера выполняется следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Если</span> СредстваТелефонии<span class="operator">.</span>ПоддерживаетсяНаборНомера<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
    СредстваТелефонии<span class="operator">.</span>НабратьНомер<span class="operator">(</span>НомерТелефона<span class="operator">,</span> ВызватьСразу<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЕсли</span><span class="operator">;</span></pre>

<p class="MsoNormal">Параметр
<span class="Term">ВызватьСразу</span>
отвечает за то, как будет выполняться вызов абонента:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Параметр равен значению <span class="Term">Истина</span> – в этом случае при выполнении
метода номер начинает набираться автоматически. На экране появляется стандартный
интерфейс программы работы со звонками.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Параметр равен значению <span class="Term">Ложь</span> – в этом случае при выполнении
метода будет открыто приложение работы со звонками, в котором будет установлен
заданный номер. Пользователю останется только нажать кнопку начала вызова.</p>

<p class="MsoNormalCxSpFirst">Мобильные
устройства, функционирующие под управление ОС Android, предоставляют
возможность доступа к журналу звонков. Имеется возможность перебрать записи
журнала с установкой необходимого отбора. Для работы с журналом необходимо использовать
метод <span class="Term">ПолучитьЖурналЗвонков()</span>
объекта <span class="Term">СредстваТелефонии</span>.</p>

<p class="MsoNormalCxSpLast">Следующий
пример демонстрирует получение списка всех пропущенных звонков на мобильном
устройстве.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Если</span> СредстваТелефонии<span class="operator">.</span>ПоддерживаетсяЖурналЗвонков<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
    Журнал <span class="operator">=</span> СредстваТелефонии<span class="operator">.</span>ПолучитьЖурналЗвонков<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Отбор <span class="operator">=</span> <span class="keyword">Новый</span> ОтборКомпоновкиДанных<span class="operator">;</span>
    НовыйЭлемент <span class="operator">=</span> Отбор<span class="operator">.</span>Элементы<span class="operator">.</span>Добавить<span class="operator">(</span>Тип<span class="operator">(</span><span class="string">&quot;ЭлементОтбораКомпоновкиДанных&quot;</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    НовыйЭлемент<span class="operator">.</span>ЛевоеЗначение <span class="operator">=</span> <span class="keyword">Новый</span> ПолеКомпоновкиДанных<span class="operator">(</span><span class="string">&quot;ТипЗвонка&quot;</span><span class="operator">)</span><span class="operator">;</span>
    НовыйЭлемент<span class="operator">.</span>ВидСравнения <span class="operator">=</span> ВидСравненияКомпоновкиДанных<span class="operator">.</span>Равно<span class="operator">;</span>
    НовыйЭлемент<span class="operator">.</span>ПравоеЗначение <span class="operator">=</span> ТипЗвонкаЖурналаЗвонков<span class="operator">.</span>Пропущенный<span class="operator">;</span>
    НовыйЭлемент<span class="operator">.</span>Использование <span class="operator">=</span> <span class="keyword">Истина</span><span class="operator">;</span>
    ЗаписиЖурнала <span class="operator">=</span> Журнал<span class="operator">.</span>НайтиЗаписи<span class="operator">(</span>Отбор<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Для</span> <span class="keyword">каждого</span> Запись <span class="keyword">Из</span> ЗаписиЖурнала <span class="keyword">Цикл</span>
        <span class="comment">// обработка списка звонков</span>
    <span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">КонецЕсли</span><span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">При
работе с журналом звонков следует помнить, что отбор журнала выполняется с
помощью объекта <span class="Term">ОтборКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpMiddle">Для
обработки событий звонков (на устройствах под управлением ОС Android) предоставляется возможность подключения/отключения
обработчика звонков. После того, как в системе регистрируется обработчик
событий звонков, при наступлении того или иного события вызывается
зарегистрированный обработчик, в который передается информация о звонке.
Обработчик не позволяет управлять собственно звонком, для этого используется
штатная программа операционной системы.</p>

<p class="MsoNormalCxSpLast">С
помощью данного механизма можно реализовать, например, собственный журнал
звонков мобильного приложения или реализовать напоминание о пропущенном звонке.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> УправлениеОбработчикомЗвонков<span class="operator">(</span>ПодключитьОбработчик<span class="operator">)</span>
    <span class="keyword">Если</span> <span class="keyword">НЕ</span> СредстваТелефонии<span class="operator">.</span>ПоддерживаетсяОбработкаЗвонков<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
        <span class="comment">// обработка звонков не поддерживается</span>
        <span class="keyword">Возврат</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    Обработчик <span class="operator">=</span> <span class="keyword">Новый</span> ОписаниеОповещения<span class="operator">(</span><span class="string">&quot;ОбработчикЗвонков&quot;</span><span class="operator">,</span> ЭтотОбъект<span class="operator">,</span> <span class="string">&quot;Параметры&quot;</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Если</span> ОбрабатыватьСобытияЗвонка <span class="keyword">Тогда</span>
        СредстваТелефонии<span class="operator">.</span>ПодключитьОбработчикЗвонков<span class="operator">(</span>Обработчик<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Иначе</span>
        СредстваТелефонии<span class="operator">.</span>ОтключитьОбработчикЗвонков<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="keyword">Процедура</span> ОбработчикЗвонков<span class="operator">(</span>НомерТелефона<span class="operator">,</span> Дата<span class="operator">,</span> ВариантСобытия<span class="operator">,</span> ТипЗвонка<span class="operator">,</span> ДопПараметры<span class="operator">)</span> <span class="keyword">Экспорт</span>
    <span class="comment">// обработка событий звонков</span>
<span class="keyword">КонецПроцедуры</span></pre>

<a id="TI000001329" class="bookmark" name="issogl2_25.4.2_работа_с_сообщениями_sms_и_mms"><h3>25.4.2. Работа с сообщениями (SMS и MMS)</h3></a>

<p class="MsoNormalCxSpFirst">Мобильная
платформа предоставляет набор инструментов, позволяющих работать с сообщениями
(SMS и MMS). Предоставляется возможность отправлять и получать сообщения.
Доступ к списку сообщений не предоставляется. Отправка сообщений возможна как в
интерактивном, так и в полностью программном режиме (не интерактивном режиме).</p>

<p class="MsoNormalCxSpLast">Платформа
предоставляет средства для определения возможностей используемой мобильной ОС.
Для этого у объекта глобального контекста <span class="Term">СредстваТелефонии</span> существуют методы <span class="Term">ПоддерживаетсяОтправкаSMS()</span>, <span class="Term">ПоддерживаетсяПриемSMS()</span> и <span class="Term">ПоддерживаетсяОтправкаMMS()</span>. В зависимости от используемой мобильной операционной
системы, существуют следующие ограничения на работу с сообщениями:</p>

<p class="MsoListBullet">&#9679; 
Для ОС iOS:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Недоступна подписка на получение SMS/MMS;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Недоступна не интерактивная отправка SMS/MMS.</p>

<p class="MsoListBullet">&#9679; 
Для ОС Android:</p>

<p class="MsoListBullet2">&#9679; 
Недоступна не интерактивная отправка MMS.</p>

<p class="MsoNormal">Сообщение
в «1С:Предприятии» представлено объектом <span class="Term">SMSСообщение</span>. Отправка сообщения выглядит
следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ОтправитьСМС<span class="operator">(</span>Кому<span class="operator">,</span> Текст<span class="operator">,</span> ПослатьИнтерактивно<span class="operator">)</span>
    СМС <span class="operator">=</span> <span class="keyword">Новый</span> SMSСообщение<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>    
    СМС<span class="operator">.</span>Текст <span class="operator">=</span> Текст<span class="operator">;</span>
    СтрокаПолучатели <span class="operator">=</span> СтрЗаменить<span class="operator">(</span>Кому<span class="operator">,</span> <span class="string">&quot;,&quot;</span><span class="operator">,</span> Символы<span class="operator">.</span>ПС<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Для</span> Счетчик<span class="operator">=</span><span class="number">1</span> <span class="keyword">По</span> СтрЧислоСтрок<span class="operator">(</span>СтрокаПолучатели<span class="operator">)</span> <span class="keyword">Цикл</span>
        СМС<span class="operator">.</span>Получатели<span class="operator">.</span>Добавить<span class="operator">(</span>СокрЛП<span class="operator">(</span>СтрПолучитьСтроку<span class="operator">(</span>СтрокаПолучатели<span class="operator">,</span> Счетчик<span class="operator">)</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЦикла</span><span class="operator">;</span>
    СредстваТелефонии<span class="operator">.</span>ПослатьSMS<span class="operator">(</span>СМС<span class="operator">,</span> ПослатьИнтерактивно<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormal">В
качестве значения параметра <span class="Term">Кому</span> могут быть переданы несколько номеров телефонов,
разделенных символом «<span class="Interface">,</span>». Параметр <span class="Term">ПослатьИнтерактивно</span> определяет, как будет
отправлено сообщение:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Параметр имеет значение <span class="Term">Истина</span> – сообщение будет отправлено
сразу;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Параметр имеет значение <span class="Term">Ложь</span> – будет открыто приложение для
работы с сообщениями (установленное по умолчанию для используемой мобильной
ОС). В этом приложении будет открыта форма отправки сообщения с заполненными
полями. В этом случае пользователю необходимо самому нажать кнопку отправки
сообщения.</p>

<p class="MsoNormal">Система
не предоставляет доступа к журналу сообщений, однако имеется возможность
подписаться (если это позволяет используемая мобильная ОС) на оповещения о
получении сообщений.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПодключитьОбработчикПолученияСообщений<span class="operator">(</span><span class="operator">)</span>
    ПолучательСообщений <span class="operator">=</span> <span class="keyword">Новый</span> ОписаниеОповещения<span class="operator">(</span><span class="string">&quot;ПолучениеСообщения&quot;</span><span class="operator">,</span> ЭтотОбъект<span class="operator">)</span><span class="operator">;</span>
    СредстваТелефонии<span class="operator">.</span>ПодключитьОбработчикSMSСообщений<span class="operator">(</span>ПолучательСообщений<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПолучениеСообщения<span class="operator">(</span>Сообщение<span class="operator">,</span> ДополнительныеПараметры<span class="operator">)</span> <span class="keyword">Экспорт</span>
    Сообщить<span class="operator">(</span>Сообщение<span class="operator">.</span>Отправитель <span class="operator">+</span> <span class="string">&quot; – &quot;</span> <span class="operator">+</span> Сообщение<span class="operator">.</span>Текст<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormalCxSpFirst">При
получении входящего сообщения, будет вызываться обработчик оповещения для
обработки полученного сообщения. Сообщения, полученные с помощью установленного
обработчика оповещения, также будут доступны и из системного приложения по
работе с сообщениями.</p>

<p class="MsoNormalCxSpLast">Для
того чтобы SMS-сообщение было преобразовано в MMS-сообщение, необходимо
добавить вложения в сообщения. Это делается с помощью свойства <span class="Term">Вложения</span> объекта <span class="Term">SMSСообщение</span>. При этом в качестве значения
свойства <span class="Term">ТипСодержимого</span>
объекта <span class="Term">MMSВложение</span>
следует указывать MIME-тип передаваемых данных, например, для jpeg-файла это
будет <span class="Interface">image/jpeg</span>.</p>

<a name="_ref355102665"></a><a id="TI000000910" class="bookmark" name="issogl2_25.4.3_средства_геопозиционирования"><h3>25.4.3. Средства геопозиционирования</h3></a>

<a name="_ref458700168"></a><a id="TI000001702" class="bookmark" name="issogl3_25.4.3.1_общая_информация"><h4>25.4.3.1. Общая информация</h4></a>

<p class="MsoNormalCxSpFirst">Большое
количество мобильных устройств поддерживают определение координат, по которым
располагается устройство. Также имеется возможно выполнять преобразование
полученных координат в адрес и наоборот. Для доступа к этим функциям предназначен
<span class="Bold">провайдер</span> геопозиционирования. Каждый провайдер
описывается именем и определенным набором параметров (возможностей). Конкретный
провайдер геопозиционирования может поддерживать не все возможности.</p>

<p class="MsoNormalCxSpLast">Общая
схема работы со средствами геопозиционирования выглядит следующим образом:</p>

<p class="MsoListNumber">1.  Выбирается
необходимый провайдер геопозиционирования. В каждом случае следует выбирать тот
провайдер, который максимально подходит для реализации поставленной задачи. В
общем случае стоит выбирать провайдера, который обеспечивает минимальное
энергопотребление и максимальную точность определения координат.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Определим провайдера, который не приводит к расходованию</span>
<span class="comment">// средств и использует для определения координат</span>
<span class="comment">// сеть сотовой связи</span>
ИскомыйПровайдер <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
Провайдеры <span class="operator">=</span> СредстваГеопозиционирования<span class="operator">.</span>ПолучитьПровайдеров<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Для</span> <span class="keyword">каждого</span> Провайдер <span class="keyword">Из</span> Провайдеры <span class="keyword">Цикл</span>
    <span class="keyword">Если</span> <span class="keyword">НЕ</span> Провайдер<span class="operator">.</span>Платный <span class="keyword">и</span> Провайдер<span class="operator">.</span>ИспользуетСотовуюСеть <span class="keyword">Тогда</span>
        ИскомыйПровайдер <span class="operator">=</span> Провайдер<span class="operator">;</span>
        <span class="keyword">Прервать</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">Если</span> ИскомыйПровайдер <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
    Сообщить<span class="operator">(</span><span class="string">&quot;Требуемый провайдер не обнаружен&quot;</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Иначе</span>
    Сообщить<span class="operator">(</span><span class="string">&quot;Найден провайдер: &quot;</span> <span class="operator">+</span> ИскомыйПровайдер<span class="operator">.</span>Имя<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЕсли</span><span class="operator">;</span></pre>

<p class="Indentlist">В
случае необходимости получить самый энергоэффективный провайдер или самый
точный провайдер, можно воспользоваться методами <span class="Term">ПолучитьСамогоЭнергоЭкономичногоПровайдера()</span>
или <span class="Term">ПолучитьСамогоТочногоПровайдера()</span>
(соответственно).</p>

<p class="MsoListNumber">2.  Выполняется
определение координат с помощью выбранного провайдера геопозиционирования. Для
получения координат используются два метода. Метод <span class="Term">ПолучитьПоследнееМестоположение()</span> возвращает
последние данные о местоположении, полученные выбранным провайдером. Среди
свойств объекта <span class="Term">ДанныеМестоположения</span>
(который возвращает метод <span class="Term">ПолучитьПоследнееМестоположение()</span>), есть
свойство <span class="Term">Дата</span>,
которое описывает, когда были получены данные о местоположении. Если эти данные
были получены очень давно, то необходимо вызвать метод <span class="Term">ОбновитьМестоположение()</span> для того, чтобы
провайдер геопозиционирования заново определил данные о местоположении. Один из
параметров метода определяет тайм-аут на определение местоположения. В том
случае, если метод завершен по тайм-ауту, фактическое определение координат в
данном случае зависит от особенностей реализации конкретной версии мобильной
операционной системы.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Если местоположение на данном устройстве ни разу не выполнялось</span>
<span class="comment">// или выполнено более часа назад – обновить местоположение и</span>
<span class="comment">// получить определенные координаты</span>
Координаты <span class="operator">=</span> СредстваГеопозиционирования<span class="operator">.</span>ПолучитьПоследнееМестоположение<span class="operator">(</span>ИмяПровайдера<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Если</span> Координаты <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">ИЛИ</span> ТекущаяДата<span class="operator">(</span><span class="operator">)</span><span class="operator">-</span>Координаты<span class="operator">.</span>Дата <span class="operator">&gt;</span> <span class="number">3600</span> <span class="keyword">Тогда</span>
    СредстваГеопозиционирования<span class="operator">.</span>ОбновитьМестоположение<span class="operator">(</span>ИмяПровайдера<span class="operator">,</span> <span class="number">60</span><span class="operator">)</span><span class="operator">;</span>
    Координаты <span class="operator">=</span> СредстваГеопозиционирования<span class="operator">.</span>ПолучитьПоследнееМестоположение<span class="operator">(</span>ИмяПровайдера<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЕсли</span><span class="operator">;</span></pre>

<p class="MsoListNumber">3.  При
необходимости, выполняется подписка на изменение координат. После того, как
потребность в подписке отпала – можно отключить оповещение об изменении
координат.</p>

<p class="MsoNormal">После
получения данных о местоположении, имеется возможность выполнить несколько
вспомогательных операций, связанных с полученным местоположением:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Получить адрес по координатам. Для этого предназначен метод <span class="Term">ПолучитьАдресПоМестоположению()</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Получить координаты места по адресу. Для этого
предназначен метод <span class="Term">ПолучитьМестоположениеПоАдресу()</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Показать карту, на которой отображены координаты
одной (или нескольких) точки. Для этого предназначен метод <span class="Term">ПоказатьНаКарте()</span>. При этом на iOS всегда
будет использовать приложение <span class="Interface">Карты</span> фирмы
Apple, а на ОС Android – приложение <span class="Interface">Карты</span> фирмы
Google.</p>

<p class="NoteCxSpFirst"><span class="Note">Примечание 1.</span> Для работы методов преобразования
координат в адрес и обратно, на мобильном устройстве должен быть доступ в
Интернет.</p>

<p class="NoteCxSpLast"><span class="Note">Примечание 2.</span> Не поддерживается работа механизма
геопозиционирования в фоновом режиме на устройствах под управлением ОС iOS.</p>

<a name="_ref355102699"></a><a name="_ref423706663"></a><a name="_ref425504898"></a><a id="TI000001703" class="bookmark" name="issogl3_25.4.3.2_получение_ключа_для_работы_с_google_maps"><h4>25.4.3.2. Получение ключа для работы с Google Maps</h4></a>

<p class="Note"><span class="Note">Внимание!</span> Описание консоли
разработчика приводится по состоянию на момент написания документации.</p>

<p class="MsoNormal">Для того чтобы мобильное приложение могло
работать с геопозиционированием под управлением ОС Android, необходимо получить
специальный ключ для работы с Google Maps. Для этого необходимо
выполнить следующие действия:</p>

<p class="MsoListNumberCxSpFirst">1. 
Необходимо войти в консоль разработчика (Google Developers Console, <a href="https://console.developers.google.com/project" target="_blank">https://console.developers.google.com/project</a>).</p>

<p class="MsoListNumberCxSpMiddle">2.  Необходимо
создать проект (кнопка <span class="Interface">Create Project</span>).</p>

<p class="MsoListNumberCxSpMiddle">3.  После
окончания создания проекта перейдите в свойства проекта (<span class="Interface">Projects – &lt;Имя вашего проекта&gt; – Overview</span>).</p>

<p class="MsoListNumberCxSpMiddle">4.  Необходимо
включить возможность использования сервиса Google Maps. Для этого необходимо
выбрать пункт меню <span class="Interface">APIs &amp; auth – APIs</span> (в левой части окна
веб-браузера). Затем необходимо найти <span class="Interface">Google Maps Android API v2</span> в списке <span class="Interface">Browse APIs</span> и включить его (нажать кнопку <span class="Interface">Enable API</span>).</p>

<p class="MsoListNumberCxSpMiddle">5.  Необходимо
получить ключ программного интерфейса (<span class="Interface">API Key</span>). Для этого следует выбрать пункт меню <span class="Interface">APIs &amp; auth – Credentials</span> (в левой части окна
веб-браузера). В разделе <span class="Interface">Public </span><span class="Interface">API </span><span class="Interface">Access</span> следует нажать кнопку <span class="Interface">Create </span><span class="Interface">new </span><span class="Interface">Key</span>.
В открывшемся диалоге выбрать кнопку <span class="Interface">Android key</span>. Затем необходимо создать группу мобильного
приложения в сборщике мобильных приложений (предварительно выполнив настройку
сборщика мобильных приложений) и скопировать содержимое поля <span class="Interface">Параметр получения ключа для работы с картами Google</span>.
Скопированные данные необходимо ввести в форму на сайте Google, в поле ввода,
расположенное в нижней части формы. Затем следует нажать кнопку <span class="Interface">Create</span>.</p>

<p class="MsoListNumberCxSpLast">6.  После
окончания формирования ключа, он будет отображен в поле <span class="Interface">API KEY</span>. Получившееся значение необходимо указать в поле
<span class="Interface">Ключ для работы с
картами Google</span>, находящееся в форме группы мобильного приложения. Затем
необходимо сохранить группу мобильного приложения.</p>

<a name="_ref406415921"></a><a id="TI000000911" class="bookmark" name="issogl2_25.4.4_работа_с_мультимедиа"><h3>25.4.4. Работа с мультимедиа</h3></a>

<a id="TI000001861" class="bookmark" name="issogl3_25.4.4.1_запись"><h4>25.4.4.1. Запись</h4></a>

<p class="MsoNormalCxSpFirst">Мобильные
устройства обладают различными мультимедийными возможностями: сделать
фотоснимок, сделать аудио– или видеозапись. Для различных мобильных устройств
эти возможности могут быть доступны или нет. Для определения возможности
выполнения той или иной операции предоставляются специальные функции: <span class="Term">ПоддерживаетсяФотоснимок()</span>, <span class="Term">ПоддерживаетсяВидеозапись()</span>, <span class="Term">ПоддерживаетсяАудиозапись()</span>. В том случае,
если мобильное устройство поддерживает ту или иную возможность, можно
воспользоваться методом глобального контекста, который активирует необходимое
системное приложение для выполнения нужного действия: <span class="Term">СделатьФотоснимок()</span>, <span class="Term">СделатьВидеозапись()</span>, <span class="Term">СделатьАудиозапись()</span>.</p>

<p class="MsoNormalCxSpMiddle">Выполнение
программы на встроенном языке будет ожидать выполнения требуемого действия.</p>

<p class="MsoNormalCxSpLast">В
связи с тем, что мобильные устройства могут обладать двумя камерами (передней и
задней), платформа предоставляет мобильному приложению возможность работать с
камерами по выбору. Для этого следует использовать системное перечисление <span class="Term">ТипКамерыУстройства</span> при определении
возможностей мобильного устройства и при выполнении того или иного действия.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Передняя <span class="operator">=</span> СредстваМультимедиа<span class="operator">.</span>ПоддерживаетсяФотоснимок<span class="operator">(</span>ТипКамерыУстройства<span class="operator">.</span>Передняя<span class="operator">)</span><span class="operator">;</span>
Задняя <span class="operator">=</span> СредстваМультимедиа<span class="operator">.</span>ПоддерживаетсяФотоснимок<span class="operator">(</span>ТипКамерыУстройства<span class="operator">.</span>Задняя<span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">Вышеприведенный
программный код позволяет определить, какая из двух камер устройства
поддерживает фотосъемку. С помощью этих методов можно определять наличие той
или иной камеры на устройстве. При выполнении фото– или видеосъемки, также
имеется возможность указать используемую камеру. Если тип камеры указан как <span class="Term">ТипКамерыУстройства.Авто</span>, то на устройствах
это будет обрабатываться следующим образом:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
На устройстве имеется две камеры – будет
использована задняя камера;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
На устройстве имеется одна камера – будет
использована эта камера (в зависимости от наличия).</p>

<p class="MsoNormalCxSpFirst">Кроме
того, при попытке сделать фотоснимок или выполнить видеосъемку, имеется
возможность указать некоторые дополнительные параметры, влияющие на результат
действия.</p>

<p class="MsoNormalCxSpLast">При
попытке выполнить фотосъемку имеется возможность (кроме типа камеры)
дополнительно указать:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
С каким разрешением необходимо выполнить съемку.
Если указано разрешение, не поддерживаемое устройством, будет выбрано ближайшее
подходящее разрешение. Перечень поддерживаемых разрешений можно получить с
помощью метода <span class="Term">ПолучитьПоддерживаемыеРазрешенияКамеры()</span>
объекта <span class="Term">СредстваМультимедиа</span>.
Для устройств, работающих под управлением ОС iOS, данный параметр игнорируется.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
С каким качеством будет получен результирующий
снимок. Фактически определяет степень сжатия jpeg-файла. 100 – означает
максимальное качество.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Какой снимок должен быть получен в результате:
цветной или черно-белый. Для устройств, работающих под управлением ОС iOS,
указание на необходимость получить черно-белый снимок, не влияет на интерфейс
камеры (но сам снимок будет черно-белым).</p>

<p class="MsoNormal">При
попытке выполнить видеосъемку, кроме указания типа камеры, имеется возможность
указать качество получаемого ролика. Устройства, работающие под управлением ОС
iOS, игнорируют этот параметр.</p>

<a name="_ref451862261"></a><a id="TI000001862" class="bookmark" name="issogl3_25.4.4.2_воспроизведение"><h4>25.4.4.2. Воспроизведение</h4></a>

<p class="MsoNormalCxSpFirst">Мобильная платформа предоставляет
возможность воспроизводить звуковые оповещения, воспроизводить аудиофайлы и выполнять
синтез речи. Возможность выполнения синтеза речи зависит от языка, на котором
предполагается выполнять синтез.</p>

<p class="MsoNormalCxSpLast">Для воспроизведения звукового оповещения (короткий
звуковой или вибро сигнал) предназначен метод <span class="Term">СредстваМультимедиа.ВоспроизвестиЗвуковоеОповещение()</span>.
Имеется возможность воспроизвести либо стандартный звук системы, либо звуковой
файл, имя которого передается в качестве параметра <span class="Term">Звук</span>
этого метода. Этот звуковой файл должен входить в состав мобильного приложения.
Однако на мобильной платформе разработчика отсутствует возможность подключать
ресурсы (к которым относятся воспроизводимые файлы). Для того чтобы указанный
файл был прикреплен к мобильному приложению, следует воспользоваться
возможностями сборщика мобильных приложений (см. <a href="#_ref375234120">здесь</a>). В силу этого, проверить использование звуковых
оповещений из файлов можно только на обычной мобильной платформе. Возможность
использования вибрации при воспроизведении звукового оповещения управляется
параметром <span class="Term">Вибрация</span>
метода <span class="Term">ВоспроизвестиЗвуковоеОповещение()</span>.
Если имя файла со звуковым оповещением указано без расширения, то используется
следующее расширение (в зависимости от ОС):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
ОС iOS – расширение <span class="Interface">.caf</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
ОС Android – расширение <span class="Interface">.mp3</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
ОС Windows – расширение <span class="Interface">.mp3</span>.</p>

<p class="MsoNormalCxSpFirst">Воспроизведение
оповещения нельзя приостановить или остановить. Оно всегда воспроизводится
целиком и полностью.</p>

<p class="MsoNormalCxSpMiddle">Вызов
метода глобального контекста <span class="Term">Сигнал()</span> эквивалентен вызову метода <span class="Term">СредстваМультимедиа.ВоспроизвестиЗвуковоеОповещение(ЗвуковоеОповещение.ПоУмолчанию)</span>.</p>

<p class="MsoNormalCxSpMiddle">Если
необходимо воспроизвести некоторый звуковой файл, то следует воспользоваться
методом <span class="Term">СредстваМультимедиа.ВоспроизвестиАудио()</span>.
В качестве источника воспроизведения могут выступать объект <span class="Term">ДанныеМультимедиа</span> (результат работы метода <span class="Term">СделатьАудиозапись()</span>), объект <span class="Term">ДвоичныеДанные</span> (который содержит
непосредственно аудиофайл требуемого формата) или имя файла (тип <span class="Term">Строка</span>). Воспроизведение аудиофайла, входящего
в состав мобильного приложения, не поддерживается. В том случае, если
прикладное решение должно обрабатывать состояние остановки воспроизведения –
надо указать обработчик оповещения (в параметре <span class="Term">ОбработчикОстановкиВоспроизведения</span>), который
будет вызываться в том случае, если вопросизведение остановлено или прервано.</p>

<p class="MsoNormalCxSpMiddle">Остановить
воспроизведение аудиофайла можно с помощью метода <span class="Term">СредстваМультимедиа.ОстановитьВоспроизведениеАудио()</span>.
Если аудиофайл в данный момент не воспроизводится – ничего не произойдет.</p>

<p class="MsoNormalCxSpLast">С
точки зрения возможности воспроизведения различных форматов аудиофалов,
рекомендуется опираться на MIME-тип файла. Аудиофайлы, которые записываются и
воспроизводятся с помощью инструментов мобильной платформы, имеют следующие MIME-типы (в зависимости от используемой мобильной ОС):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
ОС iOS – <span class="Term">audio/mp4</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
ОС Android – <span class="Term">audio/3gpp</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
ОС Windows – <span class="Term">audio/aac</span>.</p>

<p class="MsoNormal">Кроме
того, имеется возможность воспроизводить аудиофайлы со следующими MIME-типами:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
формат MP3 – <span class="Term">audio/mpeg</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
формат AAC – <span class="Term">audio/aac</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
формат WAVE – <span class="Term">audio/vnd.wave</span> (для ОС Android – начиная с версии 4.1 и выше).</p>

<p class="MsoNormalCxSpFirst">Воспроизведение
аудиофайлов, MIME-типы которых отличаются
от перечисленных выше, не поддерживается.</p>

<p class="MsoNormalCxSpLast">Ниже
приведен простой пример, в котором на форме находятся две кнопки, нажатие на
одну из которых (обработчик <span class="Term">ВоспроизвестиАудио()</span>) приводит к выбору
проигрываемого файла и запуск его воспроизведения, а при нажатии на вторую
кнопку (обработчик <span class="Term">Остановить()</span>) –
выполняется остановку воспроизведения.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ВоспроизвестиАудио<span class="operator">(</span>Команда<span class="operator">)</span>
    Диалог <span class="operator">=</span> <span class="keyword">Новый</span> ДиалогВыбораФайла<span class="operator">(</span>РежимДиалогаВыбораФайла<span class="operator">.</span>Открытие<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Если</span> Диалог<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
        Данные <span class="operator">=</span> Диалог<span class="operator">.</span>ПолноеИмяФайла<span class="operator">;</span>
        СредстваМультимедиа<span class="operator">.</span>ВоспроизвестиАудио<span class="operator">(</span>Данные<span class="operator">)</span><span class="operator">;</span>
        Файл <span class="operator">=</span> <span class="keyword">Новый</span> Файл<span class="operator">(</span>Диалог<span class="operator">.</span>ПолноеИмяФайла<span class="operator">)</span><span class="operator">;</span>
        Сообщить<span class="operator">(</span><span class="string">&quot;&quot;</span> <span class="operator">+</span> Файл<span class="operator">.</span>ПолучитьПредставлениеФайлаБиблиотекиМобильногоУстройства<span class="operator">(</span><span class="operator">)</span> <span class="operator">+</span> <span class="string">&quot; длительностью &quot;</span> <span class="operator">+</span> СредстваМультимедиа<span class="operator">.</span>ПолучитьПродолжительностьАудио<span class="operator">(</span>Данные<span class="operator">)</span> <span class="operator">+</span> <span class="string">&quot; секунд&quot;</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> Остановить<span class="operator">(</span>Команда<span class="operator">)</span>
    СредстваМультимедиа<span class="operator">.</span>ОстановитьВоспроизведениеАудио<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormal">На
мобильной платформе имеется возможность использовать синтезатор речи,
встроенный в операционную систему. Доступность синтехзатора для конкретного
языка следует проверять с помощью метода <span class="Term">СредстваМультимедиа.ПоддерживаетсяВоспроизведениеТекста()</span>.
Если синтезатор речи доступен – можно воспроизвести текст с помощью метода
<span class="Term">СредстваМультимедиа.ВоспроизвестиТекст()</span>.
При необходимости обрабатывать прерывание синтеза речи, имеется возможность
установить соответствующий обработчик с помощью параметра <span class="Term">ОбработчикОстановкиВоспроизведения</span>. Прервать
воспроизведение текста можно с помощью метода <span class="Term">СредстваМультимедиа.ОстановитьВоспроизведениеТекста()</span>.</p>

<a name="_ref381618656"></a><a id="TI000001452" class="bookmark" name="issogl2_25.4.5_сканирование_штрихкодов"><h3>25.4.5. Сканирование штрихкодов</h3></a>

<p class="MsoNormal">Мобильное
устройство, обладающее камерой, позволяет выполнять функции сканирования
штрихкодов. Для доступа к этой возможности платформа предоставляет специальный
интерфейс.</p>

<p class="Note"><span class="Note">Примечание.</span> Для эффективного сканирования штрихкодов
желательно, чтобы камера мобильного устройства обладала возможностью
автоматической наводки объектива камеры на резкость (автофокусом). В противном
случае сканирование штрихкодов будет затруднено.</p>

<p class="MsoNormal">Общая
схема работы со сканером штрикодов выглядит следующим образом:</p>

<p class="MsoListNumberCxSpFirst">1.  Определяется
возможность работы с механизмом сканирования. Для этого необходимо использовать
метод <span class="Term">ПоддерживаетсяСканированиеШтрихКодов()</span>
объекта глобального контекста <span class="Term">СредстваМультимедиа</span>.</p>

<p class="MsoListNumberCxSpMiddle">2.  В
том случае, если сканирование поддерживается, метод <span class="Term">ПоказатьСканированиеШтрихКодов()</span> объекта <span class="Term">СредстваМультимедиа</span> открывает специальный
интерфейс по сканированию штрихкодов. При выполнении операции сканирования
вызывается специальный обработчик, содержащий информацию о результате
сканирования.</p>

<p class="MsoListNumberCxSpLast">3.  Закрыть
интерфейс сканирования можно или вручную, с помощью стандартной кнопки перехода
к предыдущей форме интерфейса ОС Android или программно, с помощью метода <span class="Term">ЗакрытьСканированиеШтрихКодов()</span> объекта <span class="Term">СредстваМультимедиа</span>.</p>

<p class="MsoNormal">Рассмотрим
пример работы с данным механизмом. Для демонстрации будет использоваться
простая форма, на которой расположена кнопка открытия интерфейса сканирования и
признак закрытия этого интерфейса после однократного сканирования.
Сканированный штрихкод будет выводиться в виде сообщения.</p>

<p class="Note"><span class="Note">Примечание.</span> Данный пример не является законченным
инструментом. Он предназначены для демонстрации работы с механизмом
сканирования штрихкодов.</p>

<p class="MsoNormal">В
форме необходимо создать реквизит <span class="Term">ЗакрытьИнтерфейс</span> типа <span class="Term">Булево</span> и разместить его на форме. Также
следует создать команду формы ОткрытьИнтерфейсСканирования, которую также следует разместить на форме.
Модуль формы будет иметь следующий вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Обработчик команды формы ОткрытьИнтерфейсСканирования</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ОткрытьИнтерфейсСканирования<span class="operator">(</span>Команда<span class="operator">)</span>
    ОбработчикСканирования <span class="operator">=</span> <span class="keyword">Новый</span> ОписаниеОповещения<span class="operator">(</span><span class="string">&quot;ОбработкаСканирования&quot;</span><span class="operator">,</span> ЭтотОбъект<span class="operator">)</span><span class="operator">;</span>
    ОбработчикЗакрытия <span class="operator">=</span> <span class="keyword">Новый</span> ОписаниеОповещения<span class="operator">(</span><span class="string">&quot;ОбработкаЗакрытияИнтерфейса&quot;</span><span class="operator">,</span> ЭтотОбъект<span class="operator">)</span><span class="operator">;</span>
    СредстваМультимедиа<span class="operator">.</span>ПоказатьСканированиеШтрихКодов<span class="operator">(</span><span class="string">&quot;Наведите камеру на штрихкод&quot;</span><span class="operator">,</span> ОбработчикСканирования<span class="operator">,</span> ОбработчикЗакрытия<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ОбработкаСканирования<span class="operator">(</span>Штрихкод<span class="operator">,</span> Результат<span class="operator">,</span> Сообщение<span class="operator">,</span> ДополнительныеПараметры<span class="operator">)</span> <span class="keyword">Экспорт</span>
    <span class="keyword">Если</span> Результат <span class="keyword">Тогда</span>
        Текст <span class="operator">=</span> <span class="string">&quot;&quot;</span> <span class="operator">+</span> Штрихкод<span class="operator">;</span>
    <span class="keyword">Иначе</span>
        Текст <span class="operator">=</span> <span class="string">&quot;Ошибка: &quot;</span> <span class="operator">+</span> Сообщение<span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    <span class="keyword">Если</span> ЗакрытьИнтерфейс <span class="keyword">Тогда</span>
        СредстваМультимедиа<span class="operator">.</span>ЗакрытьСканированиеШтрихКодов<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    Сообщить<span class="operator">(</span>Текст<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ОбработкаЗакрытияИнтерфейса<span class="operator">(</span>ДополнительныеПараметры<span class="operator">)</span> <span class="keyword">Экспорт</span>
    Сообщить<span class="operator">(</span><span class="string">&quot;Закрывается интерфейс сканирования&quot;</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПриОткрытии<span class="operator">(</span>Отказ<span class="operator">)</span>
    <span class="keyword">Если</span> <span class="keyword">НЕ</span> СредстваМультимедиа<span class="operator">.</span>ПоддерживаетсяСканированиеШтрихКодов<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
        <span class="keyword">ВызватьИсключение</span> <span class="string">&quot;Сканирование штрихкодов не поддерживается&quot;</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    ЗакрытьИнтерфейс <span class="operator">=</span> <span class="keyword">Ложь</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormalCxSpFirst">При
открытии интерфейса сканирования в метод ПоказатьСканированиеШтрихКодов<span class="Term">()</span> передается два описания оповещения. Первое
оповещение срабатывает (параметр <span class="Term">&lt;ОбработчикСканирования&gt;</span>) в том случае,
когда система успешно распознала штрихкод, второе оповещение (параметр <span class="Term">&lt;ОбработчикЗакрытия&gt;</span>) срабатывает в том
случае, когда закрывается оконо, предназначенное для сканирования штрихкода.
Закрытие может быть как программное, так и интерактивное. Пример программного
закрытия приведен в обработчике оповещения <span class="Term">ОбработкаСканирования()</span>, а интерактивное
закрытие можно выполнить, нажав кнопку <span class="Interface">Назад</span> в
интерфейсе сканирования.</p>

<p class="MsoNormalCxSpMiddle">При
открытии формы сканирования можно определить, на какие штрихкоды будет
«реагировать» система: на линейные (например, EAN), на двухмерные (например,
QR-код) или на все. Задается это с помощью параметра <span class="Term">&lt;ТипШтрихКода&gt;</span> метода <span class="Term">ПоказатьСканированиеШтрихКодов()</span>. При этом
надо помнить, что указание на необходимость распознавать все типы штрихкодов
снижает «производительность» сканирования, т. к. система будет
тратить больше времени на поиск в изображении различных штрихкодов.</p>

<p class="MsoNormalCxSpLast">При
сканировании штрихкодов с использованием камеры мобильного устройства, будут
распознаваться следующие штрихкоды:</p>

<p class="MsoListBullet">&#9679; 
Устройство работает под управлением ОС Android:</p>

<p class="MsoListBullet2">&#9679; 
Линейные штрихкоды:</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
UPC-A;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
UPC-E;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
EAN-8;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
EAN-13;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code39;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code93;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code128;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
RSS-14;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
RSS Expanded;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
ITF;</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
Codabar.</p>

<p class="MsoListBullet2">&#9679; 
Двумерные
штрихкоды:</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
QR
Code;</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
Data
Matrix.</p>

<p class="MsoListBullet">&#9679; 
Устройство работает под управлением ОС iOS:</p>

<p class="MsoListBullet2">&#9679; 
Линейные
штрихкоды:</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
UPC-A;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
UPC-E;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
EAN-8;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
EAN-13;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code39;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code93;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code128;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
RSS-14;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
RSS Expanded;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
ITF;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Codabar;</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
PDF417.</p>

<p class="MsoListBullet2">&#9679; 
Двумерные
штрихкоды:</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
QR
Code;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
DataMatrix;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Aztec
Code;</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
MaxiCode.</p>

<p class="MsoListBullet">&#9679; 
Устройство работает под управлением ОС Windows:</p>

<p class="MsoListBullet2">&#9679; 
Линейные штрихкоды:</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
UPC-A;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
UPC-E;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
EAN-8;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
EAN-13;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code39;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code93;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Code128;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
ITF;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Codabar;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
RSS-14;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
RSS Expanded;</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
PDF417.</p>

<p class="MsoListBullet2">&#9679; 
Двумерные штрихкоды:</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
QR Code;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
DataMatrix;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
Aztec Code;</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
MaxiCode.</p>

<a name="_ref381885831"></a><a id="TI000001453" class="bookmark" name="issogl2_25.4.6_работа_с_электронной_почтой"><h3>25.4.6. Работа с электронной почтой</h3></a>

<p class="MsoNormalCxSpFirst">Мобильная
платформа предоставляет прикладному разработчику несколько способов работы с
электронной почтой. Один способ позволяет реализовать полноценный почтовый
клиент на платформе «1С:Предприятие» (объект <span class="Term">ИнтернетПочта</span> и связанные объекты), а другой
способ позволяет реализовать только отправку почтовых сообщений с помощью
приложения по работе с электронной почтой, установленное в системе по умолчанию
(объект <span class="Term">СредстваПочты</span>).</p>

<p class="MsoNormalCxSpMiddle">При
отправке почтовых сообщений типа <span class="Term">ТипТекстаПочтовогоСообщения.HTML</span> с помощью
объекта <span class="Term">СредстваПочты</span>
(под управлением ОС Android)
выполняется конвертация текста сообщения в формат Spannable. Отправляемое
письмо отображается большинством почтовым клиентов.</p>

<p class="MsoNormalCxSpLast">При
использовании текстов почтовых сообщений с типом <span class="Term">ТипТекстаПочтовогоСообщения.HTML</span> (под
управлением ОС Android)
не рекомендуется использовать следующие возможности:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
каскадные таблицы стилей;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
встроенные таблицы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
встроенные изображения;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
шрифты разных размеров.</p>

<p class="MsoNormalCxSpFirst">Рекомендуется
проверять отображение электронных писем на максимальном количестве устройств,
чтобы минимизировать зависимость от различий реализации на разных ОС и в разных
версиях почтовых программ.</p>

<p class="MsoNormalCxSpLast">Также
следует помнить, что тип текстов почтовых сообщений <span class="Term">ТипТекстаПочтовогоСообщения.РазмеченныйТекст</span>
не поддерживается объектом <span class="Term">СредстваПочты</span>.</p>

<a name="_ref382321154"></a><a id="TI000001454" class="bookmark" name="issogl2_25.4.7_работа_с_контактами"><h3>25.4.7. Работа с контактами</h3></a>

<p class="MsoNormalCxSpFirst">Список
контактов – это база данных, которая хранит информацию о субъектах, с
которыми общается владелец мобильного устройства. Описание контакта содержит
идентификационные данные контакта, адреса, телефоны и другую информацию, необходимую
для связи с субъектом. Также, на мобильном устройстве могут быть
зарегистрированы учетные записи различных сервисов. Под учетной записью
понимается набор информации, которые пользователь использует для идентификации
себя в каком-либо сервисе. Например, это имя пользователя и пароль. На
мобильном устройстве всегда существует учетная запись, описывающая само
устройство (локальная учетная запись).</p>

<p class="MsoNormalCxSpMiddle">Каждая
запись в списке контактов связана с какой-либо одной учетной записью. Мобильная
ОС может выполнять синхронизацию списка контактов с данными учетной записи
(зависит от настроек ОС). Если контакт связан с локальной учетной записью, то
синхронизация информации не выполняется и все данные расположены только на
мобильном устройстве.</p>

<p class="MsoNormalCxSpMiddle">Основная
информация о контакте хранится в объектах типа <span class="Term">ДанныеКонтакта</span>. Объекты данного типа содержат
всю информацию о контакте, но не содержат связь контакта с учетной записью. В
описании контакта есть несколько типов данных, которые могут содержать более
одного значения. Такими данными являются номера телефонов, адреса, адреса
электронной почты и другие. Для хранения таких данных предназначены массивы
объектов типа <span class="Term">ЭлементДанныхКонтакта</span>.
Для хранения списка идентификаторов в программах мгновенных сообщений
предназначен массив объектов <span class="Term">ЭлементДанныхКонтактаМгновенныеСообщения</span>.</p>

<p class="MsoNormalCxSpMiddle">Учетные записи, зарегистрированные на данном мобильном
устройстве для синхронизации контактов, описываются с помощью объекта <span class="Term">УчетнаяЗаписьКонтактов</span>.</p>

<p class="MsoNormalCxSpMiddle">Связь
между учетной записью контактов и собственно элементов списка контактов
образует объект <span class="Term">ДанныеКонтактаУчетнойЗаписи</span>.
Кроме информации о контакте и учетной записи, данный объект содержит также
идентификатор, по которому выполняется синхронизация между списком контактов на
мобильном устройстве и учетной записью. Можно сказать, что свойство <span class="Term">ГлобальныйКлючКонтакта</span> объекта <span class="Term">ДанныеКонтактаУчетнойЗаписи</span> является аналогом
свойства <span class="Term">Ссылка</span>
для прикладных объектов «1С:Предприятие».</p>

<p class="MsoNormalCxSpMiddle">Для идентификации контакта на мобильном устройстве
существует объект <span class="Term">ЛокальныйКлючКонтакта</span>.
Все операции с контактами (создание, изменение, удаление, поиск) выполняются с
использованием данного объекта. Для выполнения операций с контактами следует
использовать менеджер контактов (одноименный объект).</p>

<p class="MsoNormalCxSpLast">Следующий пример демонстрирует создание
элемента списка контактов в локальной учетной записи:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> СоздатьЭлементКонтакта<span class="operator">(</span>Имя<span class="operator">,</span> Отчество<span class="operator">,</span> Фамилия<span class="operator">,</span> ЭлектроннаяПочта<span class="operator">,</span> Телефон<span class="operator">)</span>
    ДанныеКонтакта <span class="operator">=</span> <span class="keyword">Новый</span> ДанныеКонтакта<span class="operator">;</span>
    ДанныеКонтакта<span class="operator">.</span>Имя <span class="operator">=</span> Имя<span class="operator">;</span>
    ДанныеКонтакта<span class="operator">.</span>Отчество <span class="operator">=</span> Отчество<span class="operator">;</span>
    ДанныеКонтакта<span class="operator">.</span>Фамилия <span class="operator">=</span> Фамилия<span class="operator">;</span>
    ЭлементПочта <span class="operator">=</span> <span class="keyword">Новый</span> ЭлементДанныхКонтакта<span class="operator">(</span>ТипАдресаЭлектроннойПочтыДанныхКонтакта<span class="operator">.</span>Рабочий<span class="operator">,</span> ЭлектроннаяПочта<span class="operator">)</span><span class="operator">;</span>
    ДанныеКонтакта<span class="operator">.</span>АдресаЭлектроннойПочты<span class="operator">.</span>Добавить<span class="operator">(</span>ЭлементПочта<span class="operator">)</span><span class="operator">;</span>
    ЭлементТелефон <span class="operator">=</span> <span class="keyword">Новый</span> ЭлементДанныхКонтакта<span class="operator">(</span>ТипНомераТелефонаДанныхКонтакта<span class="operator">.</span>Рабочий<span class="operator">,</span> Телефон<span class="operator">)</span><span class="operator">;</span>
    ДанныеКонтакта<span class="operator">.</span>НомераТелефонов<span class="operator">.</span>Добавить<span class="operator">(</span>ЭлементТелефон<span class="operator">)</span><span class="operator">;</span>
    МК <span class="operator">=</span> <span class="keyword">Новый</span> МенеджерКонтактов<span class="operator">;</span>
    ЛокальныеКонтакты <span class="operator">=</span> МК<span class="operator">.</span>ПолучитьЛокальнуюУчетнуюЗаписьКонтактов<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    Контакт <span class="operator">=</span> <span class="keyword">Новый</span> ДанныеКонтактаУчетнойЗаписи<span class="operator">(</span>ДанныеКонтакта<span class="operator">,</span> ЛокальныеКонтакты<span class="operator">)</span><span class="operator">;</span>
    МК<span class="operator">.</span>ДобавитьКонтакт<span class="operator">(</span>Контакт<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<a name="_ref382405225"></a><a id="TI000001455" class="bookmark" name="issogl2_25.4.8_работа_с_календарем"><h3>25.4.8. Работа с календарем</h3></a>

<p class="MsoNormalCxSpFirst">На
мобильных устройствах имеется возможность просмотра календаря и заведения в нем
различных событий. События характеризуются некоторым набором характеристик,
таких как дата и время начала и завершения, описание, занятые лица и т. д.
Также, на мобильном устройстве могут быть зарегистрированы учетные записи
различных сервисов. Под учетной записью понимается набор информации, которые
пользователь использует для идентификации себя в каком-либо сервисе. Например,
это имя пользователя и пароль. На мобильном устройстве всегда существует
учетная запись, описывающая само устройство (локальная учетная запись).</p>

<p class="MsoNormalCxSpMiddle">На
мобильном устройстве может быть несколько календарей (с разными именами).
Каждый календарь связан с какой-либо одной учетной записью. Мобильная ОС может
выполнять синхронизацию событий календарей с данными учетной записи (зависит от
настроек ОС). Если события календаря связаны с локальной учетной записью, то
синхронизация информации не выполняется и все данные расположены только на
мобильном устройстве.</p>

<p class="MsoNormalCxSpMiddle">Основная
информация о календаре хранится в объекте <span class="Term">ДанныеКалендаря</span>. События календаря описываются
объектом <span class="Term">ДанныеСобытияКалендаря</span>.
Данные объекты описывают характеристики календаря или события календаря, но не
описывают, с какой учетной записью связан объект.</p>

<p class="MsoNormalCxSpMiddle">Учетные
записи, зарегистрированные на данном мобильном устройстве для синхронизации
контактов, описываются с помощью объекта <span class="Term">УчетнаяЗаписьКалендарей</span>.</p>

<p class="MsoNormalCxSpMiddle">Связь
между данными календарей и событий и учетными записями образуется объектами <span class="Term">ДанныеКалендаряУчетнойЗаписи</span> и <span class="Term">ДанныеСобытияКалендаряУчетнойЗаписи</span>. Эти
объекты, кроме информации о собственно данных и информации об учетной записи,
хранят информацию значения ключей, по которым выполняется синхронизация между
мобильным устройство и сервисом, с которым выполняется синхронизация. Для
синхронизации данных о календарях используется <span class="Term">ГлобальныйКлючКалендаря</span>, для синхронизации
данных о событиях календарей используется <span class="Term">ГлобальныйКлючСобытияКалендаря</span>.</p>

<p class="MsoNormalCxSpLast">Для
идентификации данных календарей и событий на мобильном устройстве существует объекты
<span class="Term">ЛокальныйКлючКалендаря</span>
и <span class="Term">ЛокальныйКлючСобытияКалендаря</span>.
Все операции с календарями и событиями (создание, изменение, удаление, поиск) выполняются
с использованием данного объекта. Для выполнения операций с календарями и
событиями следует использовать менеджер календарей (одноименный объект).</p>

<a name="_ref405981345"></a><a id="TI000001539" class="bookmark" name="issogl2_25.4.9_ориентация_экрана"><h3>25.4.9. Ориентация экрана</h3></a>

<p class="MsoNormalCxSpFirst">Платформа
предоставляет информацию о некоторых характеристиках экрана устройства, на
котором выполняется клиентское приложение (персональный компьютер или мобильное
устройство). Для этого служит метод <span class="Term">ПолучитьИнформациюЭкрановКлиента()</span>. В
результате возвращается массив структур, описывающих экраны, подключенные к
устройству.</p>

<p class="MsoNormalCxSpMiddle">Каждый
элемент массива описывает один экран, подключенный к устройству. Параметры <span class="Term">Высота</span> и <span class="Term">Ширина</span> описывают, соответственно, высоту и
ширину экрана в точках. При этом для мобильного устройства эти параметры
зависят от ориентации устройства (если это разрешено в настройках), а платформы
для персонального компьютера всегда возвращает канонические параметры
подключенных экранов. Таким образом, на мобильном устройстве можно
анализировать, в каком положении находится устройство и на основании этого
принимать решения о трансформации интерфейса приложения. Для облегчения работы
с ориентацией существует событие <span class="Term">ПриИзмененииПараметровЭкрана</span>, которое можно
обработать в модуле управляемого приложения и в модуле управляемой формы.</p>

<p class="MsoNormalCxSpLast">В
качестве примера рассмотрим изменение отображения формы, отображаемой на
рабочем столе. В указанной форме есть два списка, которые отображают некоторую
информацию. При портретной ориентации экрана (узкая сторона устройства –
нижняя) списки будут отображаться друг под другом, а при ландшафтной (широкая
сторона устройства – нижняя) ориентации – списки расположены рядом. Для
реализации такого поведения в модуле формы, расположенной на рабочем столе,
следует разместить обработчик события <span class="Term">ПриИзмененииПараметровЭкрана</span> следующего вида:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПриИзмененииПараметровЭкрана<span class="operator">(</span><span class="operator">)</span>
    МассивИнформаций <span class="operator">=</span> ПолучитьИнформациюЭкрановКлиента<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Если</span> МассивИнформаций<span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">.</span>Ширина <span class="operator">&gt;</span> МассивИнформаций<span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">.</span>Высота <span class="keyword">Тогда</span>
        ЭтаФорма<span class="operator">.</span>Группировка <span class="operator">=</span> ГруппировкаПодчиненныхЭлементовФормы<span class="operator">.</span>Горизонтальная<span class="operator">;</span>
    <span class="keyword">Иначе</span>
        ЭтаФорма<span class="operator">.</span>Группировка <span class="operator">=</span> ГруппировкаПодчиненныхЭлементовФормы<span class="operator">.</span>Вертикальная<span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<a name="_ref410724117"></a><a id="TI000001540" class="bookmark" name="issogl2_25.4.10_работа_с_уведомлениями"><h3>25.4.10. Работа с уведомлениями</h3></a>

<a id="TI000001541" class="bookmark" name="issogl3_25.4.10.1_общая_информация"><h4>25.4.10.1. Общая информация</h4></a>

<p class="MsoNormalCxSpFirst">При
работе информационной системы регулярно возникает необходимость оповестить
пользователя о каком-либо событии. Событие может возникать как по расписанию,
так и в случае возникновения другого события. Само событие может наступить как
на мобильном устройстве, которым владеет пользователь, так и в каком-то другом
месте информационной системы.</p>

<p class="MsoNormalCxSpLast">Для
извещения пользователя о наступлении событий служат уведомления. Они могут
создаваться локально или рассылаться с помощью push-сервисов. Локальные
уведомления служат для информирования о событиях, которые происходят на
устройстве пользователя. Обычно источником push-уведомлений выступает
центральный узел информационной системы. С помощью push-уведомлений он
информирует удаленных пользователей о том, что изменились данные, важные для
пользователей. Однако это не единственный сценарий использования
push-уведомлений. Push-уведомления могут рассылать специализированные сервисы,
информирующие о курсах валюты, результатах спортивных состязаний, прогнозах
погоды и т. д.</p>

<a name="_ref409781610"></a><a id="TI000001542" class="bookmark" name="issogl3_25.4.10.2_локальные_уведомления"><h4>25.4.10.2. Локальные уведомления</h4></a>

<p class="MsoNormalCxSpFirst">Локальные
уведомления служат для извещения о событиях, которые происходят непосредственно
на мобильном устройстве. Локальные уведомления бывают моментальными и
запланированными. Они используются для информирования о разных событиях и,
кроме того, их отличает поведение на мобильном устройстве. Моментальные
уведомления используются в том случае, когда необходимо «здесь и сейчас»
оповестить пользователя о наступлении события, например завершении какого-либо
процесса. Таким процессом может быть операция синхронизации с внешней системой.
Запланированные уведомления позволяют в назначенное время напомнить
пользователю о необходимости выполнить какую-либо операцию. Запланированное
уведомление может быть однократным или периодическим. Однократное
запланированное уведомление можно использовать, например, если в системе
помечено, что какому-то контрагенту необходимо перезвонить в определенное
время. Повторяемое запланированное уведомление можно использовать, например, в
том случае, когда какая-то операция повторяется каждый день, вне зависимости от
внешних событий.</p>

<p class="MsoNormalCxSpMiddle">Чтобы
использовать локальные уведомления, следует установить разрешение <span class="Interface">Локальные уведомления</span>
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref370811599">здесь</a></span></span></span></span></span>). Сборщик мобильных приложений добавляет соответствующее
разрешение для собираемого мобильного приложения. Следует учитывать, что
мобильная платформа разработчика обладает всеми разрешениями для работы с локальными
уведомлениями. Поэтому рекомендуется после окончания разработки механизма
проверить его функционирование на обычной мобильной платформе. Для этого
следует воспользоваться сборщиком мобильных приложений и проверить
работоспособность получившегося мобильного приложения на мобильном устройстве.</p>

<p class="MsoNormalCxSpMiddle">Для
работы с локальными уведомлениями используется менеджер доставляемых
уведомлений (свойство глобального контекста <span class="Term">ДоставляемыеУведомления</span>) и объект <span class="Term">ДоставляемоеУведомление</span>. Объект описывает
собственно уведомление (включая параметры его отображения), а с помощью
менеджера выполняется управление механизмом уведомлений.</p>

<p class="MsoNormalCxSpLast">Рассмотрим
создание локальных уведомлений более подробно.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Функция</span> СоздатьУведомление<span class="operator">(</span>Заголовок<span class="operator">,</span> Текст<span class="operator">,</span> Данные <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> ДатаСрабатывания<span class="operator">,</span> ИнтервалПовторения <span class="operator">=</span> <span class="number">0</span><span class="operator">)</span>
    Уведомление <span class="operator">=</span> <span class="keyword">Новый</span> ДоставляемоеУведомление<span class="operator">;</span>
    Уведомление<span class="operator">.</span>Заголовок <span class="operator">=</span> Заголовок<span class="operator">;</span>
    Уведомление<span class="operator">.</span>Текст <span class="operator">=</span> Текст<span class="operator">;</span>
    Уведомление<span class="operator">.</span>Данные <span class="operator">=</span> Данные<span class="operator">;</span>
    Уведомление<span class="operator">.</span>ДатаПоявленияУниверсальноеВремя <span class="operator">=</span> ДатаСрабатывания<span class="operator">;</span>
    Уведомление<span class="operator">.</span>ИнтервалПовтора <span class="operator">=</span> ИнтервалПовторения<span class="operator">;</span>
    Уведомление<span class="operator">.</span>ЗвуковоеОповещение <span class="operator">=</span> ЗвуковоеОповещение<span class="operator">.</span>ПоУмолчанию<span class="operator">;</span>
    <span class="keyword">Возврат</span> Уведомление<span class="operator">;</span>
<span class="keyword">КонецФункции</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ЗадатьУведомление<span class="operator">(</span>Команда<span class="operator">)</span>
    Уведомление <span class="operator">=</span> СоздатьУведомление<span class="operator">(</span><span class="string">&quot;Заголовок&quot;</span><span class="operator">,</span> <span class="string">&quot;Текст&quot;</span><span class="operator">,</span> <span class="number">2014</span><span class="operator">,</span> <span class="date">'00010101'</span><span class="operator">)</span><span class="operator">;</span>
    ДоставляемыеУведомления<span class="operator">.</span>ДобавитьЛокальноеУведомление<span class="operator">(</span>Уведомление<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormal">При
создании уведомления следует помнить о следующих особенностях:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Дата и время первого отображения уведомления
задается в формате универсального времени (UTC). Для перевода из локального
времени можно использовать функцию глобального контекста <span class="Term">УниверсальноеВремя()</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если свойство <span class="Term">ДатаПоявленияУниверсальноеВремя</span> задано пустым
значением (или не задано вовсе), то уведомление будет отображено сразу. Таким
уведомлением можно извещать пользователя о том, что мобильное приложение
завершило какую-то длительную операцию, например, завершило операцию
синхронизации данных.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если необходимо, чтобы уведомление появлялось
регулярно, следует использовать свойство <span class="Term">ИнтервалПовтора</span> объекта <span class="Term">ДоставляемоеУведомление</span>. В результате можно
реализовать простой вариант безусловного таймера, который по истечении
заданного интервала времени будет формировать уведомление. Значение,
описывающее интервал повторения уведомления, зависит от используемой мобильной
операционной системы. Особенности указания интервала описаны в синтакс-помощнике.
Система не предоставляет возможности указать дату и время окончания
срабатывания уведомления.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При необходимости, имеется возможность
установить наклейку – число, отображаемое в шторке уведомлений (ОС
Android) или поверх иконки приложения (ОС iOS). Для этого служит свойство <span class="Term">Наклейка</span>. При работе под управлением ОС iOS
имеется возможность устанавливать и получать значение наклейки с помощью
методов <span class="Term">УстановитьНаклейку()</span>
и <span class="Term">ПолучитьНаклейку()</span>
менеджера доставляемых уведомлений.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
При отображении уведомления имеется возможность
воспроизвести некоторую мелодию. Для указания воспроизводимой мелодии служит
свойство <span class="Term">ЗвуковоеОповещение</span>
объекта <span class="Term">ДоставляемоеУведомление</span>.
Если в качестве значения этого свойства установлено значение системного
перечисления <span class="Term">ЗвуковоеОповещение.ПоУмолчанию</span>,
то будет воспроизводиться мелодия, установленная для уведомлений в используемой
операционной системе. Если в качестве значения свойства <span class="Term">ЗвуковоеОповещение</span> указано имя файла, то будет
воспроизведен именно этот файл. Однако на мобильной платформе разработчика
отсутствует возможность подключать ресурсы (к которым относятся воспроизводимые
файлы). Для того чтобы указанный файл был прикреплен к мобильному приложению, следует
воспользоваться возможностями сборщика мобильных приложений
(см. <a href="#_ref375234120">здесь</a></span></span></span></span></span>). В силу этого, проверить использование звуковых оповещений из
файлов можно только на обычной мобильной платформе.</p>

<p class="MsoNormalCxSpFirst">В
ряде случаев может возникать необходимость удалять установленные (но еще не
наступившие) уведомления. Такое может потребоваться в тех случаях, когда
действие, для напоминания о котором установлено уведомление, уже выполнено. Для
удаления уведомления можно использовать метод <span class="Term">ОтменитьЛокальныеУведомления()</span> менеджера
доставляемых уведомлений. При этом следует помнить, что отменяются сразу все
локальные уведомления, которые были установлены данным мобильным приложением, и
время срабатывания которых еще не наступило.</p>

<p class="MsoNormalCxSpLast">После
появления уведомления, нажатие на него приведет к запуску (или активизации)
приложения. Однако этого может оказать недостаточно для полноценной обработки
уведомления. В этом случае можно воспользоваться обработчиком уведомлений.
Подключается этот обработчик с помощью метода <span class="Term">ПодключитьОбработчикУведомлений()</span> менеджера
доставляемых уведомлений.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ПриОткрытии<span class="operator">(</span>Отказ<span class="operator">)</span>
    Обработчик <span class="operator">=</span> <span class="keyword">Новый</span> ОписаниеОповещения<span class="operator">(</span><span class="string">&quot;ОбработчикУведомлений&quot;</span><span class="operator">,</span> ЭтотОбъект<span class="operator">)</span><span class="operator">;</span>
    ДоставляемыеУведомления<span class="operator">.</span>ПодключитьОбработчикУведомлений<span class="operator">(</span>Обработчик<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="preprocessor">&amp;НаКлиенте</span>
<span class="keyword">Процедура</span> ОбработчикУведомлений<span class="operator">(</span>Уведомление<span class="operator">,</span> Локальное<span class="operator">,</span> Показано<span class="operator">,</span> ДополнительныеПараметры<span class="operator">)</span> <span class="keyword">Экспорт</span>
    <span class="comment">// Важные и нужные действия</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormalCxSpFirst">В
результате, после того, как пользователь мобильного приложения нажмет на уведомление,
будет активизировано мобильное приложение, создавшее уведомление, и в этом
приложении будет вызван обработчик уведомления. В рамках этого обработчика
можно реализовать необходимую обработку уведомления. Следует помнить, что
объект, который передается в параметре <span class="Term">Уведомление</span>, содержит реальные данные только в
свойствах <span class="Term">Текст</span>
и <span class="Term">Данные</span>.
Остальные свойства заполнены значениями по умолчанию.</p>

<p class="MsoNormalCxSpLast">Также
следует отметить, что уведомление может отображаться в шторке уведомлений, а
может не отображаться. Для оповещения мобильного приложения об этом, в
обработчик уведомлений передается параметр <span class="Term">Показано</span>. Так, если мобильное приложение
запущено и активно, то локальное уведомление не будет отображено на экране, но
обработчик уведомлений будет вызван, а параметр <span class="Term">Показано</span> будет установлен в значение <span class="Term">Ложь</span>. В этом случае задача привлечения
внимания пользователя лежит на прикладном разработчике.</p>

<a id="TI000001543" class="bookmark" name="issogl3_25.4.10.3_push-уведомления"><h4>25.4.10.3. PUSH-уведомления</h4></a>

<a id="TI000001544" class="bookmark" name="issogl4_25.4.10.3.1_общая_информация"><h5>25.4.10.3.1. Общая информация</h5></a>

<p class="MsoNormalCxSpFirst">Push-уведомления
(далее в этом разделе термины «уведомление» и «push-уведомление» используются
равнозначно) предназначены для оповещения о событиях, которые произошли где-то
в другом месте. Например, в корпоративной информационной системе изменились
какие-то данные, важные для мобильных пользователей системы.</p>

<p class="MsoNormalCxSpLast">При
работе с push-уведомлениями используются несколько различных систем:</p>

<p class="MsoListNumberCxSpFirst">1.  Собственно
мобильное приложение. Получает уведомления и реализует реакцию на них со
стороны мобильного устройства.</p>

<p class="MsoListNumberCxSpMiddle">2. 
Прикладное решение, которое занимается рассылкой
уведомлений (отправитель). В роли отправителя выступает прикладное решение,
созданное на платформе «1С:Предприятие».</p>

<p class="MsoListNumberCxSpMiddle">3. 
Сервис доставки уведомлений. Этот сервис
обеспечивает передачу уведомление от отправителя получателю (мобильному
приложению). В качестве такого сервиса выступает Apple Push Notification Service
(APNs, <a href="https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/ApplePushService.html" target="_blank">https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/ApplePushService.html</a>, на английском языке) и Google Cloud Messaging
(GCM, <a href="http://developer.android.com/intl/ru/google/gcm/index.html" target="_blank">http://developer.android.com/intl/ru/google/gcm/index.html</a>, на английском языке).</p>

<p class="MsoListNumberCxSpLast">4. 
Фирмой «1С» разработан специальный вспомогательный
сервис для отправки уведомлений. Этот сервис предназначен для облегчения
реализации отправки уведомлений из тиражных прикладных решений. При работе под
управлением iOS сервис позволяет изолировать получателей уведомлений одного
отправителя, от других отправителей, которые работают с тем же мобильным
приложением. Кроме того, сервис позволяет избежать публикации сертификата
мобильного приложения (что необходимо при непосредственной работе с сервисом
APNs). Особенности работы с этим сервисом будут описаны далее, в
соответствующих разделах. Следует понимать, что сервис фирмы «1С» не может
работать без использования APNs и GCM. Сервис расположен по адресу <a href="https://pushnotifications.1c.com" target="_blank">https://pushnotifications.1c.com</a>.</p>

<p class="MsoNormal">В
общем случае отправка уведомления выглядит следующим образом:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Отправитель формирует уведомление;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Отправитель определяет список получателей
уведомления;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Отправитель подключается к сервису уведомлений;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Отправитель передает сервису уведомление и
список получателей;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Сервис обеспечивает доставку уведомлений на
мобильные устройства;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Мобильное приложение на устройстве обеспечивает
обработку уведомлений.</p>

<p class="MsoNormalCxSpFirst">Сервис
доставки push-уведомлений не гарантирует доставки уведомления до мобильного
устройства.</p>

<p class="MsoNormalCxSpMiddle">Чтобы
использовать уведомления, следует установить разрешение <span class="Interface">Push-уведомления</span>
(см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref370811599">здесь</a></span></span></span></span></span>). Сборщик мобильных приложений добавляет соответствующее
разрешение для собираемого мобильного приложения. Работа с мобильной платформой
разработчика имеет некоторые особенности, которые будут рассмотрены ниже. В
любом случае, рекомендуется после окончания разработки механизма проверить его
функционирование на обычной мобильной платформе. Для этого следует
воспользоваться сборщиком мобильных приложений и проверить работоспособность
получившегося мобильного приложения с использованием всех сервисов доставки
уведомлений.</p>

<p class="MsoNormalCxSpLast">Обработка
push-уведомления мало отличается от обработки локального уведомления
(см. <a href="#_ref409781610">здесь</a>). Очевидно, что параметр <span class="Term">Локальное</span> будет иметь значение <span class="Term">Ложь</span>, если обработчик будет вызван для
обработки push-уведомления.</p>

<a id="TI000001545" class="bookmark" name="issogl4_25.4.10.3.2_схема_работы_с_сервисами_рассылки_уведомлений"><h5>25.4.10.3.2. Схема работы с сервисами рассылки уведомлений</h5></a>

<p class="MsoNormal">Для
понимания работы с push-уведомлениями, следует учитывать, что в процессе
разработки и внедрения системы участвуют несколько различных ролей. В ряде
случаев исполнители ролей могут объединяться, но само количество ролей остается
неизменным:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Bold">Разработчик мобильного приложения</span> –
занимается разработкой мобильного приложения (получателя уведомлений). Реализует
всю необходимую функциональность приложения для получения уведомлений.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Bold">Разработчик отправителя
уведомлений</span> – занимается разработкой информационной системы,
которая занимается рассылкой уведомлений и механизма получения и хранения
идентификаторов получателей уведомлений.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Bold">Пользователь мобильного
приложения</span> – использует мобильное приложение. Настройка мобильного
приложения также выполняется этим пользователем, поэтому настройки мобильного
приложения должны быть максимально просты и понятны даже неподготовленному
пользователю.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Bold">Внедренец отправителя</span> –
занимается установкой и настройкой системы-отправителя уведомлений в сети
пользователя системы.</p>

<p class="MsoNormalCxSpFirst">При
рассмотрении схем работы с тем или иным сервисом, описание действий будет
происходить от лица носителя той или иной роли.</p>

<p class="MsoNormalCxSpMiddle">Схема
работы содержит описание действий, которые надлежит выполнить представителю той
или иной роли в момент выполнения своих действий. Порядок описания действий всегда
будет одинаковый (разработчик мобильного приложения, разработчик отправителя,
внедренец отправителя, пользователь мобильного приложения), однако это не
означает, что физический порядок действий будет ровно таким же.</p>

<p class="MsoNormalCxSpLast">Кроме
действий, описанных далее в разделе, реализация следующих этапов считается
обязательной, и далее про них отдельно упоминаться не будет:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Реализация реакции на уведомление –
выполняет разработчик мобильного приложения;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реализация отправки уведомлений – выполняет
разработчик отправителя.</p>

<p class="MsoNormal">Также
считается, что мобильное приложение и отправитель «знают» о том, что они могут
взаимодействовать друг с другом:</p>

<p class="MsoListBullet">&#9679; 
Отправитель имеет некоторый публичный
программный интерфейс (<span class="Bold">сервис обмена</span>) для того, чтобы:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Предоставить мобильному приложению номер проекта
GCM (если таковой необходим для функционирования системы).</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Получить идентификатор получателя уведомления от
мобильного приложения.</p>

<p class="MsoListBullet">&#9679; 
Получатель (мобильное приложение) умеет
использовать сервис обмена, который публикует отправитель для выполнения обеих действий.</p>

<p class="MsoNormal">Далее
будут рассмотрены действия (по ролям), которые необходимо выполнить для работы
с тем или иным сервисом отправки уведомлений. Пошаговые инструкций для
выполнения конкретных шагов будут приведены далее в данном разделе.</p>

<p class="Lang-subheader">APNs</p>

<p class="MsoNormal">Разработчик
мобильного приложения должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Зарегистрировать для мобильного приложения
возможность получения push-уведомлений на сайте компании Apple. При регистрации
следует получить специальный сертификат.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Предоставить полученный сертификат отправителю
уведомлений.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реализовать получение идентификатора получателя
уведомлений и доставку получившегося объекта отправителю уведомлений.</p>

<p class="MsoNormal">Разработчик
отправителя должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Реализовать механизм ввода и хранения
сертификатов получателей уведомлений.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реализовать механизм получения и хранения
идентификаторов получателей уведомлений.</p>

<p class="MsoNormal">Внедренец
отправителя должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Загрузить в систему-отправителя сертификат
мобильного приложения, которое будет получать уведомления.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Сертификат должен быть получен у разработчика
мобильного приложения.</p>

<p class="MsoNormal">Пользователь
мобильного приложения должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Указать мобильному приложению параметры сервиса
обмена, который предоставляет приложение-отправитель.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Инициировать команду создания идентификатора
получателя уведомлений и отправку его отправителю уведомлений.</p>

<p class="Lang-subheader">GCM</p>

<p class="MsoNormal">Разработчик
мобильного приложения должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Реализовать ввод и хранение номеров проектов тех
экземпляров системы отправителя, уведомления от которых может получать
мобильное приложение.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реализовать получение идентификатора получателя
уведомлений и доставку получившегося объекта отправителю уведомлений.</p>

<p class="MsoNormal">Разработчик
отправителя должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Реализовать механизм ввода и хранения ключа
программного интерфейса (<span class="Interface">API KEY</span>) и
номера проекта для каждого экземпляра системы-отправителя уведомлений.
Регистрацию конкретного экземпляра отправителя на сайте Google выполняет внедренец
отправителя.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реализовать механизм получения и хранения
идентификаторов получателей уведомлений.</p>

<p class="MsoNormal">Внедренец
отправителя должен:</p>

<p class="MsoListBullet">&#9679; 
Выполнить регистрацию конкретного экземпляра
отправителя на сайте Google. Получившийся ключ программного интерфейса (<span class="Interface">API KEY</span>) и
номер проекта указать в соответствующих настройках отправителя.</p>

<p class="MsoNormal">Пользователь
мобильного приложения должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Указать мобильному приложению параметры сервиса
обмена, который предоставляет приложение-отправитель.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Инициировать выполнения команды (или команд) для
получения номера проекта (который сохранен в информационной базе отправителя),
создания идентификатора получателя уведомлений и отправку его отправителю
уведомлений.</p>

<p class="Lang-subheader">Сервис
фирмы «1С»</p>

<p class="MsoNormalCxSpFirst">В
силу того, что прямое общение с сервисами APNs и GCM существенно различается,
фирмой «1С» был реализован специальный сервис, который несколько упрощает
процесс отправки и получения уведомления для тиражных решений.</p>

<p class="MsoNormalCxSpLast">Разработчик
мобильного приложения должен:</p>

<p class="MsoListBullet">&#9679; 
Выбрать, какие сервисы будут использоваться для
доставки уведомлений на мобильное устройство:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
При необходимости указать в сервисе фирмы «1С»,
что мобильное приложение может получать уведомления с помощью сервиса APNs. Для
этого следует выполнить регистрацию мобильного приложения на сайте Apple и
предоставить полученный сертификат мобильного приложения сервису фирмы «1С».</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
При необходимости указать в сервисе фирмы «1С»,
что мобильное приложение может получать уведомления с помощью сервиса GCM.
Использовать специальный номер проекта <span class="Bold">797785657074</span>,
если получать уведомления планируется только через сервис фирмы «1С». Если
планируется получать уведомления от множества приложений, зарегистрированных на
сайте Google, необходимо реализовать ввод и хранение номеров проектов тех
экземпляров системы отправителя (например, с помощью сервиса обмена),
уведомления от которых может получать мобильное приложение. Регистрацию
конкретного экземпляра отправителя на сайте Google выполняет внедренец
отправителя.</p>

<p class="MsoListBullet">&#9679; 
Реализовать получение идентификатора получателя
уведомлений и доставку получившегося объекта отправителю уведомлений.</p>

<p class="MsoNormal">Разработчик
отправителя должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Реализовать механизм ввода и хранения ключа
программного интерфейса (<span class="Interface">API KEY Отправителя</span>)
для текущего экземпляра системы-отправителя уведомлений. Регистрацию
конкретного экземпляра отправителя на сайте сервиса фирмы «1С» выполняет
внедренец отправителя.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реализовать механизм получения и хранения
идентификаторов получателей уведомлений.</p>

<p class="MsoNormal">Внедренец
отправителя должен:</p>

<p class="MsoListBullet">&#9679; 
Выполнить регистрацию конкретного экземпляра
отправителя на сайте сервиса фирмы «1С». Получившийся ключ программного
интерфейса (<span class="Interface">API KEY Отправителя</span>) ввести в соответствующие настройки
отправителя.</p>

<p class="MsoNormal">Пользователь
мобильного приложения должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Указать мобильному приложению параметры сервиса
обмена, который предоставляет приложение-отправитель.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Инициировать команду создания идентификатора
получателя уведомлений и отправку его отправителю уведомлений.</p>

<a id="TI000001546" class="bookmark" name="issogl4_25.4.10.3.3_работа_с_сервисом_apns"><h5>25.4.10.3.3. Работа с сервисом APNs</h5></a>

<p class="MsoNormalCxSpFirst">Для
проверки работы механизма отправки уведомлений на ОС iOS, необходимо
самостоятельно собрать собственную мобильную платформу разработчика. При сборке
следует использовать специальный профиль обеспечения (provision profile), для
которого разрешена возможность работать с push-уведомлениями. Кроме того, для «собственной»
мобильной платформы разработчика необходимо указать новый идентификатор
мобильного приложения, при этом идентификаторы <span class="Term">com.e1c.mobile</span> и <span class="Term">com.e1c.mobile.ios</span> использовать не смогут, т. к.
они зарезервированы для использования фирмой «1С».</p>

<p class="MsoNormalCxSpMiddle">Для
установки соединения с APNs, на отправляющем компьютере должен быть доступен
удостоверяющий сертификат мобильного приложения получателя уведомлений.
Сертификаты для APNs бывают двух видов <span class="Interface">Apple Development IOS Push
Services</span> (сертификат разработчика) и <span class="Interface">Apple Production IOS Push
Services</span> (сертификат публичного мобильного приложения). Сертификат разработчика
предназначен для разработки мобильного приложения и его отладки. Его следует использовать,
если приложение установлено на устройство с помощью средств разработки.
Сертификат публичного мобильного приложения следует использовать, если
мобильное приложение распространяется через магазин приложений.</p>

<p class="MsoNormalCxSpLast">В
связи с этим, мобильная платформа предъявляет следующие требования к
сертификату:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Сертификат приложения должен быть предоставлен в
формате <span class="Interface">.PEM</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Сертификат должен содержать секцию <span class="Interface">Bag Attributes</span>,
в которой должен присутствовать атрибут <span class="Interface">friendlyName</span>. По
значению атрибута <span class="Interface">friendlyName</span> платформа различает сертификат
разработчика и сертификат публичного мобильного приложения. Сертификат без
атрибута <span class="Interface">friendlyName</span> будет отвергнут платформой «1С:Предприятие».</p>

<p class="Note"><span class="Note">Внимание!</span> Описание консоли разработчика приводится по
состоянию на момент написания документации.</p>

<p class="MsoNormal">Для
подготовки к рассылке уведомлений с использованием APNs, разработчик мобильного
приложения должен выполнить следующие действия:</p>

<p class="MsoListNumberCxSpFirst">1.  Необходимо
войти в консоль разработчика (iOS Dev Center, <a href="https://developer.apple.com/devcenter/ios/index.action" target="_blank">https://developer.apple.com/devcenter/ios/index.action</a>). Пользователь, от имени которого
выполняется вход в консоль, должен иметь права администратора (в консоли
разработчика).</p>

<p class="MsoListNumberCxSpMiddle">2.  В
правой части окна веб-браузера необходимо выбрать пункт меню <span class="Interface">Certificates, Identifiers &amp; Profiles</span> в разделе <span class="Interface">iOS Developer Program</span>.</p>

<p class="MsoListNumberCxSpLast">3. 
Если у мобильного приложения, которое будет
получать уведомления, отсутствует <span class="Interface">App ID</span>, то его
необходимо создать. Порядок создания описан ниже. Если <span class="Interface">App ID</span>
есть – следует пропустить этот пункт и перейти к следующему пункту.</p>

<p class="MsoListNumber2CxSpFirst">1. 
В разделе <span class="Interface">iOS Apps</span>
выбрать пункт <span class="Interface">Identifiers</span>.</p>

<p class="MsoListNumber2CxSpMiddle">2. 
Нажать кнопку <span class="Interface">+</span> над списком <span class="Interface">iOS AppIDs</span>.
Если у пользователя недостаточно прав – кнопка создания будет недоступна.</p>

<p class="MsoListNumber2CxSpMiddle">3. 
В поле <span class="Interface">Name</span> следует
задать описание приложения (латинскими буквами). В разделе <span class="Interface">App ID Suffix</span>
выбрать пункт <span class="Interface">Explicit App ID</span>. В поле <span class="Interface">Bundle ID</span>
следует указать полный идентификатор мобильного приложения (можно получить в
сборщике мобильных приложений). В разделе <span class="Interface">App Services</span>
следует отметить пункт <span class="Interface">Push Notifications</span>.</p>

<p class="MsoListNumber2CxSpMiddle">4. 
Для перехода к следующему экрану следует нажать <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber2CxSpMiddle">5. 
Следует проверить все указанные параметры и
нажать кнопку <span class="Interface">Submit</span> для подтверждения создания <span class="Interface">App ID</span>.</p>

<p class="MsoListNumber2CxSpLast">6. 
Нажатие кнопки <span class="Interface">Done</span> полностью
завершает процесс создания <span class="Interface">App ID</span>.</p>

<p class="MsoListNumber">4. 
Необходимо создать профиль провизии (provision
profile) для сборки мобильного приложения, которое может получать уведомления.
Данный профиль провизии (provision profile) в дальнейшем должен быть
использован в сборщике мобильных приложений.</p>

<p class="MsoListNumber2CxSpFirst">1.  Необходимо выбрать пункт меню <span class="Interface">Provisioning profiles – All</span> в левой части экрана <span class="Interface">Certificates, Identifiers &amp; Profiles</span>.</p>

<p class="MsoListNumber2CxSpMiddle">2. 
Необходимо нажать кнопку <span class="Interface">+</span> над списком <span class="Interface">iOS Provisioning
Profiles</span>.</p>

<p class="MsoListNumber2CxSpLast">3. 
Вид профиля выбирается в зависимости от того,
для чего он создается. Если профиль провизии (provision profile) создается для
разработки и отладки приложения, то в разделе <span class="Interface">Development</span>
необходимо выбрать пункт <span class="Interface">iOS App Development</span>.
Если профиль провизии (provision profile) создается для распространения
приложения, то в разделе <span class="Interface">Distribution</span>
следует выбрать пункт <span class="Interface">App Store</span>. В
зависимости от выбранного типа профиля провизии (provision profile), дальнейшие
шаги помощника создания профиля провизии (provision profile) будут различаться.</p>

<p class="MsoListNumber3">1. 
Выбран профиль провизии (provision profile) для
разработчика и нажата кнопка <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber4CxSpFirst">1. 
Необходимо выбрать <span class="Interface">App ID</span>
приложения, для сборки которого создается профиль провизии (provision profile),
и нажать кнопку <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber4CxSpMiddle">2. 
Необходимо выбрать сертификаты тех
разработчиков, которые смогут создавать приложения в Xcode с использованием
данного профиля провизии (provision profile) и затем нажать кнопку <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber4CxSpMiddle">3. 
Необходимо выбрать устройства, на которых будет
работать приложение, собранное с данным профилем провизии (provision profile) и
затем нажать кнопку <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber4CxSpLast">4. 
Необходимо ввести описание создаваемого профиля
(латинскими буквами) и нажать кнопку <span class="Interface">Generate</span>.</p>

<p class="MsoListNumber3">2. 
Выбран профиль провизии (provision profile) для
распространения нажата кнопка <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber4CxSpFirst">1. 
Необходимо выбрать <span class="Interface">App ID</span>
приложения, для сборки которого создается профиль провизии (provision profile),
и нажать кнопку <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber4CxSpMiddle">2. 
Необходимо выбрать сертификат фирмы-поставщика
прикладного решения и затем нажать кнопку <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber4CxSpLast">3. 
Необходимо ввести описание создаваемого профиля
(латинскими буквами) и нажать кнопку <span class="Interface">Generate</span>.</p>

<p class="MsoListNumber3">3. 
Затем следует скачать созданный профиль провизии
(provision profile) с помощью кнопки <span class="Interface">Download</span> для
дальнейшего использования (в системе Xcode или сборщике мобильных приложений).</p>

<p class="MsoListNumber">5. 
Для создания сертификата мобильного приложения
вначале необходимо сформировать файл запроса сертификата. Для выполнения данной
операции необходим компьютер Mac. Не закрывайте окно веб-браузера с открытой консолью
разработчика во время создания запроса сертификата.</p>

<p class="MsoListNumber2CxSpFirst">1. 
Необходимо запустить утилиту <span class="Interface">Связка ключей</span>.</p>

<p class="MsoListNumber2CxSpMiddle">2. 
Выбрать команду <span class="Interface">Связка ключей –
Ассистент сертификации – Запросить сертификат у бюро сертификации</span>.</p>

<p class="MsoListNumber2CxSpMiddle">3. 
В открывшемся диалоге необходимо заполнить поля,
при этом в качестве значения поля <span class="Interface">E-mail пользователя</span>
рекомендуется указать тот адрес электронной почты, который указывался при
регистрации в программе <span class="Interface">iOS Developer Program</span>.
В качестве значения свойства <span class="Interface">Запрос</span>
необходимо указать <span class="Interface">Сохранен на диске</span>.</p>

<p class="MsoListNumber2CxSpLast">4. 
После нажатия кнопки <span class="Interface">Продолжить</span>
будет сформирован файл запроса сертификата <span class="Interface">*.certSigningRequest</span>.</p>

<p class="MsoListNumber">6. 
Формируем сертификат для отправителя
уведомлений. Для этого необходимо вернуться в окно веб-браузера с открытой
консолью разработчика.</p>

<p class="MsoListNumber2CxSpFirst">1.  Необходимо выбрать пункт меню <span class="Interface">Certificates – All</span> в левой части экрана <span class="Interface">Certificates, Identifiers &amp; Profiles</span>.</p>

<p class="MsoListNumber2CxSpMiddle">2. 
Необходимо нажать кнопку <span class="Interface">+</span> над списком <span class="Interface">iOS Certificates</span>.</p>

<p class="MsoListNumber2CxSpMiddle">3. 
В зависимости от потребности, необходимо указать
пункт <span class="Interface">Apple Push Notification service SSL (Sandbox)</span> (если
нужен сертификат для разработки и отладки приложения) или пункт <span class="Interface">Apple Push
Notification service SSL (Production)</span> (если нужен сертификат для
распространяемого приложения). Затем следует нажать кнопку <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber2CxSpMiddle">4. 
Необходимо указать <span class="Interface">App ID</span>
используемого приложения и нажать кнопку <span class="Interface">Continue</span>.</p>

<p class="MsoListNumber2CxSpMiddle">5. 
Необходимо нажать кнопку <span class="Interface">Continue</span>. На
данном экране предлагается создать файл запроса сертификата, который уже создан
на предыдущем шаге.</p>

<p class="MsoListNumber2CxSpMiddle">6. 
Необходимо загрузить файл, сформированный на
предыдущем шаге (с расширением <span class="Interface">.certSigningRequest</span>)
и нажать кнопку <span class="Interface">Generate</span>.</p>

<p class="MsoListNumber2CxSpLast">7. 
После окончания формирования сертификата, его
следует скачать с сайта с помощью кнопки <span class="Interface">Download</span>.</p>

<p class="MsoListNumber">7. 
Последним шагом необходимо выполнить конвертацию
сертификата в необходимые форматы. Для этого необходим компьютер Mac, на
котором формировался файл запроса сертификата:</p>

<p class="MsoListNumber2CxSpFirst">1. 
Для конвертации также следует использовать
программу <span class="Interface">Связка ключей</span>.</p>

<p class="MsoListNumber2CxSpMiddle">2. 
Полученный на сайте сертификат загружается в <span class="Interface">Связку ключей</span>.</p>

<p class="MsoListNumber2CxSpMiddle">3. 
Выполняется экспорт сертификата из <span class="Interface">Связки ключей</span> в
формате <span class="Interface">.P12</span>.</p>

<p class="MsoListNumber2CxSpLast">4. 
Выполняется конвертация получившегося сертификата
из формата <span class="Interface">.P12</span> в формат <span class="Interface">.PEM</span>. Для этого
следует в консоли OS X выполнить следующую команду:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">openssl pkcs12 -in pushcert.p12 -out pushcert.pem -nodes -clcerts</pre>

<p class="MsoNormal">Получившиеся
сертификаты необходимы для:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Сертификат в формате <span class="Interface">.P12</span> –
необходим в том случае, если рассылка уведомлений выполняется с помощью сервиса
фирмы «1С». Сертификат должен использовать разработчиком получателя для
регистрации приложения-получателя уведомлений в сервисе фирмы «1С».</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Сертификат в формате <span class="Interface">.PEM</span> –
необходим в том случае, если уведомления будут отправляться непосредственно
через сервис APNs, и в этом случае сертификат должен быть предоставлен
разработчику отправителя или внедренцу отправителя (если интерфейс
программы-отправителя уведомлений предусматривает возможность указания
сертификата программы-получателя уведомлений).</p>

<a id="TI000001547" class="bookmark" name="issogl4_25.4.10.3.4_работа_с_сервисом_gcm"><h5>25.4.10.3.4. Работа с сервисом GCM</h5></a>

<p class="Note"><span class="Note">Внимание!</span> Описание консоли разработчика приводится по
состоянию на момент написания документации.</p>

<p class="MsoNormal">Следующие
действия должен выполнить внедренец приложения-отправителя во время
развертывания и настройки приложения-отправителя в компьютерной сети заказчика:</p>

<p class="MsoListNumberCxSpFirst">1.  Необходимо
войти в консоль разработчика (Google Developers Console, <a href="https://console.developers.google.com/project" target="_blank">https://console.developers.google.com/project</a>).</p>

<p class="MsoListNumberCxSpMiddle">2. 
Необходимо создать проект (кнопка <span class="Interface">Create Project</span>).</p>

<p class="MsoListNumberCxSpMiddle">3. 
После окончания создания проекта перейдите в
свойства проекта (<span class="Interface">Projects – &lt;Имя вашего
проекта&gt; – Overview</span>). В верхней части формы, над надписью <span class="Interface">Project Dashboard</span>,
будет показан номер проекта (<span class="Interface">Project Number</span>).
Этот номер проекта необходим для того, чтобы мобильное устройство смогло
сформировать идентификатор получателя.</p>

<p class="MsoListNumberCxSpMiddle">4. 
Необходимо включить возможность использования
сервиса GCM. Для этого необходимо выбрать пункт меню <span class="Interface">APIs &amp; auth –
APIs</span> (в левой части окна веб-браузера). Затем необходимо найти <span class="Interface">Google Cloud Messaging
for Android</span> в списке <span class="Interface">Browse APIs</span> и
включить его (перевести переключатель <span class="Interface">Status</span> в
положение <span class="Interface">ON</span>). После включения следует согласиться с тем, что вы
принимаете соглашения об использовании, которые предлагаются консолью
разработчика.</p>

<p class="MsoListNumberCxSpMiddle">5. 
Необходимо получить ключ программного интерфейса
(<span class="Interface">API Key</span>). Для этого следует выбрать пункт меню <span class="Interface">APIs &amp; auth –
Credentials</span> (в левой части окна веб-браузера). В разделе <span class="Interface">Public </span><span class="Interface">API </span><span class="Interface">Access</span> следует
нажать кнопку <span class="Interface">Create </span><span class="Interface">new </span><span class="Interface">Key</span>. В открывшемся диалоге
выбрать кнопку <span class="Interface">Server Key</span>. Затем необходимо
указать IP-адрес сервера, который будет выступать отправителем для вашего
приложения. Другими словами в данном окне рекомендуется указать IP-адрес (или
адреса) компьютера, с которого прикладное решение будет рассылать уведомления.
Для тестовых проверок можно указать IP-адрес <span class="Term">0.0.0.0/0</span>. Сменить список допустимых IP-адресов
можно с помощью команды <span class="Interface">Edit allowed IPs</span>.</p>

<p class="MsoListNumberCxSpLast">6. 
После окончания формирования ключа, он будет
отображен в поле <span class="Interface">API KEY</span>. Получившееся значение
необходимо использовать в качестве ключа аутентификации для отправки
уведомлений (параметр <span class="Term">ДанныеАутентификации</span> метода <span class="Term">Отправить()</span> объекта <span class="Term">МенеджерОтправкиДоставляемыхУведомлений</span>).
Рекомендуется относиться к данному ключу как к конфиденциальной информации.
Получение данного ключа третьими лицами позволит им отправлять push-уведомления
от вашего имени, например в случае, если при создании ключа не указывались
конкретные значения IP-адресов.</p>

<p class="MsoNormal">Получившийся
ключ программного интерфейса (<span class="Interface">API KEY</span>)
необходимо предоставить внедренцу приложения-отправителя для указания в
настройках приложения. Вышеописанные действия не требуется выполнять, если
рассылка уведомлений выполняется через сервис фирмы «1С».</p>

<a id="TI000001548" class="bookmark" name="issogl4_25.4.10.3.5_работа_с_сервисом_фирмы_1с"><h5>25.4.10.3.5. Работа с сервисом фирмы «1С»</h5></a>

<p class="MsoNormal">Разработчик
мобильного приложения должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Выполнить регистрацию в сервисе APNs (если он
используется мобильным приложением).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Необходимо зарегистрироваться на сайте сервиса <a href="https://pushnotifications.1c.com/signup" target="_blank">https://pushnotifications.1c.com/signup</a>. Для регистрации необходимо иметь
действующий номер подвижной беспроводной радиотелефонной связи (мобильный
номер). В процессе регистрации на него будет выслан код подтверждения
регистрации. В контактных данных рекомендуется указывать данные ответственного
лица разработчика мобильного приложения.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Необходимо зарегистрировать мобильное
приложение, которое будет выступать получателем уведомлений. Для этого следует
выбрать пункт меню <span class="Interface">Доставляемые уведомления – Мобильные
приложения</span> и нажать кнопку <span class="Interface">Зарегистрировать
приложение</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Необходимо подключить созданное мобильное
приложение к используемым сервисам (APNs и GCM). Для этого в списке <span class="Interface">Ваши мобильные
приложения</span> нажать ссылку <span class="Interface">Подключить к APNS и
GCM</span>. В зависимости от сервиса необходимо нажать кнопку <span class="Interface">+ Подключить к APNS</span>
или <span class="Interface">+ Подключить к GCM</span>. В зависимости от используемого
сервиса, необходимо предоставить следующие данные:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Идентификатор мобильного приложения – для
всех сервисов.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Для APNs: сертификат мобильного приложения в
формате <span class="Interface">.P12</span> (и его пароль).</p>

<p class="MsoNormal">Разработчик
отправителя должен:</p>

<p class="MsoListBullet">&#9679; 
Каких-либо действий не выполняется.</p>

<p class="MsoNormal">Внедренец
отправителя должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Необходимо зарегистрироваться на сайте сервиса <a href="https://pushnotifications.1c.com/signup" target="_blank">https://pushnotifications.1c.com/signup</a>. Для регистрации необходимо иметь
действующий номер подвижной беспроводной радиотелефонной связи (мобильный
номер). В процессе регистрации на него будет выслан код подтверждения
регистрации. В контактных данных рекомендуется указывать данные администратора
информационной системы.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Зарегистрировать отправителя уведомлений. Для
этого следует выбрать пункт меню <span class="Interface">Доставляемые
уведомления – Отправители уведомлений</span> и затем нажать кнопку <span class="Interface">Зарегистрировать
отправителя</span>. При регистрации рекомендуется указывать список IP-адресов,
с которых будет допустимо рассылать уведомления с помощью данного сервиса. Если
адреса не указаны – рассылка уведомлений допускается с любого компьютера,
который может авторизоваться в сервисе.</p>

<p class="Indentlist">Важно
понимать, что регистрацию отправителя выполняет не разработчик отправителя, а
внедренец отправителя в тот момент, когда выполняется настройка экземпляра
системы-отправителя у пользователя.</p>

<p class="MsoListBullet">&#9679; 
В результате регистрации будет сформирован
специальный ключ доступа. Для сохранения этого значения следует нажать кнопку <span class="Interface">Скопировать Ключ
доступа</span> или нажать кнопку Редактировать и скопировать значение из поля <span class="Interface">Ключ доступа отправителя</span>.
Получившееся значение необходимо указать в настройках конкретного экземпляра
приложения-отправителя. Оно будет использоваться в качестве ключа
аутентификации для отправки уведомлений (параметр <span class="Term">ДанныеАутентификации</span> метода <span class="Term">Отправить()</span> объекта <span class="Term">МенеджерОтправкиДоставляемыхУведомлений</span>). Рекомендуется
относиться к данному ключу как к конфиденциальной информации. Получение данного
ключа третьими лицами позволит им отправлять push-уведомления от вашего имени,
например в случае, если при создании отправителя не указывались конкретные
значения IP-адресов.</p>

<p class="MsoNormal">Пользователь
мобильного приложения должен:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Указать мобильному приложению параметры сервиса
обмена, который предоставляет приложение-отправитель.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Инициировать выполнения команды для создания
идентификатора получателя уведомлений и отправку его отправителю уведомлений.</p>

<a id="TI000001549" class="bookmark" name="issogl4_25.4.10.3.6_рассылка_уведомлений"><h5>25.4.10.3.6. Рассылка уведомлений</h5></a>

<p class="MsoNormal">Действия
по рассылке уведомлений практически не различаются для различных сервисов.
Различия наблюдаются в значениях параметров метода отправки уведомлений.
Собственно отправка происходит с помощью метода <span class="Term">Отправить()</span> менеджера доставки отправляемых
уведомлений:</p>

<p class="MsoListBullet">&#9679; 
При рассылке уведомлений в качестве данных
аутентификации используется (параметр <span class="Term">ДанныеАутентификации</span> метода <span class="Term">Отправить()</span>):</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Сервис APNs – сертификат мобильного
приложения, полученный из консоли разработчика. Рекомендуется относиться к
данному ключу как к конфиденциальной информации.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Сервис GCM – ключ программного интерфейса
приложения (<span class="Interface">API KEY</span>), зарегистрированного в консоли разработчика. Рекомендуется
относиться к данному ключу как к конфиденциальной информации.</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Сервис фирмы «1С» – ключ программного
интерфейса отправителя (<span class="Interface">Ключ доступа отправителя</span>),
который получен при регистрации отправителя на сайте сервиса. Рекомендуется
относиться к данному ключу как к конфиденциальной информации.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Если для отправки уведомлений используется
сервис фирмы «1С», то параметр <span class="Term">ИспользоватьПромежуточныйСервис</span> должен быть
установлен в значение <span class="Term">Истина</span>.</p>

<p class="MsoListBullet">&#9679; 
Если отправка выполняется одновременно с
использованием нескольких сервисов, то в качестве данных аутентификации может
выступать соответствие, где ключом выступает вид сервиса (значение перечисления
<span class="Term">ТипПодписчикаДоставляемыхУведомлений</span>),
а в качестве значения – те данные, которые необходимы соответствующему
сервису.</p>

<p class="Indentlist">Следует
понимать, что невозможно одновременно (в одном вызове метода <span class="Term">Отправить()</span>) отправлять уведомления с использованием
APNs или GCM и сервиса фирмы «1С». Если у метода <span class="Term">Отправить()</span> значение параметра <span class="Term">ИспользоватьПромежуточныйСервис</span> установлено в
значение <span class="Term">Истина</span>,
то значением параметра <span class="Term">ДанныеАутентфикации</span> может быть только <span class="Interface">Ключ доступа
отправителя</span>, полученный у сервиса фирмы «1С».</p>

<p class="MsoListBullet">&#9679; 
Перечень получателей уведомлений описывается с
помощью свойства <span class="Term">Получатели</span>
объекта <span class="Term">ДоставляемоеУведомление</span>,
которое выступает значением первого параметра метода <span class="Term">Отправить()</span> менеджера доставки отправляемых
уведомлений.</p>

<p class="MsoNormal">Для
обеспечения отправки уведомлений с помощью APNs, на компьютере с
системой-отправителем должны быть разрешены исходящие подключения по IP-портам <span class="Interface">2195</span> и <span class="Interface">2196</span>.</p>

<a id="TI000001550" class="bookmark" name="issogl3_25.4.10.4_особенности_обработки_уведомлений_мобильным_приложением"><h4>25.4.10.4. Особенности обработки уведомлений мобильным приложением</h4></a>

<p class="MsoNormalCxSpFirst">Если
обработчик уведомления не подключен, то уведомление сохраняется в памяти до окончания
сеанса и будет передано обработчику уведомления после его подключения (в этом
сеансе). Если до окончания сеанса обработчик не был подключен – уведомление
теряется после завершения сеанса.</p>

<p class="MsoNormalCxSpLast">Также
необходимо учитывать следующие особенности работы с уведомлениями в мобильном
приложении:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Если мобильное приложение активно, то
уведомление сразу доставляется в мобильное приложение, при этом наклейка и
звуковое оповещение игнорируются.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если мобильное приложение не активно в момент
получения уведомления, то уведомление отображается операционной системой. Если
пользователь нажал на уведомление, то будет запущено соответствующее
приложение. Если пользователь удалил уведомление – приложение не будет
проинформировано о существовании уведомления. В ОС iOS (версии 7 и младше)
уведомление удаляется из центра уведомления либо явным действием пользователя,
либо вытесняется другими уведомлениями данного приложения.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если мобильное приложение, в момент получения
уведомления, работает в фоновом режиме и не активно, то работа с уведомлением
выполняется по-разному на разных платформах:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
На платформе iOS уведомление будет передано в
мобильное приложение только после того, как его выберет пользователь из панели
уведомлений.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
На платформе Android уведомление сразу
передается в мобильное приложение и одновременно отображается в панели
уведомлений. После того, как пользователь выбрал уведомление в панели,
происходит активизация приложения, но повторно уведомление в приложение не
передается.</p>

<p class="MsoListBullet">&#9679; 
В том случае, если в мобильном приложении развернуто
несколько информационных баз, то пользователю предлагается переключиться, если
в данный момент он работает с другой информационной базой. Если конкретную
информационную базу определить не получается – выдается соответствующее
диагностическое сообщение.</p>

<a name="_ref441581633"></a><a name="_ref443653880"></a><a name="_ref443653879"></a><a id="TI000001789" class="bookmark" name="issogl2_25.4.11_работа_с_рекламой"><h3>25.4.11. Работа с рекламой</h3></a>

<a name="_ref462739376"></a><a id="TI000001790" class="bookmark" name="issogl3_25.4.11.1_общая_информация"><h4>25.4.11.1. Общая информация</h4></a>

<p class="MsoNormalCxSpFirst">Мобильная
платформа предоставляет возможность показывать рекламную информацию в мобильном
приложении. При необходимости воспроизведения рекламы, прикладной разработчик
может настроить отображение рекламного баннера с использованием рекламного
сервиса Google AdMob (<a href="https://www.google.com/admob/" target="_blank">https://www.google.com/admob/</a>, на английском языке). Сервис Google AdMob доступен для использования при работе как под управлением
ОС Android, так и под
управлением ОС iOS.</p>

<p class="MsoNormalCxSpMiddle">Реклама
отображается в виде специальных рекламных блоков графического или текстового
вида, которые может отображаться на весь экран (полноэкранный блок) или в
специально выделенной для этого части экрана мобильного устройства (для не полноэкранной
рекламы).</p>

<p class="MsoNormalCxSpMiddle">Данная
документация рассматривает только вопросы, касающиеся технических аспектов
работы мобильного приложения с данными сервисами.</p>

<p class="MsoNormalCxSpLast">Общая
схема работы при работе с рекламой выглядит следующим образом:</p>

<p class="MsoListNumberCxSpFirst">1.  Зарегистрировать
свое приложение в сервисе.</p>

<p class="MsoListNumberCxSpMiddle">2.  Настроить
рекламные блоки в сервисе (при необходимости).</p>

<p class="MsoListNumberCxSpLast">3.  Реализовать
программный интерфейс работы с рекламой, используя данные, полученные на
предыдущих шагах.</p>

<p class="MsoNormal">Для
управления отображением рекламной информации служит свойство глобального
контекста <span class="Term">ОтображениеРекламы</span>.
После старта мобильного приложения, система имеет следующие настройки по
умолчанию:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Реклама в мобильном приложении не используется.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Идентификатор полноэкранной рекламы не
установлен.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Идентификатор рекламного баннера не установлен.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Рекламная информация не отображается на экране.</p>

<p class="MsoNormal">Для
того чтобы рекламная информация стала отображаться в приложении, должны
одновременно выполняться следующие условия:</p>

<p class="MsoListNumberCxSpFirst">1.  Использование
рекламы в мобильном приложении должно быть разрешено с помощью метода <span class="Term">ОтображениеРекламы.УстановитьИспользование(Истина);</span>.</p>

<p class="MsoListNumberCxSpMiddle">2.  Установлен
способ отображения рекламного баннера с помощью метода <span class="Term">ОтображениеРекламы.УстановитьОтображениеРекламногоБаннера()</span>.
Данный метод задает способ отображения только неполноэкранной рекламы.</p>

<p class="MsoListNumberCxSpMiddle">3.  Установлен
идентификатор рекламного баннера (в случае использования системы Google adMob)
с помощью метода <span class="Term">ОтображениеРекламы.УстановитьИндентификаторРекламногоБаннера()</span>.</p>

<p class="MsoListNumberCxSpLast">4.  Если
в мобильном приложении используется межстраничное (полноэкранное) объявление, то
его отображение осуществляется с помощью метода <span class="Term">ОтображениеРекламы.ПоказатьПолноэкраннуюРекламу()</span>.
Вызов метода следует осуществлять именно в том месте, в котором планируется
отображать межстраничное объявление.</p>

<p class="Indentlist">В
случае использования системы Google adMob, предварительно следует установить
идентификатор полноэкранной рекламы с помощью метода <span class="Term">ОтображениеРекламы.УстановитьИндентификаторПолноэкраннойРекламы()</span>.
При этом пункт 1 также обязательно должен быть выполнен.</p>

<p class="MsoListNumber">5.  Ротацию
собственно рекламной информации обеспечивает рекламная сеть.</p>

<p class="MsoNormal">При
использовании системы Google adMob, при установке идентификаторов рекламы,
следует использовать идентификаторы, которые получены в веб-интерфейсе системы
(подробнее см. <a href="#_ref441491987">здесь</a>).</p>

<a id="TI000001791" class="bookmark" name="issogl3_25.4.11.2_настройка_рекламных_сервисов"><h4>25.4.11.2. Настройка рекламных сервисов</h4></a>

<a name="_ref441491987"></a><a id="TI000001793" class="bookmark" name="issogl4_25.4.11.2.1_google_admob"><h5>25.4.11.2.1. Google adMob</h5></a>

<p class="Note"><span class="Note">Внимание!</span> Описание работы с веб-интерфейсом приводится
по состоянию на момент написания документации.</p>

<p class="MsoNormal">Для
настройки рекламных блоков необходимо выполнить следующие действия:</p>

<p class="MsoListNumberCxSpFirst">1.  Зарегистрироваться
в системе Google adMob.</p>

<p class="MsoListNumberCxSpMiddle">2.  Войти
в систему от имени зарегистрированного пользователя (<a href="https://apps.admob.com" target="_blank">https://apps.admob.com</a>).</p>

<p class="MsoListNumberCxSpMiddle">3.  Если
приложение собрано с использованием сборщика мобильных приложений и ранее выполнялось
тестирование этого приложения (см. <a href="#_ref441769908">здесь</a>), то ничего делать не надо. Идентификаторы рекламных
блоков должны быть указаны в нужных местах прикладного решения. В мобильном
приложении, собранном с помощью сборщика, должна отображать реальная рекламная
информация.</p>

<p class="MsoListNumberCxSpMiddle">4.  Начать
монетизацию нового приложения. Для этого следует нажать кнопку <span class="Interface">+ Монетизировать новое
приложение</span> на закладке <span class="Interface">Главная</span>.</p>

<p class="MsoListNumberCxSpMiddle">5.  На
открывшейся странице следует ввести имя мобильного приложения и нажать кнопку <span class="Interface">Найти</span>. После
того, как ниже поля ввода сформировался список приложений, созданный по вашему
поисковому запросу (имя приложения), следует найти именно ваше приложение и
нажать кнопку <span class="Interface">+Выбрать</span> справа от него.</p>

<p class="MsoListNumberCxSpMiddle">6.  На
странице <span class="Interface">Монетизация нового приложения</span> следует нажать кнопку <span class="Interface">Далее</span>.</p>

<p class="MsoListNumberCxSpMiddle">7.  После
добавления приложения требуется указать формат и название рекламного блока. Это
делается на втором шаге (<span class="Interface">Выберите формат
объявлений и укажите название рекламного блока</span>). Рекламный блок может
быть обычным баннером (отображаемым на части экрана) и межстраничным (полноэкранным)
объявлением.</p>

<p class="MsoListNumberCxSpMiddle">8.  Нажатие
любой кнопки (<span class="Interface">Баннер</span> или <span class="Interface">Межстраничное
объявление</span>) приводит к необходимости настроить создаваемый формат блока.
Редактирование рекламного блока завершается нажатием кнопки <span class="Interface">Сохранить</span>.</p>

<p class="MsoListNumberCxSpMiddle">9.  Следует
сохранить значение свойства <span class="Interface">Идентификатор
рекламного блока</span>, который необходим для использования из встроенного
языка.</p>

<p class="MsoListNumberCxSpLast">10.  После
окончания работы на странице <span class="Interface">Монетизация нового
приложения</span> следует нажать кнопку <span class="Interface">Готово</span>.</p>

<p class="MsoNormal">Работу
с рекламными блоками также можно выполнять следующим образом:</p>

<p class="MsoListNumberCxSpFirst">1.  Войти
в систему Google adMob (<a href="https://apps.admob.com" target="_blank">https://apps.admob.com</a>).</p>

<p class="MsoListNumberCxSpMiddle">2.  Перейти
на закладку <span class="Interface">Монетизация</span>.</p>

<p class="MsoListNumberCxSpMiddle">3.  Под
заголовком <span class="Interface">Все приложения</span> выбрать требуемое приложение (левая
колонка на странице).</p>

<p class="MsoListNumberCxSpLast">4.  На
закладке <span class="Interface">Рекламные блоки</span> имеется возможность создавать и
настраивать рекламные блоки. На этой же закладке имеется возможность получить
идентификатор рекламного блока.</p>

<a id="TI000001794" class="bookmark" name="issogl3_25.4.11.3_тестирование_работы_с_рекламой"><h4>25.4.11.3. Тестирование работы с рекламой</h4></a>

<a name="_ref441769908"></a><a id="TI000001796" class="bookmark" name="issogl4_25.4.11.3.1_google_admob"><h5>25.4.11.3.1. Google adMob</h5></a>

<p class="MsoNormal">Общую схему тестирования отображения
рекламной информации, при использовании системы Google adMob, можно представить
следующим образом:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Для тестирования отображения рекламной
информации не требуется публикации мобильного приложения в магазине приложений.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для тестирования необходимы только
идентификаторы рекламных блоков, для создания которых (рекламных блоков) необходимо
зарегистрировать разрабатываемое приложение в сервисе Google adMob.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
После регистрации приложения в Google adMob, необходимо создать рекламные блоки. Их идентификаторы
будут использоваться в разрабатываемом мобильном приложении и при тестировании
и при реальной эксплуатации.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Пока приложение работает на мобильной платформе
разработчика, рекламные блоки отображают тестовое содержимое. После того, как
приложение собрано сборщиком мобильных приложений – оно начнет показывать
реальную рекламную информацию.</p>

<p class="Note"><span class="Note">Внимание!</span> Описание работы с веб-интерфейсом приводится
по состоянию на момент написания документации.</p>

<p class="MsoNormal">Для
настройки рекламной информации необходимо выполнить следующие действия:</p>

<p class="MsoListNumberCxSpFirst">1.  Войти
в систему Google adMob (<a href="https://apps.admob.com" target="_blank">https://apps.admob.com</a>).</p>

<p class="MsoListNumberCxSpMiddle">2. 
Перейти на закладку <span class="Interface">Монетизация</span>.</p>

<p class="MsoListNumberCxSpMiddle">3. 
Начать монетизацию нового приложения. Для этого
следует нажать кнопку <span class="Interface">+ Монетизировать новое
приложение</span> на закладке <span class="Interface">Главная</span>.</p>

<p class="MsoListNumberCxSpMiddle">4. 
На открывшейся странице следует перейти на
закладку <span class="Interface">Добавить приложение вручную</span>. В поле <span class="Interface">Название приложения</span>
следует ввести имя приложения так, как оно в дальнейшем будет отображаться в
магазине приложений, в поле <span class="Interface">Платформа</span>
следует указать <span class="Interface">Android</span>.</p>

<p class="MsoListNumberCxSpMiddle">5. 
На странице <span class="Interface">Монетизация нового
приложения</span> следует нажать кнопку <span class="Interface">Добавить приложение</span>.</p>

<p class="MsoListNumberCxSpMiddle">6. 
После добавления приложения требуется указать
формат и название рекламного блока. Это делается на втором шаге (<span class="Interface">Выберите формат
объявлений и укажите название рекламного блока</span>). Рекламный блок может
быть обычным баннером (отображаемым на части экрана) и межстраничным (полноэкранным)
объявлением.</p>

<p class="MsoListNumberCxSpMiddle">7. 
Нажатие любой кнопки (<span class="Interface">Баннер</span> или <span class="Interface">Межстраничное
объявление</span>) приводит к необходимости настроить создаваемый формат блока.
Редактирование рекламного блока завершается нажатием кнопки <span class="Interface">Сохранить</span>.</p>

<p class="MsoListNumberCxSpMiddle">8. 
Следует сохранить значение свойства <span class="Interface">Идентификатор
рекламного блока</span>, который необходим для использования из встроенного
языка.</p>

<p class="MsoListNumberCxSpLast">9. 
После окончания работы на странице <span class="Interface">Монетизация нового
приложения</span> следует нажать кнопку <span class="Interface">Готово</span>.</p>

<p class="MsoNormal">Идентификаторы,
полученные при создании рекламных блоков, следует использовать в качестве
параметров методов <span class="Term">ОтображениеРекламы.УстановитьИндентификаторРекламногоБаннера()</span>и
<span class="Term">ОтображениеРекламы.УстановитьИндентификаторПолноэкраннойРекламы()</span>.</p>

<a name="_ref441581651"></a><a name="_ref443653897"></a><a name="_ref443653896"></a><a id="TI000001797" class="bookmark" name="issogl2_25.4.12_работа_со_встроенными_покупками"><h3>25.4.12. Работа со встроенными покупками</h3></a>

<a id="TI000001798" class="bookmark" name="issogl3_25.4.12.1_общая_информация"><h4>25.4.12.1. Общая информация</h4></a>

<p class="MsoNormal">Мобильная платформа предоставляет
прикладному разработчику возможность реализации различных покупок внутри мобильного
приложения (in-app purchase). Предоставляется
возможность работы со следующими видами покупок:</p>

<p class="MsoListNumberCxSpFirst">1.  Постоянная
покупка. Используется на платформах iOS и Android. Приобретается однократно для учетной записи пользователя
мобильного устройства. Распространяется на все мобильные устройства, работающие
под одной учетной записью. Для распространения используется механизм
восстановления покупок.</p>

<p class="MsoListNumberCxSpMiddle">2.  Расходуемая
покупка. Используется на платформе iOS. Такая покупка может быть приобретена произвольное количество
раз. Информация о приобретении такой покупки поступает на мобильное устройство только
в момент запроса начала покупки. На платформе Android расходуемая покупка реализуется в прикладном решении с
помощью специальных средств платформы (расходование постоянной покупки).</p>

<p class="MsoListNumberCxSpLast">3.  Подписка.
Используется на платформах iOS и Android.
Такая покупка приобретается как постоянная покупка, действующая в течение определенного
времени. Имеется возможность установить автоматическое продление покупки по
истечению срока подписки. При этом со счета платежного средства, привязанного к
аккаунту пользователя, будет списываться стоимость подписки. Нельзя изменить
стоимость подписки на платформе Android. На платформе iOS изменение стоимости подписки приведет к отключению
автоматического продления подписки. Удаление приложения, через которое
осуществлялась покупка, не приводит к отключению автоматического продления подписок.
Управление подписками осуществляется с помощью Apple AppStore и Google Wallet. В
мобильном приложении невозможно реализовать интерфейс управления подписками.</p>

<p class="MsoNormal">Покупки
в мобильном приложении осуществляются с помощью внешних сервисов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
для ОС iOS: Apple In-App Purchase.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
для ОС Android: Google Play In-App Billing. На устройстве должна
быть установлена актуальная версия приложения Google Play.</p>

<p class="MsoNormalCxSpFirst">При
реализации покупок внутри мобильного приложения следует помнить, что предметы
покупок ограничиваются владельцами магазинов приложений (компании Apple, Google).</p>

<p class="MsoNormalCxSpLast">В
общем случае, покупки внутри приложений должны полностью соответствовать
требованиям владельцев сервисов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
для ОС iOS: <a href="https://developer.apple.com/app-store/review/guidelines/" target="_blank">https://developer.apple.com/app-store/review/guidelines/</a> (на английском языке).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
для ОС Android: <a href="https://support.google.com/googleplay/android-developer/answer/6151557" target="_blank">https://support.google.com/googleplay/android-developer/answer/6151557</a>.</p>

<p class="MsoNormal">В
качестве примера можно привести следующие разрешенные и запрещенные виды
контента:</p>

<p class="MsoListBullet">&#9679; 
Разрешено продавать:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
функциональные возможности мобильных приложений;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
услуги, непосредственно связанные с мобильными
приложениями.</p>

<p class="MsoListBullet">&#9679; 
Запрещено продавать:</p>

<p class="MsoListBullet2">&#9679; 
товары и услуги, используемые за пределами
мобильных приложений.</p>

<a id="TI000001799" class="bookmark" name="issogl3_25.4.12.2_схема_использования"><h4>25.4.12.2. Схема использования</h4></a>

<p class="MsoNormal">Чтобы
использовать покупки, следует для разрабатываемого мобильного приложения установить
разрешение <span class="Interface">Встроенные покупки</span> (см. стр. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref370811599">здесь</a></span></span></span></span></span>). Общая схема работы со
встроенными покупками, в мобильном приложении, выглядит следующим образом:</p>

<p class="MsoListNumberCxSpFirst">1.  Необходимо
настроить работу используемых сервисов встроенных покупок (см. <a href="#_ref441835999">здесь</a>) для взаимодействия с разрабатываемым мобильным
приложением. Во время настройки сервисов может потребоваться загрузить в
магазин приложений разрабатываемое мобильное приложение, для которого включена
возможность использования встроенных покупок. При этом загружаемое мобильное
приложение может не содержать в себе функциональность работы с покупками.
Загружаемое приложение необходимо для работы механизмов сервисов покупок.
Однако полный идентификатор загружаемого приложения должен быть в точности
таким, каким он будет для финальной версии мобильного приложения с возможностью
совершения встроенных покупок.</p>

<p class="MsoListNumberCxSpMiddle">2.  После
настройки сервисов необходимо создать необходимые покупки (в каждом из сервисов)
и зафиксировать идентификаторы и типы покупок.</p>

<p class="MsoListNumberCxSpMiddle">3.  В
мобильном приложении необходимо проверить, доступно или нет на данном
устройстве совершение покупок. Для этого следует использовать метод <span class="Term">ВстроенныеПокупки.ПодерживаютсяПокупки()</span>.</p>

<p class="MsoListNumberCxSpLast">4.  Если
покупки поддерживаются, то следует обновить список совершенных и доступных покупок
с помощью метода <span class="Term">ВстроенныеПокупки.ОбновитьИнформациюОПриобретении()</span>.
Без выполнения этой операции будет невозможно в дальнейшем совершить покупку.</p>

<p class="Indentlist">Операцию
обновления информации о приобретении рекомендуется выполнять регулярно, т. к.
список совершенных покупок может изменяться не только на текущем устройстве.</p>

<p class="MsoListNumberCxSpFirst">5.  Для
определения возможности расходования покупок средствами встроенного языка следует
использовать метод <span class="Term">ВстроенныеПокупки.ПоддерживаетсяРасходованиеПокупок()</span>.
Если метод возвращает значение <span class="Term">Истина</span>, то это означает, что мобильное
приложение исполняется на ОС Android с установленным приложением Google Play и имеется возможность расходовать постоянные покупки.</p>

<p class="MsoListNumberCxSpLast">6.  Для
осуществления покупки предназначен метод <span class="Term">ВстроенныеПокупки.НачатьПриобретение()</span>. В
качестве параметра метода следует передать идентификатор покупки (как он указан
в соответствующем сервисе) или объект <span class="Term">ВстроеннаяПокупка</span>, который можно получить с
помощью метода <span class="Term">ВстроенныеПокупки.ПолучитьСписок()</span>.</p>

<p class="IndentlistCxSpFirst">После
вызова метода, управление будет передано интерфейсу выполнения покупок, который
предоставляется операционной системой и не может быть переопределен на уровне
мобильного приложения.</p>

<p class="IndentlistCxSpLast">После
завершения покупки управление возвращается в мобильное приложение (в метод
обработки оповещения о завершении покупки). Одним из параметров метода будет
выступать статус покупки: если в обработчик передано значение <span class="Term">Истина</span>, значит покупка совершена успешно. В
противном случае покупка не совершена по любой из причин: отсутствует связь с
магазином приложений, пользователь отменил покупку в интерфейсе магазина
приложений, цифровая подпись квитанции о покупке не прошла проверку и т. д.</p>

<p class="MsoListNumber">7. 
Расходование покупок следует выполнять с помощью
метода <span class="Term">ВстроенныеПокупки.ИзрасходоватьПокупку()</span>.
После выполнения метода выполняется запрос к сервису работы с покупками, в
котором указывается, что покупка израсходована и доступна для повторного
приобретения.</p>

<a id="TI000001800" class="bookmark" name="issogl3_25.4.12.3_проверка_квитанции_встроенной_покупки"><h4>25.4.12.3. Проверка квитанции встроенной покупки</h4></a>

<p class="MsoNormalCxSpFirst">При осуществлении покупки, в мобильном
приложении выполняется проверка того, что покупка действительно выполнена. Однако
информационная система (включающая мобильное приложение) может выполнить
проверку более тщательно. Для этого предоставляется возможность передать
квитанцию выполненной покупки в прикладное решение, развернутое на персональном
компьютере. И тогда имеется возможность выполнить проверку квитанции со стороны
прикладного решения для персонального компьютера. Для этого следует
использовать метод <span class="Term">ПроверкаВстроенныхПокупок.ПроверитьКвитанциюВстроеннойПокупки()</span>.
Проверка выполняется полностью аналогично мобильной платформе. Разница
заключается в том, что при проверке с сервера прикладного решения для
персонального компьютера используются другие каналы связи с сервисом покупок (и
другое окружение проверяющей системы).</p>

<p class="MsoNormalCxSpLast">При проверке квитанции покупки выполняются
следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
для ОС iOS: отправляется запрос на сервер компании Apple для проверки полученной квитанции. Запрос отправляется по
адресу <a href="https://buy.itunes.apple.com/verifyRecepient" target="_blank">https://buy.itunes.apple.com/verifyRecepient</a> (<a href="https://sandbox.itunes.apple.com/verifyRecepient" target="_blank">https://sandbox.itunes.apple.com/verifyRecepient</a> во время тестирования).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
для ОС Android: выполняется проверка электронной подписи квитанции
выполненной покупки.</p>

<p class="MsoNormal">Если
прикладной разработчик считает, что и этого недостаточно, то предоставляется
возможность выполнять дополнительные проверки, которые базируются на содержимом
полей квитанции о покупке. К таким проверкам можно отнести проверку уникальности
идентификатора квитанции о покупке, адекватности даты покупки и т. д.</p>

<a name="_ref441835999"></a><a id="TI000001801" class="bookmark" name="issogl3_25.4.12.4_настройка_сервисов_встроенных_покупок"><h4>25.4.12.4. Настройка сервисов встроенных покупок</h4></a>

<a id="TI000001802" class="bookmark" name="issogl4_25.4.12.4.1_общая_информация"><h5>25.4.12.4.1. Общая информация</h5></a>

<p class="MsoNormal">Информацию об особенностях конкретных типов
покупок и поведения системы при работе с покупками следует искать в документации
к соответствующей операционной системе.</p>

<a name="_ref441839441"></a><a id="TI000001803" class="bookmark" name="issogl4_25.4.12.4.2_apple_in-app_purchase"><h5>25.4.12.4.2. Apple In-App Purchase</h5></a>

<p class="Note"><span class="Note">Внимание!</span> Описание работы с веб-интерфейсом приводится
по состоянию на момент написания документации.</p>

<p class="MsoListNumberCxSpFirst">1.  Войти
в Member Center (<a href="https://developer.apple.com/membercenter/index.action" target="_blank">https://developer.apple.com/membercenter/index.action</a>) от имени разработчика.</p>

<p class="MsoListNumberCxSpMiddle">2.  Перейти в раздел <span class="Interface">Certificates, Identifiers &amp; Profiles</span>.</p>

<p class="MsoListNumberCxSpMiddle">3.  Перейти
в раздел <span class="Interface">Identifiers</span>.</p>

<p class="MsoListNumberCxSpMiddle">4.  Зарегистрировать
iOS App ID для приложения (если оно еще не зарегистрировано в Member Center). При этом регистрируемый идентификатор должен совпадать с
полным идентификатором мобильного приложения, в которое планируется встраивать
работу с встроенными покупками. При создании iOS App ID следует убедиться, что разрешен сервис
<span class="Interface">In-App Purchase</span>.</p>

<p class="MsoListNumberCxSpLast">5.  Если
планируется использовать мобильную платформу разработчика для работы со
встроенными покупками, следует выполнить следующие действия:</p>

<p class="MsoListNumber2CxSpFirst">1.  Перейти в раздел <span class="Interface">Provisioning Profiles</span>.</p>

<p class="MsoListNumber2CxSpMiddle">2.  Создать
новый профиль обеспечения (provisioning profile).</p>

<p class="MsoListNumber2CxSpMiddle">3.  Указать,
что этот профиль предназначен для <span class="Interface">iOS App Development</span>.</p>

<p class="MsoListNumber2CxSpMiddle">4.  Указать
в качестве App ID именно тот iOS App ID, который создан на предыдущем шаге. Нельзя указывать на этом
шаге iOS Wildcard AppID.</p>

<p class="MsoListNumber2CxSpLast">5.  Созданный
профиль обеспечения в дальнейшем будет необходимо использовать в сборщике
мобильных приложений.</p>

<p class="MsoListNumberCxSpFirst">6.  Войти
в систему iTunes Connect (<a href="https://itunesconnect.apple.com" target="_blank">https://itunesconnect.apple.com</a>).</p>

<p class="MsoListNumberCxSpMiddle">7.  Перейти
в раздел <span class="Interface">Соглашения, налоги и банковские операции</span>.</p>

<p class="MsoListNumberCxSpMiddle">8.  Принять
соглашение <span class="Interface">Paid Application</span>. При этом необходимо указать информацию
о банковском счете, на который будут перечисляться заработанные средства.</p>

<p class="MsoListNumberCxSpMiddle">9.  Перейти
на закладку <span class="Interface">Функции</span>.</p>

<p class="MsoListNumberCxSpMiddle">10.  Перейти
в раздел <span class="Interface">Встроенные покупки</span> (открыт по умолчанию).</p>

<p class="MsoListNumberCxSpLast">11.  Новая
встроенная покупка добавляется с помощью кнопки «<span class="Interface">+</span>»,
расположенной справа от заголовка списка <span class="Interface">Встроенные покупки</span>.</p>

<a name="_ref441840200"></a><a id="TI000001804" class="bookmark" name="issogl4_25.4.12.4.3_google_play_in-app_billing"><h5>25.4.12.4.3. Google Play In-App Billing</h5></a>

<p class="Note"><span class="Note">Внимание!</span> Описание работы с веб-интерфейсом приводится
по состоянию на момент написания документации.</p>

<p class="MsoNormal">Для создания
встроенных покупок следует выполнить следующие шаги:</p>

<p class="MsoListNumberCxSpFirst">1.  Войти
в консоль разработчика Google Play (<a href="https://play.google.com/apps/publish/" target="_blank">https://play.google.com/apps/publish/</a>).</p>

<p class="MsoListNumberCxSpMiddle">2.  Создать
или найти мобильное приложение, в котором планируется реализовать работу с
встроенными покупками. На данном этапе следует собрать мобильное приложение,
для которого установлено разрешение Встроенные покупки, но может отсутствовать
функциональность работы с покупками. Сборку необходимо выполнять с помощью
сборщика мобильных приложений. Собранное приложение необходимо загрузить в
магазин приложений (в статусе альфа-версии).</p>

<p class="MsoListNumberCxSpMiddle">3.  Перейти
на страницу приложения.</p>

<p class="MsoListNumberCxSpMiddle">4.  На
странице приложения, в разделе <span class="Interface">Службы и API</span>
необходимо запомнить значение поля <span class="Interface">ЛИЦЕНЗИОННЫЙ КЛЮЧ ДЛЯ
ЭТОГО ПРИЛОЖЕНИЯ</span>. Это значение будет необходимо для выполнения проверки
квитанции встроенной покупки на стороне прикладного решения для персонального
компьютера.</p>

<p class="MsoListNumberCxSpMiddle">5.  Перейти
в раздел <span class="Interface">Контент для продажи</span>.</p>

<p class="MsoListNumberCxSpLast">6.  Новая
встроенная покупка добавляется с помощью кнопки <span class="Interface">+ Добавить продукт</span>.
Будьте внимательны при добавлении продуктов! Их невозможно удалить!</p>

<a id="TI000001805" class="bookmark" name="issogl3_25.4.12.5_тестирование_встроенных_покупок"><h4>25.4.12.5. Тестирование встроенных покупок</h4></a>

<a id="TI000001806" class="bookmark" name="issogl4_25.4.12.5.1_общая_информация"><h5>25.4.12.5.1. Общая информация</h5></a>

<p class="MsoNormal">Данный раздел содержит рекомендации по
тестированию работы со встроенными покупками. Рекомендации касаются особенностей
взаимодействия мобильного приложения (мобильной платформы) и сервиса встроенных
покупок.</p>

<a id="TI000001807" class="bookmark" name="issogl4_25.4.12.5.2_для_ос_ios"><h5>25.4.12.5.2. Для ОС iOS</h5></a>

<a id="TI000001808" class="bookmark" name="issogl5_общая_информация"><h6>Общая информация</h6></a>

<p class="MsoNormal">Тестирование работы с покупками для
мобильного приложения, работающего под управлением ОС iOS
можно разделить на две части:</p>

<p class="MsoListNumberCxSpFirst">1.  Тестирование
алгоритмов работы с покупками, их безошибочность и корректность реакции
мобильного приложения на выполненные покупки. Это тестирование выполняется с
помощью мобильной платформы разработчика и сервиса Apple In-App Purchase,
работающего в специальном (тестовом) режиме.</p>

<p class="MsoListNumberCxSpLast">2.  Финальное
тестирование, когда проверяется работа именно того мобильного приложения,
которое будет размещаться в магазине приложений. Покупки будут выполняться
через реальный сервис Apple In-App Purchase, но фактического списания денежных
средств выполняться не будет. Для тестирования используется специальная
программа TestFlight.</p>

<p class="MsoNormal">Дальше
будут подробнее рассмотрены оба тестирования.</p>

<a id="TI000001809" class="bookmark" name="issogl5_на_платформе_разработчика"><h6>На платформе разработчика</h6></a>

<p class="Note"><span class="Note">Внимание!</span> Описание работы с веб-интерфейсом приводится
по состоянию на момент написания документации.</p>

<p class="MsoNormalCxSpFirst">Первым шагом следует выполнить все операции
по предварительной настройке сервиса Apple In-App Purchase. При
настройке следует указывать тот идентификатор мобильного приложения, который
будет использовать для разрабатываемого приложения. Подробности настройки
сервиса см. <a href="#_ref441839441">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">После
выполнения настроек необходимо собрать мобильную платформу разработчика, указав
при ее сборке идентификатор мобильного приложения, который использовался при
настройке сервиса. Подробнее о создании мобильной платформы разработчика
см. <a href="#_ref441839541">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Затем
необходимо указать аккаунты пользователей, которые смогу тестировать встроенные
покупки в «песочнице» (sandbox). Для этого необходимо выполнить следующее:</p>

<p class="MsoListNumberCxSpFirst">1.  Войти
в систему iTunes Connect (<a href="https://itunesconnect.apple.com" target="_blank">https://itunesconnect.apple.com</a>).</p>

<p class="MsoListNumberCxSpMiddle">2.  Перейти
в раздел <span class="Interface">Пользователи и роли</span>.</p>

<p class="MsoListNumberCxSpMiddle">3.  Перейти
на закладку <span class="Interface">Тестировщики Sandbox</span>.</p>

<p class="MsoListNumberCxSpMiddle">4.  На
данной странице следует добавить электронную почту тех пользователей, которые
будут выполнять роль тестировщиков.</p>

<p class="MsoListNumberCxSpLast">5.  Аккаунты,
указанные в качестве тестировщиков, могут принимать участие в тестировании
продукта с использованием платформы разработчика.</p>

<a id="TI000001810" class="bookmark" name="issogl5_с_помощью_программы_testflight"><h6>С помощью программы TestFlight</h6></a>

<p class="Note"><span class="Note">Внимание!</span> Описание работы с веб-интерфейсом приводится
по состоянию на момент написания документации.</p>

<p class="MsoNormalCxSpFirst">Первым шагом следует выполнить все операции
по предварительной настройке сервиса Apple In-App Purchase. При
настройке следует указывать тот идентификатор мобильного приложения, который
будет использовать для разрабатываемого приложения. Подробности настройки
сервиса см. <a href="#_ref441839441">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Затем выполнить следующие операции:</p>

<p class="MsoListNumberCxSpFirst">1.  Войти
в систему iTunes Connect (<a href="https://itunesconnect.apple.com" target="_blank">https://itunesconnect.apple.com</a>).</p>

<p class="MsoListNumberCxSpMiddle">2.  Перейти
в раздел <span class="Interface">Пользователи и роли</span>.</p>

<p class="MsoListNumberCxSpMiddle">3.  Перейти
в раздел <span class="Interface">Мои приложения</span>.</p>

<p class="MsoListNumberCxSpMiddle">4.  Найти
приложение, которое планируется тестировать.</p>

<p class="MsoListNumberCxSpMiddle">5.  Загрузить
мобильное приложение, собранное с помощью сборщика мобильных приложений.</p>

<p class="MsoListNumberCxSpMiddle">6.  Перейти
в свойства мобильного приложения.</p>

<p class="MsoListNumberCxSpMiddle">7.  Перейти
в раздел <span class="Interface">TestFlight</span>.</p>

<p class="MsoListNumberCxSpMiddle">8.  Перейти
в раздел <span class="Interface">Внутреннее тестирование</span> (открыт по умолчанию).</p>

<p class="MsoListNumberCxSpMiddle">9.  Укажите,
кто из внутренних тестировщиков будет заниматься тестированием выбранного
мобильного приложения.</p>

<p class="MsoListNumberCxSpLast">10.  Аккаунты,
указанные в качестве тестировщиков, могут принимать участие в тестировании
продукта.</p>

<a id="TI000001811" class="bookmark" name="issogl4_25.4.12.5.3_для_ос_android"><h5>25.4.12.5.3. Для ОС Android</h5></a>

<a id="TI000001812" class="bookmark" name="issogl5_общая_информация1"><h6>Общая информация</h6></a>

<p class="MsoNormal">Тестирование работы с покупками для
мобильного приложения, работающего под управлением ОС Android
можно разделить на две части:</p>

<p class="MsoListNumberCxSpFirst">1.  Тестирование
алгоритмов работы с покупками, их безошибочность и корректность реакции
мобильного приложения на выполненные покупки. Это тестирование выполняется с
помощью мобильной платформы разработчика и сборщика мобильных приложений
(который предоставляет эмулятор системы Google Play In-App Billing).</p>

<p class="MsoListNumberCxSpLast">2.  Финальное
тестирование, когда проверяется работа именно того мобильного приложения, которое
будет размещаться в магазине приложений. Покупки будут выполняться через
реальный сервис Google Play In-App Billing, но фактического списания денежных
средств выполняться не будет.</p>

<p class="MsoNormal">Дальше
будут подробнее рассмотрены оба тестирования.</p>

<a id="TI000001813" class="bookmark" name="issogl5_на_платформе_разработчика1"><h6>На платформе разработчика</h6></a>

<p class="MsoNormalCxSpFirst">Платформа разработчика предоставляет
возможность выполнять тестирование работы с покупками без необходимости выполнять
сборку мобильного приложения. Для этого в свойствах информационной базы, на
которой будет осуществляться тестирование, следует заполнить свойства <span class="Interface">Адрес сервера покупок</span> и <span class="Interface">Идентификатор
пользователя</span>.</p>

<p class="MsoNormalCxSpMiddle">Инструменты,
предоставляемые компанией Google, для тестирования работы с покупками не позволяют
использовать для этой цели мобильную платформу разработчика. В связи с этим в
сборщике мобильных приложений реализован сервис, который эмулирует Google Play In-App Billing.</p>

<p class="MsoNormalCxSpMiddle">Для того чтобы воспользоваться этим
сервисом, необходимо опубликовать на веб-сервере HTTP-сервис
<span class="Interface">PurchasesTest</span>
(подробнее про публикацию на веб-сервере см. <a href="/db/v8310doc/bookmark/adm/TI000000451" target="_top">здесь</a>).
Адрес опубликованного HTTP-сервиса необходимо указать в свойстве информационной базы <span class="Interface">Адрес сервера покупок</span>.</p>

<p class="MsoNormalCxSpMiddle">В
сборщике следует завести пользователя, для которого выбрана роль <span class="Interface">Проверка покупок</span>.
Затем в сборщике мобильных приложений следует открыть специальный инструмент
для тестирования встроенных покупок (<span class="Interface">Рабочий стол – Сервис –
Тестирование встроенных покупок</span>).</p>

<p class="MsoNormalCxSpMiddle">В
поле <span class="Interface">Мобильное приложение</span> выбирается то мобильное приложения,
для которого будет выполняться тестирование встроенных покупок. Содержимое
остальных таблиц связано с выбранным приложением.</p>

<p class="MsoNormalCxSpMiddle">В
таблице <span class="Interface">Тестовые пользователи</span> предоставляется возможность
указать несколько пользователей, от имени которых будет тестироваться
выполнение встроенных покупок. Указание разных идентификаторов тестовых
пользователей в свойствах информационной базы на мобильном устройстве (свойство
<span class="Interface">Идентификатор пользователя</span>) позволит быстро проверять
работу с покупками от имени разных пользователей, работающих с мобильным
приложением.</p>

<p class="MsoNormalCxSpMiddle">В
таблице <span class="Interface">Доступные покупки</span> необходимо создать ровно тот список
покупок (особенно в части идентификаторов и типов покупок), который в
дальнейшем будет создаваться в консоли разработчика Google Play. При указании валюты покупки следует использовать буквенный
код валюты из стандарта ISO 4217 (<a href="http://www.iso.org/iso/ru/home/standards/currency_codes.htm" target="_blank">http://www.iso.org/iso/ru/home/standards/currency_codes.htm</a>).</p>

<p class="MsoNormalCxSpLast">В
таблице <span class="Interface">Совершенные покупки</span> имеется возможность создать
необходимую конфигурацию тестового окружения: какой пользователь, какие покупки
совершил, имеется возможность отключать приобретение покупки и т. д.</p>

<a id="TI000001814" class="bookmark" name="issogl5_собранное_приложение"><h6>Собранное приложение</h6></a>

<p class="Note"><span class="Note">Внимание!</span> Описание работы с веб-интерфейсом приводится
по состоянию на момент написания документации.</p>

<p class="MsoNormal">Первым шагом следует выполнить все операции
по предварительной настройке сервиса Google Play In-App Billing.
При настройке следует указывать тот идентификатор мобильного приложения,
который будет использовать для разрабатываемого приложения. Подробности
настройки сервиса см. <a href="#_ref441840200">здесь</a>.</p>

<p class="MsoListNumberCxSpFirst">1.  Войти
в консоль разработчика Google Play (<a href="https://play.google.com/apps/publish/" target="_blank">https://play.google.com/apps/publish/</a>).</p>

<p class="MsoListNumberCxSpMiddle">2. 
Перейти в раздел <span class="Interface">Настройки</span> (в
левой части экрана).</p>

<p class="MsoListNumberCxSpMiddle">3. 
В разделе <span class="Interface">Аккаунты Gmail
тестировщиков</span> указать адреса электронной почты тех прикладных
разработчиков, которые будут тестировать работу со встроенными покупками.
Указанные тут разработчики (или тестировщики) смогут выполнять покупки без
выполнения реальной оплаты, однако, при выполнении тестовой покупки будет
необходимо указывать данные реальной, платежеспособной банковской карты. С этой
карты будет выполнено тестовое списание (с последующим возвратом) небольшой
суммы (примерно 1 доллар США) для проверки корректности указанных данных.</p>

<p class="MsoListNumberCxSpLast">4. 
Аккаунты, указанные в качестве тестировщиков,
могут принимать участие в тестировании продукта.</p>

<a name="_ref451968771"></a><a id="TI000001864" class="bookmark" name="issogl2_25.4.13_характеристики_интернет-соединения"><h3>25.4.13. Характеристики интернет-соединения</h3></a>

<p class="MsoNormalCxSpFirst">При
использовании мобильного приложения часто возникают задачи обмена информацией с
внешней системой через Интернет. При этом может возникать задача выполнения
обмена только через определенные виды интернет-соединения или если используемое
интернет-соединение обладает достаточной пропускной способностью (скорость) для
выполнения обмена.</p>

<p class="MsoNormalCxSpMiddle">Мобильная
платформа позволяет определить параметры интернет-соединения, которое в данный
момент используется на мобильном устройстве. Получить эти параметры можно с
помощью свойства глобального контекста <span class="Term">ИнформацияОбИнтернетСоединении</span>.</p>

<p class="MsoNormalCxSpMiddle">Для
определения типа интернет-соединения используется метод этого объекта <span class="Term">ПолучитьТипСоединения()</span>. Система распознает
следующие типы интернет-соединения: подключение с помощью мобильного интернета
(GRPS, EDGE и т. д.), WiFi-соединение, подключение по локальной сети и отсутствие
интернет-соединения.</p>

<p class="MsoNormalCxSpMiddle">С
помощью метода <span class="Term">ПолучитьОжидаемуюСкоростьИнтернетСоединения()</span>
объекта <span class="Term">ИнформацияОбИнтернетСоединении</span>
можно выполнить оценку ожидаемой скорости текущего соединения. Если метод возвращает
значение 0, то это означает, что в данный момент доступ в Интернет отсутствует
на мобильном устройстве.</p>

<p class="MsoNormalCxSpMiddle">С
помощью метода <span class="Term">ИнформацияОбИнтернетСоединении.ПолучитьИспользованиеРоуминга()</span>
имеется возможность узнать, что устройство в момент вызова метода находится в
роуминге. Нахождение в роуминге может означать, что тарификация скачиваемых
данных с помощью мобильной сети передачи данных, существенно (в десятки раз!)
превышает таковую при нахождении в домашней сети. Если функция возвращает
значение <span class="Term">Неизвестно</span>,
то это означает, что тип используемого соединения не равен значению <span class="Term">ТипИнтернетСоединения.СотовыеДанные</span>.</p>

<p class="MsoNormalCxSpLast">Важной
особенностью инструментов работы с интернет-соединением в мобильной платформе
является возможность подключить специальный обработчик, который будет
срабатывать в следующих случаях:</p>

<p class="MsoListNumberCxSpFirst">1.  При
смене типа интернет-соединения. К такому случаю также относится ситуация, когда
на мобильном устройстве отключается любой доступ в Интернет, например
пользователь перевел устройство в «режим полета».</p>

<p class="MsoListNumberCxSpMiddle">2.  При
изменении ожидаемой скорости интернет-соединения при подключении с помощью
мобильного интернета. В этом случае фиксируется изменения используемого
стандарта мобильной сотовой связи, например, переход с сети стандарта 2G на сеть стандарта 3G и т. д.</p>

<p class="MsoListNumberCxSpLast">3.  При
изменении состояния роуминга для текущего мобильного устройства.</p>

<p class="MsoNormal">Для
подключения (или отключения) обработчика изменения интернет-соединения следует
использовать методы <span class="Term">ПодключитьОбработчикИзмененияИнтернетСоединения()</span>
(<span class="Term">ОтключитьОбработчикИзмененияИнтернетСоединения()</span>)
объекта <span class="Term">ИнформацияОбИнтернетСоединении</span>.</p>

<a id="TI000000915" class="bookmark" name="issogl1_25.5_взаимодействие_с_мобильным_устройством_при_разработке_мобильного_приложения"><h2>25.5. Взаимодействие с мобильным устройством при разработке мобильного приложения</h2></a>

<a id="TI000001649" class="bookmark" name="issogl2_25.5.1_общая_информация"><h3>25.5.1. Общая информация</h3></a>

<p class="MsoNormal">Помещение
мобильного приложения на мобильное устройство возможно двумя способами:</p>

<p class="MsoListBullet">&#9679; 
Через фирменный магазин приложений App Store (<a href="http://itunes.apple.com/ru/genre/ios" target="_blank">http://itunes.apple.com/ru/genre/ios</a>) или Google Play (<a href="http://play.google.com" target="_blank">http://play.google.com</a>). Данный способ используется для
распространения публичных версий мобильных приложений. Описание подготовки
прикладного решения к публикации см. <a href="#_ref336341992">здесь</a>.</p>

<p class="Indentlist">Подготовленное
к публикации прикладное решение одобряется и публикуется по правилам
соответствующего магазина приложений. Подробности этого процесса в данной книге
не рассматриваются.</p>

<p class="MsoListBullet">&#9679; 
С помощью версии мобильной платформы для
разработчика. Используется для разработки мобильных приложений. Далее будет
рассмотрен этот способ.</p>

<p class="MsoNormal">Для
того чтобы начать использовать мобильное приложение, необходимо выполнить
некоторые действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
На мобильное устройство должна быть установлена
мобильная платформа разработчика;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Мобильное приложение опубликовано на
веб-сервере;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
На мобильном устройстве создана информационная
база (приложение) на основе опубликованного мобильного приложения.</p>

<p class="MsoNormalCxSpFirst">После
выполнения этих операций получается готовая инфраструктура для разработки и
исполнения мобильного приложения на мобильном устройстве. При этом система
может быть настроена таким образом, что обновление конфигурации будет приводить
к тому, что мобильная платформа для разработчика автоматически обновит
конфигурацию на мобильном устройстве.</p>

<p class="MsoNormalCxSpLast">Далее
будет более подробно рассмотрено каждое действие.</p>

<a id="TI000000916" class="bookmark" name="issogl2_25.5.2_установка_мобильной_платформы_разработчика"><h3>25.5.2. Установка мобильной платформы разработчика</h3></a>

<a name="_ref335407095"></a><a name="_ref441839541"></a><a id="TI000000917" class="bookmark" name="issogl3_25.5.2.1_для_ос_ios"><h4>25.5.2.1. Для ОС iOS</h4></a>

<p class="MsoNormal">Для разработки мобильного приложения для ОС iOS необходимо
выполнить следующие требования:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Работа с мобильным устройством возможна только с
компьютера фирмы Apple (далее – Mac) с установленной операционной системой
OS X 10.8 и выше.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
На компьютере Mac должен быть один свободный
USB-порт, используемый для связи с мобильным устройством.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
На этом компьютере необходимо установить средство
разработки Xcode версии 4.5 и выше (<a href="https://developer.apple.com/xcode/" target="_blank">https://developer.apple.com/xcode/</a>).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Необходимо зарегистрироваться в программе iOS Developer Program (<a href="https://developer.apple.com/programs/ios/" target="_blank">https://developer.apple.com/programs/ios/</a>).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для работы необходимо мобильное устройство на
iOS, соответствующее системным требованиям (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000017" target="_top">здесь</a>).</p>

<p class="MsoNormal">Для установки мобильной платформы разработчика на мобильное
устройство, работающее под управлением iOS, необходимо выполнить следующие
действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Подключить мобильное устройство к компьютеру Mac;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Распаковать файл с проектом мобильной платформы prjios.zip на компьютере Mac;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Открыть проект мобильной платформы разработчика
в системе Xcode (двойным щелчком мыши по файлу 1cem.xcodeproj
или выбрать файл <span class="Interface">1cem.xcodeproj</span> с помощью команды <span class="Interface">File – Open</span> в системе Xcode);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Открыть инструмент <span class="Interface">Organizer</span> с
помощью команды меню Xcode <span class="Interface">Window – Organizer</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В открывшемся окне, в панели слева выбрать
подключенный телефон (отмечен зеленым маркером);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В панели снизу выбрать команду <span class="Interface">Add to Portal</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Средство <span class="Interface">Organizer</span> запросит необходимые для телефона сертификаты
и provisioning profile с сайта Apple и установит их
на телефон автоматически. Потребуется ввести пароль разработчика, полученный
при регистрации в iOS Developer Program.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
С помощью команды меню Xcode <span class="Interface">Product –
Edit Scheme…</span> необходимо открыть диалог настроек текущей схемы запуска. В
открывшемся диалоге:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
В свойстве <span class="Interface">Scheme</span> выбрать значение <span class="Interface">1cem</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
В свойстве <span class="Interface">Destination</span>
выбрать подключенный телефон;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
В свойстве <span class="Interface">Build
configuration</span> выбрать значение <span class="Interface">Release</span>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Нажать кнопку <span class="Interface">OK</span>.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Запустить проект с помощью команды меню Xcode <span class="Interface">Product – Run</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Мобильная платформа будет передана на мобильное
устройство, запущена и ее иконка появится в списке установленных приложений
мобильного устройства.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Мобильное устройство можно отключить от
компьютера Mac и далее запускать мобильную платформу нажатием на иконку
«1С:Предприятие» в списке приложений мобильного устройства. Если в момент
отключения на мобильном устройстве была запущена мобильная платформа
разработчика, которая запущена с помощью Xcode, то она будет остановлена.</p>

<a name="_ref374529681"></a><a id="TI000000918" class="bookmark" name="issogl3_25.5.2.2_для_ос_android"><h4>25.5.2.2. Для ОС Android</h4></a>

<p class="MsoNormal">Для
разработки мобильного приложения для ОС Android необходимо выполнить следующие требования:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Установить на компьютере Android Studio (<a href="http://developer.android.com/studio/index.html" target="_blank">http://developer.android.com/studio/index.html</a>). Для работы платформы разработчика
необходимо, чтобы на компьютере был установлен <span class="Interface">Android </span><span class="Interface">SDK </span><span class="Interface">Platform-</span><span class="Interface">tools</span> версии не ниже 14.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Проверить, что нужные компоненты установлены,
можно с помощью утилиты <span class="Interface">SDK Manager.exe</span>,
которая находится в каталоге, в который был установлен Android SDK.</p>

<p class="Picture"><IMG src="_img/img00479.gif?_=1496848987" WIDTH="800" ALT HEIGHT="634"></p>

<p class="MsoCaption"><a name="_ref422827146">Рис. </a>471. Настройка
Android SDK для разработчика</p>

<p class="Indentlist">Для
нормальной работы с платформой разработчика необходимо установить <span class="Interface">Android SDK Platform-tools</span>
(пример на <a href="#_ref422827146">рис.471</a>). Версия инструмента можно посмотреть в колонке <span class="Interface">Rev</span>. На рисунке
будет выполнена установка версии 22, что удовлетворяет требованиям (версия не
ниже 14). После выбора компонент следует нажать кнопку <span class="Interface">Install X package…</span>
и согласиться с лицензионным соглашением.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
На компьютере должен быть один свободный
USB-порт, используемый для связи с мобильным устройством.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для работы необходимо мобильное устройство на Android, соответствующее системным требованиям (подробнее
см. <a href="/db/v8310doc/bookmark/adm/TI000000017" target="_top">здесь</a>).</p>

<p class="MsoNormal">Для
установки мобильной платформы разработчика на мобильное устройство, работающее
под управлением Android,
необходимо выполнить следующие действия:</p>

<p class="MsoListBullet">&#9679; 
В настройках мобильного устройства необходимо
установить следующие флажки:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Interface">Неизвестные источники</span>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Interface">Отладка через USB</span>;</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Скачать с сайта производителя и установить на
компьютер USB-драйвер мобильного устройства;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Подключить мобильное устройство к компьютеру;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
С помощью интерпретатора командной строки ОС Windows выполнить команду:</p>

<p class="Lang-subheader">Пример
для ARM-платформы:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">%ANDROID_SDK%\platform<span class="operator">-</span>tools\adb<span class="operator">.</span>exe install <span class="operator">-</span>r <span class="string">&quot;&lt;Каталог платформы&gt;\1cem-arm.apk&quot;</span></pre>

<p class="Lang-subheader">Пример
для x86-платформы:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">%ANDROID_SDK%\platform<span class="operator">-</span>tools\adb<span class="operator">.</span>exe install <span class="operator">-</span>r <span class="string">&quot;&lt;Каталог платформы&gt;\1cem-x86.apk&quot;</span></pre>

<p class="Indentlist">Где,
<span class="Interface">Каталог платформы</span> – каталог, в котором расположен соответствующий
файл с мобильной платформой. Если мобильная платформа уже установлена на мобильное
устройство, то данная команда выполнит ее переустановку.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Мобильная платформа будет передана на мобильное
устройство и ее иконка появится в списке установленных приложений.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Мобильное устройство можно отключить от
компьютера и далее запускать мобильную платформу нажатием на иконку «1С:Предприятие» в списке приложений мобильного
устройства.</p>

<p class="MsoNormal">Для
установки мобильной платформы разработчика можно воспользоваться командой
конфигуратора <span class="Interface">Главное меню – Конфигурация – Мобильное
приложение – Использование Android debug bridge – Установить
мобильную платформу</span>. В этом случае надо будет выполнить дополнительную
настройку конфигуратора (подробнее см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 33. сервисные возможности.htm?_=1496848987#_ref374531917">здесь</a>). С установку мобильной платформы можно выполнить или
на физическое мобильное устройство, подключенное к компьютеру или на эмулятор
устройства, созданный с помощью менеджера виртуальных устройств Android (<span class="Interface">AVD Manager.exe</span>,
входит в состав Android SDK).</p>

<a name="_ref335923589"></a><a name="_ref431284343"></a><a id="TI000001736" class="bookmark" name="issogl3_25.5.2.3_для_ос_windows"><h4>25.5.2.3. Для ОС Windows</h4></a>

<a name="_ref453150156"></a><a id="TI000001737" class="bookmark" name="issogl4_25.5.2.3.1_ос_windows_phone"><h5>25.5.2.3.1. ОС Windows Phone</h5></a>

<p class="MsoNormal">Для разработки мобильного приложения для ОС
Windows необходимо выполнить следующие требования:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Работа с мобильным устройством возможна только с
компьютера с установленной операционной системой Windows 8.1 и выше.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
На компьютере должен быть один свободный
USB-порт, используемый для связи с мобильным устройством.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Необходимо иметь учетную запись Microsoft (<a href="https://login.live.com/" target="_blank">https://login.live.com/</a>).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
На этом компьютере необходимо установить средство
разработки Microsoft Visual Studio Commnunity 2015 и выше (<a href="https://dev.windows.com/en-us/downloads" target="_blank">https://dev.windows.com/en-us/downloads</a>).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При установке средства разработки необходимо
выбрать компоненту <span class="Interface">Инструменты Windows 8.1 и Windows Phone 8.0/8.1</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для работы необходимо мобильное устройство на
Windows Phone, соответствующее системным требованиям (подробнее
см. <a href="/db/v8310doc/bookmark/adm/TI000000017" target="_top">здесь</a>).</p>

<p class="MsoNormal">Для установки мобильной платформы разработчика
на мобильное устройство, работающее под управлением Windows, необходимо
выполнить следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Подключить мобильное устройство к компьютеру;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Запустить приложение <span class="Interface">Windows Phone
Developer Registration 8.1</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выбрать подключенное устройство и нажать кнопку <span class="Interface">Register</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Извлечь из файла поставки мобильной платформы (<span class="Interface">mobile.zip</span>) файл с дистрибутивом платформы для
мобильного телефона нужной архитектуры (файлы <span class="Interface">1cem-phone-arm.appx</span> или <span class="Interface">1cem-phone-x86.appx</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Запустить приложение <span class="Interface">Windows Phone Application
Deployment 8.1</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В запустившемся приложении следует выбрать
подключенное устройство, файл с мобильной платформой и нажать кнопку <span class="Interface">Deploy</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Мобильная платформа будет передана на мобильное
устройство, запущена и ее иконка появится в списке установленных приложений
мобильного устройства.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Мобильное устройство можно отключить от
компьютера и далее запускать мобильную платформу нажатием на иконку
«1С:Предприятие» в списке приложений мобильного устройства.</p>

<a id="TI000001738" class="bookmark" name="issogl4_25.5.2.3.2_ос_windows_на_сенсорных_устройствах"><h5>25.5.2.3.2. ОС Windows на сенсорных устройствах</h5></a>

<p class="MsoNormal">Для разработки мобильного приложения для ОС
Windows необходимо выполнить следующие требования:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Работа с мобильным устройством возможна только с
компьютера с установленной операционной системой Windows 8.1 и выше.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Необходимо иметь учетную запись Microsoft (<a href="https://login.live.com/" target="_blank">https://login.live.com/</a>).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для работы необходимо устройство на Windows (планшет
или компьютер с сенсорным экраном), соответствующее системным требованиям
(подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000017" target="_top">здесь</a>).</p>

<p class="MsoNormal">Для установки мобильной платформы
разработчика на устройство, работающее под управлением Windows, необходимо выполнить
следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Скопировать на устройство файл поставки
мобильной платформы (<span class="Interface">mobile.zip</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Извлечь из файла поставки мобильной платформы (<span class="Interface">mobile.zip</span>) файл сертификата (файл <span class="Interface">1cem.cer</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Установить сертификат в хранилище <span class="Interface">Доверенные люди</span> на локальной машине;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Извлечь из файла поставки мобильной платформы (<span class="Interface">mobile.zip</span>) файл с дистрибутивом платформы для компьютера
нужной архитектуры (файлы <span class="Interface">1cem-x64.appx</span> или <span class="Interface">1cem-x86.appx</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Запустить PowerShell от имени администратора
(прав администратора системы недостаточно);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Выполнить команду</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">Show-WindowsDeveloperLicenseRegistration</pre>

<p class="Indentlist">, а затем в открывшемся окне указать данные
учетной записи Microsoft;</p>

<p class="MsoListBullet">&#9679; 
Выполнить команду:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">Add-AppxPackage &lt;Каталог&gt;\1cem-&lt;arch&gt;.appx</pre>

<p class="Indentlist">, где:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Interface">&lt;Каталог&gt;</span> –
каталог, в который помещена мобильная платформа разработчика;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Interface">&lt;arch&gt;</span> –
архитектура устройства (<span class="Interface">x86</span> или <span class="Interface">x64</span>).</p>

<p class="MsoListBullet">&#9679; 
В дальнейшем запускать мобильную платформу разработчика
можно нажатием на иконку «1С:Предприятие» в списке приложений.</p>

<a name="_ref374633853"></a><a id="TI000000919" class="bookmark" name="issogl2_25.5.3_публикация_мобильного_приложения_на_веб-сервере"><h3>25.5.3. Публикация мобильного приложения на веб-сервере</h3></a>

<p class="MsoNormal">Чтобы
мобильное приложение было доступно мобильной платформе, необходимо выполнить
публикацию мобильного приложения на веб-севере. Фактически, публикация делится
на две части:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Подготовка инфраструктуры для работы и начальная
выгрузка конфигурации мобильного приложения – выполняется один раз.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Обновление конфигурации мобильного приложения в
подготовленной инфраструктуре.</p>

<p class="MsoNormal">Для
подготовки инфраструктуры служит команда <span class="Interface">Конфигурация – Мобильное
приложение – Публиковать…</span>. В открывшемся диалоге следует указать
флажок Создавать виртуальный
каталог на веб-сервере. Если флажок не установлен, то будут недоступны
реквизиты <span class="Interface">Имя</span> и <span class="Interface">Каталог</span>, а
также при нажатии кнопки <span class="Interface">Опубликовать</span> не
будет выполняться создание виртуального каталога на веб-сервере.</p>

<p class="Note"><span class="Note">Внимание!</span> Для выполнения публикации требуются
административные права.</p>

<p class="Picture"><IMG src="_img/img00480.gif?_=1496848987" WIDTH="543" ALT HEIGHT="190"></p>

<p class="MsoCaption">Рис.
472. Публикация мобильного приложения</p>

<p class="MsoNormal">Затем
указать свойства виртуального каталога веб-сервера:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Имя</span> – определяет
имя виртуального каталога. Это имя будет участвовать в URL конфигурации
мобильного приложения для указания на мобильном устройстве при создании
информационной базы.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Веб-сервер</span> – определяет
используемый веб-сервер. Если используется веб-сервер Microsoft Internet Information Services, то становится возможным указание флажка <span class="Interface">Использовать
аутентификацию операционной системы на веб-сервере</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Каталог</span> – указывает
физический каталог на диске, в котором будет находиться файл конфигурации мобильного
приложения в формате <span class="Interface">.xml</span> и куда будет отображен
виртуальный каталог веб-сервера.</p>

<p class="MsoNormalCxSpFirst">Флажок
Обновлять мобильное
приложение при обновлении конфигурации базы данных управляет возможностью автоматического
обновления конфигурации мобильного приложения при обновлении конфигурации базы
данных. Если флажок установлен – обновление будет выполняться.</p>

<p class="MsoNormalCxSpLast">Операцию
обновления конфигурации также можно выполнить принудительно, с помощью команды <span class="Interface">Конфигурация – Мобильное
приложение – Обновить публикуемое приложение</span>. Если к моменту вызова данной
команды публикация мобильного приложения не выполнялась – будет открыт
диалог публикации, описанный выше.</p>

<p class="Note"><span class="Note">Внимание!</span> На веб-сервере публикуется конфигурация базы
данных, а не редактируемая конфигурация.</p>

<p class="MsoNormal">Для
выполнения собственно публикации необходимо нажать кнопку <span class="Interface">Опубликовать</span>.
При этом выполняются следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Если установлен флажок <span class="Interface">Создавать виртуальный
каталог на веб-сервере</span>, то создается виртуальный каталог на веб-сервере;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Создается каталог на диске, в который отображается
виртуальный каталог;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Предлагается выгрузить конфигурацию мобильного
приложения в каталог (указанный в реквизите <span class="Interface">Каталог</span> диалога
публикации);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Проверяется, соответствует конфигурация базы
данных редактируемой конфигурации или нет;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если конфигурация информационной базы не соответствует
редактируемой конфигурации – предлагается выполнить обновление
конфигурации базы данных. Однако эту операцию можно не выполнять, если
требуется опубликовать именно конфигурацию базы данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выполняется проверка мобильного приложения (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 27. инструменты разработки.htm?_=1496848987#_ref335326060">здесь</a>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если ошибок нет, то выполняется выгрузка
конфигурации информационной базы в файл, в противном случае выгрузка не
производится.</p>

<p class="MsoNormal">Файл
с конфигурацией мобильного приложения, выгруженный с помощью команды <span class="Interface">Публиковать…</span>,
имеет фиксированное имя <span class="Interface">1cema.xml</span>.
Поиск (и обновление) именно этого файла выполняется при выполнении команды <span class="Interface">Обновить публикуемое
приложение.</span></p>

<p class="Note"><span class="Note">Совет.</span> При создании виртуального каталога, файл
конфигурации (<span class="Interface">1cema.xml</span>) устанавливается в
качестве его (каталога) страницы по умолчанию. Это позволяет в диалоге создания
информационной базы на мобильном устройстве указывать URL в сокращенном виде.</p>

<p class="MsoNormal">Кнопка
<span class="Interface">Отключить</span> диалога публикации мобильного приложения выполняет
отмену публикации: удаляет виртуальный каталог на веб-сервере и физический
каталог.</p>

<a name="_ref335927974"></a><a name="_ref374622217"></a><a name="_ref374622216"></a><a id="TI000000920" class="bookmark" name="issogl2_25.5.4_запуск_и_перезапуск_приложения_на_мобильной_платформе"><h3>25.5.4. Запуск и перезапуск приложения на мобильной платформе</h3></a>

<a id="TI000001324" class="bookmark" name="issogl3_25.5.4.1_общая_информация"><h4>25.5.4.1. Общая информация</h4></a>

<p class="MsoNormalCxSpFirst">Запуск
мобильного приложения осуществляется непосредственно на мобильном устройстве
или из конфигуратора. На устройстве должна быть установлена мобильная платформа
разработчика.</p>

<p class="MsoNormalCxSpLast">Запуск
из конфигуратора возможен при одновременном выполнении двух условий: разработка
выполняется с использованием ОС Android и выполнена соответствующая настройка
конфигуратора (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 33. сервисные возможности.htm?_=1496848987#_ref374531917">здесь</a>).</p>

<a name="_ref459655890"></a><a id="TI000001325" class="bookmark" name="issogl3_25.5.4.2_перезапуск_мобильного_приложения_опубликованного_на_веб-сервере"><h4>25.5.4.2. Перезапуск мобильного приложения, опубликованного на веб-сервере</h4></a>

<p class="MsoNormalCxSpFirst">Если мобильное приложение запущено с помощью мобильной платформы
разработчика и для приложения установлен флажок <span class="Interface">Перезапуск из
конфигуратора</span> (см. <a href="#_ref335927440">здесь</a>), то существует возможность перезапускать мобильное
приложение из конфигуратора. Это можно сделать с помощью команды главного меню <span class="Interface">Отладка – Начало отладки –
Мобильное приложение: запустить</span>.</p>

<p class="MsoNormalCxSpMiddle">Если
конфигурация была модифицирована (были произведены изменения), то конфигуратор
выводит вопрос: <span class="Interface">Редактируемая
конфигурация отличается от конфигурации базы данных. Произвести обновление
конфигурации базы данных?</span> Для сохранения внесенных изменений следует
выбрать кнопку <span class="Interface">Да</span>.</p>

<p class="MsoNormalCxSpMiddle">Если
выбрана кнопка <span class="Interface">Нет</span>, то мобильное
приложение будет перезапущено без обновления конфигурации.</p>

<p class="MsoNormalCxSpMiddle">Если
при публикации мобильного приложения был установлен флажок <span class="Interface">Обновлять мобильное
приложение при обновлении конфигурации базы данных</span>, то будет выполнено
автоматическое обновление публикации конфигурации мобильного приложения.</p>

<p class="MsoNormalCxSpMiddle">Используемые
в конфигурации внешние компоненты также будут размещены в каталоге, на который
отображается виртуальный каталог веб-сервера. Будут копироваться только те
файлы внешней компоненты, которые предназначены для использования на ОС Android и iOS (если таковые существуют в составе архива с внешней
компонентой).</p>

<p class="MsoNormalCxSpLast">Мобильное
приложение выполняет проверку обновления при открытии в том случае, если
установлен флажок <span class="Interface">Перезапуск из
конфигуратора</span> в свойствах мобильного приложения на мобильном устройстве.
Если этот флажок сброшен, то при открытии наличие обновлений не проверяется.
Однако такую проверку можно выполнить вручную (см. <a href="#_ref335927440">здесь</a>).</p>

<a name="_ref459648773"></a><a id="TI000001326" class="bookmark" name="issogl3_25.5.4.3_запуск_и_перезапуск_мобильного_приложения_при_использовании_android_debug_bridge"><h4>25.5.4.3. Запуск и перезапуск мобильного приложения при использовании Android debug bridge</h4></a>

<p class="MsoNormalCxSpFirst">Запуск
и перезапуск мобильного приложения можно выполнять с помощью конфигуратора. Это
можно сделать с помощью команды главного меню <span class="Interface">Отладка – Начало
отладки – Мобильное приложение: запустить</span>. Чтобы при этом
использовался Android Debug Bridge,
конфигуратора должен быть соответствующим образом настроен (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 33. сервисные возможности.htm?_=1496848987#_ref374531917">здесь</a>). Кроме того, конфигурация должна быть опубликована в
файловой системе (публикация на веб-сервере в этом случае не является
обязательной) (см. <a href="#_ref374633853">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Если
конфигурация была модифицирована (были произведены изменения), то конфигуратор
выводит вопрос: <span class="Interface">Редактируемая конфигурация отличается от
конфигурации базы данных. Произвести обновление конфигурации базы данных?</span>
Для сохранения внесенных изменений следует выбрать кнопку <span class="Interface">Да</span>.</p>

<p class="MsoNormalCxSpMiddle">Если
выбрана кнопка <span class="Interface">Нет</span>, то мобильное приложение будет
перезапущено без обновления конфигурации.</p>

<p class="MsoNormalCxSpMiddle">Если
при публикации мобильного приложения был установлен флажок <span class="Interface">Обновлять мобильное
приложение при обновлении конфигурации базы данных</span>, то будет выполнено
автоматическое обновление публикации конфигурации мобильного приложения.</p>

<p class="MsoNormalCxSpMiddle">При
работе с помощью Android Debug Bridge,
используемые в конфигурации внешние компоненты также будут скопированы на
используемое мобильное устройство. Будут копироваться только те файлы внешней
компоненты, которые предназначены для использования на ОС Android (если таковые существуют в составе архива с внешней
компонентой).</p>

<p class="MsoNormalCxSpLast">После
перезапуска мобильной платформы разработчика будет обнаружена новая
конфигурация и будет выдано предложение выполнить обновление.</p>

<a name="_ref427338390"></a><a id="TI000001716" class="bookmark" name="issogl2_25.5.5_отладка_мобильного_приложения"><h3>25.5.5. Отладка мобильного приложения</h3></a>

<p class="MsoNormalCxSpFirst">Отладка
мобильного приложение возможна только при использовании протокола отладки HTTP.
Мобильное приложение, функционирующее под управлением ОС Android, можно
запускать в режиме отладки непосредственно из конфигуратора, с использованием Android Debug Bridge (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 33. сервисные возможности.htm?_=1496848987#_ref374531917">здесь</a>). Мобильное приложение, функционирующее под
управлением ОС iOS или ОС Windows, нельзя запустить в режиме отладки
непосредственно из конфигуратора. Подробное описание настройки мобильных
приложений см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 28. отладка и тестирование прикладных решений.htm?_=1496848987#_ref427322135">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Для
отладки приложения используются два параметра в свойствах информационной базы
мобильного приложения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Отладка разрешена</span> –
указывает, будет в данном мобильном приложении разрешена отладка или не будет.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Адрес отладки</span> –
указывает расположение сервера отладки, если отладка разрешена.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Вышеописанные параметры игнорируются в том
случае, если:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
информационная база запускается непосредственно
из конфигуратора – в этом случае в качестве адреса сервера отладки
выступает адрес конфигуратора, выполняющего запуск мобильного приложения,
применимо только для работы через Android Debug Bridge;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
для конфигурации установлен флажок <span class="Interface">Перезапуск из
конфигуратора</span> – в этом случае адрес сервера отладки получается из
публикации мобильного приложения.</p>

<a id="TI000000921" class="bookmark" name="issogl2_25.5.6_управление_приложениями_на_мобильной_платформе_разработчика"><h3>25.5.6. Управление приложениями на мобильной платформе разработчика</h3></a>

<a id="TI000000922" class="bookmark" name="issogl3_25.5.6.1_создание_приложения"><h4>25.5.6.1. Создание приложения</h4></a>

<p class="MsoNormal">Для
того чтобы создать приложение на мобильной платформе разработчика, следует:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Запустить «1С:Предприятие» на мобильном
устройстве;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выбрать команду добавления приложения;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В открывшемся окне ввести URL веб-сервера, на
котором опубликовано мобильное приложение (см. <a href="#_ref335923589">здесь</a>) в поле <span class="Interface">Адрес</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При необходимости, следует указать имя
пользователя и пароль для авторизации на веб-сервере, на котором опубликовано
мобильное приложение и нажмите кнопку <span class="Interface">Загрузить</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Затем следует указать имя приложения и нажать
кнопку <span class="Interface">Готово</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
После закрытия окна будет создано приложение.</p>

<p class="MsoNormal">Список
приложений будет пропущен, и будет сразу запущено приложение, если оно в списке
единственное. В этом случае для перехода в список приложений следует выбрать
команду <span class="Interface">Список приложений</span> в главном меню приложения.</p>

<a name="_ref335927440"></a><a name="_ref431284204"></a><a id="TI000000923" class="bookmark" name="issogl3_25.5.6.2_изменение_свойств_приложения"><h4>25.5.6.2. Изменение свойств приложения</h4></a>

<p class="MsoNormal">Свойства
приложения изменяются в специальном окне. В зависимости от операционной
системы, доступ к этой команде выполняется по-разному:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Для ОС iOS: в правой части строки с именем
нужного приложения нажмите картинку с изображением знака больше.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для ОС Android: выполните длинное нажатие (или
жест с правой стороны экрана) на нужном приложении. В открывшемся контекстном
меню выберите команду <span class="Interface">Изменить</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для ОС Windows: выполните длинное нажатие (или
жест с правой стороны экрана) на нужном приложении. В открывшемся контекстном
меню выберите команду <span class="Interface">Изменить</span>.</p>

<p class="MsoNormalCxSpFirst">В
открывшемся окне можно изменять свойства приложения, которые указывались при
его создании: наименование приложения, URL расположения конфигурации, имя и
пароль пользователя для доступа к веб-серверу, на котором располагается
конфигурация мобильного приложения.</p>

<p class="MsoNormalCxSpLast">Также
в этом окне можно выполнить следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Запустить мобильное приложение. Для этого
необходимо нажать кнопку <span class="Interface">Открыть</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Проверить наличие новой версии конфигурации
мобильного приложения на веб-сервере. Для этого необходимо нажать кнопку <span class="Interface">Проверить обновления</span>.
В случае наличия новой версии конфигурации будет предложено выполнить
обновление мобильного приложения.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Удалить приложение с помощью кнопки <span class="Interface">Удалить</span>.</p>

<p class="Note"><span class="Note">Внимание!</span> После удаления приложения, данные
информационной базы восстановить невозможно.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Настроить возможность автоматического обновления
и перезапуска мобильного приложения в случае, если на веб-сервере будет обнаружена
новая версия конфигурации (см. <a href="#_ref335927974">здесь</a>). Для этого следует изменить состояние флажка Перезапуск из конфигуратора.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Настроить возможность отладки (флажок <span class="Interface">Отладка разрешена</span>)
и указать адрес отладчика (в поле <span class="Interface">Адрес отладчика</span>).
Подробнее про отладку см. <a href="#_ref427338390">здесь</a>.</p>

<p class="MsoNormal">Список
приложений будет пропущен, и будет сразу запущено приложение, если оно в списке
единственное. В этом случае для перехода в список приложений следует выбрать
команду <span class="Interface">Список приложений</span> в главном меню приложения.</p>

<a name="_ref431284224"></a><a id="TI000000924" class="bookmark" name="issogl3_25.5.6.3_удаление_приложения"><h4>25.5.6.3. Удаление приложения</h4></a>

<p class="MsoNormal">Для
удаления приложения следует выбрать команду <span class="Interface">Удалить</span> и
подтвердить свое действие. В зависимости от
операционной системы, доступ к этой команде выполняется по-разному:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Для ОС iOS: нажмите кнопку <span class="Interface">Изменить</span>, затем
нажмите картинку в левой части строки с именем удаляемого приложения. Затем
в правой части этой же строки нажмите кнопку <span class="Interface">Удалить</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для ОС Android: выполните длинное нажатие (или
жест с правой стороны экрана) на нужном приложении. В открывшемся контекстном
меню выберите команду <span class="Interface">Удалить</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для ОС Windows: выполните длинное нажатие (или
жест с правой стороны экрана) на нужном приложении. В открывшемся контекстном
меню выберите команду <span class="Interface">Удалить</span>.</p>

<p class="MsoNormal">Список приложений будет пропущен, и будет
сразу запущено приложение, если оно в списке единственное. В этом случае для
перехода в список приложений следует выбрать команду <span class="Interface">Список приложений</span> в главном меню приложения.</p>

<p class="Note"><span class="Note">Внимание!</span> После удаления
приложения, данные информационной базы восстановить невозможно.</p>

<a name="_ref356470647"></a><a name="_ref356470646"></a><a name="_ref375234121"></a><a name="_ref375234120"></a><a id="TI000000925" class="bookmark" name="issogl2_25.5.7_сборка_мобильного_приложения_перед_публикацией_в_магазине_приложений"><h3>25.5.7. Сборка мобильного приложения перед публикацией в магазине приложений</h3></a>

<p class="MsoNormal">Мобильное
приложение, предназначенное для публикации в магазине приложений, состоит из
мобильной платформы и мобильного приложения и дополнительных файлов (иконок,
логотипов и т. д.), «упакованные» в один контейнер. Этот файл можно
установить на мобильное устройство.</p>

<p class="Regularbeforepicture">Для
формирования мобильного приложения предназначена специальная конфигурация (<span class="Interface">Сборщик мобильных
приложений</span>), которая входит в состав дистрибутива мобильной платформы.
Конфигурация предоставляет следующие возможности:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Хранить разные версии мобильных конфигураций. Сборщик
позволяет загружать как мобильные конфигурации без внешних компонент (<span class="Interface">1cema.xml</span>), так
и мобильные конфигурации с включенными внешними компонентами (<span class="Interface">1cema.zip</span>).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Хранить разные пакеты графической информации
(иконки и заставки).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Хранить разные версии мобильной платформы.
Сборщик мобильных приложений работает с мобильной платформой версии 8.3.4 и
старше. Работа с предыдущими версиями мобильной платформы не поддерживается.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Собирать и хранить собственно мобильные
приложения.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Сборка для ОС Android выполняется как для
архитектуры ARM, так и для архитектуры x86.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При наличии компьютера Apple, подключенного к сети, в которой развернут сборщик
мобильных приложений, имеется возможность выполнять полный цикл сборки
мобильного приложения для ОС iOS – с автоматически созданием пакета приложения
(<span class="Interface">.ipa</span>).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Сборка для ОС Windows выполняется как для ОС
Windows Phone, так и для ОС Windows (приложение для распространения через
Windows Store).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Выполнять публикацию собранных мобильных
приложений в соответствующих магазинах приложений непосредственно из сборщика
(только для iOS и Android).</p>

<p class="MsoNormalCxSpFirst">В
том случае, если собираемое мобильное приложение включает внешние компоненты,
то будут собраны мобильные приложения только для тех мобильных ОС, для которых
существуют внешние компоненты. Другими словами, если к мобильной конфигурации
подключена внешняя компонента, которая собрана для ОС iOS и Android,
то такое мобильное приложение не будет собрано для ОС Windows.</p>

<p class="MsoNormalCxSpLast">Результатом
работы сборщика выступают следующие объекты:</p>

<p class="MsoListNumberCxSpFirst">1.  Мобильное
приложение для ОС Android (архитектура ARM);</p>

<p class="MsoListNumberCxSpMiddle">2.  Мобильное
приложение для ОС Android (архитектура x86);</p>

<p class="MsoListNumberCxSpMiddle">3.  Проект
мобильного приложения для сборки на компьютере Apple (.zip-файл);</p>

<p class="MsoListNumberCxSpMiddle">4.  Пакет
приложения для ОС iOS (.ipa-файл). Файл с пакетом приложения формируется в том
случае, если в сборщике мобильных приложений настроены параметры соединения с
компьютером Mac, который может выполнять сборку пакета приложений;</p>

<p class="MsoListNumberCxSpMiddle">5.  Мобильное
приложение для ОС Windows Phone (архитектура ARM, .appx-файл);</p>

<p class="MsoListNumberCxSpMiddle">6. 
Мобильное приложение для ОС Windows Phone
(архитектура x86, .appx-файл);</p>

<p class="MsoListNumberCxSpMiddle">7. 
Мобильное приложение для магазина приложений ОС
Windows (архитектура x86, .appx-файл);</p>

<p class="MsoListNumberCxSpLast">8.  Мобильное
приложение для магазина приложений ОС Windows (архитектура x64, .appx-файл).</p>

<p class="MsoNormal">Для
того чтобы сборщик мобильных приложений мог выполнять какие-либо действия на
стороне компьютера Apple,
его необходимо настроить. Для этого необходимо выполнить следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Установить все доступные обновления OS X;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Установить программу Xcode. Получить пакет можно
здесь: <a href="https://developer.apple.com/xcode/" target="_blank">https://developer.apple.com/xcode/</a>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Скачать и установить в связку ключей <span class="Interface">Система</span>
сертификат <span class="Interface">Apple Worldwide Developer Relations</span> (<a href="http://developer.apple.com/certificationauthority/AppleWWDRCA.cer" target="_blank">http://developer.apple.com/certificationauthority/AppleWWDRCA.cer</a>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
С помощью средств портала разработчика Apple
создать и установить в связку ключей <span class="Interface">Система</span>
сертификат дистрибуции для Apple AppStore или для корпоративного
распространения:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Для этого потребуется создание личного ключа
средствами связки ключей;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
Следует обратить внимание на то, что все личные
ключи и сертификаты должны располагаться в связке <span class="Interface">Система</span>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
После создания личного ключа, на вкладке <span class="Interface">Доступ</span> диалога
свойств ключа установить настройку <span class="Interface">Разрешить всем программам
получать доступ к этому объекту</span>.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
С помощью вкладки <span class="Interface">Accounts</span>
настроек Xcode установить provisioning profile, соответствующий сертификату дистрибуции;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В настройках <span class="Interface">Общий доступ</span>,
системных настроек компьютера Mac, необходимо разрешить режим <span class="Interface">Удаленный вход</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Здесь же следует получить имя компьютера,
которое затем указать в настройках сборщика мобильного приложения.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Также следует убедиться, что IP-порт номер 22 (SSH)
компьютера Apple доступен
для компьютера, на котором функционирует серверная часть сборщика мобильных
приложений.</p>

<p class="MsoNormal">Сборка
мобильного приложения выполняется на стороне сервера. На компьютере (или
компьютерах), на котором исполняется серверная часть «1С:Предприятия», должно
быть установлено следующее программное обеспечение:</p>

<p class="MsoListNumberCxSpFirst">1.  Пакет
Android Stuido. Пакет можно скачать отсюда: <a href="http://developer.android.com/studio/index.html" target="_blank">http://developer.android.com/studio/index.html</a>.</p>

<p class="MsoListNumberCxSpMiddle">2.  Пакет
Java SDK. Пакет можно скачать отсюда: <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>.</p>

<p class="MsoListNumberCxSpMiddle">3.  Пакет
Apache Ant. Пакет можно скачать отсюда: <a href="http://ant.apache.org/bindownload.cgi" target="_blank">http://ant.apache.org/bindownload.cgi</a>.</p>

<p class="MsoListNumberCxSpMiddle">4.  Пакет
PuTTY (используются утилиты <span class="Interface">pscp</span> и <span class="Interface">plink</span>). Пакет
можно скачать отсюда: <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" target="_blank">http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html</a>.</p>

<p class="MsoListNumberCxSpLast">5.  Пакет
Windows SDK. Пакет можно скачать отсюда: <a href="https://msdn.microsoft.com/en-us/windows/desktop/bg162891.aspx" target="_blank">https://msdn.microsoft.com/en-us/windows/desktop/bg162891.aspx</a>.</p>

<p class="Note"><span class="Note">Внимание!</span> Сборка мобильного приложения для ОС Windows
возможна только в том случае, если на компьютере, который выполняет сборку,
установлена операционная система Windows 8.1 и выше.</p>

<p class="MsoNormal">Требования
к компонентам Android Studio определяются требованиями мобильной платформы,
которая используется при сборке мобильного приложения. Мобильная платформа
содержит API Level, который считается рекомендуемым при использовании мобиьлных
приложений, собранных с этой платформой. Именно этот API Level будет требовать
и сборщик при сборке мобильного приложения. API Level определяет требования к
версиям Android Tools и Android Platform Tools. Версия Android Build Tools не
должна быть младше, чем используемый API Level. Однако допускается
использование любой более старшей версии API Level, относительно версии,
которую требует мобильная платформа. В этом случае требования к другим
компонентам будут проверяться относительно той версии API Level, который будет
реально использоваться при сборке.</p>

<p class="Regularbeforepicture">Проверить
это можно с помощью утилиты <span class="Interface">SDK Manager.exe</span>,
которая поставляется вместе с SDK. Необходимые для работы сборщика компоненты
отмечены на <a href="#_ref422827670">рис.473</a>.</p>

<p class="Picture"><IMG src="_img/img00481.gif?_=1496848987" WIDTH="800" ALT HEIGHT="634"></p>

<p class="MsoCaption"><a name="_ref422827670">Рис. </a>473. Настройка
Android SDK для сборщика</p>

<p class="MsoNormalCxSpFirst">Не
рекомендуется устанавливать ознакомительные или тестовые версии требуемых
компонент. После выбора необходимых компонентов следует нажать кнопку <span class="Interface">Install … packages…</span>
и согласиться с лицензионным соглашением.</p>

<p class="MsoNormalCxSpLast">Также
сборщик мобильных приложений содержит встроенную документацию (справка),
которая содержит описание правил работы со сборщиком, системные требования и
форматы архивов, которые будут загружаться в прикладное решение.</p>

<a name="_ref336341992"></a><a id="TI000000926" class="bookmark" name="issogl1_25.6_публикация_в_магазине_приложений"><h2>25.6. Публикация в магазине приложений</h2></a>

<p class="MsoNormal">Подготовка
приложения для размещения в магазине приложений делается аналогично проверке
мобильного приложения перед публикацией в магазине приложений.</p>

<a name="_ref375308525"></a><a name="_ref375308524"></a><a id="TI000000927" class="bookmark" name="issogl2_25.6.1_для_ос_ios"><h3>25.6.1. Для ОС iOS</h3></a>

<p class="MsoNormal">Перед
отправкой приложения в Apple AppStore необходимо создать приложение в портале
iTunes Connect и заполнить всю требуемую информацию о приложении. Затем
следует нажать кнопку <span class="Interface">Ready to Upload Binary</span>,
при этом статус вашего приложения в iTunes Connect должен измениться
на <span class="Interface">Waiting For Upload</span>.</p>

<a id="TI000001330" class="bookmark" name="issogl3_25.6.1.1_из_архива_проекта"><h4>25.6.1.1. Из архива проекта</h4></a>

<p class="MsoNormal">После
формирования файла с архивом приложения для ОС iOS следует скопировать файл
архива на компьютер Mac и выполнить следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Распаковать файл с проектом мобильного
приложения <span class="Interface">&lt;ИдентификаторПриложения&gt;.zip</span> на компьютере Mac;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Открыть проект мобильной платформы разработчика
в системе Xcode (двойным щелчком мыши по файлу <span class="Interface">1cem.xcodeproj</span>
или выбрать файл <span class="Interface">1cem.xcodeproj</span> с помощью команды <span class="Interface">File – Open</span>
в системе Xcode);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
С помощью команды меню Xcode <span class="Interface">Product – Edit
Scheme…</span> необходимо открыть диалог настроек текущей схемы запуска. В
открывшемся диалоге:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
В свойстве <span class="Interface">Scheme</span> выбрать
значение <span class="Interface">1cem</span>;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
В свойстве <span class="Interface">Build configuration</span>
выбрать значение <span class="Interface">Release</span>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Нажать кнопку <span class="Interface">OK</span>.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Создать архив приложения с помощью команды Xcode
<span class="Interface">Product – Archive</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Открыть инструмент <span class="Interface">Organizer</span> с
помощью команды меню Xcode <span class="Interface">Window – Organizer</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В верхней панели переключится на архивы <span class="Interface">Archives</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выбрать созданный архив и нажать кнопку <span class="Interface">Distribute…</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Следовать указаниям помощника.</p>

<a name="_ref409790252"></a><a id="TI000001331" class="bookmark" name="issogl3_25.6.1.2_бинарный_файл_ipa"><h4>25.6.1.2. Бинарный файл (.ipa)</h4></a>

<p class="Lang">С
помощью сборщика мобильных приложений</p>

<p class="MsoNormalCxSpFirst">Необходимо
открыть элемент списка мобильных приложений, для которого необходимо выполнить
загрузку приложения, и выбрать команду <span class="Interface">Загрузить в магазины…</span>.
Сборщик проведет анализ выбранного мобильного приложения и сообщит пользователю
о возможности или невозможности выполнить загрузку. Если загрузка доступна
(установлен флажок <span class="Interface">Загрузить в Apple AppStore</span>), то
нажав кнопку <span class="Interface">Загрузить</span>, сборщик попытается выполнит загрузку. При
этом используется имя пользователя и пароль доступа к iTunes Connect, который
можно указать в диалоге настройки параметров поставщика на закладке <span class="Interface">Параметры для ОС iOS</span>
(если настройку выполняет администратор сборщика) или в диалоге <span class="Interface">Сервис – Параметры
доступа к iTunes Connect</span> (если публикацию может выполнять обычный
пользователь).</p>

<p class="MsoNormalCxSpMiddle">Публикация
выполняется с помощью компьютер Mac, на котором выполнялась сборка мобильного
приложения.</p>

<p class="MsoNormalCxSpLast">По
окончанию загрузки сборщик сообщит состояние загрузки. Если есть подозрение,
что загрузка закончилась неудачно – рекомендуется нажать кнопку <span class="Interface">Журнал для AppStore</span>.
Будет открыт документ, в котором находится журнал загрузки. Журнал не сохраняется
в информационной базе и будет утерян после закрытия окна загрузки.</p>

<p class="Lang">Вручную</p>

<p class="MsoNormalCxSpFirst">Отправка
подготовленного пакета приложения (.ipa) в Apple App Store выполняется с
помощью утилиты <span class="Interface">Application Loader</span>, входящей в комплект
средств разработки Xcode. Для запуска утилиты загрузчика
приложений необходимо сначала запустить Xcode, затем выбрать меню <span class="Interface">Xcode – Open
Developer Tool – Application Loader</span>.</p>

<p class="MsoNormalCxSpLast">В
загрузчике необходимо ввести данные вашей учетной записи в программе для
разработчиков Apple. Затем необходимо выбрать <span class="Interface">Deliver Your App</span>.
В открывшемся диалоге выбрать приложение, которое вы хотите отправить. Если его
нет в списке, значит в iTunes Connect для этого приложения не заполнена
необходимая информация. Далее необходимо нажать <span class="Interface">Next</span>, затем <span class="Interface">Choose</span>, и
выбрать требуемый <span class="Interface">.ipa</span> файл. Для отправки файла
необходимо нажать <span class="Interface">Send</span> и дождаться завершения
процесса.</p>

<a name="_ref375308540"></a><a name="_ref375308539"></a><a id="TI000000928" class="bookmark" name="issogl2_25.6.2_для_ос_android"><h3>25.6.2. Для ОС Android</h3></a>

<p class="Lang">С
помощью сборщика мобильных приложений</p>

<p class="MsoNormalCxSpFirst">Первую
загрузку приложения в магазин Google Play следует выполнять вручную. Последующие загрузки можно
выполняться с помощью сборщика мобильных приложений.</p>

<p class="MsoNormalCxSpMiddle">Необходимо
открыть элемент списка мобильных приложений, для которого необходимо выполнить
загрузку приложения, и выбрать команду <span class="Interface">Загрузить в магазины…</span>.
Сборщик проведет анализ выбранного мобильного приложения и сообщит пользователю
о возможности или невозможности выполнить загрузку. Если загрузка доступна
(установлен флажок <span class="Interface">Загрузить в </span><span class="Interface">Google </span><span class="Interface">Play</span>), то необходимо указать
конфигурацию, в которую будет помещено приложение в поле Конфигурация, а затем нажать
кнопку <span class="Interface">Загрузить</span>. Сборщик попытается выполнить загрузку
(загружаются исполняемые файлы для обеих архитектур: ARM и x86). При этом
используется параметры доступа к Google Play, которые можно задать в диалоге настройки параметров
поставщика на закладке <span class="Interface">Параметры для ОС </span><span class="Interface">Android</span>. Эту настройку может
выполнить только администратор сборщика. Алгоритм получения доступа описан в
справке сборщика мобильных приложений.</p>

<p class="MsoNormalCxSpLast">По
окончанию загрузки сборщик сообщит состояние загрузки. Если загрузка
закончилась неудачно – рекомендуется нажать кнопку <span class="Interface">Журнал для </span><span class="Interface">Google </span><span class="Interface">Play</span>. Будет открыт документ, в
котором находится журнал загрузки. Журнал не сохраняется в информационной базе
и будет утерян после закрытия окна загрузки.</p>

<p class="Lang">Вручную</p>

<p class="MsoNormalCxSpFirst">Для
выкладки приложения в Google Play необходимо создать приложение на портале Google Play, заполнить требуемую информацию о приложении и загрузить
.apk-файл(ы).</p>

<p class="MsoNormalCxSpLast">При
создании приложения следует выбрать <span class="Interface">Prepare Store Listing</span>.
После заполнения информации о приложении необходимо перейти на закладку <span class="Interface">APK</span> и
переключиться в расширенный режим, нажав кнопку <span class="Interface">Switch to advanced
mode</span>. Далее, для каждой архитектуры процессора (ARM и x86) следует нажать
<span class="Interface">Upload new APK to Production</span>, и выбрать
соответствующий файл приложения. Только расширенный режим позволяет загружать файлы
приложений для различных архитектур процессоров. В результате оба приложения
появятся в списке с соответствующими архитектурами ARM и x86. Теперь необходимо
нажать кнопку <span class="Interface">Publish now</span>.</p>

<a name="_ref431287656"></a><a id="TI000001739" class="bookmark" name="issogl2_25.6.3_для_ос_windows"><h3>25.6.3. Для ОС Windows</h3></a>

<p class="Lang-subheader">С
помощью сборщика мобильных приложений</p>

<p class="MsoNormal">Сборщик
мобильных приложений не поддерживает публикацию приложений в магазин Windows
Store.</p>

<p class="Lang-subheader">Вручную</p>

<p class="MsoNormalCxSpFirst">Прежде
чем выполнять сборку приложения в сборщике мобильных приложений, необходимо
зарезервировать идентифкатор вашего приложения в магазине Windows Store. Для
этого необходимо зайти в информаицонную панель магазина (<a href="https://appdev.microsoft.com/StorePortals/" target="_blank">https://appdev.microsoft.com/StorePortals/</a>).</p>

<p class="MsoNormalCxSpMiddle">Для
создания приложения следует выбрать <span class="Interface">+ Создать новое
приложение</span>. Теперь необходимо ввести планируемый идентификатор приложения
и нажать гиперссылку <span class="Interface">Проверить доступность</span>. Если введенное
имя занято, то зарезервировать данное имя будет невозможно, о чем будет
сообщено справа от поля с идентификатором приложения. Если имя доступно, то
следует нажать кнопку <span class="Interface">Зарезервировать имя
приложения</span>.</p>

<p class="MsoNormalCxSpMiddle">После
сборки мобильного приложения следует загрузить получившиеся файлы в созданное
приложение из информационной панели. Для этого информационной панели следует
нажать мышью на созданное приложение и в левом меню выбрать пункт <span class="Interface">Отправки</span>, а затем
нажать кнопку <span class="Interface">Начать отправку</span>.</p>

<p class="MsoNormalCxSpMiddle">В
открывшейся форме необходимо установить свойства приложения, цены, описание
продукта, его возрастной ценз и т. д. Затем следует нажать
гиперссылку <span class="Interface">Пакеты</span> и загрузить .appx-файлы созданные сборщиком
мобильных приложений. Если загрузка прошла успешно – следует нажать кнопку
<span class="Interface">Сохранить</span>. После заполнения всех параметров отправки
следует нажать кнопку <span class="Interface">Отправить в Магазин</span>
и ожидать результатов проверки.</p>

<p class="MsoNormalCxSpMiddle"> </p>

<br>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>