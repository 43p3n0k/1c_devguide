<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1043;&#1083;&#1072;&#1074;&#1072; 13. &#1041;&#1080;&#1079;&#1085;&#1077;&#1089;-&#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089;&#1099; &#1080; &#1079;&#1072;&#1076;&#1072;&#1095;&#1080;</title>
		<LINK REL="stylesheet" href="/db/content/v8310doc/src/руководство разработчика/style.css?_=1496848987">
		<script charset="windows-1251" src="/db/content/v8310doc/src/руководство разработчика/script.js?_=1496848987" TYPE="text/javascript"></script>		<!--[if !IE]>--><script charset="windows-1251" src="/db/content/v8310doc/src/руководство разработчика/zeroclipboard.js?_=1496848987" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="/db/content/v8310doc/src/руководство разработчика/глава 13. бизнес-процессы и задачи.htm" rel="canonical">
<link href="/static/its.content.css?_=1490872753" type="text/css" rel="stylesheet">
<script charset="windows-1251" type="text/javascript" src="/static/its.content.js?_=1489758009"></script>
<!--[if lt IE 9]><script charset="windows-1251" type="text/javascript" src="/static/html5shiv.js?_=1484636606"></script><![endif]-->

</head>
	<body class="v8310doc">
<a name="_ref237783457"></a><a id="TI000000665" class="bookmark"><h1>Глава 13.  Бизнес-процессы и задачи</h1></a>

<a id="TI000000666" class="bookmark" name="issogl1_13.1_основные_понятия"><h2>13.1. Основные понятия</h2></a>

<p class="MsoNormalCxSpFirst"><span class="Bold">Бизнес-процессы</span> в системе «1С:Предприятие»
предназначены для объединения отдельных операций в цепочки взаимосвязанных
действий, приводящих к достижению конкретной цели. Например, цепочку по выписке
счета, приему наличной оплаты и отпуску товара со склада можно представить как
бизнес-процесс <span class="Interface">Продажа товара за наличный расчет</span>.</p>

<p class="MsoNormalCxSpMiddle">Бизнес-процессы в системе «1С:Предприятие» позволяют
формализовать процедуры обработки тех или иных событий, возникающих в
деятельности организации, и обеспечить участие в них исполнителей.</p>

<p class="MsoNormalCxSpMiddle">Применение механизмов бизнес-процессов в
прикладных решениях позволяет повысить их эффективность, улучшить конечный
результат и получить новые возможности.</p>

<p class="MsoNormalCxSpMiddle">Бизнес-процессы дают возможность перейти к процессному
управлению и качественно улучшить деятельность предприятия за счет
реинжиниринга и автоматизации бизнес-процессов.</p>

<p class="MsoNormalCxSpMiddle">Наибольший эффект дает автоматизация ключевых бизнес-процессов,
которые начинаются и заканчиваются во внешней по отношению к организации среде.</p>

<p class="MsoNormalCxSpMiddle">Цепочки взаимосвязанных действий бизнес-процесса
представляются с помощью карты маршрута бизнес-процесса. Карта маршрута
описывает логику бизнес-процесса и весь его жизненный цикл от точки старта до
точки завершения в виде схематического изображения последовательности прохождения
взаимосвязанных точек маршрута.</p>

<p class="MsoNormalCxSpMiddle">Последовательное выполнение цепочки
взаимосвязанных действий будем называть движением бизнес-процесса.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Точка маршрута</span> – отражает
этап жизненного цикла бизнес-процесса, связанный с выполнением, как правило,
одной автоматической или ручной операции.</p>

<p class="MsoNormalCxSpLast"><span class="Bold">Задачи</span> в системе «1С:Предприятие»
позволяют вести учет заданий по исполнителям и служат отражением продвижения
бизнес-процессов по точкам маршрута. При этом задачи могут создаваться не
только бизнес-процессами, но и другими объектами информационной базы, и
непосредственно пользователями.</p>

<a id="TI000000667" class="bookmark" name="issogl1_13.2_общая_часть"><h2>13.2. Общая часть</h2></a>

<p class="MsoNormal">Механизм бизнес-процессов в системе «1С:Предприятие» обеспечивается
сразу несколькими объектами конфигурирования:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Бизнес-процессы,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Задачи,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Регистр сведений,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Параметр сеанса.</p>

<p class="Regularbeforepicture">Как правило, типы реквизитов адресации задачи и
измерений регистра сведений имеют ссылочный тип (например, <span class="Term">СправочникСсылка</span>,
поэтому к четырем вышеперечисленным видам добавляются еще справочники).</p>

<p class="Picture"><IMG src="/db/content/v8310doc/src/руководство разработчика/_img/img00413.gif?_=1496848987" WIDTH="562" ALT HEIGHT="300"></p>

<p class="MsoCaption">Рис. 415. Схема бизнес-процессов</p>

<p class="MsoNormalCxSpFirst">Основные объекты – бизнес-процессы и задачи –
взаимодействуют друг с другом (например, бизнес-процесс создает задачи, а
задача в процессе выполнения приводит к продвижению его по маршруту).</p>

<p class="MsoNormalCxSpMiddle">Вспомогательные объекты – параметры сеанса,
регистр сведений и справочники – не используют друг друга и основные объекты.</p>

<p class="MsoNormalCxSpMiddle">При создании карты маршрута бизнес-процесса используются
справочники с предопределенными данными (ролями, подразделениями и пр.) для
установки их значений в свойства адресации точек маршрута. Бизнес-процессы
создают задачи при переходе на точки маршрута и используют <span class="Interface">Адресацию</span> (регистр сведения, см. ниже) для обработки групповых
точек.</p>

<p class="MsoNormalCxSpLast">Задачи сообщают бизнес-процессам о своем выполнении,
чем вызывают их движение дальше по маршруту. Регистр сведения используется ими
для отбора задач для текущего исполнителя в соответствии с установленным
параметром сеанса.</p>

<a id="TI000000668" class="bookmark" name="issogl1_13.3_маршрутизация"><h2>13.3. Маршрутизация</h2></a>

<p class="MsoNormal">Бизнес-процессы в системе «1С:Предприятие» допускают
следующие виды маршрутизации:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Bold">Жесткая</span>. Бизнес-процесс
имеет строгую карту маршрута, не включающую в себя условных и параллельных переходов,
с жестко определенными адресатами для каждой точки маршрута. Данный вид не
допускает свободной и условной маршрутизации.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Bold">Свободная</span>. Адресаты
точки карты маршрута бизнес-процесса не установлены и определяются программно
или интерактивно в течение жизненного цикла бизнес-процесса.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Bold">Условная</span>. Карта маршрута
предусматривает проверку условий и переход по соответствующим ветвям. Переходы
могут быть как бинарными (условие), так и множественными (выбор варианта).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Bold">Параллельная</span>. Карта
маршрута предусматривает разделение бизнес-процесса на параллельные ветви с
возможностью последующего слияния (ожидания). Продвижение бизнес-процесса по
каждой из параллельных ветвей происходит независимо по мере выполнения соответствующих
задач.</p>

<p class="MsoNormal">Как правило, в реальных картах бизнес-процессов встречаются
все эти типы маршрутизации.</p>

<a id="TI000000669" class="bookmark" name="issogl1_13.4_система_адресации"><h2>13.4. Система адресации</h2></a>

<p class="MsoNormalCxSpFirst">Ключевым понятием в механизме бизнес-процессов и
задач в «1С:Предприятии» является система адресации. Основное назначение
системы адресации – обеспечить возможность не только персональной, но и
ролевой адресации задач участникам бизнес-процессов.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Ролевая адресация (ролевая
маршрутизация)</span> – набор правил и соглашений, зафиксированных в
настройках объектов метаданных, который позволяет определять конечного адресата
(исполнителя), исходя из назначенных ему ролей, принадлежности к подразделению,
а также других реквизитов адресации.</p>

<p class="MsoNormalCxSpMiddle">Реквизиты адресации задачи задают размерность адресного
пространства в контексте автоматизируемой предметной области и используются для
определения принадлежности задач конкретным исполнителям.</p>

<p class="MsoNormalCxSpMiddle">Определение конкретного исполнителя осуществляется
с помощью свойств задачи – <span class="Interface">Адресация</span>, <span class="Interface">Основной реквизит адресации</span> и <span class="Interface">Текущий
исполнитель</span>.</p>

<p class="MsoNormalCxSpMiddle">Процесс определения основного реквизита адресации
из остальных реквизитов адресации называется <span class="Bold">разыменованием</span>.</p>

<p class="MsoNormalCxSpLast"><span class="Interface">Адресация</span> – регистр
сведений, который хранит актуальную на текущий момент информацию о соответствии
исполнителей (основной реквизит адресации) структурным подразделениям, рабочим
группам, выполняемым функциям и т. д., то есть всем остальным
реквизитам адресации задач.</p>

<p class="Regularbeforepicture">Один из реквизитов адресации задачи является основным
и означает конкретного сотрудника – исполнителя заданий.</p>

<p class="Picture"><IMG src="/db/content/v8310doc/src/руководство разработчика/_img/img00414.gif?_=1496848987" WIDTH="497" ALT HEIGHT="260"></p>

<p class="MsoCaption">Рис. 416. Схема адресации</p>

<p class="MsoNormal">Поясним на примере работу системы адресации.</p>

<p class="Regularbeforetable">Допустим, что есть регистр сведений, состоящий из
двух измерений – роль и сотрудник, в который внесены следующие записи.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Роль</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Сотрудник</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кассир</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Менеджер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Петров</p>
  </td>
 </tr>
</table>

<p class="Regularbeforetable">Допустим, что есть бизнес-процесс (например, <span class="Interface">Принять наличную оплату</span>), в одной из точек которого в
свойствах адресации установлена только роль <span class="Interface">Кассир</span>.
При переходе бизнес-процесса на эту точку будет сформирована одна задача.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Свойство задачи</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Значение</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Наименование</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Принять
  наличную оплату</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Роль</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кассир</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Сотрудник</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">-</p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpMiddle">При просмотре сотрудником <span class="Interface">Ивановым</span>
списка задач для себя система адресации покажет ему эту задачу, т. к.
в регистре сведений есть запись о том, что для <span class="Interface">Иванова</span>
установлена роль <span class="Interface">Кассир</span>. Сотрудник <span class="Interface">Петров</span> эту задачу не увидит.</p>

<p class="MsoNormalCxSpLast">Приведем примерную последовательность действий для
создания двух различных бизнес-процессов:</p>

<p class="MsoListNumberCxSpFirst">1. 
Будем исходить из того, что выбрана 3-мерная
система адресации – <span class="Interface">сотрудник</span>, <span class="Interface">роль</span>, <span class="Interface">подразделение</span>.</p>

<p class="MsoListNumberCxSpLast">2.  Создадим
справочники для каждого из планируемых измерений адресации (<span class="Term">Сотрудники</span>, <span class="Term">Роли</span>,
<span class="Term">Подразделения</span>)
и заполним их предопределенными значениями:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Сотрудники</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Роли</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Подразделения</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кассир</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Бухгалтерия</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Петров</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Менеджер</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Отдел
  продаж</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Сидоров</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Руководитель
  отдела</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Склад</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кладовщик</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
</table>

<p class="MsoListNumber">3.  Создадим
регистр сведений и добавим к нему измерения, по одному для каждого из ранее
созданных справочников. Тип измерений следует установить как ссылку на соответствующий
справочник:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Измерение</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Тип</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Сотрудник</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СправочникСсылка.Сотрудники</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Роль</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СправочникСсылка.Роль</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Подразделение</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СправочникСсылка.Подразделения</span></p>
  </td>
 </tr>
</table>

<p class="MsoListNumberCxSpFirst">4.  Создадим
параметр сеанса <span class="Term">ТекущийИсполнитель</span>
и установим ему тип <span class="Term">СправочникСсылка.Сотрудники</span>.</p>

<p class="MsoListNumberCxSpLast">5.  Проинициализируем
параметр сеанса при запуске системы:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> УстановкаПараметровСеанса<span class="operator">(</span>ТребуемыеПараметры<span class="operator">)</span>
    Пользователь <span class="operator">=</span> Справочники<span class="operator">.</span>Сотрудники<span class="operator">.</span>
                    НайтиПоНаименованию<span class="operator">(</span>ИмяПользователя<span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    ПараметрыСеанса<span class="operator">.</span>ТекущийИсполнитель <span class="operator">=</span> Пользователь<span class="operator">;</span>
     
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoListNumberCxSpFirst">1. 
Создадим задачу.</p>

<p class="MsoListNumberCxSpMiddle">2.  Установим
созданный ранее регистр сведений в свойство задачи <span class="Term">Адресация</span>.</p>

<p class="MsoListNumberCxSpLast">3.  Добавим
к задаче реквизиты адресации аналогично измерениям регистра сведений:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">Сотрудник</span>,</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
<span class="Term">Роль</span>,</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">Подразделение</span>.</p>

<p class="MsoListNumber">4.  Установим
для созданных реквизитов адресации задачи тип в виде ссылки на соответствующий
справочник и в свойстве <span class="Interface">Реквизиты адресации</span>
установим ссылку на измерение регистра сведений.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Реквизит<br>
  адресации</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Тип</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Измерение<br>
  адресации</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Сотрудник</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СправочникСсылка.</span></p>
  <p class="MsoNormalCxSpMiddle"><span class="Term">Сотрудники</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Сотрудник</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Роль</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СправочникСсылка.</span></p>
  <p class="MsoNormalCxSpMiddle"><span class="Term">Роль</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Роль</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Подразделение</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СправочникСсылка.</span></p>
  <p class="MsoNormalCxSpMiddle"><span class="Term">Подразделения</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Подразделение</span></p>
  </td>
 </tr>
</table>

<p class="MsoListNumberCxSpFirst">5.  Выберем
реквизит <span class="Term">Сотрудник</span>
в качестве основного реквизита адресации, установив его в соответствующем свойстве
задачи.</p>

<p class="MsoListNumberCxSpLast">6.  Создадим
первый бизнес-процесс и установим у него ссылку на созданную ранее задачу
(свойство <span class="Term">Задача</span>).</p>

<p class="Regularbeforepicture">Спроектируем маршрутную карту бизнес-процесса,
устанавливая нужные реквизиты адресации для точек маршрута, выбирая их из
предопределенных данных соответствующих справочников.</p>

<p class="Picture"><IMG src="/db/content/v8310doc/src/руководство разработчика/_img/img00415.gif?_=1496848987" WIDTH="563" ALT HEIGHT="520"></p>

<p class="MsoCaption">Рис. 417. Карта бизнес-процесса</p>

<p class="MsoListNumberCxSpFirst">7.  Создадим
следующий бизнес-процесс и установим у него ссылку на эту же задачу.</p>

<p class="MsoListNumberCxSpLast">8.  Спроектируем
маршрутную карту созданного бизнес-процесса. И так далее.</p>

<p class="MsoNormalCxSpFirst">В дальнейшем будем использовать этот пример для комментирования
ключевых особенностей бизнес-процессов в системе «1С:Предприятие».</p>

<p class="MsoNormalCxSpLast">Рассмотрим подробнее несколько ключевых особенностей
механизма бизнес-процессов.</p>

<a id="TI000000670" class="bookmark" name="issogl1_13.5_старт_бизнес-процесса"><h2>13.5. Старт бизнес-процесса</h2></a>

<p class="MsoNormalCxSpFirst">Бизнес-процесс стартует при вызове метода <span class="Term">Старт()</span>
или нажатии кнопки <span class="Interface">Стартовать и закрыть</span> в форме
объекта.</p>

<p class="MsoNormalCxSpLast">Нижеследующий фрагмент кода показывает программное
создание, запись и старт бизнес-процесса.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">БП <span class="operator">=</span> БизнесПроцессы<span class="operator">.</span>Согласование<span class="operator">.</span>СоздатьБизнесПроцесс<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
БП<span class="operator">.</span>Дата <span class="operator">=</span> ТекущаяДата<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
БП<span class="operator">.</span>Записать<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
БП<span class="operator">.</span>Старт<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="Regularbeforetable">При старте выполняется следующая последовательность
действий.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>№</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Внутренний механизм</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Обработчики<br>
  на встроенном языке</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПередСтартом</span>
  у точки старта</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Продвижение
  по карте маршрута до точки действия</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Формирование задач (см. <a href="#_ref214940306">здесь</a>)</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpMiddle"> </p>

<p class="MsoNormalCxSpLast">Бизнес-процесс может быть записан, но не стартован.
Это может оказаться полезным, если создание бизнес-процесса и его старт
разделены во времени. Например, когда бизнес-процесс стартует при наступлении
некоторого события.</p>

<a id="TI000000671" class="bookmark" name="issogl1_13.6_выполнение_задач"><h2>13.6. Выполнение задач</h2></a>

<p class="Regularbeforetable">При вызове метода <span class="Term">ВыполнитьЗадачу()</span>
осуществляется проверка выполнения, после которой задача помечается как выполненная
и об этом оповещается бизнес-процесс. Если все необходимые условия выполнены,
то бизнес-процесс осуществляет переход на следующую точку маршрута.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>№</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Внутренний<br>
  механизм</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Обработчики<br>
  на встроенном языке</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Начало
  транзакции</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПередВыполнением</span>
  у задачи</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПередВыполнением</span>
  у соответствующей точки маршрута</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Установка свойства <span class="Term">Выполнена</span>
  у задачи равным <span class="Term">Истина</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">5</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПриВыполнении</span>
  у задачи</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">6</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Запись
  объекта задачи</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">7</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПриВыполнении</span>
  у соответствующей точки маршрута</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Переход
  бизнес-процесса на следующую точку маршрута</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">9</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Формирование задач по новой точке
  маршрута (см. <a href="#_ref214940306">здесь</a>)</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">10</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Завершение
  транзакции</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
</table>

<a id="TI000000672" class="bookmark" name="issogl1_13.7_разделение_и_слияние"><h2>13.7. Разделение и слияние</h2></a>

<p class="MsoNormalCxSpFirst">Для разделения бизнес-процесса на несколько параллельно
(одновременно и независимо) исполняемых ветвей используется точка разделения.
Точка разделения имеет один вход и неограниченное количество выходов.</p>

<p class="MsoNormalCxSpMiddle">Для синхронизации разделенных ранее ветвей используется
точка слияния. Бизнес-процесс не будет выполняться дальше точки слияния, пока
все входящие в нее ветви не будут пройдены. Таким образом, точка слияния является
этапом бизнес-процесса, на котором должны быть завершены все задачи по
разделенным ранее веткам.</p>

<p class="MsoNormalCxSpLast">Допускается вложенное разделение и слияние. При этом
каждая точка слияния будет синхронизировать только ветки «своей» точки
разделения.</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span> Разделение может быть и
без слияния. В этом случае бизнес-процесс будет иметь несколько параллельных
ветвей до своего завершения.</p>

<p class="MsoNormal">Слияние без разделения не допускается, о чем выдается соответствующее
сообщение при проверке карты маршрута: <span class="Interface">Не все линии,
вошедшие в точку слияния, вышли из точки разделения</span>.</p>

<a id="TI000000673" class="bookmark" name="issogl1_13.8_ручное_управление"><h2>13.8. Ручное управление</h2></a>

<p class="MsoNormal">Признаки завершения бизнес-процесса и выполнения у задачи
можно устанавливать вручную, в обход механизма бизнес-процессов, однако делать
это нужно с полным пониманием всех возможных последствий.</p>

<a id="TI000000674" class="bookmark" name="issogl2_13.8.1_признак_завершенности_бизнес-процесса"><h3>13.8.1. Признак завершенности бизнес-процесса</h3></a>

<p class="MsoNormalCxSpFirst">Если установить признак<span class="Bold"> </span>завершенности,
то бизнес-процесс будет считаться завершенным, даже несмотря на то, что связанные
с ним задачи еще не выполнены. И при выполнении этих задач завершенный
бизнес-процесс уже не будет двигаться дальше по маршруту.</p>

<p class="MsoNormalCxSpMiddle">Признак завершения можно установить у нестартованного
бизнес-процесса. В этом случае его старт в дальнейшем будет невозможен.</p>

<p class="MsoNormalCxSpLast">Если вручную снять признак завершения с завершенного
бизнес-процесса, то связанные с ним задачи все равно останутся выполненными. Таким
образом, бизнес-процесс не будет завершен, но по нему не будет ни одной
невыполненной задачи. Повторный старт такого бизнес-процесса невозможен, т. к.
система будет считать его стартованным (по нему есть одна или более задач). Поэтому
при ручном снятии признака завершения следует снять признаки выполнения у нужных
задач таким образом, чтобы вернуть бизнес-процесс на нужную точку маршрута.</p>

<a id="TI000000675" class="bookmark" name="issogl2_13.8.2_признак_выполнения_задачи"><h3>13.8.2. Признак выполнения задачи</h3></a>

<p class="MsoNormalCxSpFirst">Если установить признак выполнения задачи вручную,
то это не приведет к продвижению бизнес-процесса дальше по маршруту. При этом
также не будут вызваны обработчики событий <span class="Term">ПередВыполнением()</span>
и <span class="Term">ПриВыполнении()</span>
у задачи и соответствующей ей точке маршрута.</p>

<p class="MsoNormalCxSpMiddle">Ручная установка признака выполнения может
привести к остановке бизнес-процесса – он не будет завершен, но по нему не
будет ни одной невыполненной задачи.</p>

<p class="MsoNormalCxSpMiddle">Снятие признака выполнения у задачи может привести
к появлению параллельного потока в незавершенном бизнес-процессе. Допустим,
бизнес-процесс еще не завершен и по нему есть одна выполненная и одна
невыполненная задача. Если снять признак выполнения с выполненной задачи, то у
данного бизнес-процесса появятся две невыполненные задачи. При выполнении
каждой из них бизнес-процесс будет двигаться дальше по карте маршрута от точки,
соответствующей выполненной задаче. При этом бизнес-процесс будет считаться
завершенным, когда все задачи в обеих параллельных ветвях будут выполнены.</p>

<p class="MsoNormalCxSpLast">Снятие признака выполнения у задачи, бизнес-процесс
которой уже завершен, приведет к тому, что задача будет видна в списках как
невыполненная, но ее выполнение не будет продвигать бизнес-процесс дальше по
маршруту.</p>

<a id="TI000000676" class="bookmark" name="issogl2_13.8.3_удаление_задач"><h3>13.8.3. Удаление задач</h3></a>

<p class="MsoNormalCxSpFirst">Если удалить невыполненные задачи незавершенного
бизнес-процесса, то он может остановиться. Такой бизнес-процесс будет
незавершенным, но по нему не будет ни одной активной (невыполненной) задачи.</p>

<p class="MsoNormalCxSpMiddle">Задачи используются для отображения реальной карты
маршрута бизнес-процесса, чтобы показать уже пройденные точки маршрута и
активные (невыполненные). Поэтому удаление задач может привести к некорректному
и противоречивому отображению пройденных и активных точек маршрута.</p>

<p class="MsoNormalCxSpLast">Удаление всех задач для незавершенного
бизнес-процесса переводит его в статус нестартованного.</p>

<a id="TI000000677" class="bookmark" name="issogl2_13.8.4_добавление_задач"><h3>13.8.4. Добавление задач</h3></a>

<p class="MsoNormalCxSpFirst">Если вручную создать новую задачу по завершенному
бизнес-процессу, то бизнес-процесс все равно будет считаться завершенным и
выполнение этой задачи не приведет к его продвижению по карте маршрута.</p>

<p class="MsoNormalCxSpMiddle">Если вручную создать новую задачу для еще не стартовавшего
бизнес-процесса, то он получает статус стартованного и выполнение этой задачи
приведет к его продвижению дальше по карте маршрута.</p>

<p class="MsoNormalCxSpLast">Создание новой задачи для уже стартовавашего и незавершенного
бизнес-процесса приводит к его распараллеливанию.</p>

<a id="TI000000678" class="bookmark" name="issogl1_13.9_условный_переход"><h2>13.9. Условный переход</h2></a>

<p class="MsoNormalCxSpFirst">Для условного ветвления бизнес-процесса
используется точка условного перехода. Важной особенностью этой точки является
обработчик проверки условия, наличие которого обязательно и контролируется при
проверке карты маршрута перед сохранением бизнес-процесса. Если обработчик отсутствует,
то будет выдано предупреждение: <span class="Interface">Точка условия не имеет
обработчика события &quot;Проверка условия&quot;</span>.</p>

<p class="MsoNormalCxSpMiddle">Этот обработчик должен вернуть результат проверки
условия, от которого будет зависеть выбор следующей точки маршрута. Если результат
<span class="Term">Истина</span>,
то бизнес-процесс пойдет по ветке <span class="Interface">Да</span>, в противном
случае – по ветке <span class="Interface">Нет</span>. По умолчанию результат
устанавливается равным значению <span class="Term">Ложь</span>.</p>

<p class="MsoNormalCxSpLast">Обработчик проверки условия может, например, иметь такой
вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ОграничениеСкидкиПроверкаУсловия<span class="operator">(</span>ТочкаМаршрутаБП<span class="operator">,</span> Результат<span class="operator">)</span>
    <span class="keyword">Если</span> ПолучитьСкидкуПоСчету<span class="operator">(</span><span class="operator">)</span> <span class="operator">&gt;</span> ПолучитьОбычнуюСкидку<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
        Результат <span class="operator">=</span> <span class="keyword">Истина</span><span class="operator">;</span>
    <span class="keyword">Иначе</span>
        Результат <span class="operator">=</span> <span class="keyword">Ложь</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormal">Для реализации многовариантного выбора можно использовать
несколько последовательно соединенных точек условного перехода, однако удобнее
для этого применять точку выбора варианта.</p>

<a id="TI000000679" class="bookmark" name="issogl1_13.10.выбор_варианта"><h2>13.10.Выбор варианта</h2></a>

<p class="MsoNormalCxSpFirst">Для выбора одного из нескольких возможных путей используется
точка выбора варианта. Важной особенностью этой точки является обработчик
выбора варианта, наличие которого обязательно и контролируется при проверке
карты маршрута перед сохранением бизнес-процесса. Если обработчик отсутствует,
то будет выдано предупреждение: <span class="Interface">Точка выбора варианта не
имеет обработчика события Выбор варианта</span>.</p>

<p class="MsoNormalCxSpLast">Этот обработчик должен установить параметр <span class="Term">Результат</span>
равным одному из предусмотренных вариантов. Процедура-обработчик может иметь
примерно такой вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ВыборВарианта <span class="operator">(</span>ТочкаВыбораВарианта<span class="operator">,</span> Результат<span class="operator">)</span>
    <span class="keyword">Если</span> ВидОплаты <span class="operator">=</span> Перечисления<span class="operator">.</span>ВидОплаты<span class="operator">.</span>Наличная <span class="keyword">Тогда</span>
        Результат <span class="operator">=</span> ТочкаВыбораВарианта<span class="operator">.</span>Варианты<span class="operator">.</span>Наличная<span class="operator">;</span>
    <span class="keyword">ИначеЕсли</span> ВидОплаты <span class="operator">=</span> Перечисления<span class="operator">.</span>ВидОплаты<span class="operator">.</span>Безналичная <span class="keyword">Тогда</span>
        Результат <span class="operator">=</span> ТочкаВыбораВарианта<span class="operator">.</span>Варианты<span class="operator">.</span>Безналичная<span class="operator">;</span>
    <span class="keyword">ИначеЕсли</span> ВидОплаты <span class="operator">=</span> Перечисления<span class="operator">.</span>ВидОплаты<span class="operator">.</span>Взаимозачет <span class="keyword">Тогда</span>
        Результат <span class="operator">=</span> ТочкаВыбораВарианта<span class="operator">.</span>Варианты<span class="operator">.</span>Взаимозачет<span class="operator">;</span>
    <span class="keyword">ИначеЕсли</span> ВидОплаты <span class="operator">=</span> Перечисления<span class="operator">.</span>ВидОплаты<span class="operator">.</span>Кредит <span class="keyword">Тогда</span>
        Результат <span class="operator">=</span> ТочкаВыбораВарианта<span class="operator">.</span>Варианты<span class="operator">.</span>Кредит<span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormalCxSpFirst">В этом обработчике <span class="Term">ВидОплаты</span> – реквизит
бизнес-процесса.</p>

<p class="MsoNormalCxSpLast">Если в процедуре-обработчике выбора варианта не установить
какое-либо значение параметра <span class="Term">Результат</span>, то это приведет к ошибке и отмене
транзакции, в рамках которой выполнялся выбор варианта.</p>

<a name="_ref214940306"></a><a id="TI000000680" class="bookmark" name="issogl1_13.11.формирование_задач"><h2>13.11.Формирование задач</h2></a>

<p class="MsoNormalCxSpFirst">Задачи формируются только при поступлении
бизнес-процесса в точки действия или точки вложенных бизнес-процессов. При
прохождении других точек (условный переход, разделение, слияние, обработка и
пр.) бизнес-процесс автоматически выполняет предусмотренные действия и переходит
к следующей точке в соответствии с картой маршрута.</p>

<p class="MsoNormalCxSpMiddle">Рассмотрим, например, процесс перехода
бизнес-процесса на первую точку действия в результате вызова у него метода <span class="Term">Старт()</span>.</p>

<p class="MsoNormalCxSpLast">При прохождении маршрута бизнес-процесс в точках
действия или точках вложенных бизнес-процессов может создавать одну или
несколько задач. Несколько задач будут сформированы в том случае, если у точки
маршрута установлен признак «групповая». В этом случае бизнес-процесс отбирает
в регистре сведений (<span class="Term">Адресация</span>)
все записи, соответствующие установленным в данной точке реквизитам адресации,
и для каждой из них формирует свою задачу.</p>

<p class="Regularbeforetable">Например, если в точке маршрута установлена
адресация только по роли <span class="Term">Кассир</span>, а в регистре сведений имеются две
записи вида, то будут сформированы две задачи, у которых будут установлены оба
реквизита адресации – и роль, и конечный исполнитель.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Сотрудник</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Роль</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Подразделение</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кассир</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Петров</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кассир</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpLast">Таким образом, для групповых точек маршрута ролевая
маршрутизация применяется только один раз – в момент формирования списка
задач.</p>

<p class="Regularbeforetable">Рассмотрим последовательность вызова обработчиков
событий на встроенном языке в момент перехода на первую точку маршрута <span class="Interface">Выписка счета</span>.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>№</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Внутренний<br>
  механизм</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Обработчики<br>
  на встроенном языке</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Начало
  транзакции</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПередСозданиемЗадач()</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Формирование
  списка задач</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПриСозданииЗадач()</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">5</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Запись
  всех сформированных задач </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">6</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПередЗаписью()</span>
  у задачи</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">7</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Запись
  задачи</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов обработчика <span class="Term">ПриЗаписи()</span>
  у задачи</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">9</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Завершение
  транзакции</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpMiddle">На втором шаге происходит вызов обработчика <span class="Term">ПередСозданиемЗадач()</span>.
Этот обработчик вызывается до формирования списка задач самим бизнес-процессом,
поэтому ему передается пустой массив формируемых задач с тем, чтобы его можно
было сформировать самостоятельно и отказаться от стандартной обработки.</p>

<p class="MsoNormalCxSpMiddle">На третьем шаге бизнес-процесс проверяет, вернул
ли предыдущий обработчик <span class="Term">СтандартнаяОбработка = Истина</span>. Если да, то
производится разыменование установленных в точке маршрута реквизитов адресации
и формируется одна задача или список задач (для групповой точки) по количеству
результатов разыменования (например, количество сотрудников отдела). При этом
каждой сформированной задаче устанавливается наименование, ссылка на
бизнес-процесс и точку маршрута и соответствующие реквизиты адресации.</p>

<p class="MsoNormalCxSpMiddle">На четвертом шаге осуществляется вызов обработчика
<span class="Term">ПриСозданииЗадач()</span>.
В этот обработчик передается список задач, сформированный ранее в обработчике <span class="Term">ПередСозданиемЗадач()</span>
или самим бизнес-процессом. Задачи еще не записаны. В этом обработчике можно
предусмотреть тонкую настройку сформированных задач – установку
контрольного срока, приоритета и других дополнительных реквизитов. Также в этом
обработчике можно добавить к массиву сформированных задач новые задачи.</p>

<p class="MsoNormalCxSpMiddle">На пятом шаге проверяется нормальное завершение обработчика
<span class="Term">ПриСозданииЗадач()</span>.
Если обработчик в параметре <span class="Term">Отказ</span> вернул значение <span class="Term">Истина</span>, то процесс
создания задач прерывается и вызывается исключение. В нашем случае это приведет
к отмене выполнения метода <span class="Term">Старт()</span>. Если же <span class="Term">Отказ = Ложь</span>, то
производится запись всех задач из сформированного массива с вызовом
обработчиков <span class="Term">ПередЗаписью()</span>
и <span class="Term">ПриЗаписи()</span>
у каждой отдельной задачи (шаги 6 и 8 соответственно).</p>

<p class="MsoNormalCxSpLast">При формировании бизнес-процессом массива задач у
них автоматически заполняются следующие реквизиты:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Наименование устанавливается равным наименованию
соответствующей точки маршрута, например <span class="Interface">Выписка счета</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Ссылка на экземпляр бизнес-процесса, породившего
эту задачу.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Ссылка на точку маршрута бизнес-процесса.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Реквизиты адресации задачи устанавливаются равными
реквизитам адресации соответствующей точки маршрута. Например, если точка
маршрута адресована роли <span class="Term">Кассир</span>, то в реквизит адресации задачи <span class="Term">Роль</span>
будет установлено <span class="Term">Кассир</span>.</p>

<a id="TI000000681" class="bookmark" name="issogl1_13.12.проверка_выполнения"><h2>13.12.Проверка выполнения</h2></a>

<p class="MsoNormalCxSpFirst">Выполнение задач может осуществляться не только
пользователями, но и автоматизированными процедурами. Например, если задача
предусматривает проведение документа, то автоматическая процедура слежения за такими
задачами может определять, что нужный документ уже проведен, и помечать задачу
как выполненную путем вызова у нее метода <span class="Term">Выполнить()</span>.</p>

<p class="MsoNormalCxSpMiddle">Для организации такого рода автоматизированных процедур
предназначен метод <span class="Term">ПроверкаВыполнения()</span>
у задачи и соответствующие ему обработчики у точек маршрута.</p>

<p class="MsoNormalCxSpLast">Рассмотрим последовательность действий, которая произойдет
в результате работы следующего кода на встроенном языке.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Если</span> Задача<span class="operator">.</span>ПроверитьВыполнение<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
    Задача<span class="operator">.</span>ВыполнитьЗадачу<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЕсли</span></pre>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>№</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Внутренний<br>
  механизм</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Обработчики<br>
  на встроенном языке</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Обработка
  вызова метода <span class="Term">ПроверитьВыполнение()</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов
  обработчика <span class="Term">ОбработкаПроверкиВыполнения()</span>
  у задачи. Если <span class="Term">Результат</span>
  равен <span class="Term">Ложь</span>,
  то метод <span class="Term">ПроверитьВыполнение()</span>
  сразу возвращает <span class="Term">Ложь</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов
  обработки <span class="Term">ОбработкаПроверкиВыполнения()</span>
  у соответствующей точки маршрута</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Возврат
  результата вызова обработчика из предыдущего пункта и, если он равен <span class="Term">Истина</span>,
  вызов метода <span class="Term">ВыполнитьЗадачу()</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpLast">Описание одного из способов использования
автоматизированного выполнения задач см. <a href="#_ref74573561">здесь</a>.</p>

<a id="TI000000682" class="bookmark" name="issogl1_13.13.выполнение_вложенных_процессов"><h2>13.13.Выполнение вложенных процессов</h2></a>

<p class="MsoNormal">При проектировании маршрутной карты можно предусматривать
старт вложенных бизнес-процессов. В этом случае основной бизнес-процесс ждет
завершения вложенного бизнес-процесса и только после этого переходит к следующей
точке маршрута.</p>

<p class="Regularbeforetable">При переходе на точку маршрута вида <span class="Interface">Вложенный бизнес-процесс</span> выполняется следующая
последовательность действий.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>№</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Внутренний<br>
  механизм</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Обработчики<br>
  на встроенном языке</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Начало
  транзакции</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПередСозданиемВложенныхБизнесПроцессов()</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вызов
  обработчика <span class="Term">ПередСозданиемЗадач()</span>
  для точки маршрута</p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Если
  <span class="Term">СтандартнаяОбработка</span>,
  то формируется массив задач</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">5</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПриСозданииЗадач()</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">6</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Запись
  массива сформированных задач и создание массива вложенных бизнес-процессов</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">7</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПриСозданииВложенныхБизнесПроцессов()</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">8</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Запись
  и старт сформированных бизнес-процессов</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">9</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Завершение
  транзакции</p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
 </tr>
</table>

<p class="MsoNormalCxSpMiddle">Рассмотрим подробнее.</p>

<p class="MsoNormalCxSpMiddle">На втором шаге происходит вызов обработчика <span class="Term">ПередСозданиемВложенныхБизнесПроцессов()</span>,
в котором можно добавить свои бизнес-процессы в массив формируемых бизнес-процессов
(по умолчанию массив приходит пустым). Если были добавлены бизнес-процессы в массив,
то стандартная механика генерации бизнес-процессов будет отменена.</p>

<p class="MsoNormalCxSpMiddle">На третьем шаге происходит вызов обработчика <span class="Term">ПередСозданиемЗадач()</span>.
В него передается пустой, еще не сформированный массив задач. Если этот
обработчик не изменит стандартную обработку, то сформированный им массив задач
будет очищен на третьем шаге и заполнен задачами (по одной задаче на каждый
стартующий вложенный бизнес-процесс) с установленным наименованием и ссылками
на бизнес-процесс и точку маршрута.</p>

<p class="MsoNormalCxSpMiddle">На пятом шаге можно «донастроить» сформированные задачи
и добавить к ним новые в случае необходимости.</p>

<p class="MsoNormalCxSpMiddle">На шестом шаге происходит запись сформированных задач,
после чего по каждой из них создается вложенный бизнес-процесс установленного в
точке маршрута типа. У созданных бизнес-процессов устанавливается дата и ссылка
на ведущую задачу.</p>

<p class="MsoNormalCxSpLast">На седьмом шаге происходит вызов обработчика <span class="Term">ПриСозданииВложенныхБизнесПроцессов()</span>.
Обработчик этого события может «донастроить» автоматически сформированные бизнес-процессы
(их количество равно количеству задач после обработчика <span class="Term">ПриСозданииЗадач()</span>)
или удалить некоторые из них, а также добавить к ним новые бизнес-процессы.
Запись списка бизнес-процессов будет осуществлена после завершения обработчика.</p>

<a id="TI000000683" class="bookmark" name="issogl1_13.14.завершение_бизнес-процесса"><h2>13.14.Завершение бизнес-процесса</h2></a>

<p class="MsoNormalCxSpFirst">Завершение является последним этапом в жизненном
цикле бизнес-процесса. Бизнес-процесс автоматически становится завершенным
(свойству <span class="Term">Завершен</span>
устанавливается значение <span class="Term">Истина</span>) при достижении точки завершения и при
условии отсутствия невыполненных задач по этому бизнес-процессу.</p>

<p class="MsoNormalCxSpMiddle">Если у бизнес-процесса установлено свойство <span class="Interface">Ведущая задача</span>, т. е. он является вложенным,
то при своем завершении он помечает эту задачу как выполненную. Это, в свою очередь,
приводит к продвижению основного бизнес-процесса дальше по маршруту.</p>

<p class="MsoNormalCxSpMiddle">При переходе на точку завершения вызывается обработчик
<span class="Term">ПриЗавершении()</span>.
Если он установит <span class="Term">Отказ</span>
равным <span class="Term">Истина</span>,
например, если не выполнены все необходимые условия завершения бизнес-процесса,
то обработка прерывается. Задача по точке маршрута, выполнение которой привело
к переходу на точку завершения, при этом остается невыполненной.</p>

<p class="MsoNormalCxSpLast">Установка свойству <span class="Term">Завершен</span> значения <span class="Term">Истина</span>
(средствами встроенного языка или интерактивно) может использоваться для
прерывания хода бизнес-процесса или для исключения его из списка активных
(незавершенных) бизнес-процессов. При этом никакие обработчики, кроме <span class="Term">ПередЗаписью</span>
и <span class="Term">ПриЗаписи</span>,
не вызываются. Выполнение ведущей задачи при этом не производится.</p>

<a id="TI000000684" class="bookmark" name="issogl1_13.15.стандартные_реквизиты_бизнес-процессов_и_задач"><h2>13.15.Стандартные реквизиты бизнес-процессов и задач</h2></a>

<p class="MsoNormal">В таблицах перечислены предопределенные поля
бизнес-процессов и задач.</p>

<p class="Regularbeforetable">Стандартные реквизиты бизнес-процессов:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Реквизит </b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Тип</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПометкаУдаления</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Булево</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Номер</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Строка</span>
  или <span class="Term">Число</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Дата</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Дата</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Завершен</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Булево</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВедущаяЗадача</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЗадачаСсылка.&lt;Имя
  задачи&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Ссылка</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">БизнесПроцессСсылка.</span></p>
  <p class="MsoNormalCxSpMiddle"><span class="Term">&lt;Имя
  бизнес-процесса&gt;</span></p>
  </td>
 </tr>
</table>

<p class="Regularbeforetable">Стандартные реквизиты задач:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Реквизит </b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Тип</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПометкаУдаления</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Булево</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Номер</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Строка</span>
  или <span class="Term">Число</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Дата </span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Дата</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Наименование</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Строка</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Выполнена</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Булево</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">БизнесПроцесс</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">БизнесПроцессСсылка.</span></p>
  <p class="MsoNormalCxSpMiddle"><span class="Term">&lt;Имя
  бизнес-процесса&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТочкаМаршрута</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">БизнесПроцессСсылка.</span></p>
  <p class="MsoNormalCxSpMiddle"><span class="Term">&lt;Имя
  бизнес-процесса&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Ссылка</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЗадачаСсылка.&lt;Имя
  задачи&gt;</span></p>
  </td>
 </tr>
</table>

<a id="TI000000685" class="bookmark" name="issogl1_13.16.бизнес-процессы_с_несколькими_точками_старта"><h2>13.16.Бизнес-процессы с несколькими точками старта</h2></a>

<p class="MsoNormalCxSpFirst">Наличие нескольких точек старта предполагает, что выбор
конкретной точки для старта определяется внешними по отношению к
бизнес-процессу условиями.</p>

<p class="MsoNormalCxSpMiddle">Если же бизнес-процесс обладает всей необходимой информацией,
чтобы при старте самостоятельно принять решение о выборе того или иного
маршрута, то достаточно одной точки старта, следом за которой будет идти точка
проверки условия или точка выбора варианта.</p>

<p class="MsoNormalCxSpLast">Если бизнес-процесс имеет несколько точек старта, то
при вызове метода <span class="Term">Старт()</span>
необходимо указать конкретную точку. В противном случае будет выдано сообщение
об ошибке. Поэтому при создании бизнес-процесса с несколькими точками старта
необходимо сделать следующее:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
определить интерактивные команды старта для
указания корректной точки старта в каждом случае старта бизнес-процесса.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
если данный бизнес-процесс является вложенным
для других бизнес-процессов, то в соответствующих точках маршрута нужно
прописать обработчик <span class="Term">ПриСозданииВложенныхБизнесПроцессов()</span>
так, чтобы записывать и стартовать с нужной точки все бизнес-процессы из массива
сформированных.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ВложенноеСогласованиеПриСозданииВложенныхБП<span class="operator">(</span>ТочкаМаршрутаБП<span class="operator">,</span> ФормируемыеПроцессы<span class="operator">,</span> Отказ<span class="operator">)</span>
    <span class="keyword">Для</span> <span class="keyword">каждого</span> БизнесПроцесс <span class="keyword">из</span> ФормируемыеПроцессы <span class="keyword">Цикл</span>
        БизнесПроцесс<span class="operator">.</span>Записать<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
        Точки <span class="operator">=</span> БизнесПроцессы<span class="operator">.</span>СогласованиеДокумента<span class="operator">.</span>ТочкиМаршрута<span class="operator">;</span>
        БизнесПроцесс<span class="operator">.</span>Старт<span class="operator">(</span>Точки<span class="operator">.</span>УпрощенноеСогласование<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЦикла</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormal">В остальном использование бизнес-процессов с несколькими
точками старта ничем не отличается от обычных бизнес-процессов.</p>

<a name="_ref74573561"></a><a id="TI000000686" class="bookmark" name="issogl1_13.17.обратная_связь"><h2>13.17.Обратная связь</h2></a>

<p class="MsoNormalCxSpFirst">Другие объекты информационной базы (документы, элементы
справочников) могут быть вовлечены в бизнес-процессы и могут влиять на них.</p>

<p class="MsoNormalCxSpMiddle">Для эффективного использования механизма
бизнес-процессов возникает необходимость автоматически выполнять соответствующие
задачи при выполнении требуемых операций с другими объектами информационной
базы (например, при проведении документа, при установке скидки по выписанному
счету, при резервировании товара на складе и т. д.).</p>

<p class="MsoNormalCxSpMiddle">Важной особенностью механизма бизнес-процессов в
системе «1С:Предприятие» является то, что он не требует существенного изменения
используемых прикладных решений. Поэтому реакция бизнес-процессов и задач на
изменение других объектов информационной базы может настраиваться без
существенного изменения этих объектов.</p>

<p class="MsoNormalCxSpMiddle">Рассмотрим сказанное на примере. Допустим, что
задача требует проведения документа и нужно, чтобы при проведении документа она
выполнялась автоматически и пользователю не требовалось открывать список задач,
находить в нем нужную задачу и выполнять ее.</p>

<p class="MsoNormalCxSpLast">Для этого последовательно выполним следующие действия:</p>

<p class="MsoListBullet">&#9679; 
Добавим оповещение о проведении в форму
документа:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ПослеЗаписи<span class="operator">(</span>Отказ<span class="operator">)</span>
    <span class="keyword">Если</span> БылоПроведение <span class="keyword">Тогда</span>
        Оповестить<span class="operator">(</span><span class="string">&quot;ПроведениеДокумента&quot;</span><span class="operator">,</span> <span class="operator">,</span> ЭтотОбъект<span class="operator">.</span>Ссылка<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoListBullet">&#9679; 
Зарегистрируем обработчик оповещения. Это можно
сделать в обработчике <span class="Term">ПриНачалеРаботыСистемы()</span>
модуля управляемого приложения:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПодключитьОбработчикОповещения<span class="operator">(</span><span class="string">&quot;ОбработчикОповещения&quot;</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoListBullet">&#9679; 
Из обработчика оповещения вызовем метод
серверного общего модуля (например, <span class="Term">РаботаСБизнесПроцессами</span>), который выполнит
необходимые проверки и задачу:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Обработчик оповещения в модуле управляемого приложения</span>
<span class="keyword">Процедура</span> ОбработчикОповещения<span class="operator">(</span>ИмяСобытия<span class="operator">,</span> Параметр<span class="operator">,</span> Источник<span class="operator">)</span> <span class="keyword">Экспорт</span>
    <span class="keyword">Если</span> ИмяСобытия <span class="operator">=</span> <span class="string">&quot;ПроведениеДокумента&quot;</span> <span class="keyword">Тогда</span>
        РаботаСБизнесПроцессами<span class="operator">.</span>ВыполнитьЗадачуПоДокументу<span class="operator">(</span>Источник<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
...
<span class="preprocessor">&amp;НаСервере</span>
<span class="comment">// Метод серверного общего модуля РаботаСБизнесПроцессами</span>
<span class="keyword">Процедура</span> ВыполнитьЗадачуПоДокументу<span class="operator">(</span>ДокументСсылка<span class="operator">)</span> <span class="keyword">Экспорт</span>
        Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
        Запрос<span class="operator">.</span>УстановитьПараметр<span class="operator">(</span><span class="string">&quot;Парам&quot;</span><span class="operator">,</span> ДокументСсылка<span class="operator">)</span><span class="operator">;</span>
        Запрос<span class="operator">.</span>Текст <span class="operator">=</span> 
                <span class="string">&quot;ВЫБРАТЬ</span>
<span class="string">                |Ссылка </span>
<span class="string">                |ИЗ</span>
<span class="string">                |Задача.Задача.ЗадачиПоИсполнителю</span>
<span class="string">                |</span>
<span class="string">                |ГДЕ</span>
<span class="string">                |Документ = &amp;Парам&quot;</span><span class="operator">;</span>
        Выборка <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
        <span class="keyword">Пока</span> Выборка<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Цикл</span> 
            ТекущаяЗадача <span class="operator">=</span> Выборка<span class="operator">.</span>Ссылка<span class="operator">.</span>ПолучитьОбъект<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
            <span class="keyword">Если</span> ТекущаяЗадача<span class="operator">.</span>ПроверитьВыполнение<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Тогда</span>
                ТекущаяЗадача<span class="operator">.</span>ВыполнитьЗадачу<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
            <span class="keyword">КонецЕсли</span><span class="operator">;</span>
        <span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormalCxSpFirst">Другим способом автоматизированного выполнения задач
является создание регламентного задания (с необходимым расписанием), которое
будет отбирать все задачи по нужному исполнителю, проверять их выполнение и, в
случае успешной проверки, автоматически выполнять их.</p>

<p class="MsoNormalCxSpLast">Рассмотрим специфические особенности конфигурирования
объектов бизнес-процессов и задач.</p>

<a id="TI000000687" class="bookmark" name="issogl1_13.18.карта_маршрута"><h2>13.18.Карта маршрута</h2></a>

<p class="MsoNormalCxSpFirst">Карта
маршрута описывает логику бизнес-процесса и весь его жизненный цикл от точки
старта до точки завершения в виде схематического изображения последовательности
прохождения взаимосвязанных точек маршрута.</p>

<p class="MsoNormalCxSpLast">Для
редактирования карты маршрута на закладке <span class="Interface">Прочее</span> окна редактирования
бизнес-процесса нужно нажать кнопку <span class="Interface">Карта маршрута</span>
(подробнее см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 27. инструменты разработки.htm?_=1496848987#_ref214456149">здесь</a>).</p>

<a id="TI000000688" class="bookmark" name="issogl1_13.19.редактирование_бизнес-процесса"><h2>13.19.Редактирование бизнес-процесса</h2></a>

<p class="MsoNormalCxSpFirst">В процессе конфигурирования может быть создано произвольное
количество видов бизнес-процессов. Назначение каждого бизнес-процесса
определяет его структуру и свойства, которые описываются в конфигурации.</p>

<p class="MsoNormalCxSpMiddle">Конфигуратор позволяет описать структуру
бизнес-процесса, создать формы и карту маршрута бизнес-процесса.</p>

<p class="MsoNormalCxSpMiddle">Свойства бизнес-процессов редактируются в палитре
свойств или окне редактирования объекта (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 2. работа с конфигурацией.htm?_=1496848987#_ref141014392">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Наряду с общими свойствами, присущими всем
объектам метаданных, бизнес-процессы обладают рядом специфических свойств.</p>

<p class="MsoNormalCxSpMiddle">Свойство <span class="Interface">Задачи</span>
определяет ссылку на сконфигурированный ранее объект задачи. Бизнес-процессу
обязательно должна быть назначена одна задача из числа уже существующих в
конфигурации. Задачи используются бизнес-процессом для формирования заданий по
исполнителям или для запуска вложенных бизнес-процессов. Если задача не
назначена, то при сохранении конфигурации базы данных будет выдана ошибка: <span class="Interface">Не выбрана задача бизнес-процесса</span>.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Автонумерация</span>.
Установка свойства приводит к тому, что вновь введенному бизнес-процессу номер
будет присваиваться автоматически. Автоматически присвоенный номер можно
исправить.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Длина номера</span>.
Устанавливает максимальную длину номера бизнес-процесса. Конфигуратор позволяет
установить длину номера равной 0, если в бизнес-процессе данного вида номер не
используется.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Тип номера</span>. Свойство
позволяет выбрать тип значения для номера бизнес-процесса – <span class="Term">Число</span>
или <span class="Term">Строка</span>.
Это свойство аналогично свойству <span class="Interface">Тип номера</span>
документа.</p>

<p class="MsoNormalCxSpMiddle">Выбор строкового типа кода бывает полезен, когда используется
сложная система нумерации, и номер может включать помимо цифр также буквы и
символы-разделители.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Контроль уникальности</span>.
Если это свойство установлено, то при вводе нового бизнес-процесса его номер
проверяется на уникальность в пределах, установленных в свойстве <span class="Interface">Периодичность</span>.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Периодичность</span>.
Свойство устанавливает пределы контроля уникальности номеров бизнес-процессов и
период повторяемости номеров. Если установлено свойство <span class="Interface">Контроль
уникальности</span>, то в свойстве <span class="Interface">Периодичность</span>
указывается, в каких пределах будет осуществляться этот контроль.</p>

<p class="MsoNormalCxSpMiddle">При установленном свойстве <span class="Interface">Автонумерация</span>
система «1С:Предприятие» будет присваивать очередной порядковый номер каждому
новому бизнес-процессу. После завершения периода, установленного в свойстве <span class="Term">Периодичность</span>,
нумерация бизнес-процессов начнется с 1.</p>

<p class="MsoNormalCxSpLast">На закладке <span class="Interface">Права</span>
имеется возможность установки привилегированного режима при создании задач
(свойство <span class="Interface">Привилегированный режим при создании задач</span>):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Если свойство установлено, то все действия по формированию
задач система будет выполнять в привилегированном режиме (при исполнении на
стороне сервере и в файловом варианте). Однако привилегированный режим не будет
установлен, если формирование задач выполняется в клиент-серверном варианте на стороне
толстого клиента.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
При создании новых бизнес-процессов свойство установлено
в значение <span class="Term">Истина</span>,
если в свойствах конфигурации указан основной режим запуска – управляемое
приложение, и в значение <span class="Term">Ложь</span>, если основным режимом запуска указан
обычный.</p>

<p class="MsoNormalCxSpFirst">Помимо основных реквизитов можно создать набор реквизитов,
позволяющих хранить дополнительную информацию.</p>

<p class="MsoNormalCxSpLast">Если объект предметной области, которой
соответствует бизнес-процесс, имеет не только такие «простые» свойства, как,
например, дату, номер, важность или контрольный срок, но и составные (списочные)
свойства, как, например, список документов на согласование, список резолюций,
список участников бизнес-процесса, для бизнес-процесса может быть создан набор
табличных частей.</p>

<a id="TI000000689" class="bookmark" name="issogl1_13.20.редактирование_задачи"><h2>13.20.Редактирование задачи</h2></a>

<p class="MsoNormalCxSpFirst">Объекты типа <span class="Interface">Задачи</span>
предназначены для выдачи и исполнения заданий пользователями системы. Задания могут
формироваться как самими пользователями, так и конкретными бизнес-процессами.</p>

<p class="MsoNormalCxSpMiddle">Задачи могут применяться самостоятельно или использоваться
для обеспечения функционирования бизнес-процессов разного вида.</p>

<p class="MsoNormalCxSpMiddle">В процессе конфигурирования может быть создано произвольное
количество видов задач, однако, как правило, задача создается одна для всех
видов бизнес-процессов.</p>

<p class="MsoNormalCxSpMiddle">Описываемые в конфигурации структура и свойства задачи
определяются особенностями автоматизируемой предметной области.</p>

<p class="MsoNormalCxSpMiddle">Для каждой задачи может быть создано несколько
форм списка, выбора, просмотра и редактирования.</p>

<p class="MsoNormalCxSpMiddle">Все задачи характеризуются номером, датой,
временем и наименованием. При формировании задач бизнес-процессами наименование
устанавливается аналогичным наименованию соответствующей точки маршрута
бизнес-процесса.</p>

<p class="MsoNormalCxSpMiddle">Свойства задачи редактируются в палитре свойств
или окне редактирования объекта (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 2. работа с конфигурацией.htm?_=1496848987#_ref141014392">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Наряду с общими свойствами, присущими всем
объектам метаданных, задачи обладают рядом специфических свойств.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Адресация</span>. Задаче
может быть назначен непериодический регистр сведений, с измерениями которого
можно связать реквизиты адресации задачи. Это связывание позволяет определять
значение основного реквизита адресации задачи на основании данных, содержащихся
в соответствующем регистре сведений, что делает возможной не только прямую адресацию
задач конкретным исполнителям, но и ролевую.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Основной реквизит адресации</span>.
Один из реквизитов адресации задачи может быть назначен основным. В этом случае
именно в этом реквизите адресации необходимо будет указывать конкретного
исполнителя задания. Если исполнитель не будет указан, то значение этого реквизита
адресации будет определяться из связанного с задачей регистра сведений (см.
свойство <span class="Interface">Адресация</span>).</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Текущий исполнитель</span>.
Это свойство устанавливает ссылку на параметр сеанса, в котором будет храниться
текущий исполнитель. Свойство используется, например, как значение по умолчанию
для свойства <span class="Interface">Исполнитель</span> табличного поля списка
задач.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Автопрефикс</span> номера
задачи. Может принимать значения <span class="Interface">Не использовать</span> и
<span class="Interface">Номер бизнес-процесса</span>. Если это свойство установлено
в значение <span class="Interface">Номер бизнес-процесса</span>, то при создании
новой задачи ее номер автоматически дополняется номером соответствующего ей
бизнес-процесса.</p>

<p class="MsoNormalCxSpMiddle">Группа подчиненных объектов <span class="Interface">Реквизиты
адресации</span> устанавливает набор реквизитов, которые определяют тип и размерность
системы адресации задач этого вида в контексте автоматизируемой предметной
области. Один из этих реквизитов может быть установлен основным (см. свойство <span class="Interface">Основной реквизит адресации</span>). Реквизиты адресации можно
связать с измерениями регистра сведений. Это связывание используется системой
для определения значения основного реквизита адресации, если оно не указано, и
делает возможным не только прямую, но и ролевую адресацию.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Длина номера</span>.
Устанавливает максимальную длину номера задачи.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Тип номера</span>. Свойство
позволяет выбрать тип значения для номера задачи – <span class="Term">Число</span> или <span class="Term">Строка</span>.
Выбор строкового типа кода бывает полезен, когда используется сложная система
нумерации и номер может включать помимо цифр также буквы и символы-разделители.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Контроль уникальности</span>.
Если это свойство установлено, то при вводе новой задачи ее номер проверяется
на уникальность.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Автонумерация</span>.
Установка свойства приводит к тому, что вновь введенной задаче номер будет
присваиваться автоматически. Автоматически присвоенный номер можно исправить.</p>

<p class="MsoNormalCxSpMiddle">Если объект предметной
области, которой соответствует задача, имеет не только такие «простые» свойства,
как, например, дату, номер, важность или контрольный срок исполнения, но и
составные (списочные) свойства, как, например, список документов для
согласования, то может быть создан набор табличных частей.</p>

<p class="MsoNormalCxSpMiddle"> </p>

<br>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>