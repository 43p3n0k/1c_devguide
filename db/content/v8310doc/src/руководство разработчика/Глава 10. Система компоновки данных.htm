<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1043;&#1083;&#1072;&#1074;&#1072; 10. &#1057;&#1080;&#1089;&#1090;&#1077;&#1084;&#1072; &#1082;&#1086;&#1084;&#1087;&#1086;&#1085;&#1086;&#1074;&#1082;&#1080; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;</title>
		<LINK REL="stylesheet" href="style.css?_=1496848987">
		<SCRIPT src="script.js?_=1496848987" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js?_=1496848987" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="/db/content/v8310doc/src/руководство разработчика/глава 10. система компоновки данных.htm" rel="canonical">
<link href="/static/its.content.css?_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="/static/its.content.js?_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="/static/html5shiv.js?_=1484636606"></script><![endif]-->

</head>
	<body class="v8310doc">
<a name="_ref215481437"></a><a name="_ref166301231"></a><a id="TI000000543" class="bookmark"><h1>Глава 10.  Система компоновки данных</h1></a>

<p class="MsoNormal">Система компоновки
данных предназначена для создания отчетов «1С:Предприятия» на основе их
декларативного описания. Использование декларативного описания отчетов позволяет
реализовать следующие возможности:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
создание отчета без программирования;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
возможность создания различных вариантов отчета;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
возможность задания различных вариантов
пользовательских настроек;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
использование автоматически генерируемых форм
просмотра и настройки отчета;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
разбиение исполнения отчета на этапы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
исполнение отдельных этапов построения отчета на
различных компьютерах;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
независимое использование отдельных частей
системы компоновки данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
программное влияние на процесс выполнения
отчета;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
настройки структуры отчета;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
совмещение в отчете нескольких таблиц;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
создание вложенных отчетов и др.</p>

<p class="MsoNormal">Возможности системы
компоновки данных используются:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
при работе динамических списков (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 7. формы.htm?_=1496848987#_ref221603703">здесь</a>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
при подготовке данных для последующей обработки
(например, в обработках).</p>

<a id="TI000000544" class="bookmark" name="issogl1_10.1_общие_сведения_о_компоновке_данных"><h2>10.1. Общие сведения о компоновке данных</h2></a>

<p class="MsoNormalCxSpFirst">Система
компоновки данных представляет собой совокупность элементов, каждый из которых
соответствует определенному этапу выполнения отчета. Таким образом, весь процесс
выполнения отчета в системе компоновки данных сводится к последовательному
переходу от одного элемента к другому, доходя в итоге до готового отчета.</p>

<p class="MsoNormalCxSpLast">Каждый
элемент системы компоновки данных имеет собственное декларативное описание,
возможность программного доступа и возможность сериализации в/из XML. Такой подход
позволяет гибко управлять различными этапами выполнения отчета.</p>

<p class="Regularbeforepicture">Основные
элементы системы компоновки данных представлены на <a href="#_ref212348338">рис.364</a>.</p>

<p class="Picture"><IMG src="_img/img00363.gif?_=1496848987" WIDTH="381" ALT HEIGHT="442"></p>

<p class="MsoCaption"><a name="_ref212348338">Рис. </a>364. Основные
элементы системы компоновки данных</p>

<p class="MsoNormal"><span class="Bold">Схема
компоновки данных</span> – описывает суть данных, которые предоставляются
отчету (откуда получать данные и как можно управлять компоновкой данных).
Представляет собой базу, на основе которой могут быть сформированы всевозможные
отчеты. Может содержать:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
текст запроса с инструкциями системы компоновки
данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
описание нескольких наборов данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
описание доступных полей;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
описание связей между несколькими наборами данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
описание параметров получения данных;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
описание макетов полей и группировок и др.</p>

<p class="MsoNormal"><span class="Bold">Настройки
компоновки данных</span> – описывают все, что может настроить разработчик
или пользователь в некоторой установленной схеме компоновки данных. Могут
содержать:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
отбор;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
упорядочивание;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
условное оформление;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
структуру отчета (составные части будущего
отчета);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
параметры получения данных;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
параметры вывода данных и др.</p>

<p class="MsoNormalCxSpFirst"><span class="Bold">Макет компоновки данных</span> – представляет собой уже готовое
описание того, как должен быть сформирован отчет. В нем соединяется схема
компоновки и настройки компоновки. Фактически представляет собой результат
применения конкретных настроек к схеме компоновки и является готовым заданием
процессору компоновки на формирование отчета нужной структуры с учетом конкретных
настроек.</p>

<p class="MsoNormalCxSpLast"><span class="Bold">Элемент результата компоновки данных</span> – результат компоновки
данных представляется набором элементов результата компоновки данных. Как
самостоятельная логическая сущность результат компоновки данных не существует,
существуют только его элементы. Элементы результата компоновки данных можно
вывести в табличный документ для представления их конечному пользователю или в
другие виды документов.</p>

<p class="Regularbeforepicture">Процесс
компоновки данных состоит из нескольких этапов, которые представлены на <a href="#_ref212348480">рис.365</a>.</p>

<p class="Picture"><IMG src="_img/img00364.gif?_=1496848987" WIDTH="245" ALT HEIGHT="422"></p>

<p class="MsoCaption"><a name="_ref212348480">Рис. </a>365. Этапы процесса
компоновки данных</p>

<p class="MsoNormal">Создание схемы
компоновки данных может быть выполнено:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
визуально, при помощи конструктора схемы компоновки
данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
визуально, при помощи любого редактора, позволяющего
редактировать текст XML;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
программно, при помощи объектов встроенного языка
системы «1С:Предприятие».</p>

<p class="MsoNormalCxSpFirst"><span class="Bold">Редактирование настроек компоновки данных</span> – для редактирования
настроек компоновки в системе предусмотрен ряд объектов встроенного языка и
расширений табличного поля.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Подготовка к исполнению</span> – процесс формирования макета
компоновки данных. В данном процессе формируются запросы, необходимые для
получения данных, указанных в настройках, формируются макеты областей отчета.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Исполнение компоновки данных</span> – это процесс получения,
агрегации, оформления данных.</p>

<p class="MsoNormalCxSpLast"><span class="Bold">Вывод результата компоновки данных</span> – полученный результат
компоновки может быть выведен в документ, который будет показан пользователю.
Отчет может быть выведен в различных форматах.</p>

<p class="Regularbeforepicture">Схема на
<a href="#_ref214973974">рис.366</a> в обобщенном виде представляет объекты системы
компоновки данных, используемые на различных этапах создания отчета.</p>

<p class="Picture"><IMG src="_img/img00365.gif?_=1496848987" WIDTH="536" ALT HEIGHT="516"></p>

<p class="MsoCaption"><a name="_ref214973974">Рис. </a>366. Объекты
системы компоновки данных</p>

<p class="MsoNormalCxSpFirst"><span class="Bold">Конструктор схемы компоновки данных</span> – может быть использован
для создания схемы компоновки данных.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Компоновщик настроек компоновки данных</span> – может быть
использован для редактирования настроек системы компоновки данных.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Компоновщик макета компоновки данных</span> – используется для
подготовки к исполнению.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Процессор компоновки данных</span> – осуществляет исполнение
компоновки данных.</p>

<p class="MsoNormalCxSpMiddle"><span class="Bold">Процессор вывода результата компоновки данных в табличный документ</span> –
выводит элементы результата компоновки данных в табличный документ.</p>

<p class="MsoNormalCxSpLast">Отличительной
особенностью отчета, получаемого с помощью системы компоновки данных, является
то, что он может иметь сложную структуру, включающую в себя различное сочетание
следующих элементов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
группировка,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблица,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
диаграмма,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
вложенный отчет.</p>

<p class="Regularbeforepicture">Таким
образом, отчет, полученный с помощью системы компоновки данных, представляет
собой не таблицу, а сложную иерархическую структуру, в которой участвуют
перечисленные элементы.</p>

<p class="Picture"><IMG src="_img/img00366.gif?_=1496848987" WIDTH="800" ALT HEIGHT="647"></p>

<p class="MsoCaption">Рис. 367. Структура отчета</p>

<p class="MsoNormal">На данном рисунке
приведен пример отчета, содержащего на первом уровне иерархии диаграмму и
группировку по номенклатурным группам. А внутри группировки по номенклатурным
группам расположена таблица, содержащая обороты номенклатуры, принадлежащей
указанной номенклатурной группе.</p>

<a id="TI000000545" class="bookmark" name="issogl1_10.2_общие_объекты_системы_компоновки_данных"><h2>10.2. Общие объекты системы компоновки данных</h2></a>

<a id="TI000000546" class="bookmark" name="issogl2_10.2.1_свойство_использование"><h3>10.2.1. Свойство «Использование»</h3></a>

<p class="MsoNormal">Многие объекты, в
основном подсистемы настроек компоновки данных, имеют свойство булевого типа <span class="Term">Использование</span>. Это свойство позволяет
отключать часть функциональности без ее физического удаления. Значение этого
свойства по умолчанию – <span class="Term">Истина</span>,
кроме отдельно описанных случаев.</p>

<a id="TI000000547" class="bookmark" name="issogl2_10.2.2_поле_системы_компоновки_данных"><h3>10.2.2. Поле системы компоновки данных</h3></a>

<p class="MsoNormal">Это объект,
представляющий путь к данным поля. Поле реализовано в виде отдельного типа с
целью устранить неоднозначность в свойствах некоторых объектов, которые могут
принимать значения как строк, так и полей. Имеет конструктор с параметром <span class="Term">Строка</span>, описывающий путь к данным; свойств и методов
не имеет. Если путь к данным содержит идентификатор с пробелами
или специальными символами, то такие идентификаторы следует заключать в
квадратные скобки.</p>

<a id="TI000000548" class="bookmark" name="issogl2_10.2.3_параметры_системы_компоновки_данных"><h3>10.2.3. Параметры системы компоновки данных</h3></a>

<p class="MsoNormal">Механизм параметров
был реализован для единообразного использования и редактирования коллекций некоторых
значений, состав и тип элементов которых определен заранее и не может быть
изменен. Механизм параметров состоит из двух частей:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Доступные параметры – определяют состав
коллекции и допустимые типы ее элементов. Параметр является аналогом поля
системы компоновки данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Значения параметров.</p>

<a name="_ref216099257"></a><a id="TI000000549" class="bookmark" name="issogl1_10.3_схема_компоновки_данных"><h2>10.3. Схема компоновки данных</h2></a>

<p class="MsoNormalCxSpFirst">Схема
компоновки данных представляется объектом встроенного языка системы «1С:Предприятие»
<span class="Term">СхемаКомпоновкиДанных</span>
и состоит из множества других вложенных объектов. Схема компоновки данных имеет
представление в виде XML; таким образом, может быть создана любыми средствами,
позволяющими генерировать XML, равно как и использована любыми средствами,
которые могут читать XML.</p>

<p class="MsoNormalCxSpMiddle">Схема
компоновки данных используется для предоставления информации о доступных
настройках, а также при формировании макета компоновки данных (см. <a href="#_ref215655387">здесь</a>), т. е. при исполнении компоновки данных.</p>

<p class="MsoNormalCxSpMiddle">Для
визуального редактирования схемы компоновки данных предназначен конструктор
схемы компоновки данных (см. <a href="#_ref166301286">здесь</a>).</p>

<p class="MsoNormalCxSpLast">Загрузку
схемы компоновки данных из XML можно осуществить стандартными средствами
встроенного языка.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЧтениеXML <span class="operator">=</span> <span class="keyword">Новый</span> ЧтениеXML<span class="operator">;</span>
ЧтениеXML<span class="operator">.</span>УстановитьСтроку<span class="operator">(</span>ЭлементыФормы<span class="operator">.</span>ТекстСхемыКомпоновкиДанных<span class="operator">.</span>ПолучитьТекст<span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
СКД <span class="operator">=</span> СериализаторXDTO<span class="operator">.</span>ПрочитатьXML<span class="operator">(</span>ЧтениеXML<span class="operator">,</span> Тип<span class="operator">(</span><span class="string">&quot;СхемаКомпоновкиДанных&quot;</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">Все выражения,
описываемые в схеме компоновки данных, записываются на языке выражений системы
компоновки данных (см. <a href="#_ref216148128">здесь</a>).</p>

<a id="TI000000550" class="bookmark" name="issogl2_10.3.1_составные_части_схемы_компоновки_данных"><h3>10.3.1. Составные части схемы компоновки данных</h3></a>

<p class="Regularbeforepicture">Каждая
схема компоновки данных содержит множество объектов, описывающих ту или иную
часть. Рассмотрим эти составные части.</p>

<p class="Picture"><IMG src="_img/img00367.gif?_=1496848987" WIDTH="279" ALT HEIGHT="455"></p>

<p class="MsoCaption">Рис. 368. Составные части схемы компоновки данных</p>

<a name="_ref216148244"></a><a id="TI000000551" class="bookmark" name="issogl3_10.3.1.1_источники_данных"><h4>10.3.1.1. Источники данных</h4></a>

<p class="MsoNormalCxSpFirst">Схема
компоновки данных может содержать несколько источников данных.</p>

<p class="MsoNormalCxSpMiddle">Под
источником данных подразумевается источник, из которого будут получаться
данные. В качестве источника данных выступает информационная база системы «1С:Предприятие».</p>

<p class="MsoNormalCxSpLast">Источники
данных описываются в свойстве <span class="Term">ИсточникиДанных</span>
схемы, которое содержит коллекцию значений, состоящую из элементов <span class="Term">ИсточникДанныхСхемыКомпоновкиДанных</span>.</p>

<a id="TI000000552" class="bookmark" name="issogl3_10.3.1.2_наборы_данных"><h4>10.3.1.2. Наборы данных</h4></a>

<p class="MsoNormalCxSpFirst">Наборы
данных в схеме компоновки данных содержат информацию о том, какие поля можно
получать из данного набора, какие поля набора данных можно использовать в отборе
и т. п.</p>

<p class="MsoNormalCxSpMiddle">В схеме
компоновки данных допускается наличие нескольких наборов данных (см. <a href="#_ref216148174">здесь</a>).</p>

<p class="MsoNormalCxSpLast">Наборы
данных описываются в свойстве <span class="Term">НаборыДанных</span>
схемы. Свойство содержит коллекцию значений, в которую могут входить следующие
элементы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Bold">запрос</span> (<span class="Term">НаборДанныхЗапросСхемыКомпоновкиДанных</span>) –
получение данных описывается при помощи языка запросов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Bold">объект</span> (<span class="Term">НаборДанныхОбъектСхемыКомпоновкиДанных</span>) –
описывается имя внешнего набора данных, из которого будут получаться данные;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Bold">объединение</span> (<span class="Term">НаборДанныхОбъединениеСхемыКомпоновкиДанных</span>) –
описываются наборы данных – составные части объединения.</p>

<p class="MsoNormal">Все три набора
данных содержат ряд общих свойств:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Имя</span> – имя
набора данных, под которым к этому набору данных можно будет обращаться из
других объектов схемы компоновки данных. В рамках одной схемы компоновки данных
имена наборов данных должны быть уникальными.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Поля</span> – описания
полей, доступных для набора данных.</p>

<p class="MsoNormalCxSpFirst">Кроме
этого, наборы данных – запрос и объект содержат свойство <span class="Term">ИсточникДанных</span> – имя источника данных, из
которого будут получаться данные. Оно должно содержать имя одного источника
данных, присутствующего в схеме компоновки данных (см. <a href="#_ref216148244">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Набор
данных – запрос содержит свойство <span class="Term">Запрос</span> –
текст запроса, при помощи которого будут получаться данные из источника данных.
В тексте запроса допускается использование специального расширения – расширения
языка запросов для системы компоновки данных (см. <a href="#_ref216148275">здесь</a>).</p>

<p class="MsoNormalCxSpLast">Набор
данных – объединение содержит свойство <span class="Term">Элементы</span>,
содержащее перечень наборов данных, входящих в объединение (см. <a href="#_ref216148316">здесь</a>).</p>

<a id="TI000000553" class="bookmark" name="issogl4_10.3.1.2.1_набор_данных_запрос"><h5>10.3.1.2.1. Набор данных – запрос</h5></a>

<p class="MsoNormalCxSpFirst">Содержит
обычный запрос к данным, расположенным в информационной базе «1С:Предприятия».</p>

<p class="MsoNormalCxSpMiddle">Набор данных – запрос может содержать
пакетный запрос. Результирующим запросом будет пакетный запрос. При этом состав
полей, которые будут помещаться во временную таблицу, автоматически
определяется по использованным в других запросах полям. В случае, если от
временной таблицы не понадобилось ни одно поле, временная таблица не будет
помещаться в результирующий запрос. Отбор, применяемый в настройках компоновки
данных, применяется во всех запросах пакета.</p>

<p class="MsoNormalCxSpMiddle">Содержимым набора данных будет считаться
результат последнего запроса пакета.</p>

<p class="MsoNormalCxSpLast">В рамках
одного набора данных возможно обращение только к одному источнику данных
(включая внешние источники данных).</p>

<a id="TI000000554" class="bookmark" name="issogl4_10.3.1.2.2_набор_данных_объект"><h5>10.3.1.2.2. Набор данных – объект</h5></a>

<p class="MsoNormalCxSpFirst">Набор
данных – объект используется для вывода в отчет информации из некоторого
объекта встроенного языка: таблицы значений, результата запроса, текущего
документа и т. п.</p>

<p class="MsoNormalCxSpLast">Этот
«источник» данных описывается в схеме компоновки, затем он заполняется
программным образом, например, по нажатию какой-то кнопки, и в качестве
внешнего набора данных передается в процессор компоновки.</p>

<a name="_ref216148316"></a><a id="TI000000555" class="bookmark" name="issogl4_10.3.1.2.3_набор_данных_объединение"><h5>10.3.1.2.3. Набор данных – объединение</h5></a>

<p class="MsoNormalCxSpFirst">Набор
данных – объединение содержит свойство <span class="Term">Элементы</span>,
описывающее наборы данных, которые необходимо объединить.</p>

<p class="MsoNormalCxSpLast">Заметим,
что значения полей набора данных – объединение будут получаться из полей
вложенных наборов данных по их пути к данным. Так, в приведенном примере у
внешнего набора данных будет поле <span class="Term">СуммаРасх</span>.
Данные для него будут получаться из вложенных наборов данных, у которых путь к
данным – <span class="Term">СуммаРасход</span>.</p>

<a id="TI000000556" class="bookmark" name="issogl4_10.3.1.2.4_поле_набора_данных_схемы_компоновки_данных"><h5>10.3.1.2.4. Поле набора данных схемы компоновки данных</h5></a>

<p class="MsoNormalCxSpFirst">Набор
данных может содержать описания полей, которые будут доступны для этого набора
данных.</p>

<p class="MsoNormalCxSpLast">Поля набора
данных описываются в свойстве <span class="Interface">Поля наборов данных</span>, которое содержит коллекцию
значений, состоящую из элементов <span class="Term">ПолеНабораДанныхСхемыКомпоновкиДанных</span>.</p>

<a id="TI000000557" class="bookmark" name="issogl3_10.3.1.3_связи_наборов_данных"><h4>10.3.1.3. Связи наборов данных</h4></a>

<p class="MsoNormalCxSpFirst">Наборы
данных, присутствующие в схеме компоновки данных, могут быть связаны друг с
другом.</p>

<p class="MsoNormalCxSpLast">Связи
наборов данных описываются в свойстве <span class="Term">СвязиНаборовДанных</span>
схемы компоновки данных, которое содержит коллекцию значений, состоящую из
элементов <span class="Term">СвязьНаборовДанныхСхемыКомпоновкиДанных</span>.</p>

<a name="_ref414355077"></a><a id="TI000000558" class="bookmark" name="issogl3_10.3.1.4_вычисляемые_поля"><h4>10.3.1.4. Вычисляемые поля</h4></a>

<p class="MsoNormalCxSpFirst">В схеме
компоновки данных существует возможность описать поля, которые будут
вычисляться по некоторым выражениям с использованием полей наборов данных.
Данные поля могут быть использованы в настройках точно так же, как поля набора
данных, за исключением следующего: не поддерживается использование реквизитов
вычисляемых полей, не поддерживается иерархическая группировка по вычисляемым полям.</p>

<p class="MsoNormalCxSpLast">Вычисляемые
поля описываются в свойстве <span class="Term">ВычисляемыеПоляСхемыКомпоновкиДанных</span>
схемы компоновки данных, которое содержит коллекцию значений, состоящую из элементов
<span class="Term">ВычисляемоеПолеСхемыКомпоновкиДанных</span>.</p>

<a id="TI000000559" class="bookmark" name="issogl3_10.3.1.5_поля_ресурсов"><h4>10.3.1.5. Поля ресурсов</h4></a>

<p class="MsoNormalCxSpFirst">В схеме
компоновки данных возможно описание полей ресурсов, значения которых будут
вычисляться для групповых записей. Осуществляется это при помощи описания поля
итога.</p>

<p class="MsoNormalCxSpLast">Поля итога
описываются в свойстве <span class="Term">ПоляИтога</span>
схемы компоновки данных, которое содержит коллекцию значений, состоящую из
элементов <span class="Term">ПолеИтогаСхемыКомпоновкиДанных</span>.
При расчете ресурсов каждая запись набора данных, для которого рассчитывается
ресурс, участвует в расчете ресурса только один раз.</p>

<a id="TI000000560" class="bookmark" name="issogl3_10.3.1.6_параметры"><h4>10.3.1.6. Параметры</h4></a>

<p class="MsoNormalCxSpFirst">Схема
компоновки данных содержит описание параметров данных.</p>

<p class="MsoNormalCxSpMiddle">Параметры
данных описываются в свойстве <span class="Interface">Параметры схемы компоновки данных</span>, которое содержит
коллекцию значений, состоящую из элементов <span class="Term">ПараметрСхемыКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">Для
параметра можно указать признак обязательности использования параметров и
запрет незаполненного параметра. Например, с помощью комбинации этих признаков
можно реализовать параметр, без заполнения которого формирование отчета невозможно.</p>

<a id="TI000000561" class="bookmark" name="issogl3_10.3.1.7_вложенные_схемы"><h4>10.3.1.7. Вложенные схемы</h4></a>

<p class="MsoNormalCxSpFirst">Схема
компоновки данных может содержать описания вложенных схем компоновки данных.</p>

<p class="MsoNormalCxSpLast">Вложенные
схемы компоновки данных описываются в свойстве <span class="Term">ВложенныеСхемыКомпоновкиДанных</span>
схемы компоновки данных, которое содержит коллекцию значений, состоящую из
элементов <span class="Term">ВложеннаяСхемаКомпоновкиДанных</span>.</p>

<a id="TI000000562" class="bookmark" name="issogl3_10.3.1.8_макеты"><h4>10.3.1.8. Макеты</h4></a>

<p class="MsoNormalCxSpFirst">В схеме
компоновки данных можно описать макеты, которые будут использоваться для вывода
поля или группировки. При указании макета для поля или группировки указывается
имя макета, описанного в данном свойстве.</p>

<p class="MsoNormalCxSpLast">Макеты
описываются в свойстве <span class="Interface">Макеты схемы компоновки данных</span>. Свойство содержит
коллекцию значений, состоящую из элементов <span class="Term">ОписаниеМакетаСхемыКомпоновкиДанных</span>.</p>

<a id="TI000000563" class="bookmark" name="issogl3_10.3.1.9_макеты_полей"><h4>10.3.1.9. Макеты полей</h4></a>

<p class="Regularbeforepicture">Для
каждого поля в схеме компоновки данных может быть указано имя макета,
используемого для вывода данного поля в результат компоновки.</p>

<p class="Picture"><IMG src="_img/img00368.gif?_=1496848987" WIDTH="564" ALT HEIGHT="361"></p>

<p class="MsoCaption">Рис. 369. Макеты полей</p>

<p class="MsoNormal">Связь поля с
макетом описывается с помощью объекта <span class="Term">МакетПоляСхемыКомпоновкиДанных</span>.
Коллекция этих объектов содержится в свойстве <span class="Term">МакетыПолей</span>
объекта <span class="Term">СхемаКомпоновкиДанных</span>.</p>

<a id="TI000000564" class="bookmark" name="issogl3_10.3.1.10_макеты_группировок"><h4>10.3.1.10. Макеты группировок</h4></a>

<p class="MsoNormalCxSpFirst">Для каждой
группировки в схеме компоновки данных можно указать имя макета, который будет
использоваться при выводе данной группировки.</p>

<p class="MsoNormalCxSpLast">Связь
группировки с макетом описывается с помощью объекта <span class="Term">МакетГруппировкиСхемыКомпоновкиДанных</span>. Коллекция
этих объектов содержится в свойстве <span class="Term">МакетыГруппировок</span>
объекта <span class="Term">СхемаКомпоновкиДанных</span>.</p>

<a id="TI000000565" class="bookmark" name="issogl3_10.3.1.11_макеты_заголовков_группировок"><h4>10.3.1.11. Макеты заголовков группировок</h4></a>

<p class="MsoNormalCxSpFirst">Для каждой
группировки могут описываться также макеты заголовков группировок.</p>

<p class="MsoNormalCxSpLast">Связь
заголовка группировки с макетом описывается с помощью объекта <span class="Term">МакетГруппировкиСхемыКомпоновкиДанных</span>
(см. предыдущий раздел). Коллекция этих объектов содержится в свойстве <span class="Term">МакетыЗаголовковГруппировок</span> объекта <span class="Term">СхемаКомпоновкиДанных</span>.</p>

<a id="TI000000566" class="bookmark" name="issogl3_10.3.1.12_настройки_по_умолчанию"><h4>10.3.1.12. Настройки по умолчанию</h4></a>

<p class="Regularbeforepicture">Каждый
вариант отчета, который задан в схеме компоновки данных, содержит настройки
компоновки данных по умолчанию, которые могут быть заданы разработчиком. При
этом вариантом по умолчанию будет считаться тот вариант, который стоит первым в
списке вариантов настроек системы компоновки данных (вариант <span class="Interface">Диаграмма по периодам</span>
на <a href="#_ref215655275">рис.370</a>). Настройки варианта по умолчанию будут применяться
при первом открытии отчета, при выборе команды Еще – Стандартные
настройки (<span class="Interface">Все действия – Стандартные
настройки</span>), а
также могут быть использованы для программной установки настроек по умолчанию.</p>

<p class="Picture"><IMG src="_img/img00369.gif?_=1496848987" WIDTH="604" ALT HEIGHT="437"></p>

<p class="MsoCaption"><a name="_ref215655275">Рис. </a>370. Вариант по
умолчанию</p>

<p class="MsoNormal">Подробнее о
настройках компоновки данных см. <a href="#_ref215370820">здесь</a>.</p>

<a name="_ref216148174"></a><a id="TI000000567" class="bookmark" name="issogl2_10.3.2_работа_с_несколькими_наборами_данных"><h3>10.3.2. Работа с несколькими наборами данных</h3></a>

<p class="MsoNormalCxSpFirst">Система
компоновки данных позволяет использовать в одной компоновке несколько наборов
данных.</p>

<p class="MsoNormalCxSpMiddle">Для того
чтобы в одной компоновке использовать несколько наборов данных, необходимо
внести в схему описания наборов данных, которые предполагается использовать, и
указать связи между наборами данных.</p>

<p class="MsoNormalCxSpLast">Рассмотрим
следующий пример.</p>

<p class="Regularbeforepicture">Запишем
три набора данных: <span class="Term">ПрайсЛист</span>,
<span class="Term">Остатки</span> и <span class="Term">Продажи</span>.</p>

<p class="Picture"><IMG src="_img/img00370.gif?_=1496848987" WIDTH="388" ALT HEIGHT="224"></p>

<p class="MsoCaption">Рис. 371. Пример нескольких наборов данных</p>

<p class="Regularbeforepicture">Опишем связи
между наборами данных. Создадим связь между наборами данных <span class="Term">ПрайсЛист</span> и <span class="Term">Остатки</span>,
а также связь между наборами данных <span class="Term">ПрайсЛист</span>
и <span class="Term">Продажи</span> (см. <a href="#_ref215372291">рис.372</a>).</p>

<p class="Picture"><IMG src="_img/img00371.gif?_=1496848987" WIDTH="591" ALT HEIGHT="185"></p>

<p class="MsoCaption"><a name="_ref215372291">Рис. </a>372. Связи наборов
данных</p>

<p class="Regularbeforepicture">Дополнительно
опишем ресурсы (см. <a href="#_ref215372299">рис.373</a>).</p>

<p class="Picture"><IMG src="_img/img00372.gif?_=1496848987" WIDTH="800" ALT HEIGHT="341"></p>

<p class="MsoCaption"><a name="_ref215372299">Рис. </a>373. Ресурсы схемы
компоновки данных</p>

<p class="Regularbeforepicture">Если в
системе компоновки данных описывается связь между двумя наборами данных, то
набор данных, к которому идет связь, будет считаться <span class="Bold">зависимым</span>.
Набор данных, от которого идет связь, будет считаться <span class="Bold">родительским</span>
по отношению к зависимому от него набору данных.</p>

<p class="Picture"><IMG src="_img/img00373.gif?_=1496848987" WIDTH="328" ALT HEIGHT="129"></p>

<p class="MsoCaption">Рис. 374. Зависимые наборы данных</p>

<p class="MsoNormalCxSpFirst">В
приведенных примерах зависимыми наборами данных будут наборы данных <span class="Term">Остатки</span> и <span class="Term">Продажи</span>.
А родительским по отношению к обоим этим наборам – <span class="Term">ПрайсЛист</span>.</p>

<p class="MsoNormalCxSpMiddle">В схеме
компоновки данных нет указания типа связи. Все связи считаются левыми внешними
соединениями. То есть запись родительского набора данных будет использоваться в
компоновке даже в том случае, если для нее не найдены записи в зависимом
наборе.</p>

<p class="MsoNormalCxSpLast">В макете
компоновки данных (см. <a href="#_ref215655387">здесь</a>) возможно указание типа связи. Тип связи генерируется
компоновщиком макета в зависимости от накладываемых глобальных отборов. Если на
поле набора данных, являющегося зависимым, накладывается глобальный отбор,
генерируемые связи в макете компоновки данных от этого набора данных до всех
его родительских наборов (вплоть до начала иерархии наборов данных) будут иметь
тип <span class="Term">Внутренняя</span>. Это
означает, что записи родительского набора данных будут участвовать в компоновке
только в том случае, если будут найдены записи в зависимых наборах данных.</p>

<p class="Regularbeforepicture">Например,
если пользователь наложит глобальный отбор на поле <span class="Term">Склад</span>, наборы данных <span class="Term">ПрайсЛист</span> и <span class="Term">Остатки</span>
будут связаны внутренней связью.</p>

<p class="Picture"><IMG src="_img/img00374.gif?_=1496848987" WIDTH="231" ALT HEIGHT="189"></p>

<p class="MsoCaption">Рис. 375. Внутренняя связь</p>

<p class="MsoNormal">Если набор данных
зависит от некоторого набора и в связи указана возможность использования списка
параметров, данные из зависимого набора данных будут получаться порциями по
1000 записей. В случае, если использование списка параметров в связи не
разрешено, записи будут получаться по одной.</p>

<p class="Regularbeforepicture">Если и
зависимый, и родительский набор данных содержит поле с одинаковым именем,
данное поле будет получаться из родительского набора данных. В приведенных
примерах поле <span class="Term">Номенклатура</span>
всегда будет получаться из набора данных <span class="Term">ПрайсЛист</span>.</p>

<p class="Picture"><IMG src="_img/img00375.gif?_=1496848987" WIDTH="505" ALT HEIGHT="221"></p>

<p class="MsoCaption">Рис. 376. Общее поле</p>

<p class="MsoNormalCxSpFirst">Несвязанные
наборы данных не могут содержать поля с одинаковыми именами, если у них нет
общего родителя, в котором данное поле также присутствует. Так, наборы данных <span class="Term">Остатки</span> и <span class="Term">Обороты</span>
могут содержать поле <span class="Term">Номенклатура</span>,
но не могли бы оба содержать поле <span class="Term">Контрагент</span>.</p>

<p class="MsoNormalCxSpMiddle">В
описании связи, в выражении источника, используются поля из набора данных
источника (родительского набора); в выражении связи приемника используются поля
набора данных приемника (зависимого набора данных). Так, при описании связи
между наборами данных <span class="Term">ПрайсЛист</span>
и <span class="Term">Остатки</span> выражение <span class="Term">Номенклатура</span> в свойстве <span class="Term">ВыражениеИсточник</span> использует поле набора данных
<span class="Term">ПрайсЛист</span>, а
выражение <span class="Term">Номенклатура</span> в
свойстве <span class="Term">ВыражениеПриемник</span>
использует поле набора данных <span class="Term">Остатки</span>.</p>

<p class="MsoNormalCxSpMiddle">В одной
группировке не могут быть использованы поля из не связанных друг с другом
наборов данных. При этом наборы данных, имеющие общие родительские наборы данных,
связанными не считаются. Исключение сделано для полей-итогов, которые могут
быть использованы в любой группировке. В приведенном примере мы не сможем в
одной группировке задействовать поля <span class="Term">Склад</span>
и <span class="Term">Контрагент</span>. Однако
поля <span class="Term">КоличествоОстаток</span>
и <span class="Term">СуммаОборот</span> сможем
задействовать, т. к. они являются ресурсами.</p>

<p class="MsoNormalCxSpMiddle">Данные
зависимого набора данных не могут быть получены без получения данных
родительского набора. То есть при получении данных из зависимого набора автоматически
будут получаться и данные из родительского набора (и всех родителей родителя).
В нашем примере при получении набора данных <span class="Term">Остатки</span>
будут получаться данные и из набора <span class="Term">ПрайсЛист</span>.</p>

<p class="MsoNormalCxSpMiddle">Если в
группировке используются наборы данных из нескольких наборов данных, при
исполнении компоновки будет осуществляться обход по последнему зависимому
набору данных. Так, если в группировке будут использоваться поля наборов <span class="Term">ПрайсЛист</span> и <span class="Term">Остатки</span>,
обход будет происходить по набору <span class="Term">Остатки</span>.</p>

<p class="MsoNormalCxSpLast">Если ни
одного поля из связанного набора данных в настройках не задействовано, набор
данных не будет включен в макет компоновки данных.</p>

<a name="_ref216148275"></a><a name="_ref428962417"></a><a id="TI000000568" class="bookmark" name="issogl2_10.3.3_расширение_языка_запросов_для_системы_компоновки_данных"><h3>10.3.3. Расширение языка запросов для системы компоновки данных</h3></a>

<p class="MsoNormal">Расширение языка
запросов для системы компоновки данных осуществляется при помощи специальных синтаксических
инструкций, заключаемых в фигурные скобки и помещаемых непосредственно в текст
запроса.</p>

<a name="_ref331503894"></a><a id="TI000000569" class="bookmark" name="issogl3_10.3.3.1_синтаксические_элементы_расширения_языка_запросов_системы_компоновки_данных"><h4>10.3.3.1. Синтаксические элементы расширения языка запросов системы компоновки данных</h4></a>

<p class="Lang">ВЫБРАТЬ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">В этом
предложении описываются поля, которые пользователь сможет выбирать для вывода.
После данного ключевого слова через запятую перечисляются псевдонимы полей из
основного списка выборки запроса, которые будут доступными для настройки.</p>

<p class="MsoNormalCxSpMiddle">После
псевдонима поля может находиться комбинация символов «<span class="Term">.*</span>», что обозначает возможность использования
дочерних полей от данного поля.</p>

<p class="MsoNormalCxSpLast">Например,
запись <span class="Term">Номенклатура.*</span>
обозначает возможность использования дочерних полей поля <span class="Term">Номенклатура</span> (например, поля <span class="Term">Номенклатура.Код</span>). Элемент <span class="Term">ВЫБРАТЬ</span> может присутствовать только в первом
запросе объединения.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">{ВЫБРАТЬ Номенклатура<span class="operator">,</span> Склад}</pre>

<p class="Lang">ГДЕ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Описываются
поля, на которые пользователь сможет накладывать отбор. В данном предложении
используются поля таблиц. Использование псевдонимов полей списка выборки
недопустимо. Каждая часть объединения может содержать собственный элемент <span class="Term">ГДЕ</span>.</p>

<p class="MsoNormalCxSpLast">Если
значения параметров не заданы, то предложение <span class="Term">ГДЕ</span>
в результирующий запрос не включается.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">{ГДЕ Номенклатура<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span> Склад }
{ГДЕ Документ<span class="operator">.</span>Дата <span class="operator">&gt;</span><span class="operator">=</span> &ДатаНачала<span class="operator">,</span> Документ<span class="operator">.</span>Дата <span class="operator">&lt;</span><span class="operator">=</span> &ДатаКонца}</pre>

<p class="Lang">ХАРАКТЕРИСТИКИ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Для
обеспечения работы с характеристиками в расширение языка запросов для системы
компоновки данных введен синтаксис описания характеристик.</p>

<p class="MsoNormalCxSpMiddle">В примере
(см. далее) описываются характеристики для полей типа <span class="Term">Ссылка</span> на справочник <span class="Term">Номенклатура</span>.</p>

<p class="MsoNormalCxSpLast">В характеристиках
описываются следующие свойства:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">ТИП</span> – имя типа, для которого описываются
характеристики.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ВИДЫХАРАКТЕРИСТИК</span> – имя таблицы или
запрос для получения списка характеристик. В запросе допустимо использовать
ключевое слово <span class="Term">РАЗРЕШЕННЫЕ</span>.
В этом случае в списке характеристик будут присутствовать только те
характеристики, которые допускаются для пользователя наложенными ограничениями
доступа к данным.</p>

<p class="Indentlist">Если список
характеристик указан не запросом, а именем таблицы, то в запросе получения
списка характеристик, который формирует система, также используется ключевое
слово <span class="Term">РАЗРЕШЕННЫЕ</span>.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">ПОЛЕКЛЮЧА</span> – имя поля, содержащего идентификатор
характеристики.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПОЛЕИМЕНИ</span> – имя поля, содержащего имя
характеристики.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПОЛЕТИПАЗНАЧЕНИЯ</span> – имя поля, содержащего
тип значения характеристики. Если тип значения не указан, считается, что
характеристика имеет тип <span class="Term">Булево</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ЗНАЧЕНИЯХАРАКТЕРИСТИК</span> – имя таблицы или
запрос для получения значений характеристик.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПОЛЕОБЪЕКТА</span> – имя поля, содержащего
идентификатор объекта (например, ссылка номенклатуры).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПОЛЕВИДА</span> – имя поля, содержащего идентификатор
характеристики.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ПОЛЕЗНАЧЕНИЯ</span> – имя поля, содержащего
значение характеристики. Если не указано, значение будет равно <span class="Term">Истина</span> (если такая характеристика у объекта
есть), <span class="Term">Ложь</span> – в противном
случае.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">{ХАРАКТЕРИСТИКИ ТИП<span class="operator">(</span>Справочник<span class="operator">.</span>Номенклатура<span class="operator">)</span>
    ВИДЫХАРАКТЕРИСТИК <span class="operator">(</span><span class="keyword">ВЫБРАТЬ</span>
        ВидыДопСвойств<span class="operator">.</span>Ссылка<span class="operator">,</span>
        ВидыДопСвойств<span class="operator">.</span>Наименование<span class="operator">,</span>
        ВидыДопСвойств<span class="operator">.</span>ТипЗначения
    <span class="keyword">ИЗ</span>
        ПланВидовХарактеристик<span class="operator">.</span>ВидыДопСвойств <span class="keyword">КАК</span> ВидыДопСвойств<span class="operator">)</span>
    ПОЛЕКЛЮЧА Ссылка
    ПОЛЕИМЕНИ Наименование
    ПОЛЕТИПАЗНАЧЕНИЯ ТипЗначения
    ЗНАЧЕНИЯХАРАКТЕРИСТИК РегистрСведений<span class="operator">.</span>ДопСвойства
    ПОЛЕОБЪЕКТА Номенклатура
    ПОЛЕВИДА ВидСвойства
    ПОЛЕЗНАЧЕНИЯ Свойство
}</pre>

<p class="Lang">Параметры</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Кроме
основных элементов система компоновки данных принимает элементы, записанные в
параметрах виртуальных таблиц. В таких случаях тип полей зависит от типа параметра,
в котором располагаются элементы.</p>

<p class="MsoNormalCxSpLast">Поля <span class="Term">ДатаНачала</span>, <span class="Term">ДатаКонца</span>,
<span class="Term">Номенклатура</span> и <span class="Term">Склад</span> (см. пример) станут доступными в отборе, т. е.
пользователь сможет применять для них фильтры.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    УчетНоменклатурыОбороты<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
    УчетНоменклатурыОбороты<span class="operator">.</span>Склад <span class="keyword">КАК</span> Склад<span class="operator">,</span>
    УчетНоменклатурыОбороты<span class="operator">.</span>КоличествоПриход <span class="keyword">КАК</span> КоличествоПриход<span class="operator">,</span>
    УчетНоменклатурыОбороты<span class="operator">.</span>КоличествоРасход <span class="keyword">КАК</span> КоличествоРасход
<span class="keyword">ИЗ</span>
    РегистрНакопления<span class="operator">.</span>УчетНоменклатуры<span class="operator">.</span>Обороты<span class="operator">(</span>{&ДатаНачала}<span class="operator">,</span>
            {&ДатаКонца}<span class="operator">,</span>
            <span class="operator">,</span>
            {Номенклатура<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
            Склад<span class="operator">.</span><span class="operator">*</span>}<span class="operator">)</span> <span class="keyword">КАК</span> УчетНоменклатурыОбороты</pre>

<a id="TI000000570" class="bookmark" name="issogl3_10.3.3.2_автоматическое_заполнение_доступных_полей"><h4>10.3.3.2. Автоматическое заполнение доступных полей</h4></a>

<p class="MsoNormal">При автоматическом
заполнении доступных полей запроса выполняются следующие действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
все поля списка выборки и их дочерние поля становятся
доступными для выбора, упорядочивания, группировки, отбора и др.;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
параметры виртуальных таблиц становятся доступными
для отбора.</p>

<a name="_ref166301338"></a><a name="_ref166301290"></a><a name="_ref166301286"></a><a name="_ref216148128"></a><a name="_ref378760887"></a><a name="_ref378760886"></a><a id="TI000000571" class="bookmark" name="issogl2_10.3.4_язык_выражений_системы_компоновки_данных"><h3>10.3.4. Язык выражений системы компоновки данных</h3></a>

<p class="MsoNormal">Язык
выражений системы компоновки данных предназначен для записи выражений,
используемых в различных подсистемах. Выражения используются в следующих
подсистемах:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
схема компоновки данных – для описания вычисляемых
полей, полей итогов, выражений связи и т. д.;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
настройки компоновки данных – для описания
выражений пользовательских полей;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
макет компоновки данных – для описания
выражений связи наборов данных, описания параметров макета и т. д.</p>

<p class="NoteCxSpFirst"><span class="Note">Примечание.</span> В языке выражений компоновки данных отсутствует
возможность получения поля через точку от выражения.</p>

<p class="NoteCxSpLast"><span class="Note">Внимание!</span> Вычисление выражения системы компоновки
данных происходит в безопасном режиме (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref378761017">здесь</a>).</p>

<a name="_ref322536545"></a><a id="TI000000572" class="bookmark" name="issogl3_10.3.4.1_литералы"><h4>10.3.4.1. Литералы</h4></a>

<p class="MsoNormal">В
выражении могут присутствовать литералы типов, описанных далее.</p>

<p class="Lang">Строка</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Строковый
литерал записывается в символах «<span class="Interface">&quot;</span>».</p>

<p class="MsoNormalCxSpLast">При
необходимости использования внутри строкового литерала символа «<span class="Interface">&quot;</span>» следует
использовать два таких символа.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="string">&quot;Литерал &quot;</span><span class="string">&quot;в кавычках&quot;</span><span class="string">&quot;&quot;</span></pre>

<p class="Lang">Число</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Число
записывается без пробелов, в десятичном формате. Дробная часть отделяется при
помощи символа «<span class="Interface">.</span>».</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="number">10</span><span class="number">.</span><span class="number">5</span>
<span class="number">200</span></pre>

<p class="Lang">Дата</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Литерал
типа <span class="Term">Дата</span> записывается при помощи ключевого слова <span class="Term">ДАТАВРЕМЯ</span> (<span class="Term">DATETIME</span>). После данного ключевого слова в скобках,
через запятую, перечисляются год, месяц, день, часы, минуты, секунды. Указание
времени необязательно.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Шестое января 1975 года</span>
ДАТАВРЕМЯ<span class="operator">(</span><span class="number">1975</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">06</span><span class="operator">)</span>
<span class="comment">// Второе декабря 2006 года, 23 часа 56 минут 57 секунд</span>
ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2006</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">23</span><span class="operator">,</span> <span class="number">56</span><span class="operator">,</span> <span class="number">57</span><span class="operator">)</span></pre>

<p class="Lang">Булево</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Булевы
значения могут быть записаны при помощи литералов <span class="Term">Истина</span> (<span class="Term">True</span>), <span class="Term">Ложь</span> (<span class="Term">False</span>).</p>

<p class="Lang">Значение</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Для
указания литералов других типов (системных перечислений, предопределенных
данных) используется ключевое слово <span class="Term">ЗНАЧЕНИЕ</span>, после которого в скобках идет
указание имени литерала.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЗНАЧЕНИЕ<span class="operator">(</span>ВидСчета<span class="operator">.</span>Активный<span class="operator">)</span></pre>

<p class="Lang">Поля</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">В
выражениях могут использоваться поля наборов данных. Поле идентифицируется
путем к данным. Части пути к данным отделяются друг от друга символом «<span class="Interface">.</span>». Имя поля не
является чувствительным к регистру. Если путь к данным содержит идентификатор с
пробелами или специальными символами, то такие идентификаторы следует заключать
в квадратные скобки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Номенклатура<span class="operator">.</span>Артикул
Продажи<span class="operator">.</span>СуммаОборот
Продажи<span class="operator">.</span><span class="operator">[</span>Сумма оборот<span class="operator">]</span></pre>

<p class="Lang">Параметры</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Выражения могут использовать параметры. Для
использования в выражении параметра достаточно написать его имя, которому будет
предшествовать символ «<span class="Term">&amp;</span>».</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="preprocessor">&amp;Контрагент</span>
<span class="preprocessor">&amp;ДатаНачала</span></pre>

<p class="Lang">Тип</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Формирует
значение типа <span class="Term">Тип</span>. Тип задается при помощи ключевого слова <span class="Term">Тип</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Тип<span class="operator">(</span><span class="string">&quot;Строка&quot;</span><span class="operator">)</span></pre>

<a id="TI000000573" class="bookmark" name="issogl3_10.3.4.2_операции_над_числами"><h4>10.3.4.2. Операции над числами</h4></a>

<p class="Lang">Унарный
&quot;-&quot;</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для изменения знака числа на обратный.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="operator">-</span>Продажи<span class="operator">.</span>Количество</pre>

<p class="Lang">Унарный
&quot;+&quot;</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция не выполняет над числом никаких действий.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="operator">+</span>Продажи<span class="operator">.</span>Количество</pre>

<p class="Lang">Бинарный
&quot;-&quot;</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для вычисления разности двух чисел.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ОстИОбрт<span class="operator">.</span>НачальныйОстаток – ОстИОбрт<span class="operator">.</span>КонечныйОстаток
ОстИОбрт<span class="operator">.</span>НачальныйОстаток – <span class="number">100</span>
<span class="number">400</span> – <span class="number">357</span></pre>

<p class="Lang">Бинарный
&quot;+&quot;</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для вычисления суммы двух чисел.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ОстИОбрт<span class="operator">.</span>НачальныйОстаток <span class="operator">+</span> ОстИОбрт<span class="operator">.</span>Оборот
ОстИОбрт<span class="operator">.</span>НачальныйОстаток <span class="operator">+</span> <span class="number">100</span>
<span class="number">400</span> <span class="operator">+</span> <span class="number">357</span></pre>

<p class="Lang">Произведение
&quot;*&quot;</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для вычисления произведения двух чисел.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Номенклатура<span class="operator">.</span>Цена <span class="operator">*</span> <span class="number">1</span><span class="number">.</span><span class="number">2</span>
<span class="number">2</span> <span class="operator">*</span> <span class="number">3</span><span class="number">.</span><span class="number">14</span></pre>

<p class="Lang">Деление
&quot;/&quot;</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для получения результата деления одного операнда на
другой.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Номенклатура<span class="operator">.</span>Цена <span class="operator">/</span> <span class="number">1</span><span class="number">.</span><span class="number">2</span>
<span class="number">2</span> <span class="operator">/</span> <span class="number">3</span><span class="number">.</span><span class="number">14</span></pre>

<p class="Lang">Остаток
от деления &quot;%&quot;</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для получения остатка от деления одного операнда на
другой.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">Номенклатура.Цена % 1.2
2 % 3.14</pre>

<a id="TI000000574" class="bookmark" name="issogl3_10.3.4.3_операции_над_строками"><h4>10.3.4.3. Операции над строками</h4></a>

<p class="Lang">Конкатенация
(Бинарный &quot;+&quot;)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для конкатенации двух строк.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Номенклатура<span class="operator">.</span>Артикул <span class="operator">+</span> <span class="string">&quot;: &quot;</span><span class="operator">+</span> Номенклатура<span class="operator">.</span>Наименование</pre>

<p class="Lang">ПОДОБНО
(LIKE)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная
операция проверяет соответствие строки переданному шаблону.</p>

<p class="MsoNormalCxSpMiddle">Значением
оператора <span class="Term">ПОДОБНО</span> является <span class="Term">Истина</span>, если значение выражения удовлетворяет шаблону, и <span class="Term">Ложь</span> –
в противном случае.</p>

<p class="MsoNormalCxSpLast">Следующие символы в строке шаблона имеют
смысл, отличный от просто очередного символа строки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
«<span class="Interface">%</span>» – процент: последовательность, содержащая ноль и
более произвольных символов.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">_</span>» – подчеркивание: один произвольный символ.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">[…]</span>» – один или несколько символов в квадратных скобках:
один символ, любой из перечисленных внутри квадратных скобок. В перечислении
могут встречаться диапазоны, например a-z, означающие произвольный символ,
входящий в диапазон, включая концы диапазона.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
«<span class="Interface">[^…]</span>» – в
квадратных скобках значок отрицания, за которым следует один или несколько
символов: любой символ, кроме тех, которые перечислены следом за значком
отрицания.</p>

<p class="MsoNormalCxSpFirst">Любой
другой символ означает сам себя и не несет никакой дополнительной нагрузки. Если
в качестве самого себя необходимо записать один из перечисленных символов, то
ему должен предшествовать спецсимвол, указанный после ключевого слова <span class="Term">СПЕЦСИМВОЛ</span> (<span class="Term">ESCAPE</span>).</p>

<p class="MsoNormalCxSpLast">Например,
приведенный ниже шаблон означает подстроку, состоящую из последовательности
символов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
буквы <span class="Interface">А</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы <span class="Interface">Б</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы <span class="Interface">В</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
одной цифры,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
одной из букв <span class="Interface">а</span>, <span class="Interface">б</span>, <span class="Interface">в</span> или <span class="Interface">г</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
символа подчеркивания,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы <span class="Interface">а</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы <span class="Interface">б</span>,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
буквы <span class="Interface">в</span>.</p>

<p class="MsoNormal">Причем
эта последовательность может располагаться, начиная с произвольной позиции в
строке.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="string">&quot;%АБВ[0-9][абвг]\_абв%&quot;</span> СПЕЦСИМВОЛ <span class="string">&quot;\&quot;</span></pre>

<a name="_ref378763530"></a><a id="TI000000575" class="bookmark" name="issogl3_10.3.4.4_операции_сравнения"><h4>10.3.4.4. Операции сравнения</h4></a>

<p class="Lang">Равно
(=)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для сравнения двух операндов на равенство.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Продажи<span class="operator">.</span>Контрагент <span class="operator">=</span> Продажи<span class="operator">.</span>НоменклатураОсновнойПоставщик</pre>

<p class="Lang">Не
равно (&lt;&gt;)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для сравнения двух операндов на неравенство.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Продажи<span class="operator">.</span>Контрагент <span class="operator">&lt;</span><span class="operator">&gt;</span> Продажи<span class="operator">.</span>НоменклатураОсновнойПоставщик</pre>

<p class="Lang">Меньше
(&lt;)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для проверки того, что первый операнд меньше второго.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПродажиТекущие<span class="operator">.</span>Сумма <span class="operator">&lt;</span> ПродажиПрошлые<span class="operator">.</span>Сумма</pre>

<p class="Lang">Больше
(&gt;)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для проверки того, что первый операнд больше второго.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПродажиТекущие<span class="operator">.</span>Сумма <span class="operator">&gt;</span> ПродажиПрошлые<span class="operator">.</span>Сумма</pre>

<p class="Lang">Меньше
или равно (&lt;=)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для проверки того, что первый операнд меньше либо равен
второму.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПродажиТекущие<span class="operator">.</span>Сумма <span class="operator">&lt;</span><span class="operator">=</span> ПродажиПрошлые<span class="operator">.</span>Сумма</pre>

<p class="Lang">Больше
или равно (&gt;=)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция предназначена для проверки того, что первый операнд больше либо равен
второму.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПродажиТекущие<span class="operator">.</span>Сумма <span class="operator">&gt;</span><span class="operator">=</span> ПродажиПрошлые<span class="operator">.</span>Сумма</pre>

<p class="Lang">Строка начинается с подстроки (НачинаетсяС/BeginsWith)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная операция осуществляет проверку того,
что проверяемое значение начинается на строку, указанную в условии. Условие
может быть указано непосредственным значением и шаблоном. Следующие символы в
строке шаблона имеют смысл, отличный от просто очередного символа строки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
«<span class="Interface">/</span>» – следующий символ надо интерпретировать как
обычный символ.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">%</span>» – процент: последовательность, содержащая ноль и
более произвольных символов.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
«<span class="Interface">_</span>» – подчеркивание: один произвольный символ.</p>

<p class="Lang">Строка
не начинается с подстроки (НеНачинаетсяС/NotBeginsWith)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция осуществляет проверку того, что проверяемое значение не начинается на
строку, указанную в условии. Условие может быть указано непосредственным
значением и шаблоном. Следующие символы в строке шаблона имеют смысл, отличный
от просто очередного символа строки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
«<span class="Interface">/</span>» –
следующий символ надо интерпретировать как обычный символ.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">%</span>» –
процент: последовательность, содержащая ноль и более произвольных символов.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
«<span class="Interface">_</span>» –
подчеркивание: один произвольный символ.</p>

<p class="Lang">Строка удовлетворяет шаблону (Подобно/Like)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная операция осуществляет проверку того,
что проверяемое значение удовлетворяет заданному шаблону. Следующие символы в
строке шаблона имеют смысл, отличный от просто очередного символа строки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
«<span class="Interface">/</span>» – следующий символ надо интерпретировать как
обычный символ.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">%</span>» – процент: последовательность, содержащая ноль и
более произвольных символов.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
«<span class="Interface">_</span>» – подчеркивание: один произвольный символ.</p>

<p class="Lang">Строка
не удовлетворяет шаблону (НеПодобно/NotLike)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция осуществляет проверку того, что проверяемое значение не удовлетворяет
заданному шаблону. Следующие символы в строке шаблона имеют смысл, отличный от
просто очередного символа строки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
«<span class="Interface">/</span>» –
следующий символ надо интерпретировать как обычный символ.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">%</span>» –
процент: последовательность, содержащая ноль и более произвольных символов.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
«<span class="Interface">_</span>» –
подчеркивание: один произвольный символ.</p>

<p class="Lang">Операция
проверки вхождения в список (В/IN)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция осуществляет проверку наличия значения в переданном списке значений.
Результатом операции будет <span class="Term">Истина</span>, если значение найдено, или <span class="Term">Ложь</span> – в противном случае.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Номенклатура В <span class="operator">(</span>&Товар1<span class="operator">,</span> &Товар2<span class="operator">)</span></pre>

<p class="Lang">Операция
проверки наличия значения в наборе данных (В/IN)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Операция
осуществляет проверку наличия значения в указанном наборе данных. Набор данных
для проверки должен содержать одно поле.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Продажи<span class="operator">.</span>Контрагент В Контрагенты</pre>

<p class="Lang">Операция
проверки значения на NULL (ЕСТЬ NULL/IS NULL)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция возвращает значение <span class="Term">Истина</span>, если оно является значением <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Продажи<span class="operator">.</span>Контрагент ЕСТЬ <span class="keyword">NULL</span></pre>

<p class="Lang">Операция
проверки значения на неравенство NULL (ЕСТЬ НЕ NULL/IS NOT NULL)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
операция возвращает значение <span class="Term">Истина</span>, если оно не является значением <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Продажи<span class="operator">.</span>Контрагент ЕСТЬ <span class="keyword">НЕ</span> <span class="keyword">NULL</span></pre>

<a id="TI000000576" class="bookmark" name="issogl3_10.3.4.5_логические_операции"><h4>10.3.4.5. Логические операции</h4></a>

<p class="MsoNormal">Логические
операции принимают в качестве операндов выражения, имеющие тип <span class="Term">Булево</span>.</p>

<p class="Lang">Операция
НЕ (NOT)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Операция
<span class="Term">НЕ</span> возвращает значение <span class="Term">Истина</span>, если ее операнд имеет значение <span class="Term">Ложь</span>, и значение <span class="Term">Ложь</span>, если ее операнд имеет значение <span class="Term">Истина</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">НЕ</span> Документ<span class="operator">.</span>Грузополучатель <span class="operator">=</span> Документ<span class="operator">.</span>Грузоотправитель</pre>

<p class="Lang">Операция
И (AND)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Операция
<span class="Term">И</span> возвращает значение <span class="Term">Истина</span>, если оба операнда имеют значение <span class="Term">Истина</span>, и значение <span class="Term">Ложь</span>, если один из операндов имеет значение <span class="Term">Ложь</span>, например:</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Документ<span class="operator">.</span>Грузополучатель <span class="operator">=</span> Документ<span class="operator">.</span>Грузоотправитель <span class="keyword">И</span> Документ<span class="operator">.</span>Грузополучатель <span class="operator">=</span> &Контрагент</pre>

<p class="Lang">Операция
ИЛИ (OR)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Операция
<span class="Term">ИЛИ</span> возвращает значение <span class="Term">Истина</span>, если один из операндов имеет значение <span class="Term">Истина</span>, и <span class="Term">Ложь</span>, если оба операнда имеют значение <span class="Term">Ложь</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Документ<span class="operator">.</span>Грузополучатель <span class="operator">=</span> Документ<span class="operator">.</span>Грузоотправитель <span class="keyword">ИЛИ</span> Документ<span class="operator">.</span>Грузополучатель <span class="operator">=</span> &Контрагент</pre>

<a name="_ref322533676"></a><a name="_ref416785433"></a><a id="TI000000577" class="bookmark" name="issogl3_10.3.4.6_агрегатные_функции"><h4>10.3.4.6. Агрегатные функции</h4></a>

<p class="MsoNormal">Агрегатные
функции осуществляют некоторое действие над набором данных.</p>

<p class="Lang">СУММА
(SUM)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Сумма(Выражение)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Агрегатная функция <span class="Term">Сумма</span>
рассчитывает сумму значений выражений, переданных ей в качестве аргумента для
всех детальных записей. В качестве параметра можно передавать <span class="Term">Массив</span>.
В этом случае функция будет применена к содержимому массива.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СУММА<span class="operator">(</span>Продажи<span class="operator">.</span>СуммаОборот<span class="operator">)</span></pre>

<p class="Lang">КОЛИЧЕСТВО
(COUNT)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Количество(Выражение)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
<span class="Term">Количество</span> рассчитывает количество значений,
отличных от значения <span class="Term">NULL</span>. В качестве параметра можно передавать <span class="Term">Массив</span>. В этом случае функция будет применена
к содержимому массива.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">КОЛИЧЕСТВО<span class="operator">(</span>Продажи<span class="operator">.</span>Контрагент<span class="operator">)</span></pre>

<p class="Lang">КОЛИЧЕСТВО
(РАЗЛИЧНЫЕ) (COUNT (DISTINCT))</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Количество(Различные
Выражение)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Эта
функция рассчитывает количество различных значений. Для получения различных
значений следует перед параметром метода <span class="Term">Количество</span> указать <span class="Term">Различные</span> (<span class="Term">Distinct</span>). В качестве параметра можно передавать
<span class="Term">Массив</span>. В этом случае функция будет применена
к содержимому массива.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">КОЛИЧЕСТВО<span class="operator">(</span>Различные Продажи<span class="operator">.</span>Контрагент<span class="operator">)</span></pre>

<p class="Lang">МАКСИМУМ
(MAX)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Максимум(Выражение)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
получает максимальное значение. В качестве параметра можно передавать <span class="Term">Массив</span>. В этом случае функция будет применена
к содержимому массива.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">МАКСИМУМ<span class="operator">(</span>Остатки<span class="operator">.</span>Количество<span class="operator">)</span></pre>

<p class="Lang">МИНИМУМ
(MIN)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Минимум(Выражение)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
получает минимальное значение. В качестве параметра можно передавать <span class="Term">Массив</span>. В этом случае функция будет применена
к содержимому массива.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">МИНИМУМ<span class="operator">(</span>Остатки<span class="operator">.</span>Количество<span class="operator">)</span></pre>

<p class="Lang">СРЕДНЕЕ
(AVG)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Среднее(Выражение)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
получает среднее значение для значений, отличных от <span class="Term">NULL</span>. В качестве параметра можно передавать <span class="Term">Массив</span>. В этом случае функция будет применена
к содержимому массива.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СРЕДНЕЕ<span class="operator">(</span>Остатки<span class="operator">.</span>Количество<span class="operator">)</span></pre>

<p class="Lang">МАССИВ
(ARRAY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Массив([Различные]
Выражение)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
формирует массив, содержащий значение выражения для каждой детальной записи.</p>

<p class="MsoNormalCxSpMiddle">В
качестве параметра можно использовать таблицу значений. При этом результатом
работы функции будет массив, содержащий значения первой колонки таблицы
значений, переданной в качестве параметра.</p>

<p class="MsoNormalCxSpMiddle">Если
выражение содержит функцию <span class="Term">Массив</span>, то считается, что данное выражение
является агрегатным.</p>

<p class="MsoNormalCxSpLast">Если
указано ключевое слово <span class="Term">Различные</span>, то получаемый массив не будет
содержать дублирующихся значений.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ФункцииОтчетов<span class="operator">.</span>СтандартноеОтклонение<span class="operator">(</span>Массив<span class="operator">(</span>Сумма<span class="operator">)</span><span class="operator">)</span></pre>

<p class="Lang">ТАБЛИЦАЗНАЧЕНИЙ
(VALUETABLE)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ТаблицаЗначений([Различные]
Выражение1 [КАК ИмяКолонки1][, Выражение2 [КАК ИмяКолонки2]], …)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
формирует таблицу значений, содержащую столько колонок, сколько параметров у
функции. Детальные записи получаются из наборов данных, которые нужны для вычисления
всех выражений, указанных в параметрах функции.</p>

<p class="MsoNormalCxSpMiddle">Если
параметрами функции выступают поля-остатки, то в результирующую таблицу
значений попадут значения для записей по уникальным комбинациям измерений из
других периодов. При этом значения получаются только для полей-остатков,
измерений, счетов, полей периодов и их реквизитов. Значения остальных полей в
записях из других периодов считаются равными <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpMiddle">Если
выражение содержит функцию <span class="Term">ТаблицаЗначений</span>, то считается, что данное
выражение является агрегатным.</p>

<p class="MsoNormalCxSpMiddle">Если
указано ключевое слово <span class="Term">Различные</span>, то в получаемой таблице значений не
будет строк, содержащих одинаковые данные.</p>

<p class="MsoNormalCxSpLast">Для
каждой колонки можно задать имя с помощью ключевого слова <span class="Term">КАК</span>, следующего после выражения, формирующего
значение колонки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ФункцииОтчетов<span class="operator">.</span>ТаблицуЗначенийВСтроку<span class="operator">(</span>ТаблицаЗначений<span class="operator">(</span>Склад <span class="keyword">КАК</span> Склад<span class="operator">,</span> КоличествоОстаток <span class="keyword">КАК</span> Остаток<span class="operator">)</span><span class="operator">)</span></pre>

<p class="Lang">СВЕРНУТЬ
(GROUPBY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Свернуть(&lt;Выражение&gt;,
&lt;НомераКолонок&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для удаления дубликатов из массива.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражение&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Массив</span> или <span class="Term">ТаблицаЗначений</span>. Для значения, расположенного
в данном формальном параметре, выполняется удаление дубликатов.</p>

<p class="Lang-parameter">&lt;НомераКолонок&gt;</p>

<p class="MsoNormal">Тип
<span class="Term">Строка</span>. Используется, если параметр <span class="Term">Выражение</span> имеет тип <span class="Term">ТаблицаЗначений</span>. Номера или имена (через
запятую) колонок таблицы значений, среди которых нужно искать дубликаты. По
умолчанию все колонки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Свернуть<span class="operator">(</span>ТаблицаЗначений<span class="operator">(</span>НомерТелефона<span class="operator">,</span> Адрес<span class="operator">)</span> <span class="operator">,</span><span class="string">&quot;НомерТелефона&quot;</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="Lang">ПОЛУЧИТЬЧАСТЬ
(GETPART)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ПолучитьЧасть(&lt;Выражение&gt;,
&lt;НомерКолонок&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
получает таблицу значений, которая содержит указанные колонки исходной таблицы
значений.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражение&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">ТаблицаЗначений</span>. Таблица значений, из которой
нужно получить колонки.</p>

<p class="Lang-parameter">&lt;НомераКолонок&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Номера или имена (через запятую)
колонок таблицы значений, которые нужно получить.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Таблица
значений, содержащая только те колонки, которые указаны в параметре <span class="Term">НомераКолонок</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПолучитьЧасть<span class="operator">(</span>Свернуть<span class="operator">(</span>ТаблицаЗначений<span class="operator">(</span>НомерТелефона<span class="operator">,</span> Адрес<span class="operator">)</span> <span class="operator">,</span><span class="string">&quot;НомерТелефона&quot;</span><span class="operator">)</span><span class="operator">,</span><span class="string">&quot;НомерТелефона&quot;</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="Lang">УПОРЯДОЧИТЬ
(ORDER)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Упорядочить(&lt;Выражение&gt;,
&lt;НомераКолонок&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Предназначена
для упорядочивания элементов массива и таблицы значений.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражение&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Массив</span> или <span class="Term">ТаблицаЗначений</span>. Объект, который требуется упорядочить.</p>

<p class="Lang-parameter">&lt;НомераКолонок&gt;</p>

<p class="MsoNormalCxSpFirst">Используется,
если параметр <span class="Term">Выражение</span> имеет тип <span class="Term">ТаблицаЗначений</span>. Номера или имена (через
запятую) колонок таблицы значений, которые требуется упорядочить. По умолчанию
все колонки.</p>

<p class="MsoNormalCxSpLast">После
каждой колонки может содержаться направление упорядочивания или признак
автоматического упорядочивания.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Массив
или таблица значений, которые упорядочены в соответствии с переданными
параметрами.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Упорядочить<span class="operator">(</span>ТаблицаЗначений<span class="operator">(</span>НомерТелефона<span class="operator">,</span> Адрес<span class="operator">,</span> ДатаЗвонка<span class="operator">)</span><span class="operator">,</span><span class="string">&quot;ДатаЗвонка Убыв&quot;</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="Lang">СОЕДИНИТЬСТРОКИ
(JOINSTRINGS)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">СоединитьСтроки(&lt;Значения&gt;,
&lt;РазделительЭлементов&gt;, &lt;РазделительКолонок&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Предназначена
для объединения строк в одну строку.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Значения&gt;</p>

<p class="MsoNormal">Значения,
строковые представления которых нужно объединить в одну строку. Если типом
значения параметра является <span class="Term">Массив</span>, то в строку будут объединяться
элементы массива. Если типом значения параметра является <span class="Term">ТаблицаЗначений</span>, то в строку будут
объединяться все колонки и строки таблицы.</p>

<p class="Lang-parameter">&lt;РазделительЭлементов&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Содержит текст, который нужно
использовать в качестве разделителя между элементами массива и строками таблицы
значений. По умолчанию символ перевода строк.</p>

<p class="Lang-parameter">&lt;РазделительКолонок&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Содержит текст, который нужно
использовать в качестве разделителя между колонками таблицы значений. По
умолчанию &quot;<span class="Interface">; </span>&quot;.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Объединенная
строка.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СоединитьСтроки<span class="operator">(</span>ТаблицаЗначений<span class="operator">(</span>НомерТелефона<span class="operator">,</span> Адрес<span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="Lang">ГРУППОВАЯОБРАБОТКА
(GROUPPROCESSING)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ГрупповаяОбработка(&lt;Выражения&gt;,
&lt;ВыраженияИерархии&gt;, &lt;ИмяГруппировки&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Формируется
таблица значений, содержащая значения параметров (в колонках) для каждой
групповой записи (в строках). В случае использования иерархической группировки
каждый уровень иерархии обрабатывается отдельно. Значения для иерархических
записей также помещаются в таблицу данных. В возвращаемом объекте эта таблица
значений будет размещена в свойстве <span class="Term">Данные</span>.</p>

<p class="MsoNormalCxSpMiddle">В
свойство <span class="Term">ТекущийЭлемент</span> помещается строка передаваемой таблицы
значений, для которой в настоящий момент вычисляется функция.</p>

<p class="MsoNormalCxSpLast">При
реализации функции, которая в качестве параметра может принимать данные
групповой обработки, следует учитывать, что в качестве значения в функцию может
быть передано значение <span class="Term">NULL</span>. Например, такое может произойти в случае
расчета функции <span class="Term">ГрупповаяОбработка()</span> с указанием имени
группировки, которая в настоящий момент недоступна.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражения&gt;</p>

<p class="MsoNormal">Строка
с перечисленными через запятую выражениями, которые нужно вычислить. После
каждого выражения возможно наличие необязательного ключевого слова <span class="Term">КАК</span> и имени колонки результирующей таблицы
значений. Каждое выражение описывает колонку формируемой таблицы значений.</p>

<p class="Lang-parameter">&lt;ВыраженияИерархии&gt;</p>

<p class="MsoNormal">Выражения,
которые нужно вычислить для иерархических записей. Аналогично параметру <span class="Term">Выражения</span> с тем отличием, что параметр <span class="Term">Выражения</span> используется для неиерархических
записей, а параметр <span class="Term">ВыраженияИерархии</span> используется для иерархических
записей. Если параметр не указан, то для вычисления значений для иерархических
записей используется выражения, указанные в параметре <span class="Term">Выражение</span>.</p>

<p class="Lang-parameter">&lt;ИмяГруппировки&gt;</p>

<p class="MsoNormal">Имя
группировки, в которой нужно вычислять группировку обработки. Если не указано,
то вычисление происходит в текущей группировке. Если вычисление идет в таблице
и параметр содержит пустую строку или не указан, то значение вычисляется для
группировки – строки. Компоновщик макета при генерации макета компоновки
данных заменяет данное имя именем группировки в результирующем макете. Если
группировка недоступна, то функция будет заменена на значение <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Объект
<span class="Term">ДанныеГрупповойОбработкиКомпоновкиДанных</span>.</p>

<p class="Lang-subheader">Пример:</p>

<p class="MsoNormal">Пример
реализации функции <span class="Term">ABCКлассификация()</span>, которая возвращает
значение 1, если значение составляет 75 % от общей суммы, 2, если процент между
75 % и 95 %, и 3 в других случаях.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Рассчитать ABC классификацию.</span>
<span class="keyword">Функция</span> ABCКлассификация<span class="operator">(</span>Данные<span class="operator">)</span> <span class="keyword">Экспорт</span>
<span class="keyword">Перем</span> ТаблицаЗначений<span class="operator">;</span>
    <span class="keyword">Если</span> Данные <span class="operator">=</span> <span class="keyword">Null</span> <span class="keyword">Тогда</span>
        <span class="keyword">Возврат</span> <span class="keyword">Null</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    <span class="keyword">Если</span> ТипЗнч<span class="operator">(</span>Данные<span class="operator">)</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> Тип<span class="operator">(</span><span class="string">&quot;ДанныеГрупповойОбработкиКомпоновкиДанных&quot;</span><span class="operator">)</span> <span class="keyword">Тогда</span>
        Сообщить<span class="operator">(</span>ТипЗнч<span class="operator">(</span>Данные<span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
        <span class="keyword">ВызватьИсключение</span> <span class="string">&quot;В функцию ABCКлассификация() можно передавать только объект типа ДанныеГрупповойОбработкиКомпоновкиДанных&quot;</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    <span class="keyword">Если</span> <span class="keyword">Не</span> Данные<span class="operator">.</span>ВременныеДанныеОбработки<span class="operator">.</span>Свойство<span class="operator">(</span><span class="string">&quot;ABCКлассификацияТаблицаЗначений&quot;</span><span class="operator">,</span> ТаблицаЗначений<span class="operator">)</span> <span class="keyword">Тогда</span>
        <span class="comment">// выполним расчет классификации один раз при первом вызове</span>
        <span class="comment">// а потом запомним выполненный расчет и дальше будем этот</span>
        <span class="comment">// расчет использовать</span>
        ТаблицаЗначений <span class="operator">=</span> Данные<span class="operator">.</span>Данные<span class="operator">.</span>Скопировать<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
        ТаблицаЗначений<span class="operator">.</span>Колонки<span class="operator">.</span>Добавить<span class="operator">(</span><span class="string">&quot;Номер&quot;</span><span class="operator">,</span> <span class="keyword">Новый</span> ОписаниеТипов<span class="operator">(</span><span class="string">&quot;Число&quot;</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
        Номер <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
        ОбщаяСумма <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
        <span class="keyword">Для</span> <span class="keyword">Каждого</span> СтрокаТаблицыЗначений <span class="keyword">Из</span> ТаблицаЗначений <span class="keyword">Цикл</span>
            СтрокаТаблицыЗначений<span class="operator">.</span>Номер <span class="operator">=</span> Номер<span class="operator">;</span>
            Номер <span class="operator">=</span> Номер <span class="operator">+</span> <span class="number">1</span><span class="operator">;</span>
            <span class="keyword">Если</span> СтрокаТаблицыЗначений<span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">NULL</span> <span class="keyword">Тогда</span>
                ОбщаяСумма <span class="operator">=</span> ОбщаяСумма <span class="operator">+</span> СтрокаТаблицыЗначений<span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">;</span>
            <span class="keyword">КонецЕсли</span><span class="operator">;</span>
        <span class="keyword">КонецЦикла</span><span class="operator">;</span>
        ТаблицаЗначений<span class="operator">.</span>Сортировать<span class="operator">(</span>ТаблицаЗначений<span class="operator">.</span>Колонки<span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">.</span>Имя <span class="operator">+</span> <span class="string">&quot; Убыв&quot;</span><span class="operator">)</span><span class="operator">;</span>
        ТаблицаЗначений<span class="operator">.</span>Индексы<span class="operator">.</span>Добавить<span class="operator">(</span><span class="string">&quot;Номер&quot;</span><span class="operator">)</span><span class="operator">;</span>
        НакопленнаяСумма <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
        ИндексКлассаA <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
        ИндексКлассаB <span class="operator">=</span> <span class="keyword">Неопределено</span><span class="operator">;</span>
        <span class="keyword">Для</span> <span class="keyword">Каждого</span> СтрокаТаблицыЗначений <span class="keyword">Из</span> ТаблицаЗначений <span class="keyword">Цикл</span>
            <span class="keyword">Если</span> СтрокаТаблицыЗначений<span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">NULL</span> <span class="keyword">Тогда</span>
                НакопленнаяСумма <span class="operator">=</span> НакопленнаяСумма <span class="operator">+</span> СтрокаТаблицыЗначений<span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">;</span>
            <span class="keyword">КонецЕсли</span><span class="operator">;</span>
            <span class="keyword">Если</span> ОбщаяСумма <span class="operator">=</span> <span class="number">0</span> <span class="keyword">Тогда</span>
                Процент <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>
            <span class="keyword">Иначе</span>
                Процент <span class="operator">=</span> НакопленнаяСумма <span class="operator">/</span> ОбщаяСумма<span class="operator">;</span>
            <span class="keyword">КонецЕсли</span><span class="operator">;</span>
            <span class="keyword">Если</span> Процент <span class="operator">&gt;</span> <span class="number">0</span><span class="number">.</span><span class="number">75</span> <span class="keyword">Тогда</span>
                <span class="keyword">Если</span> ИндексКлассаA <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
                    ИндексКлассаA <span class="operator">=</span> ТаблицаЗначений<span class="operator">.</span>Индекс<span class="operator">(</span>СтрокаТаблицыЗначений<span class="operator">)</span><span class="operator">;</span>
                <span class="keyword">ИначеЕсли</span> Процент <span class="operator">&gt;</span> <span class="number">0</span><span class="number">.</span><span class="number">90</span> <span class="keyword">Тогда</span>
                    <span class="keyword">Если</span> ИндексКлассаB <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
                        ИндексКлассаB <span class="operator">=</span> ТаблицаЗначений<span class="operator">.</span>Индекс<span class="operator">(</span>СтрокаТаблицыЗначений<span class="operator">)</span><span class="operator">;</span>
                    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
                    <span class="keyword">Прервать</span><span class="operator">;</span>
                <span class="keyword">КонецЕсли</span><span class="operator">;</span>
            <span class="keyword">КонецЕсли</span><span class="operator">;</span>
        <span class="keyword">КонецЦикла</span><span class="operator">;</span>
            Данные<span class="operator">.</span>ВременныеДанныеОбработки<span class="operator">.</span>Вставить<span class="operator">(</span><span class="string">&quot;ABCКлассификацияТаблицаЗначений&quot;</span><span class="operator">,</span> ТаблицаЗначений<span class="operator">)</span><span class="operator">;</span>
            Данные<span class="operator">.</span>ВременныеДанныеОбработки<span class="operator">.</span>Вставить<span class="operator">(</span><span class="string">&quot;ABCКлассификацияИндексКлассаA&quot;</span><span class="operator">,</span> ИндексКлассаA<span class="operator">)</span><span class="operator">;</span>
            Данные<span class="operator">.</span>ВременныеДанныеОбработки<span class="operator">.</span>Вставить<span class="operator">(</span><span class="string">&quot;ABCКлассификацияИндексКлассаB&quot;</span><span class="operator">,</span> ИндексКлассаB<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    <span class="keyword">Если</span> Данные<span class="operator">.</span>ТекущийЭлемент <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
        <span class="comment">// Итог по группировке.</span>
        <span class="keyword">Возврат</span> <span class="keyword">Null</span><span class="operator">;</span>
    <span class="keyword">Иначе</span>
        Строка <span class="operator">=</span> ТаблицаЗначений<span class="operator">.</span>Найти<span class="operator">(</span>Данные<span class="operator">.</span>Данные<span class="operator">.</span>Индекс<span class="operator">(</span>Данные<span class="operator">.</span>ТекущийЭлемент<span class="operator">)</span><span class="operator">,</span> <span class="string">&quot;Номер&quot;</span><span class="operator">)</span><span class="operator">;</span>
        <span class="keyword">Если</span> Строка <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
            <span class="keyword">Возврат</span> <span class="keyword">Null</span><span class="operator">;</span>
        <span class="keyword">Иначе</span>
            Индекс <span class="operator">=</span> ТаблицаЗначений<span class="operator">.</span>Индекс<span class="operator">(</span>Строка<span class="operator">)</span><span class="operator">;</span>
            <span class="keyword">Если</span> Индекс <span class="operator">&lt;</span><span class="operator">=</span> Данные<span class="operator">.</span>ВременныеДанныеОбработки<span class="operator">.</span>ABCКлассификацияИндексКлассаA <span class="keyword">Тогда</span>
                <span class="keyword">Возврат</span> <span class="number">1</span><span class="operator">;</span>
            <span class="keyword">ИначеЕсли</span> Индекс <span class="operator">&lt;</span><span class="operator">=</span> Данные<span class="operator">.</span>ВременныеДанныеОбработки<span class="operator">.</span>ABCКлассификацияИндексКлассаB <span class="keyword">Тогда</span>
                <span class="keyword">Возврат</span> <span class="number">2</span><span class="operator">;</span>
            <span class="keyword">Иначе</span>
                <span class="keyword">Возврат</span> <span class="number">3</span><span class="operator">;</span>
            <span class="keyword">КонецЕсли</span><span class="operator">;</span>
        <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецФункции</span></pre>

<p class="MsoNormal">В
выражении компоновки для получения класса можно использовать следующее
выражение (например, в ресурсе или пользовательском поле):</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ABCКлассификация<span class="operator">(</span>ГрупповаяОбработка<span class="operator">(</span><span class="string">&quot;Сумма(СуммаОборот)&quot;</span><span class="operator">)</span><span class="operator">)</span></pre>

<p class="Lang">КАЖДЫЙ
(EVERY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Каждый(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Агрегатная функция <span class="Term">Каждый</span>
определяет наличие в переданном наборе хотя бы одного значения <span class="Term">Ложь</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">Истина</span> –
если в переданном наборе не содержится значения <span class="Term">Ложь</span>.</p>

<p class="MsoNormalCxSpLast"><span class="Term">Ложь</span> –
если в переданном наборе содержится хотя бы одно значение <span class="Term">Ложь</span>.</p>

<p class="Lang">ЛЮБОЙ
(ANY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Любой(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Агрегатная
функция <span class="Term">Любой</span> определяет наличие в переданном наборе
хотя бы одного значения <span class="Term">Истина</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">Истина</span> –
если в переданном наборе содержится хотя бы одно значение <span class="Term">Истина</span>.</p>

<p class="MsoNormalCxSpLast"><span class="Term">Ложь</span> –
если в переданном наборе не содержится значения <span class="Term">Истина</span>.</p>

<p class="Lang">СТАНДАРТНОЕОТКЛОНЕНИЕГЕНЕРАЛЬНОЙСОВОКУПНОСТИ (STDDEV_POP)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">СтандартноеОтклонениеГенеральнойСовокупности(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
стандартное отклонение генеральной совокупности переданного набора.</p>

<p class="MsoNormalCxSpLast">Вычисление
выполняется по формуле: SQRT(ДисперсияГенеральнойСовокупности(X)).</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат вычисления
функции.</p>

<p class="Lang">СТАНДАРТНОЕОТКЛОНЕНИЕВЫБОРКИ(STDDEV_SAMP)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">СтандартноеОтклонениеВыборки(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
стандартное отклонение выборки переданного набора.</p>

<p class="MsoNormalCxSpLast">Вычисление
выполняется по формуле: <span class="Term">SQRT(ДисперсияВыборки(X))</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат вычисления функции.</p>

<p class="Lang">ДИСПЕРСИЯВЫБОРКИ
(VAR_SAMP)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ДисперсияВыборки(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
выборочную дисперсию для переданного набора.</p>

<p class="MsoNormalCxSpLast">Вычисление выполняется по формуле: <span class="Term">(SUM(X2)-SUM(X)2/COUNT(X))/(COUNT(X)-1)</span>.
Если количество записей в наборе равно 1 (<span class="Term">COUNT(X)=1</span>), возвращаемое значение равно <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат
вычисления функции.</p>

<p class="Lang">ДИСПЕРСИЯГЕНЕРАЛЬНОЙСОВОКУПНОСТИ
(VAR_POP)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ДисперсияГенеральнойСовокупности(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
дисперсию генеральной совокупности для переданного набора. Значения <span class="Term">NULL</span> игнорируются.</p>

<p class="MsoNormalCxSpLast">Вычисление выполняется по формуле: <span class="Term">(SUM(X2)-SUM(X)2/COUNT(X))/(COUNT(X))</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат
вычисления функции.</p>

<p class="Lang">КОВАРИАЦИЯГЕНЕРАЛЬНОЙСОВОКУПНОСТИ
(COVAR_POP)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">КовариацияГенеральнойСовокупности(&lt;Y&gt;, &lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
ковариацию совокупности множества пар переданных
наборов.</p>

<p class="MsoNormalCxSpLast">Вычисление
выполняется по формуле: <span class="Term">(SUM(Y*X)-SUM(X)*SUM(Y)/N)/N</span>. <span class="Term">N</span> – число пар значений <span class="Term">X</span> и <span class="Term">Y</span> из переданных наборов, где ни значение <span class="Term">X</span>, ни значение <span class="Term">Y</span> не равны <span class="Term">NULL</span>. Пары, где есть хотя бы одно значение <span class="Term">NULL</span>, игнорируются.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат вычисления функции.</p>

<p class="Lang">КОВАРИАЦИЯВЫБОРКИ
(COVAR_SAMP)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">КовариацияВыборки(&lt;Y&gt;,
&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
образец ковариации множества пар переданных наборов.</p>

<p class="MsoNormalCxSpLast">Вычисление выполняется по формуле: <span class="Term">(SUM(Y*X)-SUM(Y)*SUM(X)/N)/(N-1)</span>.
<span class="Term">N</span> –
число пар значений <span class="Term">X</span>
и <span class="Term">Y</span>
из переданных наборов, где ни значение <span class="Term">X</span>,
ни значение <span class="Term">Y</span>
не равны <span class="Term">NULL</span>.
Пары, где есть хотя бы одно значение <span class="Term">NULL</span>,
игнорируются.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат вычисления функции или <span class="Term">NULL</span> – если функция применяется к пустым
множествам.</p>

<p class="Lang">КОРРЕЛЯЦИЯ
(CORR)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Корреляция(&lt;Y&gt;,
&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет
коэффициент корреляции множества пар переданных наборов. Вычисление
выполняется по формуле: <span class="Term">КовариацияГенеральнойСовокупности(Y,
X)/(СтандартноеОтклонениеГенеральнойСовокупности(Y)*</span>
<span class="Term">СтандартноеОтклонениеГенеральнойСовокупности(X))</span>.<span class="Term"> </span>Пары,
где есть хотя бы одно значение <span class="Term">NULL</span>, игнорируются.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат
вычисления функции или <span class="Term">NULL</span> – если функция применяется к пустым
множествам.</p>

<p class="Lang">РЕГРЕССИЯНАКЛОН
(REGR_SLOPE)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрссияНаклон(&lt;Y&gt;,
&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
наклон линии.</p>

<p class="MsoNormalCxSpLast">Вычисление
выполняется по формуле: <span class="Term">КовариацияГенеральнойСовокупности(Y,
X)/ДисперсияГенеральнойСовокупности(X)</span>. Пары, где есть
хотя бы одно значение <span class="Term">NULL</span>,
игнорируются.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат вычисления функции.</p>

<p class="Lang">РЕГРЕССИЯОТРЕЗОК
(REGR_INTERCEPT)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрессияОтрезок(&lt;Y&gt;,
&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
Y-точку пересечения линии регресса.</p>

<p class="MsoNormalCxSpLast">Вычисление
выполняется по формуле: <span class="Term">Среднее(Y)-РегрессияНаклон(Y, X)*Среднее(X)</span>. Пары,
где есть хотя бы одно значение <span class="Term">NULL</span>, игнорируются.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат вычисления функции.</p>

<p class="Lang">РЕГРЕССИЯКОЛИЧЕСТВО
(REGR_COUNT)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрессияКоличество(&lt;Y&gt;,
&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет
количество пар, не содержащих <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат
вычисления функции.</p>

<p class="Lang">РЕГРЕССИЯ_R2
(REGR_R2)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Регрессия_R2(&lt;Y&gt;,
&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет
коэффициент детерминации для регрессии. Функция вычисляется без учета пар
значений, содержащих значение <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">NULL</span>, если ДисперсияГенеральнойСовокупности(X)
равно <span class="Term">0</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">1</span>, если ДисперсияГенеральнойСовокупности(Y)
равно <span class="Term">0</span>
и <span class="Term">ДисперсияГенеральнойСовокупности(X)</span>
не равно <span class="Term">0</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Pow(Корреляция(Y, X), 2)</span>, если <span class="Term">ДисперсияГенеральнойСовокупности(Y)</span> больше <span class="Term">0</span> и <span class="Term">ДисперсияГенеральнойСовокупности(X)</span> не равно <span class="Term">0</span>.</p>

<p class="Lang">РЕГРЕССИЯСРЕДНЕЕX (REGR_AVGX)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрессияСреднееX(&lt;Y&gt;, &lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет среднее из независимых переменных <span class="Term">&lt;X&gt;</span>
для линии регрессии, после исключения пар, где хотя бы одно значение равно <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpLast">Вычисление
выполняется по формуле: <span class="Term">Среднее(X)</span>.</p>

<p class="Lang-subheader">Возвращаемое значение:</p>

<p class="MsoNormal">Результат вычисления
функции.</p>

<p class="Lang">РЕГРЕССИЯСРЕДНЕЕY
(REGR_AVGY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрессияСреднееY(&lt;Y&gt;,
&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Вычисляет
среднее из зависимых переменных <span class="Term">&lt;Y&gt;</span> для линии регрессии, после
исключения пар, где хотя бы одно значение равно <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpLast">Вычисление
выполняется по формуле: <span class="Term">Среднее(Y)</span>.</p>

<p class="Lang-subheader">Возвращаемое
значение:</p>

<p class="MsoNormal">Результат вычисления функции.</p>

<p class="Lang">РЕГРЕССИЯSXX (REGR_SXX)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрессияSXX(&lt;Y&gt;, &lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Выполняет расчет по следующей формуле:</p>

<p class="MsoNormalCxSpLast"><span class="Term">РегрессияКоличество(Y, X) *
ДисперсияГенеральнойСовокупоности(X)</span>. Пары, где есть хотя бы одно
значение <span class="Term">NULL</span>,
игнорируются.</p>

<p class="Lang-subheader">Возвращаемое значение:</p>

<p class="MsoNormal">Результат вычисления
функции.</p>

<p class="Lang">РЕГРЕССИЯSYY (REGR_SYY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрессияSYY(&lt;Y&gt;, &lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Выполняет расчет по следующей формуле:</p>

<p class="MsoNormalCxSpLast"><span class="Term">РегрессияКоличество(Y, X) *
ДисперсияГенеральнойСовокупоности(Y)</span>. Пары, где есть хотя бы одно
значение <span class="Term">NULL</span>,
игнорируются.</p>

<p class="Lang-subheader">Возвращаемое значение:</p>

<p class="MsoNormal">Результат вычисления функции.</p>

<p class="Lang">РЕГРЕССИЯSXY (REGR_SXY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">РегрессияSXY(&lt;Y&gt;, &lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Выполняет расчет по следующей формуле:</p>

<p class="MsoNormalCxSpLast"><span class="Term">РегрессияКоличество(Y, X) * КовариацияГенеральнойСовокупоности(Y,
X)</span>. Пары, где есть хотя бы одно значение <span class="Term">NULL</span>,
игнорируются.</p>

<p class="Lang-subheader">Возвращаемое значение:</p>

<p class="MsoNormal">Результат вычисления функции.</p>

<p class="Lang">МЕСТОВПОРЯДКЕ (RANK)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">МестоВПорядке(&lt;Порядок&gt;, &lt;ПорядокИерархии&gt;,
&lt;ИмяГруппировки&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция вычисляет, какое место имеет текущая
запись среди записей текущей группировки, если ее упорядочить в порядке, указанном
в параметрах функции. Нумерация начинается с 1.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Порядок&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Содержит выражения, в
последовательности которых нужно расположить групповые записи, разделенные
через запятую. Направление упорядочивания управляется при помощи слов <span class="Term">Возр</span>, <span class="Term">Убыв</span>. После поля также можно указать строку <span class="Term">Автоупорядочивание</span>, что обозначает, что при
упорядочивании ссылок нужно использовать поля упорядочивания, определенные для
объекта, на который указывает ссылка. Если последовательность не указана, то
значение рассчитывается в последовательности группировки.</p>

<p class="Lang-parameter">&lt;ПорядокИерархии&gt;</p>

<p class="MsoNormal">Тип: <span class="Term">Строка</span>.
Строка, содержащая выражения упорядочивания для иерархических записей.</p>

<p class="Lang-parameter">&lt;ИмяГруппировки&gt;</p>

<p class="MsoNormal">Тип: <span class="Term">Строка</span>.
Имя группировки, в которой нужно вычислять функцию. Если не указано, то
вычисление происходит в текущей группировке. Если вычисление выполняется в
таблице и параметр содержит пустую строку или не указан, то значение вычисляется
для группировки-строки. Компоновщик макета при генерации макета компоновки
данных заменяет данное имя на имя группировки в результирующем макете. Если
группировка не доступна, то функция будет заменена на значение <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Возвращаемое значение:</p>

<p class="MsoNormal">Номер по порядку. Если в последовательности
имеются две или более записей с одинаковым значением полей упорядочивания, то
для всех этих записей функция возвращает одинаковое значение.</p>

<p class="Lang">КЛАССИФИКАЦИЯABC (CLASSIFICATIONABC)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">КлассификацияABC(&lt;Значение&gt;, &lt;КоличествоГрупп&gt;, &lt;ПроцентыДляГрупп&gt;,
&lt;ИмяГруппировки&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Выполняет ABC-классификацию каждой записи в
заданной группировке.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Значение&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Указывает выражение, для которого
следует рассчитывать классификацию.</p>

<p class="Lang-parameter">&lt;КоличествоГрупп&gt;</p>

<p class="MsoNormal">Тип: <span class="Term">Число</span>.
На сколько групп необходимо разбить набор значений.</p>

<p class="Lang-parameter">&lt;ПроцентыДляГрупп&gt;</p>

<p class="MsoNormal">Тип: <span class="Term">Строка</span>.
Объем, в %, каждой группы разбиения, кроме последней группы. Перечисляются в
строке через запятую.</p>

<p class="Lang-parameter">&lt;ИмяГруппировки&gt;</p>

<p class="MsoNormal">Тип: <span class="Term">Строка</span>.
Имя группировки, в которой нужно вычислять функцию. Если не указано, то
вычисление происходит в текущей группировке. Если вычисление идет в таблице и
параметр содержит пустую строку или не указан, то значение вычисляется для
группировки-строки. Компоновщик макета при генерации макета компоновки данных
заменяет данное имя на имя группировки в результирующем макете. Если
группировка не доступна, то функция будет заменена на значение <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Возвращаемое значение:</p>

<p class="MsoNormal">Номер класса. <span class="Term">1</span>
соответствует классу <span class="Term">A</span>,
<span class="Term">2</span> –
классу <span class="Term">B</span>,
<span class="Term">3</span> –
классу <span class="Term">C</span>
и т. д.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">КлассификацияABC(СуммаОборот, 3, &quot;15, 25&quot;)</pre>

<a id="TI000000578" class="bookmark" name="issogl3_10.3.4.7_другие_операции"><h4>10.3.4.7. Другие операции</h4></a>

<p class="Lang">Операция
ВЫБОР (CASE)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Операция
<span class="Term">ВЫБОР</span> предназначена для осуществления выбора
одного из нескольких значений при выполнении некоторых условий.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБОР</span> <span class="keyword">Когда</span> Сумма <span class="operator">&gt;</span> <span class="number">1000</span> <span class="keyword">Тогда</span> Сумма <span class="keyword">Иначе</span> <span class="number">0</span> <span class="keyword">Конец</span></pre>

<a id="TI000000579" class="bookmark" name="issogl3_10.3.4.8_правила_сравнения_двух_значений"><h4>10.3.4.8. Правила сравнения двух значений</h4></a>

<p class="MsoNormal">Если
типы сравниваемых значений отличаются друг от друга, то отношения между
значениями определяются на основании приоритета типов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">NULL</span> (самый низший);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Булево</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Число</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Дата</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Строка</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
ссылочные типы.</p>

<p class="MsoNormalCxSpFirst">Отношения
между различными ссылочными типами определяются на основе ссылочных номеров
таблиц, соответствующих тому или иному типу.</p>

<p class="MsoNormalCxSpLast">Если
типы данных совпадают, то производится сравнение значений по следующим
правилам:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
у типа <span class="Term">Булево</span> значение <span class="Term">Истина</span> больше значения <span class="Term">Ложь</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
у типа <span class="Term">Число</span> обычные правила сравнения для чисел;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
у типа <span class="Term">Дата</span> более ранние даты меньше более поздних;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
у типа <span class="Term">Строка</span> сравнения строк в соответствии с установленными
национальными особенностями базы данных;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
ссылочные типы сравниваются на основе своих значений
(номера записи и т. п.).</p>

<a id="TI000000580" class="bookmark" name="issogl3_10.3.4.9_работа_со_значением_null"><h4>10.3.4.9. Работа со значением NULL</h4></a>

<p class="MsoNormalCxSpFirst">Любая
операция, в которой значение одного из операндов <span class="Term">NULL</span>, будет давать результат <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpLast">Есть
исключения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
операция <span class="Term">И</span> будет возвращать <span class="Term">NULL</span> только в случае, если ни один из
операндов не имеет значение <span class="Term">Ложь</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
операция <span class="Term">ИЛИ</span> будет возвращать <span class="Term">NULL</span> только в случае, если ни один из
операндов не имеет значение <span class="Term">Истина</span>.</p>

<a id="TI000000581" class="bookmark" name="issogl3_10.3.4.10_приоритеты_операций"><h4>10.3.4.10. Приоритеты операций</h4></a>

<p class="MsoNormal">Операции
имеют следующие приоритеты (первая строка имеет низший приоритет):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">ИЛИ</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">И</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">НЕ</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">В</span>, <span class="Term">ЕСТЬ NULL</span>, <span class="Term">ЕСТЬ НЕ NULL</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
=, &lt;&gt;, &lt;=, &lt;, &gt;=, &gt;;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Бинарный +, Бинарный -;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
*, /, %;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Унарный +, Унарный -.</p>

<a name="_ref322534401"></a><a name="_ref393981173"></a><a id="TI000000582" class="bookmark" name="issogl3_10.3.4.11_функции"><h4>10.3.4.11. Функции</h4></a>

<p class="Lang">ВЫЧИСЛИТЬ
(EVAL)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Вычислить(&lt;Выражение&gt;,
&lt;Группировка&gt;, &lt;ТипРасчета&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
<span class="Term">ВЫЧИСЛИТЬ</span> предназначена для вычисления выражения
в контексте некоторой группировки.</p>

<p class="MsoNormalCxSpLast">Функция
используется для совместимости с предыдущими версиями «1С:Предприятия». Вместо
данной функции рекомендуется использовать функцию <span class="Term">ВычислитьВыражение</span>.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражение&gt;</p>

<p class="MsoNormal">Строка,
содержащая вычисляемое выражение.</p>

<p class="Lang-parameter">&lt;Группировка&gt;</p>

<p class="MsoNormal">Строка,
содержащая имя группировки, в контексте которой необходимо вычислить выражение.
Если в качестве имени группировки используется пустая строка, вычисление будет
выполнено в контексте текущей группировки. Если в качестве имени группировки
будет использована строка <span class="Term">ОбщийИтог</span>, вычисление будет выполнено в контексте
общего итога. В остальных случаях вычисление будет выполняться в контексте родительской
группировки с таким именем.</p>

<p class="Lang-parameter">&lt;ТипРасчета&gt;</p>

<p class="MsoNormal">Строка,
содержащая тип расчета. Если данный параметр имеет значение <span class="Term">ОбщийИтог</span>, выражение будет вычисляться для всех
записей группировки. Если значение параметра – <span class="Term">Группировка</span>, значения будут вычисляться для
текущей групповой записи группировки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Сумма<span class="operator">(</span>Продажи<span class="operator">.</span>СуммаОборот<span class="operator">)</span> <span class="operator">/</span> ВЫЧИСЛИТЬ<span class="operator">(</span><span class="string">&quot;Сумма(Продажи.СуммаОборот)&quot;</span><span class="operator">,</span> <span class="string">&quot;ОбщийИтог&quot;</span><span class="operator">)</span></pre>

<p class="MsoNormal">В
данном примере в результате получится отношение суммы по полю <span class="Term">Продажи.СуммаОборот</span> записи группировки к сумме
того же поля во всей компоновке.</p>

<p class="Lang">ВЫЧИСЛИТЬВЫРАЖЕНИЕ
(EVALEXPRESSION)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ВычислитьВыражение(&lt;Выражение&gt;,
&lt;Группировка&gt;, &lt;ОбластьВычисления&gt;, &lt;Начало&gt;, &lt;Конец&gt;,
&lt;Сортировка&gt;, &lt;ИерархическаяСортировка&gt;,
&lt;ОбработкаОдинаковыхЗначенийПорядка&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
предназначена для вычисления выражения в контексте некоторой группировки. При
указании интервала вычисление возможно только для агрегатных функций системы
компоновки данных (см. <a href="#_ref416785433">здесь</a>), для остальных функций вычисление не выполняется.</p>

<p class="MsoNormalCxSpMiddle">Функция
учитывает отбор группировок, но не учитывает иерархические отборы. Функция не
может применяться к группировке в групповом отборе этой группировки. Например,
в отборе группировки <span class="Term">Номенклатура</span> нельзя использовать выражение <span class="Term">ВычислитьВыражение(&quot;Сумма(СуммаОборот)&quot;, , &quot;ОбщийИтог&quot;)
&gt; 1000</span>. Но такое выражение можно использовать в иерархическом
отборе. Если конечная запись предшествует начальной, то считается, что записи
для расчета детальных данных и расчета агрегатных функций отсутствуют.</p>

<p class="MsoNormalCxSpMiddle">При
расчете интервальных выражений для общего итога (параметр <span class="Term">Группировка</span> имеет значение <span class="Term">ОбщийИтог</span>) считается, что записи для расчета
детальных данных и расчета агрегатных функций отсутствуют.</p>

<p class="MsoNormalCxSpLast">Если
выражение упорядочивания содержит поля, которые не могут быть использованы в
группировке, то компоновщик макета при генерации выражения функции <span class="Term">ВычислитьВыражение</span> заменяет функцию <span class="Term">ВычислитьВыражение</span> на <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражение&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражение, которое нужно вычислить.</p>

<p class="Lang-parameter">&lt;Группировка&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Содержит имя группировки, в контексте
которой необходимо вычислить выражение. В случае, если в качестве имени
группировки используется пустая строка, вычисление будет выполнено в контексте
текущей группировки. Если в качестве имени группировки будет использована
строка <span class="Term">ОбщийИтог</span>, вычисление будет выполнено в
контексте общего итога. В остальных случаях вычисление будет выполняться в контексте
родительской группировки с таким именем.</p>

<p class="Lang-subheader">Например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Сумма<span class="operator">(</span>Продажи<span class="operator">.</span>СуммаОборот<span class="operator">)</span><span class="operator">/</span>Вычислить<span class="operator">(</span><span class="string">&quot;Сумма(Продажи.СуммаОборот)&quot;</span><span class="operator">,</span> <span class="string">&quot;ОбщийИтог&quot;</span><span class="operator">)</span></pre>

<p class="MsoNormal">В
данном примере в результате получится отношение суммы по полю <span class="Term">Продажи.СуммаОборот</span> записи группировки к сумме
того же поля во всей компоновке.</p>

<p class="Lang-parameter">&lt;ОбластьВычисления&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Параметр может принимать следующие
значения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">ОбщийИтог</span> – выражение будет вычисляться
для всех записей группировки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Иерархия</span> – выражение будет вычисляться
для родительской иерархической записи, если таковая имеется, и для всей группировки,
если родительской иерархической записи не имеется.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Группировка</span> – выражение будет вычисляться
для текущей групповой записи группировки.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ГруппировкаНеРесурса</span> – при вычислении
функции для групповой записи по ресурсам выражение будет вычислено для первой
групповой записи исходной группировки.</p>

<p class="IndentlistCxSpFirst">При
вычислении функции <span class="Term">ВычислитьВыражение()</span> со значением <span class="Term">ГруппировкаНеРесурса</span> для групповых записей, не
являющихся группировками по ресурсам, функция вычисляется, как в случае, если
значение параметра было равно значению <span class="Term">Группировка</span>.</p>

<p class="IndentlistCxSpLast">Компоновщик
макета компоновки данных при генерации макета компоновки данных при выводе в
макет поля-ресурса, по которому выполняется группировка, помещает в макет
выражение, вычисляемое при помощи функции <span class="Term">ВычислитьВыражение()</span>, с указанием параметра <span class="Term">ГруппировкаНеРесурса</span>. Для остальных ресурсов в
группировке по ресурсу помещаются обычные выражения ресурсов.</p>

<p class="Lang-parameter">&lt;Начало&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Указывает, с какой записи нужно
начинать фрагмент, в котором рассчитывать агрегатные функции выражения, и из
какой записи получать значения полей вне агрегатных функций. Значение может
быть одним из следующих:</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Первая</span> (<span class="Term">First</span>). Необходимо получать первую запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение от начала группировки. Получаемое
значение должно целым числом больше нуля. Например, <span class="Term">Первая(3)</span> – получение третьей записи от
начала группировки.</p>

<p class="Indentlist">Если
первая запись выходит за пределы группировки, то считается, что записей нет.
Например, если записей 3, а требуется получить <span class="Term">Первая(4)</span>, то считается, что записей нет.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Последняя</span> (<span class="Term">Last</span>). Необходимо получить последнюю запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение от конца группировки. Получаемое значение
должно целым числом больше нуля. Например, <span class="Term">Последняя(3)</span> – получение третьей записи
от конца группировки.</p>

<p class="Indentlist">Если
последняя запись выходит за пределы группировки, то считается, что записей нет.
Например, если записей 3, а требуется получить <span class="Term">Последняя(4)</span>, то считается, что записей нет.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Предыдущая</span> (<span class="Term">Previous</span>). Необходимо получить предыдущую запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение назад от текущей записи группировки.
Например, <span class="Term">Предыдущая(2)</span> – получение предыдущей от
предыдущей записи.</p>

<p class="IndentlistCxSpFirst">Если
предыдущая запись выходит за пределы группировки (например, для второй записи
группировки требуется получить <span class="Term">Предыдущая(3)</span>), то получается первая запись
группировки.</p>

<p class="IndentlistCxSpLast">При
получении предыдущей записи для итога по группировке считается, что получается
первая запись.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Следующая</span> (<span class="Term">Next</span>). Необходимо получить следующую запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение вперед от текущей записи
группировки. Например, <span class="Term">Следующая(2)</span> – получение следующей от
следующей записи.</p>

<p class="IndentlistCxSpFirst">Если
следующая запись выходит за пределы группировки, то считается, что записей нет.
Например, если записей 3 и для третьей записи получают <span class="Term">Следующая()</span>, то считается, что записей нет.</p>

<p class="IndentlistCxSpLast">При
получении следующей записи для итога по группировке считается, что записи нет.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Текущая</span> (<span class="Term">Current</span>). Необходимо получить текущую запись.</p>

<p class="Indentlist">При
получении для итога по группировке получается первая запись.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">ОграничивающееЗначение</span> (<span class="Term">BoundaryValue</span>). Необходимо получить запись по
указанному значению. После слова <span class="Term">ОграничивающееЗначение</span> в скобках следует
указать выражение первого поля упорядочивания, со значения которого нужно
начинать фрагмент.</p>

<p class="Indentlist">В
качестве записи будет получаться первая запись, значение поля упорядочивания у
которой больше или равно указанному значению. Например, если в качестве поля
упорядочивания используется поле <span class="Term">Период</span>, оно имеет значения <span class="Interface">01.01.2010</span>, <span class="Interface">01.02.2010</span>, <span class="Interface">01.03.2010</span> и
требуется получить <span class="Term">ОграничивающееЗначение(ДатаВремя(2010, 1, 15))</span>,
то будет получена запись с датой <span class="Interface">01.02.2010</span>.</p>

<p class="Lang-parameter">&lt;Конец&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Указывает, до какой записи нужно продолжать
фрагмент, в котором рассчитывать агрегатные функции выражения. Значение может
быть одним из следующих:</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Первая</span> (<span class="Term">First</span>). Необходимо получать первую запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение от начала группировки. Получаемое
значение должно целым числом больше нуля. Например, <span class="Term">Первая(3)</span> – получение третьей записи от
начала группировки.</p>

<p class="Indentlist">Если
первая запись выходит за пределы группировки, то считается, что записей нет.
Например, если записей 3, а требуется получить <span class="Term">Первая(4)</span>, то считается, что записей нет.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Последняя</span> (<span class="Term">Last</span>). Необходимо получить последнюю запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение от конца группировки. Получаемое
значение должно целым числом больше нуля. Например, <span class="Term">Последняя(3)</span> – получение третьей записи
от конца группировки.</p>

<p class="Indentlist">Если
последняя запись выходит за пределы группировки, то считается, что записей нет.
Например, если записей 3, а требуется получить <span class="Term">Последняя(4)</span>, то считается, что записей нет.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Предыдущая</span> (<span class="Term">Previous</span>). Необходимо получить предыдущую запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение назад от текущей записи группировки.
Например, <span class="Term">Предыдущая(2)</span> – получение предыдущей от
предыдущей записи.</p>

<p class="IndentlistCxSpFirst">Если
предыдущая запись выходит за пределы группировки (например, для второй записи
группировки требуется получить <span class="Term">Предыдущая(3)</span>, то получается первая запись
группировки.</p>

<p class="IndentlistCxSpLast">При
получении предыдущей записи для итога по группировке считается, что получается
первая запись.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Следующая</span> (<span class="Term">Next</span>). Необходимо получить следующую запись
группировки. После слова в скобках можно указывать выражение, результат
которого будет использоваться как смещение вперед от текущей записи
группировки. Например, <span class="Term">Следующая(2)</span> – получение следующей от
следующей записи.</p>

<p class="IndentlistCxSpFirst">Если
следующая запись выходит за пределы группировки, то считается, что записей нет.
Например, если записей 3 и для третьей записи получают <span class="Term">Следующая()</span>, то считается, что записей нет.</p>

<p class="IndentlistCxSpLast">При
получении следующей записи для итога по группировке считается, что записи нет.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Текущая</span> (<span class="Term">Current</span>). Необходимо получить текущую запись.</p>

<p class="Indentlist">При
получении для итога по группировке получается первая запись.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">ОграничивающееЗначение</span> (<span class="Term">BoundaryValue</span>). Необходимо получить запись по
указанному значению. После слова <span class="Term">ОграничивающееЗначение</span> в скобках следует указать
выражение первого поля упорядочивания, со значения которого необходимо завершить
фрагмент.</p>

<p class="Indentlist">В
качестве записи будет получаться первая запись, значение поля упорядочивания у
которой больше или равно указанному значению. Например, если в качестве поля
упорядочивания используется поле <span class="Term">Период</span>, оно имеет значения <span class="Interface">01.01.2010</span>, <span class="Interface">01.02.2010</span>, <span class="Interface">01.03.2010</span> и
требуется получить <span class="Term">ОграничивающееЗначение(ДатаВремя(2010, 1, 15))</span>,
то будет получена запись с датой <span class="Interface">01.02.2010</span>.</p>

<p class="Lang-parameter">&lt;Сортировка&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Перечисляются выражения, разделенные
запятыми, которые описывают правила упорядочивания. Если не указана, то
упорядочивание выполняется так же, как и у группировки, для которой вычисляется
выражение. После каждого выражения можно указать ключевое слово <span class="Term">Возр</span> (для упорядочивания по возрастанию), <span class="Term">Убыв</span> (для упорядочивания по убывания) и <span class="Term">Автоупорядочивание</span> (для упорядочивания
ссылочных полей по полям, по которым нужно упорядочивать объект, на который
выполняется ссылка). Слово <span class="Term">Автоупорядочивание</span> может использоваться как со
словом <span class="Term">Возр</span>, так и со словом <span class="Term">Убыв</span>.</p>

<p class="Lang-parameter">&lt;ИерархическаяСортировка&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Аналогично параметру <span class="Term">Сортировка</span>. Применяется для упорядочивания
иерархических записей. Если не указано, компоновщик макета генерирует
упорядочивание в соответствии с упорядочиванием, указанным в параметре <span class="Term">Сортировка</span>.</p>

<p class="Lang-parameter">&lt;ОбработкаОдинаковыхЗначенийПорядка&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Указывает правило определения
предыдущей или следующий записи, если есть несколько записей с одинаковым
значением упорядочивания:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Отдельно</span> (<span class="Term">Separately</span>) обозначает, что для определения
предыдущей и следующей записей используется последовательность упорядоченных
записей. Значение по умолчанию.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Вместе</span> (<span class="Term">Together</span>) обозначает, что предыдущая и
следующие записи определяются на основании значений выражений упорядочивания.</p>

<p class="Indentlist">Например,
если полученная последовательность упорядочена по дате:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>№</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Дата</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>ФИО</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Значение</b></p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">01 января 2001 года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов М.</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">10</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">2</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">02 января 2001 года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Петров С.</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">20</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">3</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">02 января 2001 года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Сидоров Р.</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">30</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">4</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">03 января 2001 года</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Петров С.</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">40</p>
  </td>
  
 </tr>
</table>

<p class="Indentlist">Если
значение параметра равно <span class="Term">Отдельно</span>, то:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Предыдущей записью к записи 3 будет запись 2.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Если расчетный фрагмент определяется как <span class="Term">Текущая, Текущая</span> (соответственно, параметры <span class="Term">Начало</span> и <span class="Term">Конец</span>), то для записи 2 этот фрагмент будет
состоять из одной записи 2. Выражение <span class="Term">ВычислитьВыражение(&quot;Сумма(Значение)&quot;, , , Текущая,
Текущая)</span> будет равно 20.</p>

<p class="Indentlist">Если
значение параметра равно <span class="Term">Вместе</span>, то:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Предыдущей записью к записи 3 будет запись 1.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Если расчетный фрагмент определяется как <span class="Term">Текущая, Текущая</span> (соответственно, параметры <span class="Term">Начало</span> и <span class="Term">Конец</span>), то для записи 2 этот фрагмент будет
состоять из записей 2 и 3. Выражение <span class="Term">ВычислитьВыражение(&quot;Сумма(Значение)&quot;, , , Текущая,
Текущая)</span> будет равно 50.</p>

<p class="Indentlist">При
указании значения параметра, равного <span class="Term">Вместе</span>, в параметрах <span class="Term">Начало</span> и <span class="Term">Конец</span> нельзя указывать смещение для позиций <span class="Term">Первая</span>, <span class="Term">Последняя</span>, <span class="Term">Предыдущая</span>, <span class="Term">Следующая</span>.</p>

<p class="Lang-subheader">Пример:</p>

<p class="MsoNormal">Если
требуется рассчитать сумму с накоплением, то можно использовать следующее
выражение:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ВычислитьВыражение<span class="operator">(</span><span class="string">&quot;Сумма(СуммаОборот)&quot;</span><span class="operator">,</span> <span class="operator">,</span> <span class="operator">,</span> <span class="string">&quot;Первая&quot;</span><span class="operator">,</span> <span class="string">&quot;Текущая&quot;</span><span class="operator">)</span></pre>

<p class="MsoNormal">Если
требуется получить значение группировки в предыдущей строке, то можно
использовать следующее выражение:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ВычислитьВыражение<span class="operator">(</span><span class="string">&quot;Курс&quot;</span><span class="operator">,</span> <span class="operator">,</span> <span class="operator">,</span> <span class="string">&quot;Предыдущая&quot;</span><span class="operator">)</span></pre>

<p class="Lang">ВЫЧИСЛИТЬВЫРАЖЕНИЕСГРУППИРОВКОЙМАССИВ
(EVALEXPRESSIONWITHGROUPARRAY)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ВычислитьВыражениеСГруппировкойМассив(&lt;Выражение&gt;,
&lt;ВыражениеПолейГруппировки&gt;, &lt;ОтборЗаписей&gt;,
&lt;ОтборГруппировок&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
возвращает массив, каждый элемент которого содержит результат вычисления
выражения для группировки по указанному полю.</p>

<p class="MsoNormalCxSpMiddle">Компоновщик
макета при генерации макета преобразовывает параметры функции в термины полей
макета компоновки данных. Например, поле <span class="Term">Контрагент</span> будет преобразовано в <span class="Term">НаборДанных.Контрагент</span>.</p>

<p class="MsoNormalCxSpLast">Компоновщик
макета при генерации выражений для вывода пользовательского поля, в выражении
которого присутствует только функция <span class="Term">ВычислитьМассивСГруппировкойМассив(),</span>
генерирует выводимое выражение таким образом, чтобы выводимая информация была
упорядочена. Например, для пользовательского поля с выражением:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ВычислитьВыражениеСГруппировкойМассив<span class="operator">(</span><span class="string">&quot;Сумма(СуммаОборот)&quot;</span><span class="operator">,</span> <span class="string">&quot;Контрагент&quot;</span><span class="operator">)</span></pre>

<p class="MsoNormal">Компоновщик
макета сгенерирует для вывода следующее выражение:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СоединитьСтроки<span class="operator">(</span>Массив<span class="operator">(</span>Упорядочить<span class="operator">(</span>ВычислитьВыражениеСГруппировкойТаблицаЗначений<span class="operator">(</span><span class="string">&quot;Представление(Сумма(НаборДанных.СуммаОборот)),Сумма(НаборДанных.СуммаОборот)&quot;</span><span class="operator">,</span><span class="string">&quot;НаборДанных.Контрагент&quot;</span><span class="operator">)</span><span class="operator">,</span><span class="string">&quot;2&quot;</span><span class="operator">)</span><span class="operator">)</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражение&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражение, которое нужно вычислить.
Строка, например, <span class="Term">Сумма(СуммаОборот)</span>.</p>

<p class="Lang-parameter">&lt;ВыражениеПолейГруппировки&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражения полей группировки –
выражения полей группировки, перечисленные через запятую. Например, <span class="Term">Контрагент, Партия</span>.</p>

<p class="Lang-parameter">&lt;ОтборЗаписей&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражение, описывающее отбор, применяемый
к детальным записям. В выражении не поддерживается
использование агрегатных функций. Например, <span class="Term">ПометкаУдаления = Ложь</span>.</p>

<p class="Lang-parameter">&lt;ОтборГруппировок&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражение, описывающее отбор,
применяемый к групповым записям. Например, <span class="Term">Сумма(СуммаОборот) &gt; &amp;Параметр1</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Максимум<span class="operator">(</span>ВычислитьВыражениеСГруппировкойМассив <span class="operator">(</span><span class="string">&quot;Сумма(СуммаОборот)&quot;</span><span class="operator">,</span> <span class="string">&quot;Контрагент&quot;</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="Lang">ВЫЧИСЛИТЬВЫРАЖЕНИЕСГРУППИРОВКОЙТАБЛИЦАЗНАЧЕНИЙ
(EVALEXPRESSIONWITHGROUPVALUETABLE)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ВычислитьВыражениеСГруппировкойТаблицаЗначений(&lt;Выражения&gt;,
&lt;ВыражениеПолейГруппировки&gt;, &lt;ОтборЗаписей&gt;, &lt;ОтборГруппировок&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
возвращает таблицу значений, каждая строка которой содержит результат
вычисления выражений для группировки по указанному полю.</p>

<p class="MsoNormalCxSpMiddle">Компоновщик
макета при генерации макета преобразовывает параметры функции в термины полей
макета компоновки данных. Например, поле <span class="Term">Контрагент</span> будет конвертировано в <span class="Term">НаборДанных.Контрагент</span>.</p>

<p class="MsoNormalCxSpLast">Компоновщик
макета при генерации выражений для вывода пользовательского поля, в выражении
которого присутствует только функция <span class="Term">ВычислитьМассивСГруппировкойТаблицаЗначений(),</span>
генерирует выводимое выражение таким образом, чтобы выводимая информация была
упорядочена. Например, для пользовательского поля с выражением:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ВычислитьВыражениеСГруппировкойТаблицаЗначений <span class="operator">(</span><span class="string">&quot;Контрагент, Сумма(СуммаОборот)&quot;</span><span class="operator">,</span> <span class="string">&quot;Контрагент&quot;</span><span class="operator">)</span></pre>

<p class="MsoNormal">Компоновщик
макета сгенерирует для вывода следующее выражение:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СоединитьСтроки<span class="operator">(</span>ПолучитьЧасть<span class="operator">(</span>Упорядочить<span class="operator">(</span>ВычислитьВыражениеСГруппировкойТаблицаЗначений <span class="operator">(</span><span class="string">&quot;НаборДанных.Контрагент, НаборДанных.КонтрагентПредставление, Сумма(НаборДанных.СуммаОборот), Представление(НаборДанных.СуммаОборот), НаборДанных.ПолеУпорядочивание&quot;</span><span class="operator">,</span> <span class="string">&quot;НаборДанных.Контрагент&quot;</span><span class="operator">)</span><span class="operator">,</span> <span class="string">&quot;5, 1, 3&quot;</span><span class="operator">)</span><span class="operator">,</span> <span class="string">&quot;2, 4&quot;</span><span class="operator">)</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Параметры:</p>

<p class="Lang-parameter">&lt;Выражения&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражения, которые нужно вычислить. В
строке может быть перечислено несколько выражений через запятую. После каждого
выражения может быть необязательное ключевое слово <span class="Term">КАК</span> и имя колонки таблицы значений. Например: <span class="Term">Контрагент, Сумма(СуммаОборот) Как ОбъемПродаж</span>.</p>

<p class="Lang-parameter">&lt;ВыражениеПолейГруппировки&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражения полей группировки –
выражения полей группировки, перечисленные через запятую. Например, <span class="Term">Контрагент, Партия</span>.</p>

<p class="Lang-parameter">&lt;ОтборЗаписей&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражение, описывающее отбор, применяемый
к детальным записям. В выражении не поддерживается использование агрегатных
функций. Например, <span class="Term">ПометкаУдаления = Ложь</span>.</p>

<p class="Lang-parameter">&lt;ОтборГруппировок&gt;</p>

<p class="MsoNormal">Тип:
<span class="Term">Строка</span>. Выражение, описывающее отбор,
применяемый к групповым записям. Например, <span class="Term">Сумма(СуммаОборот) &gt; &amp;Параметр1</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ВычислитьВыражениеСГруппировкойТаблицаЗначений <span class="operator">(</span><span class="string">&quot;Контрагент КАК Контрагент, Сумма(СуммаОборот) Как ОбъемПродаж&quot;</span><span class="operator">,</span> <span class="string">&quot;Контрагент&quot;</span><span class="operator">)</span></pre>

<p class="MsoNormal">Результатом
работы данной функции будет таблица значений с колонками <span class="Term">Контрагент</span> и <span class="Term">ОбъемПродаж</span>, в которых будут находиться
контрагенты с их объемами продаж.</p>

<p class="Lang">УРОВЕНЬ
(LEVEL)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для получения текущего уровня записи.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">УРОВЕНЬ<span class="operator">(</span><span class="operator">)</span></pre>

<p class="Lang">УРОВЕНЬВГРУППИРОВКЕ
(LEVELINGROUP)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для получения уровня записи относительно корня группировки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">УРОВЕНЬВГРУППИРОВКЕ<span class="operator">(</span><span class="operator">)</span></pre>

<p class="Lang">ЗНАЧЕНИЕЗАПОЛНЕНО
(VALUEISFILLED)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
<span class="Term">Истина</span>, если значение отлично от значения данного
типа по умолчанию, отлично от значения <span class="Term">NULL</span>, отлично от пустой ссылки, отлично от
значения <span class="Term">Неопределено</span>. Для логических значений осуществляется
проверка на значение <span class="Term">NULL</span>. Для строк осуществляется проверка на отсутствие
непробельных символов.</p>

<p class="Lang">НОМЕРПОПОРЯДКУ
(SERIALNUMBER)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Получить
следующий порядковый номер.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">НОМЕРПОПОРЯДКУ<span class="operator">(</span><span class="operator">)</span></pre>

<p class="Lang">НОМЕРПОПОРЯДКУВГРУППИРОВКЕ
(GROUPSERIALNUMBER)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
следующий порядковый номер в текущей группировке.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">НОМЕРПОПОРЯДКУВГРУППИРОВКЕ<span class="operator">(</span><span class="operator">)</span></pre>

<p class="Lang">ФОРМАТ
(FORMAT)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Получить
отформатированную строку переданного значения. Форматная строка задается в
соответствии с форматной строкой системы «1С:Предприятие».</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Значение,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Форматная строка.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ФОРМАТ<span class="operator">(</span>РасходныеНакладные<span class="operator">.</span>СуммаДок<span class="operator">,</span> <span class="string">&quot;ЧДЦ=2&quot;</span><span class="operator">)</span></pre>

<p class="Lang">НАЧАЛОПЕРИОДА
(BEGINOFPERIOD)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для выделения определенной даты из заданной даты.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Выражение типа <span class="Term">Дата</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Тип периода – строка, содержащая одно из
значений:<span class="Term"> Минута</span>,<span class="Term"> Час</span>,<span class="Term"> День</span>,<span class="Term"> Неделя</span>,<span class="Term"> Месяц</span>,<span class="Term"> Квартал</span>,<span class="Term"> Год</span>,<span class="Term"> Декада</span>,<span class="Term"> Полугодие</span>. Если тип периода указан <span class="Term">Неделя</span>, то учитывается значение свойства <span class="Interface">Первый день недели</span>
региональных установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>).</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">НАЧАЛОПЕРИОДА<span class="operator">(</span>ДатаВремя<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> <span class="string">&quot;Месяц&quot;</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">01.10.2002 0:00:00</pre>

<p class="Lang">КОНЕЦПЕРИОДА
(ENDOFPERIOD)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для выделения определенной даты из заданной даты.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Выражение типа <span class="Term">Дата</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Тип периода – строка, содержащая одно из
значений:<span class="Term"> Минута</span>,<span class="Term"> Час</span>,<span class="Term"> День</span>,<span class="Term"> Неделя</span>,<span class="Term"> Месяц</span>,<span class="Term"> Квартал</span>,<span class="Term"> Год</span>,<span class="Term"> Декада</span>,<span class="Term"> Полугодие</span>. Если тип периода указан <span class="Term">Неделя</span>, то учитывается значение свойства <span class="Interface">Первый день недели</span>
региональных установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>).</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">КОНЕЦПЕРИОДА<span class="operator">(</span>ДатаВремя<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> <span class="string">&quot;Неделя&quot;</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">13.10.2002 23:59:59</pre>

<p class="Lang">ДОБАВИТЬКДАТЕ
(DATEADD)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для прибавления к дате некоторой величины.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Выражение типа <span class="Term">Дата</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Тип увеличения – строка, содержащая одно из
значений: <span class="Term">Секунда</span>, <span class="Term">Минута</span>, <span class="Term">Час</span>, <span class="Term">День</span>, <span class="Term">Неделя</span>, <span class="Term">Месяц</span>, <span class="Term">Квартал</span>, <span class="Term">Год</span>, <span class="Term">Декада</span>, <span class="Term">Полугодие</span>. Следует учитывать, что под термином
<span class="Term">Декада</span> понимается строго 10 дней, вне
зависимости от даты, указанной в первом параметре функции.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Величина – на сколько необходимо увеличить
дату. Тип <span class="Term">Число</span>. Дробная часть игнорируется.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ДОБАВИТЬКДАТЕ(ДатаВремя(2002, 10, 12, 10, 15, 34), &quot;Месяц&quot;, 1)</pre>

<p class="Lang-subheader">Результат:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">12.11.2002 10:15:34</pre>

<p class="Lang">РАЗНОСТЬДАТ
(DATEDIFF)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для получения разницы между двумя датами.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Выражение типа <span class="Term">Дата</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выражение типа <span class="Term">Дата</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Тип разности – одно из значений: <span class="Term">Секунда</span>, <span class="Term">Минута</span>, <span class="Term">Час</span>, <span class="Term">День</span>, <span class="Term">Месяц</span>, <span class="Term">Квартал</span>, <span class="Term">Год</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">РАЗНОСТЬДАТ<span class="operator">(</span>ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span>
            ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">14</span><span class="operator">,</span> <span class="number">9</span><span class="operator">,</span> <span class="number">18</span><span class="operator">,</span> <span class="number">06</span><span class="operator">)</span><span class="operator">,</span>
            <span class="string">&quot;ДЕНЬ&quot;</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">2</pre>

<p class="Lang">ТЕКУЩАЯДАТА
(CURRENTDATE)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
системную дату. При компоновке макета компоновки во всех выражениях, которые
присутствуют в компоновке, функция <span class="Term">ТекущаяДата()</span> заменяется значением текущей
даты.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ТЕКУЩАЯДАТА<span class="operator">(</span><span class="operator">)</span></pre>

<p class="Lang">ПОДСТРОКА
(SUBSTRING)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для выделения подстроки из строки.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
выражение, имеющее строковый тип;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
позиция символа, с которого начинается
выделяемая из строки подстрока;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
длина выделяемой подстроки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПОДСТРОКА<span class="operator">(</span>Контрагенты<span class="operator">.</span>Адрес<span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">4</span><span class="operator">)</span></pre>

<p class="Lang">ДЛИНАСТРОКИ
(STRINGLENGTH)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
предназначена для определения длины строки. Параметр – выражение
строкового типа.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ДЛИНАСТРОКИ<span class="operator">(</span>Контрагенты<span class="operator">.</span>Адрес<span class="operator">)</span></pre>

<p class="Lang">ГОД
(YEAR)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для выделения года из значения типа <span class="Term">Дата</span>. Единственный параметр – это выражение,
имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ГОД<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">КВАРТАЛ
(QUARTER)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для выделения номера квартала из значения типа <span class="Term">Дата</span>. Номер квартала в норме находится в диапазоне
от 1 до 4. Единственный параметр функции – это выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">КВАРТАЛ<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">МЕСЯЦ
(MONTH)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для выделения номера месяца из значения типа <span class="Term">Дата</span>. Номер месяца в норме находится в диапазоне
от 1 до 12. Единственный параметр функции – это выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">МЕСЯЦ<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">ДЕНЬГОДА
(DAYOFYEAR)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для получения дня года из значения типа <span class="Term">Дата</span>. День года в норме находится в диапазоне
от 1 до 365 (366). Единственный параметр функции – это выражение, имеющее
тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ДЕНЬГОДА<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">ДЕНЬ
(DAY)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для получения дня месяца из значения типа <span class="Term">Дата</span>. День месяца в норме находится в диапазоне
от 1 до 31. Единственный параметр функции – это выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ДЕНЬ<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">НЕДЕЛЯ
(WEEK)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для получения номера недели года из значения типа <span class="Term">Дата</span>. Недели года нумеруются, начиная с 1. Единственный
параметр функции – это выражение, имеющее тип <span class="Term">Дата</span>. При вычислении учитывается значение
свойства <span class="Interface">Первый день недели</span>
региональных установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>).</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">НЕДЕЛЯ<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">ДЕНЬНЕДЕЛИ
(WEEKDAY)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для получения дня недели из значения типа <span class="Term">Дата</span>. День недели в норме находится в диапазоне
от 1 (понедельник) до 7 (воскресенье). Единственный параметр функции – это
выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ДЕНЬНЕДЕЛИ<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">ЧАС
(HOUR)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для получения часа суток из значения типа <span class="Term">Дата</span>. Час суток находится в диапазоне от 0 до
23. Единственный параметр функции – это выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЧАС<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">МИНУТА
(MINUTE)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для получения минуты часа из значения типа <span class="Term">Дата</span>. Минута часа находится в диапазоне от 0
до 59. Единственный параметр функции – это выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">МИНУТА<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">СЕКУНДА
(SECOND)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для получения секунды минуты из значения типа <span class="Term">Дата</span>. Секунда минуты находится в диапазоне от
0 до 59. Единственный параметр функции – это выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СЕКУНДА<span class="operator">(</span>РасхНакл<span class="operator">.</span>Дата<span class="operator">)</span></pre>

<p class="Lang">ВЫРАЗИТЬ
(CAST)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция предназначена для выделения типа из выражения, которое может содержать
составной тип. Если выражение будет содержать тип, отличный от требуемого, будет
возвращено значение <span class="Term">NULL</span>.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Преобразуемое выражение.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Тип</span> – строка, содержащая строку типа.
Например, <span class="Term">Число</span>, <span class="Term">Строка</span> и т. п. Кроме примитивных
типов данная строка может содержать имя таблицы. В таком случае будет
осуществлена попытка выразить к ссылке на указанную таблицу.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ВЫРАЗИТЬ<span class="operator">(</span>Данные<span class="operator">.</span>Реквизит1<span class="operator">,</span> <span class="string">&quot;Число(10,3)&quot;</span><span class="operator">)</span></pre>

<p class="Lang">ЕСТЬNULL
(ISNULL)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная
функция возвращает значение второго параметра, если значение первого параметра <span class="Term">NULL</span>. В противном случае будет возвращено
значение первого параметра.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЕСТЬNULL<span class="operator">(</span>Сумма<span class="operator">(</span>Продажи<span class="operator">.</span>СуммаОборот<span class="operator">)</span><span class="operator">,</span> <span class="number">0</span><span class="operator">)</span></pre>

<p class="Lang">ПРЕДСТАВЛЕНИЕ
(PRESENTATION)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Представление(&lt;Выражение&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная
функция возвращает строковое представление переданного значения непримитивного
типа. Для значений примитивного типа возвращает само значение.</p>

<p class="MsoNormalCxSpLast">Если
в качестве параметра передан массив, то функция возвращает строку, содержащую
строковые представления всех элементов массива, разделенных символами &quot;<span class="Interface">; </span>&quot;. Если
в качестве параметра передана таблица значений, то функция возвращает строку,
содержащую строковые представления всех строк таблицы значений, причем
представления ячеек каждой строки разделяются символами &quot;<span class="Interface">; </span>&quot;, а
строки – символом перевода строки. Если у какого-либо элемента строковое
представление пустое, то вместо его представления выводится строка <span class="Interface">&lt;Пустое
значение&gt;</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Представление<span class="operator">(</span>Контрагент<span class="operator">)</span></pre>

<p class="Lang">СТРОКА
(STRING)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Строка(&lt;Выражение&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Если
в качестве параметра передан массив, то функция возвращает строку, содержащую
строковые представления всех элементов массива, разделенных символами &quot;<span class="Interface">; </span>&quot;. Если
в качестве параметра передана таблица значений, то функция возвращает строку,
содержащую строковые представления всех строк таблицы значений, причем представления
ячеек каждой строки разделяются символами &quot;<span class="Interface">; </span>&quot;, а
строки – символом перевода строки. Если у какого-либо элемента строковое
представление пустое, то вместо его представления выводится строка <span class="Interface">&lt;Пустое
значение&gt;</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Строка<span class="operator">(</span>ДатаПродажи<span class="operator">)</span></pre>

<p class="Lang">ACOS</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ACos(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение арккосинуса.</p>

<p class="Lang">ASIN</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ASin(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение арксинуса.</p>

<p class="Lang">ATAN</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ATan(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение арктангенса.</p>

<p class="Lang">COS</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Cos(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет
значение косинуса.</p>

<p class="Lang">SIN</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Sin(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение синуса.</p>

<p class="Lang">TAN</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Tan(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение тангенса.</p>

<p class="Lang">EXP</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Exp(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет <span class="Term">e</span>
в степени <span class="Term">X</span>.</p>

<p class="Lang">LOG</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Log(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение натурального логарифма.</p>

<p class="Lang">LOG10</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Log10(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение десятичного логарифма.</p>

<p class="Lang">POW</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Pow(&lt;X&gt;, &lt;Y&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение <span class="Term">X</span>
в степени <span class="Term">Y</span>.</p>

<p class="Lang">SQRT</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Sqrt(&lt;X&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет значение квадратного корня.</p>

<p class="Lang">ОКР (ROUND)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Окр(&lt;Выражение&gt;, &lt;КоличествоЗнаков&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Округляет значение <span class="Term">Выражение</span>
до <span class="Term">КоличествоЗнаков</span>
после запятой.</p>

<p class="Lang">ЦЕЛ (INT)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">Цел(&lt;Выражение&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет целую часть переданного числа,
полностью отсекая дробную часть.</p>

<p class="Lang">ТИПЗНАЧЕНИЯ (VALUETYPE)</p>

<p class="Lang-subheader">Синтаксис:</p>

<p class="MsoNormal"><span class="Term">ТипЗначения(&lt;Выражение&gt;)</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Вычисляет тип выражения, переданного в
качестве параметра.</p>

<p class="Lang-subheader">Возвращаемое значение:</p>

<p class="MsoNormal">Значение типа <span class="Term">Тип</span>.</p>

<a id="TI000000583" class="bookmark" name="issogl3_10.3.4.12_функции_общих_модулей"><h4>10.3.4.12. Функции общих модулей</h4></a>

<p class="MsoNormal">Выражение
механизма компоновки данных может содержать вызовы функций глобальных общих
модулей конфигурации и неглобальных общих модулей с установленным свойством <span class="Interface">Клиент (обычное приложение)</span>
(при использовании обычного приложения) или <span class="Interface">Сервер</span> (при использовании
управляемого приложения). Никакого дополнительного синтаксиса для вызова таких
функций не требуется.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СокращенноеНаименование<span class="operator">(</span>Докум<span class="operator">.</span>Ссылка<span class="operator">,</span> Докум<span class="operator">.</span>Дата<span class="operator">,</span> Докум<span class="operator">.</span>Номер<span class="operator">)</span></pre>

<p class="MsoNormalCxSpFirst">В
данном примере будет осуществлен вызов функции <span class="Term">СокращенноеНаименование()</span> из общего модуля
конфигурации.</p>

<p class="MsoNormalCxSpMiddle">Отметим,
что использование функций общих модулей разрешено только при указании
соответствующего параметра процессора компоновки данных.</p>

<p class="MsoNormalCxSpLast">Кроме
того, функции общих модулей не могут быть использованы в выражениях
пользовательских полей.</p>

<a id="TI000000584" class="bookmark" name="issogl2_10.3.5_конструктор_схемы_компоновки_данных"><h3>10.3.5. Конструктор схемы компоновки данных</h3></a>

<p class="MsoNormalCxSpFirst">Конструктор
схемы компоновки данных представляет собой объект встроенного языка <span class="Term">КонструкторСхемыКомпоновкиДанных</span>,
предназначенный для визуального конструирования схемы компоновки данных. Кроме
того, конструктор схемы компоновки данных используется в конфигураторе при редактировании
схемы компоновки данных.</p>

<p class="MsoNormalCxSpLast">Для наборов
данных – запроса конструктор автоматически получает вложенные наборы
данных из текста запроса и оформляет их как поля набора данных – вложенный
набор данных.</p>

<p class="Regularbeforepicture">Для
наборов данных – объекта конструктор позволяет добавлять поля – вложенные
наборы данных.</p>

<p class="Picture"><IMG src="_img/img00376.gif?_=1496848987" WIDTH="591" ALT HEIGHT="236"></p>

<p class="MsoCaption">Рис. 377. Добавление нового набора данных</p>

<p class="MsoNormal">Ниже приведен
пример открытия окна конструктора схемы компоновки данных и последующей
сериализации полученной схемы компоновки в XML.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> КоманднаяПанельРедактораОтчета <span class="operator">(</span>Кнопка<span class="operator">)</span>
    Конструктор <span class="operator">=</span> <span class="keyword">Новый</span> КонструкторСхемыКомпоновкиДанных<span class="operator">;</span>
    Конструктор<span class="operator">.</span>УстановитьСхему<span class="operator">(</span>ПолучитьСхемуКомпоновкиДанных<span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    Конструктор<span class="operator">.</span>Редактировать<span class="operator">(</span>ЭтотОбъект<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="keyword">Процедура</span> ОбработкаВыбора<span class="operator">(</span>ЗначениеВыбора<span class="operator">,</span> Источник<span class="operator">)</span>
    <span class="keyword">Если</span> ТипЗнч<span class="operator">(</span>Источник<span class="operator">)</span> <span class="operator">=</span> Тип<span class="operator">(</span><span class="string">&quot;КонструкторСхемыКомпоновкиДанных&quot;</span><span class="operator">)</span> <span class="keyword">Тогда</span>
        СхемаКомпоновкиДанных <span class="operator">=</span> Источник<span class="operator">.</span>ПолучитьСхему<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
        ЗаписьXML <span class="operator">=</span> <span class="keyword">Новый</span> ЗаписьXML<span class="operator">;</span>
        ЗаписьXML<span class="operator">.</span>УстановитьСтроку<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
        СериализаторXDTO<span class="operator">.</span>ЗаписатьXML<span class="operator">(</span>ЗаписьXML<span class="operator">,</span> СхемаКомпоновкиДанных<span class="operator">,</span> <span class="string">&quot;dataCompositionScheme&quot;</span><span class="operator">,</span> <span class="string">&quot;http://v8.1c.ru/8/data-composition-system/scheme&quot;</span><span class="operator">)</span><span class="operator">;</span>
        ЭлементыФормы<span class="operator">.</span>ТекстСхемыКомпоновкиДанных<span class="operator">.</span> УстановитьТекст<span class="operator">(</span>ЗаписьXML<span class="operator">.</span>Закрыть<span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<p class="MsoNormal">Работа со схемой
компоновки данных подразделяется на следующие этапы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
редактирование наборов данных,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование полей наборов данных,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование связей наборов данных,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование вычисляемых полей,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование ресурсов,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование параметров,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование макетов,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование вложенных настроек,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
редактирование настроек системы компоновки данных.</p>

<a id="TI000000585" class="bookmark" name="issogl3_10.3.5.1_редактирование_наборов_данных"><h4>10.3.5.1. Редактирование наборов данных</h4></a>

<p class="MsoNormal">Система компоновки
данных поддерживает редактирование следующих объектов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
набор данных – запрос;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
набор данных – объект;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
набор данных – объединение;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
полей запроса.</p>

<p class="MsoNormalCxSpFirst">При
добавлении набора данных ему автоматически генерируется имя и источник данных
(если источника данных не существует).</p>

<p class="MsoNormalCxSpMiddle">Поле
набора данных схемы компоновки данных – вложенный набор данных может быть
описано в запросе и описано в наборе данных – объекте.</p>

<p class="MsoNormalCxSpLast">В тексте
запроса набора данных – объекта в предложениях <span class="Term">{ВЫБРАТЬ}</span> и <span class="Term">{ГДЕ}</span>
можно использовать вложенные таблицы.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
 ПриходТовара<span class="operator">.</span>Дата<span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Номер<span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Поставщик<span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Склад<span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Товары<span class="operator">.</span><span class="operator">(</span>
 НомерСтроки<span class="operator">,</span>
 Товар<span class="operator">,</span>
 Цена<span class="operator">,</span>
 Количество<span class="operator">,</span>
 Сумма
 <span class="operator">)</span>
{ВЫБРАТЬ
 Дата<span class="operator">,</span>
 Номер<span class="operator">,</span>
 Поставщик<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
 Склад<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
 Товары<span class="operator">.</span><span class="operator">(</span>
     НомерСтроки<span class="operator">,</span>
     Товар<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
     Цена<span class="operator">,</span>
     Количество<span class="operator">,</span>
     Сумма
     <span class="operator">)</span>}
 
<span class="keyword">ИЗ</span>
 Документ<span class="operator">.</span>ПриходТовара <span class="keyword">КАК</span> ПриходТовара
{ГДЕ 
 ПриходТовара<span class="operator">.</span>Дата<span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Номер<span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Поставщик<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Склад<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
 ПриходТовара<span class="operator">.</span>Товары<span class="operator">.</span><span class="operator">(</span>
     НомерСтроки<span class="operator">,</span>
     Товар<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
     Цена<span class="operator">,</span>
     Количество<span class="operator">,</span>
     Сумма
     <span class="operator">)</span>}</pre>

<p class="MsoNormal">В приведенном
примере жирным выделены фрагменты запроса, описывающие поля вложенных таблиц,
доступные для настроек.</p>

<a id="TI000000586" class="bookmark" name="issogl4_10.3.5.1.1_редактирование_набора_данных_запроса"><h5>10.3.5.1.1. Редактирование набора данных – запроса</h5></a>

<p class="Regularbeforepicture">Редактирование
набора данных – запроса заключается в составлении запроса к данным. Для
этого можно воспользоваться конструктором запроса или редактировать текст запроса
непосредственно в окне конструктора схемы компоновки данных.</p>

<p class="Picture"><IMG src="_img/img00377.gif?_=1496848987" WIDTH="585" ALT HEIGHT="419"></p>

<p class="MsoCaption">Рис. 378. Набор данных – запрос</p>

<p class="MsoNormal">Если флажок <span class="Interface">Автозаполнение</span>
установлен, то система компоновки данных автоматически заполняет поля схемы
компоновки данных на основании созданного запроса.</p>

<a id="TI000000587" class="bookmark" name="issogl4_10.3.5.1.2_редактирование_набора_данных_объекта"><h5>10.3.5.1.2. Редактирование набора данных – объекта</h5></a>

<p class="Regularbeforepicture">Редактирование
набора данных – объекта заключается в добавлении/редактировании имени
объекта, содержащего данные; в добавлении/редактировании полей и группировок.</p>

<p class="Picture"><IMG src="_img/img00378.gif?_=1496848987" WIDTH="585" ALT HEIGHT="415"></p>

<p class="MsoCaption">Рис. 379. Набор данных – объект</p>

<a id="TI000000588" class="bookmark" name="issogl4_10.3.5.1.3_редактирование_набора_данных_объединения"><h5>10.3.5.1.3. Редактирование набора данных – объединения</h5></a>

<p class="Regularbeforepicture">Редактирование
набора данных – объединения заключается в редактировании объединенных
полей из состава полей, подчиненных данному набору данных. Созданные наборы данных –
запросы и объекты можно добавлять в набор данных – объединение, перемещая
их мышкой.</p>

<p class="Picture"><IMG src="_img/img00379.gif?_=1496848987" WIDTH="585" ALT HEIGHT="427"></p>

<p class="MsoCaption">Рис. 380. Набор данных – объединение</p>

<a id="TI000000589" class="bookmark" name="issogl3_10.3.5.2_редактирование_полей_набора_данных"><h4>10.3.5.2. Редактирование полей набора данных</h4></a>

<p class="MsoNormal">При редактировании
полей существует возможность задать:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
заголовок поля;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
ограничение доступности поля;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
ограничение доступности полей-реквизитов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
роль для поля;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
представление поля;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
выражения упорядочивания;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
способ проверки иерархии (набор данных и параметр);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
тип значения поля;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
оформление поля.</p>

<p class="MsoNormalCxSpFirst">Следует
заметить, что роль поля, представление, выражение упорядочивания, параметр, тип
значения и оформление поля редактируются только на верхнем уровне иерархии наборов
данных.</p>

<p class="MsoNormalCxSpMiddle">Если у
поля набора данных не установлен заголовок, система компоновки данных пытается
сформировать заголовок поля на основе синонима поля запроса. Если синоним для
поля не получен, то в качестве заголовка поля используется путь к данным поля,
дополненный пробелами при помощи алгоритма преобразования имен в синонимы.
Синонимы для полей запроса получаются только для тех полей, у которых либо не
установлен псевдоним, либо псевдоним не отличается от псевдонима, которой был
бы у данного поля по умолчанию.</p>

<p class="MsoNormalCxSpLast">Синонимы
для поля запроса получаются следующим образом.</p>

<p class="MsoListBullet">&#9679; 
Если запрос не содержит объединений:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
Если выражение поля запроса состоит из одного
поля, то синоним получается из этого поля.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
Если выражение поля является агрегатной функцией
над одним полем, то синоним поля получается из этого поля. Для других выражений
считается, что синоним получить невозможно.</p>

<p class="MsoListBullet">&#9679; 
Если запрос содержит объединения:</p>

<p class="MsoListBullet2">&#9679; 
Во всех объединениях ищется поле, для которого
можно получить синоним, использующийся в качестве синонима поля. Если такого
поля не найдено, то считается, что синоним получить невозможно.</p>

<p class="MsoNormalCxSpFirst">В
конструкторе схемы компоновки данных существует дополнительная колонка с
флажком, указывающим, что заголовок поля установлен вручную. Флажок автоматически
снимается, если у поля не установлен заголовок.</p>

<p class="MsoNormalCxSpMiddle">При
заполнении полей на основании запроса конструктор автоматически заполняет
заголовки для тех полей, у которых невозможно получение синонима, и для тех полей,
у которых в запросе псевдоним отличается от псевдонима данного поля по умолчанию.
Таким образом, для таких полей флажок будет автоматически установлен.</p>

<p class="MsoNormalCxSpMiddle">Если
данный флажок снят, в колонке <span class="Interface">Заголовок</span> отображается заголовок, который будет
выводиться пользователю. При этом сам заголовок в поле не заполнен. Колонка <span class="Interface">Заголовок</span> для
полей, у которых снят флажок, не редактируется и отображается недоступным
цветом текста.</p>

<p class="MsoNormalCxSpLast">Если
разработчику требуется изменить заголовок, он устанавливает флажок, при этом
текст заголовка поля заполняется на основании текста, который ранее отображался
в колонке <span class="Interface">Заголовок</span>. Если флажок снят, конструктор очищает текст заголовка
и начинает отображать в заголовке автоматически генерируемый заголовок.</p>

<p class="Regularbeforepicture">Роль
поля изначально определяется в запросе, но есть возможность ее изменения в
отдельном диалоге.</p>

<p class="Picture"><IMG src="_img/img00380.gif?_=1496848987" WIDTH="320" ALT HEIGHT="414"></p>

<p class="MsoCaption">Рис. 381. Роль поля</p>

<p class="MsoNormalCxSpFirst">Для поля
счета в параметре <span class="Interface">Вид</span> необходимо явно указать ссылку на вид счета.</p>

<p class="MsoNormalCxSpMiddle">Для поля
измерения в параметре <span class="Interface">Измерение</span> можно указать путь к данным родительского
измерения.</p>

<p class="MsoNormalCxSpMiddle">Установленный
признак <span class="Interface">Игнорировать
значения NULL</span> означает, что в результат не будут включены групповые записи
по данному полю, если оно содержит значение <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpMiddle">В
результирующем наборе данных поля с установленным флажком <span class="Interface">Обязательное</span>
будут присутствовать всегда, если в настройках задействовано хотя бы одно поле
из его набора данных. Например, необходимо получать развернутые остатки по
субконто. При этом если поле <span class="Interface">Субконто</span> не будет использоваться в запросе, остатки
будут получаться свернутыми.</p>

<p class="MsoNormalCxSpLast">Выражения
упорядочивания поля, тип значения и оформление также могут быть отредактированы
в отдельном диалоге.</p>

<a id="TI000000590" class="bookmark" name="issogl3_10.3.5.3_редактирование_связей_наборов_данных"><h4>10.3.5.3. Редактирование связей наборов данных</h4></a>

<p class="Regularbeforepicture">При
наличии нескольких наборов данных верхнего уровня существует возможность
настроить связь между ними по одному или нескольким полям.</p>

<p class="Picture"><IMG src="_img/img00371.gif?_=1496848987" WIDTH="591" ALT HEIGHT="185"></p>

<p class="MsoCaption"><a name="_ref212350782">Рис. </a>382. Связи наборов
данных</p>

<p class="MsoNormal">Источником и
приемником связи являются наборы данных. Выражениями источника и приемника –
поля наборов данных.</p>

<a id="TI000000591" class="bookmark" name="issogl3_10.3.5.4_редактирование_вычисляемых_полей"><h4>10.3.5.4. Редактирование вычисляемых полей</h4></a>

<p class="MsoNormal">Закладка <span class="Interface">Вычисляемые поля</span>
позволяет создавать и редактировать следующие свойства/характеристики вычисляемых
полей:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
путь к данным;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
выражение;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
заголовок;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
ограничение доступности;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
выражение представления;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
выражения упорядочивания;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
тип значения;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
оформление;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
доступные значения.</p>

<p class="MsoNormal">Выражения
упорядочивания редактируются в отдельном диалоге.</p>

<a id="TI000000592" class="bookmark" name="issogl3_10.3.5.5_редактирование_ресурсов"><h4>10.3.5.5. Редактирование ресурсов</h4></a>

<p class="Regularbeforepicture">Вычисление
ресурсов возможно по всем полям всех наборов данных и по вычисляемым полям. В
левом табличном поле отображается список доступных и неиспользованных полей. В
правом табличном поле отображаются поля, по которым будут формироваться итоги и
выражения их вычисления.</p>

<p class="Picture"><IMG src="_img/img00381.gif?_=1496848987" WIDTH="800" ALT HEIGHT="341"></p>

<p class="MsoCaption">Рис. 383. Редактирование ресурсов</p>

<p class="MsoNormal">По умолчанию для
числовых полей устанавливается функция <span class="Term">Сумма</span>,
для нечисловых полей – <span class="Term">Количество</span>.
Нажатием кнопки &quot;<span class="Interface">&gt;&gt;</span>&quot; можно добавить в ресурсы все поля типа <span class="Term">Число</span>. При этом допускается ввод нескольких
строк для одного ресурса. Компоновщик макета, получая выражение для ресурса,
использует информацию о том, для какой группировки оно получается, и выдает
соответствующее выражение.</p>

<p class="Regularbeforepicture">В
диалоге редактирования колонки <span class="Interface">Рассчитывать по…</span> для полей, по которым возможна
иерархическая группировка, добавляются строки с именем поля и ключевым словом <span class="Term">Иерархия</span>. Выражение будет использоваться для
иерархических записей группировки по полю, указанному перед словом. При выборе
группировки, в разрезе которой может рассчитываться ресурс, можно одновременно
выбирать и обычное, и иерархическое поле.</p>

<p class="Picture"><IMG src="_img/img00382.gif?_=1496848987" WIDTH="287" ALT HEIGHT="217"></p>

<p class="MsoCaption">Рис. 384. Расчет ресурсов по полям группировки</p>

<p class="MsoNormal">Если для ресурса
было указано, что его можно рассчитывать только в разрезе некоторой группировки
(то есть в колонке <span class="Interface">Рассчитывать по…</span> было выбрано хотя бы одно поле группировки),
то данный ресурс будет выводиться в результат только для этой группировки и
группировок, вложенных в нее.</p>

<a id="TI000000593" class="bookmark" name="issogl3_10.3.5.6_редактирование_параметров"><h4>10.3.5.6. Редактирование параметров</h4></a>

<p class="MsoNormal">Редактирование
параметров включает в себя:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
редактирование имени параметра;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование заголовка;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
редактирование доступных типов и значений параметра;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
определение значения и доступности списка значений
параметра;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
определение выражения;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
определение параметра в качестве доступного поля
настройки компоновки данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
ограничение доступности;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
определение обязательности заполнения параметра;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
признак использования параметра;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
задание параметров редактирования.</p>

<p class="Picture"><IMG src="_img/img00383.gif?_=1496848987" WIDTH="585" ALT HEIGHT="215"></p>

<p class="MsoCaption">Рис. 385. Редактирование параметров</p>

<p class="MsoNormalCxSpFirst">При
неопределенном значении параметра считается, что значение – нулевая ссылка
на заданный тип. В параметрах могут использоваться предопределенные данные и
перечисления (режим Конфигуратор).</p>

<p class="MsoNormalCxSpLast">В колонке <span class="Interface">Доступные значения</span>
редактируются значения, которые могут быть выбраны пользователем в качестве параметров
схемы компоновки данных. Если флажок в колонке <span class="Interface">Доступен список значений</span>
установлен, то это означает, что можно будет использовать несколько значений параметра.</p>

<p class="Note"><span class="Note">Примечание.</span>
При использовании типа параметра <span class="Term">СтандартныйПериод</span>
следует учитывать, что даты начала и конца стандартного периода также содержат
и время. Причем начальная дата имеет время <span class="Interface">00:00:00</span>, а конечная дата <span class="Interface">23:59:59</span>. Таким
образом, в запросе не обязательно использовать функции <span class="Term">НАЧАЛОПЕРИОДА</span> и <span class="Term">КОНЕЦПЕРИОДА</span>.</p>

<p class="MsoNormalCxSpFirst">Приведем
пример использования обязательного параметра схемы компоновки данных: допустим,
в отчете требуется обязательно указывать
параметр <span class="Interface">Организация</span>. В схеме компоновки данных для параметра <span class="Interface">Организация</span> свойство
<span class="Interface">Использование</span> устанавливается
в значение <span class="Interface">Всегда</span>, а свойство <span class="Interface">Запрещать
незаполненные значения – </span>в значение <span class="Term">Истина</span>.</p>

<p class="MsoNormalCxSpLast">Во время
работы с отчетом пользователю недоступно свойство <span class="Interface">Использование</span>
(он отсутствует), а незаполненное значение отображается обычным способом
(волнистая красная черта). Если пользователь не заполнит значение параметра и
запустит отчет на исполнение, он получит сообщение о том, что нужно ввести
значение параметра.</p>

<a id="TI000000594" class="bookmark" name="issogl3_10.3.5.7_редактирование_макетов"><h4>10.3.5.7. Редактирование макетов</h4></a>

<p class="Regularbeforepicture">Добавление
макетов осуществляется нажатием кнопки <span class="Interface">Добавить макет</span> на командной панели.</p>

<p class="Picture"><IMG src="_img/img00384.gif?_=1496848987" WIDTH="585" ALT HEIGHT="369"></p>

<p class="MsoCaption">Рис. 386. Редактор макета</p>

<p class="MsoNormal">Предлагается выбрать
один из вариантов макетов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
макет поля,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
макет группировки,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
макет заголовка группировки,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
макет ресурсов таблицы.</p>

<p class="MsoNormalCxSpFirst">Для макета
группировки и заголовка группировки можно задать имя группировки или поля
группировки, тип макета.</p>

<p class="MsoNormalCxSpMiddle">Для
макета ресурса таблицы можно задать макеты для двух группировок, на пересечении
которых он находится.</p>

<p class="MsoNormalCxSpMiddle">Колонка
табличного поля <span class="Interface">Область</span> указывает координаты области макета в табличном
документе.</p>

<p class="MsoNormalCxSpMiddle">Редактирование
областей табличного документа возможно с помощью панели свойств, вызываемой <span class="Interface">Alt + Enter</span>.
Редактируется как внешний вид, так и содержимое ячейки и параметр расшифровки
для нее.</p>

<p class="MsoNormalCxSpLast">Макет может
редактироваться на всех языках, поддерживаемых системой. При задании параметра
или шаблона ячейке табличного документа параметры добавляются в макет и
отображаются в колонке <span class="Interface">Имя параметра</span> табличного поля <span class="Interface">Параметры макета</span>.
Возможно редактирование выражения параметра макета. При загрузке области макета
разделяются пустыми строками.</p>

<a id="TI000000595" class="bookmark" name="issogl3_10.3.5.8_вложенные_схемы"><h4>10.3.5.8. Вложенные схемы</h4></a>

<p class="Regularbeforepicture">Закладка
<span class="Interface">Вложенные
схемы</span> позволяет создавать и редактировать вложенные схемы компоновки
данных. В роли схемы могут выступать вложенные схемы, редактируемые конструктором
схемы компоновки данных.</p>

<p class="Picture"><IMG src="_img/img00385.gif?_=1496848987" WIDTH="585" ALT HEIGHT="188"></p>

<p class="MsoCaption">Рис. 387. Вложенные схемы</p>

<a id="TI000000596" class="bookmark" name="issogl3_10.3.5.9_настройки"><h4>10.3.5.9. Настройки</h4></a>

<p class="Regularbeforepicture">Схема
компоновки данных содержит настройки компоновки данных по умолчанию, которые
могут быть заданы разработчиком.</p>

<p class="Picture"><a name="_ref149027177"></a><IMG src="_img/img00386.gif?_=1496848987" WIDTH="800" ALT HEIGHT="534"></p>

<p class="MsoCaption">Рис. 388. Редактор настроек
схемы компоновки данных</p>

<p class="MsoNormal">Настройка отчета <span class="Interface">Авто позиция ресурсов</span> управляет тем, как будут выводиться
поля ресурсов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Не использовать</span> –
в этом случае ресурсы выводятся в том порядке, в котором перечислены поля на
закладке <span class="Interface">Выбранные поля</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">После всех полей</span> –
в этом случае ресурсы выводятся после всех полей.</p>

<p class="MsoNormalCxSpFirst">Для группировки (или группировки таблицы)
существует параметр <span class="Interface">Вариант использования
группировки</span>, который управляет выводом дополнительной информации после
полей ресурсов. Если данный параметр не установлен либо имеет значение <span class="Interface">Авто</span>, то группировка отвечает за вывод детальных записей.</p>

<p class="MsoNormalCxSpMiddle">Если параметр имеет значение <span class="Interface">Дополнительная информация</span> и указан у группировки-колонки,
то в результирующую таблицу в этой колонке будет выдана одна колонка, в ней
будут выводиться поля, указанные на закладке <span class="Interface">Выбранные полях</span> данной группировки и доступные для
вывода в группировке-строке. Если при этом у группировки-колонки указаны поля
группировки, то при компоновке макета будет выдана ошибка. Для группировки-строки –
аналогично, только выводится одна строка, а не колонка.</p>

<p class="MsoNormalCxSpMiddle">Например, в таблицу в строках выдается <span class="Interface">Номенклатура</span>. В колонках таблицы выдаются склады. Формируется
отчет об остатках товаров на складах. Необходимо выводить артикул номенклатуры
после колонок с остатками. Для этого следует добавить в колонки таблицы
группировку без групповых полей и в настройках группировки указать параметр <span class="Interface">Вариант использования группировки</span> в значение <span class="Interface">Дополнительная информация</span>. На закладке <span class="Interface">Выбранные поля</span> следует указать поле <span class="Interface">Номенклатура.Артикул</span>.</p>

<p class="MsoNormalCxSpMiddle">При выводе такой группировки вне таблицы в
группировке выдаются все поля, которые доступны в данной группировке.</p>

<p class="MsoNormalCxSpMiddle">Например, если в отчете имеется группировка,
в которую вложено несколько группировок. При помощи группировки с параметром <span class="Interface">Вариант использования группировки</span>, установленным в
значение <span class="Interface">Дополнительная информация</span>,
можно вывести между группировками данные родительской группировки.</p>

<p class="MsoNormalCxSpLast">Для группировок с вариантом использования <span class="Interface">Дополнительная информация</span> игнорируются следующие параметры:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Расположение полей
группировки</span> – заголовки полей, выводимых в группировки, всегда
выдаются в начале строки/колонки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Количество записей</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Процент записей</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Расположение итогов</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Расположение полей
группировок</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">Расположение группировок</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Расположение общих итогов</span>.</p>

<p class="MsoNormal">При выполнении компоновки макета, если в
группировке с вариантом использования <span class="Interface">Дополнительная информация</span> используется поле, которое
недоступно в группировке или в таблице, недоступно ни в одной группировке,
выдается исключение.</p>

<a name="_ref215643147"></a><a name="_ref215370820"></a><a id="TI000000597" class="bookmark" name="issogl4_10.3.5.9.1_вложенные_поля"><h5>10.3.5.9.1. Вложенные поля</h5></a>

<a id="TI000001477" class="bookmark" name="issogl5_для_числовых_полей"><h6>Для числовых полей</h6></a>

<p class="MsoNormal">Для числовых
ресурсов система автоматически формирует вложенные поля. Эти поля автоматически
рассчитываются системой и позволяют упростить получение различных показателей,
например, для получения процентного отношения значения ресурса к сумме значений
ресурса во всех данных отчета. Перечислим эти поля.</p>

<p class="Lang-parameter">% в группе иерархии</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВИерархии</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">PercentInHierarchy</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное
поле содержит процент значения ресурса в текущей иерархической группе. При выводе вне таблицы равно <span class="Interface">100 %</span>.</p>

<p class="Lang-parameter">% в группе иерархии колонки или точки</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВИерархииВКолонкеИлиТочке</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">PercentInColumnOrPointHierarchy</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное поле содержит отношение значения
ресурса в текущей ячейке к значению итога ресурса на текущем уровне иерархии
текущей группировки по колонке или точке (в процентах). При выводе вне таблицы
равно полю <span class="Interface">% в группе иерархии</span>.</p>

<p class="Lang-parameter">% в группе иерархии строки или серии</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВИерархииВСтрокеИлиСерии</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">PercentInRowOrSeriesHierarchy</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное
поле содержит отношение значения ресурса в текущей ячейке к значению итога
ресурса на текущем уровне иерархии текущей группировки по строке или серии
(в процентах). При выводе вне таблицы равно <span class="Interface">100 %</span>.</p>

<p class="Lang-parameter">% в группировке</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВГруппе</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">GroupPercent</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное поле содержит отношение значения
ресурса в текущей ячейке к значению итога ресурса в текущей группировке. При выводе
вне таблицы содержит <span class="Interface">100 %</span>.</p>

<p class="Lang-parameter">% в группировке колонки или точки</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВГруппеВКолонкеИлиТочке</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">ColumnOrPointGroupPercent</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное поле содержит отношение значения
ресурса в текущей ячейке к значению итога ресурса в текущей группировке по колонке
или точке (в процентах). При выводе вне таблицы содержит <span class="Interface">100 %</span>.</p>

<p class="Lang-parameter">% в группировке строки или серии</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВГруппеВСтрокеИлиСерии</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">RowOrSeriesGroupPercent</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное поле содержит отношение значения
ресурса в текущей ячейке к значению итога ресурса в текущей группировке по
строке или серии (в процентах). При выводе вне таблицы содержит поле <span class="Interface">% в группировке</span>.</p>

<p class="Lang-parameter">% в колонке или точке</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВКолонкеИлиТочке</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">ColumnOrPointPercent</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное поле содержит отношение значения
ресурса в текущей ячейке к значению итога ресурса по колонке или точке (в процентах).
При выводе вне таблицы содержит поле<span class="Interface"> % общий</span>.</p>

<p class="Lang-parameter">% в строке или серии</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентВСтрокеИлиСерии</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">RowOrSeriesPercent</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное поле содержит отношение значения
ресурса в текущей ячейке к значению итога ресурса по строке или серии (в процентах).
При выводе вне таблицы содержит <span class="Interface">100 %</span>.</p>

<p class="Lang-parameter">% общий</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ПроцентОбщий</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">OverallPercent</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данное поле содержит отношение значения
ресурса в текущей ячейке к значению общего итога ресурса в таблице (в
процентах). При выводе вне таблицы содержит <span class="Interface">100%</span>.</p>

<a name="_ref400109086"></a><a id="TI000001478" class="bookmark" name="issogl5__для_полей_содержащих_в_составе_своих_типов_тип_дата"><h6> Для полей, содержащих в составе своих типов тип Дата</h6></a>

<p class="MsoNormal">Для полей,
содержащих в составе своих типов тип <span class="Term">Дата</span>, система автоматически формирует
вложенные поля. Эти поля автоматически рассчитываются системой и позволяют
упростить отображение различной информации, связанной с датой и временем. Для
удобства работы, эти поля сгруппированы в три группы: <span class="Interface">Даты начала</span> (<span class="Term">ДатыНачала</span>,
<span class="Term">BeginDates</span>), <span class="Interface">Даты конца</span> (<span class="Term">ДатыКонца</span>,
<span class="Term">EndDates</span>), <span class="Interface">Части дат</span> (<span class="Term">ЧастиДат</span>,
<span class="Term">DateParts</span>). Перечислим
эти поля.</p>

<p class="Lang">Группа «Даты начала»</p>

<p class="Lang-parameter">Начало дня</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоДня</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfDay</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала дня.</p>

<p class="Lang-parameter">Начало недели</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоНедели</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfWeek</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала недели, с
учетом свойства <span class="Interface">Первый день недели</span> региональных установок информационной
базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>).</p>

<p class="Lang-parameter">Начало декады</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоДекады</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfTenDays</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала декады.</p>

<p class="Lang-parameter">Начало месяца</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоМесяца</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfMonth</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала месяца.</p>

<p class="Lang-parameter">Начало квартала</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоКвартала</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfQuarter</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала квартала.</p>

<p class="Lang-parameter">Начало полугодия</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоПолугодия</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfHalfYear</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала полугодия.</p>

<p class="Lang-parameter">Начало года</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst">НачалоГода</p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfYear</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и
время начала полугодия.</p>

<p class="Lang-parameter">Начало минуты</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоМинуты</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfMinute</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала минуты (если
в составе даты есть время).</p>

<p class="Lang-parameter">Начало часа</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НачалоЧаса</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">BegOfHour</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает дату и время начала часа (если в
составе даты есть время).</p>

<p class="Lang">Группа
«Даты конца»</p>

<p class="Lang-parameter">Конец дня</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецДня</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfDay</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца дня.</p>

<p class="Lang-parameter">Конец
недели</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецНедели</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfWeek</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца недели, с учетом свойства <span class="Interface">Первый день недели</span>
региональных установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>)</p>

<p class="Lang-parameter">Конец
декады</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецДекады</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfTenDays</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца декады.</p>

<p class="Lang-parameter">Конец
месяца</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецМесяца</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfMonth</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца месяца.</p>

<p class="Lang-parameter">Конец
квартала</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецКвартала</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfQuarter</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца квартала.</p>

<p class="Lang-parameter">Конец
полугодия</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецПолугодия</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfHalfYear</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца полугодия.</p>

<p class="Lang-parameter">Конец
года</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецГода</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfYear</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца года.</p>

<p class="Lang-parameter">Конец
минуты</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецМинуты</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfMinute</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца минуты (если в составе даты есть время).</p>

<p class="Lang-parameter">Конец
часа</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">КонецЧаса</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">EndOfHour</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Возвращает
дату и время конца часа (если в составе даты есть время).</p>

<p class="Lang">Группа
«Части дат»</p>

<p class="Lang-parameter">День</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">День</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">Day</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">День
месяца (число).</p>

<p class="Lang-parameter">День
недели</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ДеньНедели</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">WeekDay</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Номер
дня недели (как возвращает функция <span class="Term">ДеньНедели()</span>, неделя всегда начинается с
понедельника).</p>

<p class="Lang-parameter">Название
дня недели</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НазваниеДняНедели</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">WeekDayName</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Представление
дня недели (1 – понедельник, 2 – вторник и т. д.). Номер
дня получается функцией <span class="Term">ДеньНедели()</span>.</p>

<p class="Lang-parameter">День
года</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">ДеньГода</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">DayOfYear</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Номер
для дня года (число).</p>

<p class="Lang-parameter">Неделя
года</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НеделяГода</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">WeekOfYear</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Номер
недели в году (число), с учетом свойства <span class="Interface">Первый день недели</span>
региональных установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>)</p>

<p class="Lang-parameter">Месяц</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">Месяц</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">Month</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Номер
месяца года (число).</p>

<p class="Lang-parameter">Название
месяца</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">НазваниеМесяца</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">MonthName</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Представление
названия месяца (1 – январь, 2 – февраль и т. д.).</p>

<p class="Lang-parameter">Квартал</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">Квартал</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">Quarter</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Номер
квартала.</p>

<p class="Lang-parameter">Год</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">Год</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">Year</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Значение года в 4-разрядном виде (число).</p>

<p class="Lang-parameter">Минута</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">Минута</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">Minute</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Номер
минуты.</p>

<p class="Lang-parameter">Час</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">Час</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">Hour</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Номер
часа.</p>

<a id="TI000000598" class="bookmark" name="issogl4_10.3.5.9.2_системные_поля"><h5>10.3.5.9.2. Системные поля</h5></a>

<p class="MsoNormal">В списке выбранных полей система формирует
специальную группу системных полей (<span class="Term">СистемныеПоля</span>,
<span class="Term">SystemFileds</span>), которые
предназначены для определения порядкового номера записи, как во всем отчете,
так и в рамках группировок. Следует помнить, что системные поля не попадают в
список полей, получающихся при развороте автополя, поэтому их необходимо добавлять
вручную.</p>

<p class="Lang-parameter">№ п/п</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">СистемныеПоля.НомерПоПорядку</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">SystemFields.SerialNumber</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Содержит порядковый номер строки в данном
отчете. Начинается с 1.</p>

<p class="Lang-parameter">№ в группе</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">СистемныеПоля.НомерПоПорядкуВГруппировке</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">SystemFields.GroupSerialNumber</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Содержит порядковый номер строки в текущей
группировке. Начинается с 1.</p>

<p class="Lang-parameter">Уровень</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">СистемныеПоля.Уровень</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">SystemFields.Level</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Содержит текущий уровень записи. Начинается
с 1.</p>

<p class="Lang-parameter">Уровень в группе</p>

<p class="Lang-subheader">Идентификатор:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">СистемныеПоля.УровеньВГруппировке</span></p>

<p class="MsoNormalCxSpLast"><span class="Term">SystemFields.LevelInGroup</span></p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Содержит текущий уровень записи относительно
группировки. Начинается с 1.</p>

<a id="TI000000599" class="bookmark" name="issogl4_10.3.5.9.3_поля_параметров"><h5>10.3.5.9.3. Поля параметров</h5></a>

<p class="MsoNormal">В выбранных полях присутствует специальная
группа <span class="Interface">Параметры</span>, которая предоставляет возможность поместить в
отчет параметры схемы компоновки данных, у которых установлен флажок <span class="Interface">Включать в доступные поля</span>.</p>

<a id="TI000000600" class="bookmark" name="issogl2_10.3.6_настройки_варианта_компоновки_данных"><h3>10.3.6. Настройки варианта компоновки данных</h3></a>

<p class="MsoNormalCxSpFirst">В схеме
компоновки данных имеется возможность определения нескольких вариантов
настроек. <span class="Bold">Вариант настройки</span> – это набор настроек
отчета, которые разработчик посчитал нужным выделить отдельно. Такие варианты
настроек хранятся в схеме компоновки данных.</p>

<p class="MsoNormalCxSpMiddle">Например,
для отчета <span class="Interface">Динамика продаж</span> одним вариантом отчета может служить
диаграмма, показывающая продажи товаров по периодам, а другим – табличный
отчет, показывающий продажи товаров в разрезе покупателей. При этом каждый вариант
отчета обладает своим набором пользовательских настроек.</p>

<p class="MsoNormalCxSpMiddle">При
использовании схемы компоновки данных для отчета варианты настроек, описанные в
схеме, предоставляются пользователю как стандартные варианты отчета.</p>

<p class="MsoNormalCxSpMiddle">Система
предоставляет возможность создания нового варианта отчета непосредственно в
режиме 1С:Предприятие. Такое действие рекомендуется выполнять опытным
пользователям. В этом случае новый вариант отчета сохраняется в хранилище
вариантов отчетов, из которого другие пользователи могут загрузить необходимый
вариант. Описание хранилища вариантов отчетов см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref215641659">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">При
помощи механизма сравнения и объединения конфигураций (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 28. отладка и тестирование прикладных решений.htm?_=1496848987#_ref230079993">здесь</a>) части настроек можно сравнивать и объединять.</p>

<p class="MsoNormalCxSpLast">Загрузку
схемы компоновки данных из XML можно осуществить стандартными средствами
встроенного языка.</p>

<a id="TI000000601" class="bookmark" name="issogl3_10.3.6.1_структура_варианта_настроек_компоновки_данных"><h4>10.3.6.1. Структура варианта настроек компоновки данных</h4></a>

<p class="MsoNormalCxSpFirst">Структура –
это некоторый скелет настроек. Она определяет взаимное расположение их основных
элементов.</p>

<p class="MsoNormalCxSpLast">Структура
настроек доступна через свойство <span class="Term">Структура</span>
объекта <span class="Term">НастройкиКомпоновкиДанных</span>.
Элементами структуры настроек могут быть:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
группировки;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблицы (<span class="Term">ТаблицаКомпоновкиДанных</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
диаграммы (<span class="Term">ДиаграммаКомпоновкиДанных</span>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
вложенные объекты настройки (<span class="Term">НастройкиВложенногоОбъектаСистемыКомпоновкиДанных</span>).</p>

<p class="Lang">Группировка</p>

<p class="MsoNormal">Для реализации
группировки в структуре настроек предусмотрено три разных типа данных:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
группировки (<span class="Term">ГруппировкаКомпоновкиДанных</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
группировки таблиц (<span class="Term">ГруппировкаТаблицыКомпоновкиДанных</span>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
группировки диаграмм (<span class="Term">ГруппировкаДиаграммыКомпоновкиДанных</span>).</p>

<p class="MsoNormal">Наличие трех типов
связано с необходимостью реализовать ограничения, наложенные на взаимное
расположение элементов в дереве структуры: таблицы и диаграммы не могут
включать в себя ничего, кроме группировок. Соответственно, все объекты
группировок имеют идентичную объектную модель, они различаются типом вложенной
коллекции значений и составом параметров вывода.</p>

<p class="Lang">Поля
группировки</p>

<p class="MsoNormal">Набор полей, по
которым осуществляется группировка, описывается с помощью объекта <span class="Term">ПоляГруппировкиСистемыКомпоновкиДанных</span>. В свойстве
<span class="Term">Элементы</span> этого
объекта содержится коллекция полей группировки, состоящая из объектов <span class="Term">ПолеГруппировкиСистемыКомпоновкиДанных</span>.</p>

<p class="Note"><span class="Note">Примечание.</span>
При выполнении группировки по полю-периоду в группировку автоматически
добавляется родительское поле-период, не являющееся дополнительным периодом, в
том случае, если в родительских группировках не осуществлялась группировка по
этому родительскому полю-периоду.</p>

<p class="MsoNormalCxSpFirst">Например,
если группировка осуществляется по полю <span class="Term">Регистратор</span>,
то в группировку автоматически будет добавлено поле <span class="Term">ПериодСекунда</span>.</p>

<p class="MsoNormalCxSpLast">При этом
создание группировок по реквизитам полей-периодов запрещено.</p>

<p class="Lang">Автополе
группировки</p>

<p class="MsoNormalCxSpFirst">Перед
использованием автополе будет преобразовано в набор полей группировки.</p>

<p class="MsoNormalCxSpLast">Формирование
набора происходит следующим образом. Берутся используемые выбранные поля со
следующими условиями:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
они доступны для использования в полях группировки;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
не являются ресурсами;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
не зависят от других выбранных полей;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
не зависят от уже существующих полей
группировки.</p>

<p class="MsoNormal">Если поле уже
включено в данные поля группировки, повторно оно не добавляется.</p>

<p class="Lang">Таблица</p>

<p class="MsoNormal">Описание таблицы в
структуре настроек выполняется с помощью объекта <span class="Term">ТаблицаСистемыКомпоновкиДанных</span>.</p>

<p class="Lang">Диаграмма</p>

<p class="MsoNormal">Описание диаграммы
в структуре настроек выполняется с помощью объекта <span class="Term">ДиаграммаСистемыКомпоновкиДанных</span>.</p>

<p class="Lang">Вложенный
объект</p>

<p class="MsoNormalCxSpFirst">Описание
вложенного объекта в структуре настроек выполняется с помощью объекта <span class="Term">НастройкиВложенногоОбъектаСистемыКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">Для объекта
реализовано свойство <span class="Term">Имя</span>,
предназначенное для идентификации вложенного отчета в сгенерированном макете компоновки
данных.</p>

<a name="_ref341954796"></a><a id="TI000000602" class="bookmark" name="issogl3_10.3.6.2_свойства_настроек_компоновки_данных"><h4>10.3.6.2. Свойства настроек компоновки данных</h4></a>

<p class="Lang">Выбор</p>

<p class="MsoNormal">Набор полей,
выводимых в результат компоновки. Описывается с помощью объекта <span class="Term">ВыбранныеПоляКомпоновкиДанных</span>. В свойстве <span class="Term">Элементы</span> этого объекта содержится коллекция
выбранных полей, состоящая из объектов <span class="Term">ВыбранноеПолеКомпоновкиДанных</span>.</p>

<p class="Lang">Группа
выбранных полей</p>

<p class="MsoNormal">Используется для
группировки полей. Описывается с помощью объекта <span class="Term">ГруппаВыбранныхПолейКомпоновкиДанных</span>.</p>

<p class="Lang">Автовыбранное
поле</p>

<p class="MsoNormal">Перед
использованием автополе будет преобразовано в набор выбранных полей. Состав
набора полей зависит от того, какому элементу структуры принадлежит разворачиваемое
автополе и в какой части структуры этот элемент располагается. Для каждого
элемента система обходит все родительские элементы структуры отчета и из
выбранных полей этих элементов отбирает ресурсы и поля по следующим правилам:</p>

<p class="MsoListBullet">&#9679; 
Для группировки и группировки таблицы на место
автополя подставляются:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
все используемые поля этой группировки, которые
доступны для использования в выбранных полях;</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
поля, которые являются реквизитами ее полей
группировки,</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
ресурсы родительских элементов.</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span>
Система при обходе учитывает только те группировки, тип которых <span class="Interface">Без иерархии</span>
или <span class="Interface">Иерархия</span>.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Для группировки диаграммы ресурсы не выбираются,
а обходятся все родительские элементы структуры настроек, и из выбранных полей
этих элементов выбираются поля группировок, если по данному полю была задана
группировка типа <span class="Interface">Только иерархия</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для группировок типа <span class="Interface">Детальные записи</span>
(группировка, группировка таблицы, группировка диаграммы) из основных выбранных
полей настроек, которым принадлежит группировка, выбираются все используемые
поля, кроме полей, участвовавших в вышестоящих группировках, и реквизитов этих
полей. Если же такая группировка имеет тип <span class="Interface">Только иерархия</span>, то ее поля и
реквизиты будут использоваться системой при формирования набора полей выбора.
Для группировки диаграммы ресурсы также не выбираются.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для группировок типа <span class="Interface">Детальная информация</span>
в выбранные поля помещаются поля – не ресурсы, которые доступны в
группировке или родительской группировке, а в таблице – еще и в какой-либо
группировке с противоположной оси.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для диаграммы автополе выбора заменяется всеми
вышестоящими ресурсами.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для таблицы автополе выбора преобразовывается в
набор используемых родительскими элементами ресурсов.</p>

<p class="Note"><span class="Note">Примечание.</span>
Если поле уже включено в выбранные поля, повторно оно не добавляется.</p>

<p class="MsoNormal">При этом поля
добавляются в набор в следующем порядке: вначале поля собственных полей
группировки (для группировок), потом поля из глобальных настроек (для группировок
типа <span class="Interface">Детальные
записи</span>) и самыми последними – ресурсы и поля из родительских
элементов.</p>

<p class="Lang">Отбор</p>

<p class="MsoNormalCxSpFirst">Используется
для фильтрации записей, попадающих в результат компоновки. Кроме того, может
использоваться для отбора записей, к которым применяется некоторое оформление
(условное оформление), и для создания пользовательских полей выбора.</p>

<p class="MsoNormalCxSpLast">Описывается
с помощью объекта <span class="Term">ОтборКомпоновкиДанных</span>.
В свойстве <span class="Term">Элементы</span>
этого объекта содержится коллекция элементов отбора, состоящая из объектов <span class="Term">ЭлементОтбораКомпоновкиДанных</span>.</p>

<p class="Lang">Группа
элементов отбора</p>

<p class="MsoNormal">Используется для
группировки элементов отбора, которая упорядочивает данные результата.
Описывается с помощью объекта <span class="Term">ГруппаЭлементовОтбораКомпоновкиДанных</span>.</p>

<p class="Lang">Порядок</p>

<p class="MsoNormal">Описывает, каким
образом нужно упорядочивать записи, выводимые в результат. Представляет собой
объект <span class="Term">ПорядокКомпоновкиДанных</span>.
В свойстве <span class="Term">Элементы</span> этого
объекта содержится коллекция элементов порядка, состоящая из объектов <span class="Term">ЭлементПорядкаКомпоновкиДанных</span>.</p>

<p class="Lang">Автоэлемент
порядка</p>

<p class="MsoNormalCxSpFirst">Перед
использованием автоматический элемент порядка будет преобразован в набор
элементов порядка.</p>

<p class="MsoNormalCxSpLast">Формирование
набора происходит по следующим правилам: ресурсы добавляются безусловно, а из
полей не ресурсов в порядок добавляются поля, являющиеся реквизитами поля
группировки, и само поле группировки (для детальных записей будут занесены все
поля). Поля группировки, которые не были указаны в глобальном упорядочивании,
попадут в конец порядка. Если поле уже включено в данный порядок, повторно оно
не добавляется.</p>

<p class="Lang">Условное
оформление</p>

<p class="MsoNormalCxSpFirst">Описывает,
каким образом оформлять различные поля результата. Представляет собой объект <span class="Term">УсловноеОформлениеКомпоновкиДанных</span>. В свойстве
<span class="Term">Элементы</span> этого
объекта содержится коллекция элементов порядка, состоящая из объектов <span class="Term">ЭлементУсловногоОформленияКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpMiddle">В оформлении
компоновки данных конструктора компоновки данных параметры <span class="Term">Формат</span>, <span class="Term">Текст</span>
редактируются как многоязычные.</p>

<p class="MsoNormalCxSpLast">Для
элемента условного оформления имеется возможность указать, для каких областей
необходимо применять условное оформление:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
К полю, выводимому в группировке;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
К полю, выводимому в иерархической группировке;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
К полю, выводимому в общем итоге;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
К заголовку полей;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
К области заголовка отчета;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
К области, в которой выводятся параметры отчета;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
К области, в которой выводятся значения отборов.</p>

<p class="Lang">Оформляемые
поля</p>

<p class="MsoNormal">Поля, к которым
применяется оформление. Описываются с помощью объекта <span class="Term">ОформляемыеПоляКомпоновкиДанных</span>.
В свойстве <span class="Term">Элементы</span>
этого объекта содержится коллекция оформляемых полей, состоящая из объектов <span class="Term">ОформляемоеПолеКомпоновкиДанных</span>. Если поля не
указаны, оформление будет применено ко всей области.</p>

<p class="Lang">Параметры
вывода</p>

<p class="MsoNormal">Значения параметров
вывода определяют внешний вид соответствующих объектов. Для части параметров поддерживается
наследование. В связи с этим коллекция параметров вывода для элемента может
содержать параметры, не относящиеся к нему самому, но используемые в элементах,
которые могут быть вставлены в подчиненную часть структуры настроек.</p>

<p class="Lang">Параметры
данных</p>

<p class="MsoNormal">Значения параметров
данных, как правило, используются в запросах для фильтрации выборки.</p>

<p class="Lang">Пользовательские
поля</p>

<p class="MsoNormalCxSpFirst">Пользовательские
поля позволяют расширить множество используемых доступных полей, определяя собственные
выражения либо наборы вариантов с условиями использования конкретного варианта.</p>

<p class="MsoNormalCxSpLast">Пользовательские
поля описываются с помощью объекта <span class="Term">ПользовательскиеПоляКомпоновкиДанных</span>.
В свойстве <span class="Term">Элементы</span> этого
объекта содержится коллекция пользовательских полей, состоящая из объектов двух
видов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
поле-выражение (объект <span class="Term">ПользовательскоеПолеВыражениеКомпоновкиДанных</span>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
поле-выбор (объект <span class="Term">ПользовательскоеПолеВыборКомпоновкиДанных</span>).</p>

<p class="MsoNormal">Тип поля
определяется системой автоматически, на основе его свойств.</p>

<p class="Lang">Варианты
пользовательского поля</p>

<p class="MsoNormal">Описание набора
альтернатив, определяющих значение поля выбора. Описываются с помощью объекта <span class="Term">ВариантыПользовательскогоПоляВыборКомпоновкиДанных</span>.
В свойстве <span class="Term">Элементы</span> этого
объекта содержится коллекция вариантов пользовательского поля-выбора, состоящая
из объектов <span class="Term">ВариантПользовательскогоПоляВыборКомпоновкиДанных</span>.</p>

<p class="Lang">Работа
с автополями</p>

<p class="MsoNormal">Если один элемент
структуры настроек содержит автополя <span class="Term">АвтоПолеГруппировкиСистемыКомпоновкиДанных</span>,
<span class="Term">АвтоВыбранноеПолеСистемыКомпоновкиДанных</span>
и <span class="Term">АвтоЭлементПорядкаСистемыКомпоновкиДанных</span>,
они преобразовываются в следующем порядке:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">АвтоПолеГруппировкиСистемыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">АвтоВыбранноеПолеСистемыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">АвтоЭлементПорядкаСистемыКомпоновкиДанных</span>.</p>

<a id="TI000000603" class="bookmark" name="issogl3_10.3.6.3_доступные_объекты"><h4>10.3.6.3. Доступные объекты</h4></a>

<p class="MsoNormal">Доступные
объекты – набор, определяющий объекты, которые могут быть использованы в
компоновке как вложенные. Например, вложенные отчеты.</p>

<a id="TI000000604" class="bookmark" name="issogl3_10.3.6.4_доступные_поля"><h4>10.3.6.4. Доступные поля</h4></a>

<p class="MsoNormal"><span class="Bold">Доступные
поля</span> – это множество полей, которые могут быть использованы при
настройке компоновки данных и будут распознаны и правильно обработаны на последующих
этапах компоновки. Доступные поля различаются по применению. Выделены следующие
коллекции полей:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
поля для выбора (свойство <span class="Term">ДоступныеПоляВыбора</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
поля группировок (свойство <span class="Term">ДоступныеПоляГруппировок</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
поля порядка (свойство <span class="Term">ДоступныеПоляПорядка</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
поля параметров данных (свойство <span class="Term">ДоступныеПоляПараметровДанных</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
поля отбора (свойство <span class="Term">ДоступныеПоляОтбора</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
поля отбора элементов структуры – используются
во всех элементах структуры, кроме верхнего (свойство <span class="Term">ДоступныеПоляОтбораЭлементовСтруктуры</span>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
поля дополнительных отборов – используются
в условном оформлении (свойство <span class="Term">ДоступныеПоляДополнительныхОтборов</span>).</p>

<p class="MsoNormalCxSpFirst">Все
перечисленные свойства содержат коллекции значений, элементами которых являются
объекты <span class="Term">ДоступноеПолеКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">В
конструкторе схемы компоновки данных и в настройках схемы компоновки данных
отчета доступные поля располагаются в следующей последовательности: вначале
поля, не являющиеся ресурсами, в алфавитном порядке по заголовкам, после них
поля-ресурсы в алфавитном порядке по заголовком. Последними в списке отражаются
системные папки.</p>

<p class="Lang">Доступное
поле отбора</p>

<p class="MsoNormal">Для использования в
отборах реализован специальный тип доступных полей. Он обладает всеми
свойствами обычного доступного поля, а также предоставляет наборы доступных
видов сравнения и доступных значений поля, необходимых для корректного
построения элементов отбора.</p>

<a name="_ref393121591"></a><a id="TI000000605" class="bookmark" name="issogl3_10.3.6.5_компоновщик_настроек_компоновки_данных"><h4>10.3.6.5. Компоновщик настроек компоновки данных</h4></a>

<p class="MsoNormalCxSpFirst">Компоновщик
настроек представляется объектом встроенного языка системы «1С:Предприятие» <span class="Term">КомпоновщикНастроекКомпоновкиДанных</span>. Объект
предназначен для связи настроек компоновки данных и схемы компоновки данных. На
основе схемы компоновки данных строится источник доступных настроек для работы
конструктора настроек.</p>

<p class="MsoNormalCxSpLast">При
необходимости использовать источник доступных настроек одного компоновщика в
другом, имеется возможность получить источник доступных настроек с помощью
метода <span class="Term">ПолучитьИсточникДоступныхНастроек()</span>
объекта <span class="Term">КомпоновщикНастроекКомпоновкиДанных</span>.</p>

<p class="Lang-subheader">Пример
передачи источника доступных настроек компоновки данных:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Перем</span> ПараметрыФормы<span class="operator">;</span>
ПараметрыФормы <span class="operator">=</span> <span class="keyword">Новый</span> Структура<span class="operator">;</span>
ПараметрыФормы<span class="operator">.</span>Вставить<span class="operator">(</span><span class="string">&quot;ИсточникДоступныхНастроек&quot;</span><span class="operator">,</span> Список<span class="operator">.</span>КомпоновщикНастроек<span class="operator">.</span>ПолучитьИсточникДоступныхНастроек<span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
ПараметрыФормы<span class="operator">.</span>Вставить<span class="operator">(</span><span class="string">&quot;Настройки&quot;</span><span class="operator">,</span> Список<span class="operator">.</span>КомпоновщикНастроек<span class="operator">.</span>Настройки<span class="operator">)</span><span class="operator">;</span>
ПараметрыФормы<span class="operator">.</span>Вставить<span class="operator">(</span><span class="string">&quot;ФиксированныеНастройки&quot;</span><span class="operator">,</span> Список<span class="operator">.</span>КомпоновщикНастроек<span class="operator">.</span>ФиксированныеНастройки<span class="operator">)</span><span class="operator">;</span>
ПараметрыФормы<span class="operator">.</span>Вставить<span class="operator">(</span><span class="string">&quot;ПользовательскиеНастройки&quot;</span><span class="operator">,</span> Список<span class="operator">.</span>КомпоновщикНастроек<span class="operator">.</span>ПользовательскиеНастройки<span class="operator">)</span><span class="operator">;</span>
ОткрытьФорму<span class="operator">(</span><span class="string">&quot;ОбщаяФорма.ФормаКомпоновщикаНастроек&quot;</span><span class="operator">,</span> ПараметрыФормы<span class="operator">)</span><span class="operator">;</span></pre>

<a name="_ref215372468"></a><a name="_ref215641592"></a><a id="TI000000606" class="bookmark" name="issogl2_10.3.7_пользовательские_настройки_системы_компоновки_данных"><h3>10.3.7. Пользовательские настройки системы компоновки данных</h3></a>

<p class="MsoNormalCxSpFirst">Существует
возможность отметки некоторых настроек для того, чтобы пользователь мог
редактировать их в отдельной форме. Данный механизм называется <span class="Bold">пользовательские настройки</span>.</p>

<p class="MsoNormalCxSpLast">При
выполнении компоновки применяются как пользовательские, так и полные настройки.
При этом пользовательские настройки «накладываются» на полные, формируя реально
исполняемые настройки.</p>

<a id="TI000000607" class="bookmark" name="issogl3_10.3.7.1_объектная_модель_пользовательских_настроек"><h4>10.3.7.1. Объектная модель пользовательских настроек</h4></a>

<p class="MsoNormal">При
помощи пользовательских настроек редактируются следующие объекты:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">ОтборКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ЭлементОтбораКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппаЭлементовОтбораКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПорядокКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ВыбранныеПоляКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">УсловноеОформлениеКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ЭлементУсловногоОформленияКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ЗначениеПараметраНастроекКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппировкаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппировкаТаблицыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппировкаДиаграммыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ТаблицаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ДиаграммаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ВложеннаяСхемаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">КоллекцияЭлементовСтруктурыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">КоллекцияЭлементовСтруктурыТаблицыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">КоллекцияЭлементовСтруктурыДиаграммыКомпоновкиДанных</span>.</p>

<p class="MsoNormal">У
данных объектов существуют следующие свойства:</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">ИдентификаторПользовательскойНастройки</span> – предназначено
для идентификации объекта пользовательской настройки. Если данное свойство
установлено, то объект считается пользовательским и подлежит редактированию в
пользовательских настройках.</p>

<p class="Indentlist">При
интерактивной отметке настройки как пользовательской система автоматически
генерирует уникальный идентификатор и заполняет данное свойство строковым
представлением этого идентификатора.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">ПредставлениеПользовательскойНастройки</span> – строка,
используемая для отображения представления в пользовательских настройках. В
конструкторе схемы возможен ввод представления на нескольких языках.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">РежимОтображения</span> – используется для определения
быстрых настроек. Подробнее о данной возможности будет рассказано ниже.</p>

<p class="MsoNormal">Пользовательские
настройки в объектной модели представляются отдельным объектом <span class="Term">ПользовательскиеНастройкиКомпоновкиДанных</span>.
Данный объект имеет свойство <span class="Term">Элементы</span>. В этой коллекции находятся элементы
пользовательских настроек. Возможны объекты следующих типов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">ОтборКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ЭлементОтбораКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппаЭлементовОтбораКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПорядокКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ВыбранныеПоляКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">УсловноеОформлениеКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ЭлементУсловногоОформленияКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ЗначениеПараметраКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппировкаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппировкаТаблицыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ГруппировкаДиаграммыКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ТаблицаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ДиаграммаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">НастройкиВложенногоОбъектаКомпоновкиДанных</span>,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">СтруктураНастроекКомпоновкиДанных</span>.</p>

<a id="TI000000608" class="bookmark" name="issogl3_10.3.7.2_настройка_пользовательских_элементов_настроек"><h4>10.3.7.2. Настройка пользовательских элементов настроек</h4></a>

<p class="Regularbeforepicture">Установить
пользовательский признак элемента настройки можно в форме настройки
пользовательского элемента, который вызывается при помощи команды <span class="Interface">Свойства элемента
пользовательских настроек</span>.</p>

<p class="Picture"><IMG src="_img/img00387.gif?_=1496848987" WIDTH="631" ALT HEIGHT="222"></p>

<p class="MsoCaption">Рис.
389. Открыть пользовательскую настройку</p>

<p class="Regularbeforepicture">В
форме настройки пользовательского элемента также можно указать представление,
которое будет использоваться для элемента, и режим его редактирования.</p>

<p class="Picture"><IMG src="_img/img00388.gif?_=1496848987" WIDTH="417" ALT HEIGHT="178"></p>

<p class="MsoCaption">Рис.
390. Свойство пользовательской настройки</p>

<p class="Regularbeforetable">В
списке структуры настроек команда <span class="Interface">Свойства элемента
пользовательских настроек</span> позволяет настраивать пользовательские
настройки для текущего элемента структуры. Для каждого элемента структуры
определен свой состав настраиваемых элементов.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Объект</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Настраиваемые
  элементы</b></p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpLast">Отчет</p>
  </td>
  
  <td valign="top">
  <p class="MsoListBulletCxSpFirst">&#9679; 
  выбранные поля,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  порядок,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  отбор,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  условное оформление,</p>
  <p class="MsoListBulletCxSpLast">&#9679; 
  состав группировок</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpLast">Группировка/<br>
  группировка таблицы/<br>
  группировка диаграммы</p>
  </td>
  
  <td valign="top">
  <p class="MsoListBulletCxSpFirst">&#9679; 
  группировка,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  выбранные поля,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  отбор,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  порядок,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  условное оформление,</p>
  <p class="MsoListBulletCxSpLast">&#9679; 
  состав вложенных группировок</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpLast">Диаграмма</p>
  </td>
  
  <td valign="top">
  <p class="MsoListBulletCxSpFirst">&#9679; 
  диаграмма,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  выбранные поля,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  условное оформление,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  состав группировок серий,</p>
  <p class="MsoListBulletCxSpLast">&#9679; 
  состав группировок точек</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpLast">Таблица</p>
  </td>
  
  <td valign="top">
  <p class="MsoListBulletCxSpFirst">&#9679; 
  таблица,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  выбранные поля,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  условное оформление,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  состав группировок строк,</p>
  <p class="MsoListBulletCxSpLast">&#9679; 
  состав группировок колонок</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpLast">Вложенная схема</p>
  </td>
  
  <td valign="top">
  <p class="MsoListBulletCxSpFirst">&#9679; 
  вложенный отчет,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  выбранные поля,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  отбор,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  порядок,</p>
  <p class="MsoListBulletCxSpMiddle">&#9679; 
  условное оформление,</p>
  <p class="MsoListBulletCxSpLast">&#9679; 
  состав группировок</p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpLast">В
зависимости от того, где происходит вызов, команда <span class="Term">Свойства</span> элемента пользовательских настроек
позволяет изменять различные настройки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
список отбора – пользовательские настройки
для текущего элемента/групп отбора;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
список параметров вывода и параметров данных –
пользовательские настройки для текущего параметра;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
список условного оформления – пользовательские
настройки для текущего элемента условного оформления.</p>

<p class="MsoNormal">Кроме
того, в таблице структуры команда <span class="Interface">Пользовательские
настройки</span> позволяет открыть модальную форму, в которой будут
отображаться пользовательские настройки со своими значениями по умолчанию.</p>

<a id="TI000000609" class="bookmark" name="issogl3_10.3.7.3_редактирование_пользовательских_настроек"><h4>10.3.7.3. Редактирование пользовательских настроек</h4></a>

<p class="Regularbeforepicture">Редактирование
объекта <span class="Term">ПользовательскиеНастройки</span>
осуществляется в таблице (см. <a href="#_ref215637065">рис.391</a>).</p>

<p class="Picture"><IMG src="_img/img00389.gif?_=1496848987" WIDTH="507" ALT HEIGHT="272"></p>

<p class="MsoCaption"><a name="_ref215637065">Рис. </a>391. Редактор
пользовательских настроек</p>

<p class="Note"><span class="Note">Совет.</span> Имеет смысл выносить в пользовательские те
настройки (из всего многообразия, предлагаемого системой компоновки данных),
которые предназначены для управления отчетом конечным пользователем.
Предполагается, что пользователь будет оперировать только этими настройками.</p>

<p class="MsoNormalCxSpFirst">Например,
в запросе, использующемся в качестве набора данных для отчета, существует
большое количество полей, по которым можно выполнять отбор. Однако разработчик
отчета считает, что есть ряд элементов отбора, которые используются наиболее
часто и их логично вынести в пользовательские настройки. Тогда пользователь
будет иметь возможность отредактировать как «особые» элементы отбора (строка <span class="Term">Товары</span> на <a href="#_ref215637065">рис.391</a>), так и отбор целиком (строка <span class="Term">Отбор</span> на <a href="#_ref215637065">рис.391</a>).</p>

<p class="MsoNormalCxSpLast">Также
логично выносить в пользовательские такие настройки, как:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Bold">Период или дата</span> – практически
для всех отчетов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Bold">Группировки и условное
оформление</span> – для табличных отчетов;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Bold">Значение счета бухгалтерского
учета</span> – для бухгалтерских отчетов и т. д.</p>

<p class="MsoNormal">При
этом для каждого отчета разработчик будет самостоятельно принимать решение о
том, какие настройки станут пользовательскими в его отчете (или варианте
отчета).</p>

<a id="TI000000610" class="bookmark" name="issogl3_10.3.7.4_быстрые_пользовательские_настройки"><h4>10.3.7.4. Быстрые пользовательские настройки</h4></a>

<p class="Regularbeforepicture">Среди
пользовательских настроек разработчик отчета может выделить такие настройки,
которые пользователь редактирует наиболее часто (например, фильтр по товару в
отчете <span class="Interface">Остатки товаров</span> или фильтр по организации в
бухгалтерском отчете). Тогда можно указать, что пользовательская настройка
является быстрой (свойство <span class="Term">РежимОтображения</span> установлено в значение <span class="Interface">Быстрый доступ</span>).
Такие настройки будут редактироваться прямо в форме отчета.</p>

<p class="Picture"><IMG src="_img/img00390.gif?_=1496848987" WIDTH="519" ALT HEIGHT="333"></p>

<p class="MsoCaption">Рис.
392. Быстрые пользовательские настройки</p>

<p class="MsoNormalCxSpFirst">У
таблицы, предназначенной для редактирования пользовательских настроек, также
имеется свойство <span class="Term">РежимОтображения</span>,
которое определяет, показывать все пользовательские настройки или только
быстрые.</p>

<p class="MsoNormalCxSpLast">Если
пользователя не устраивает текущий состав быстрых пользовательских настроек, то
он может самостоятельно изменить их состав, например, исключить из состава
быстрых пользовательских настроек те, которые он не планирует изменять часто.</p>

<p class="Regularbeforepicture">Для
такой настройки пользователю необходимо выбрать команду Еще – Изменить состав настроек… (<span class="Interface">Все действия – Изменить состав настроек…</span>) в окне редактирования настроек отчета.</p>

<p class="Picture"><IMG src="_img/img00391.gif?_=1496848987" WIDTH="706" ALT HEIGHT="305"></p>

<p class="MsoCaption">Рис.
393. Редактирование состава быстрых пользовательских настроек</p>

<p class="MsoNormalCxSpFirst">В
левой части формы представлены все пользовательские настройки, которые могут
быть выбраны быстрыми, а в правой – настройки, которые в данный момент
редактируются в форме отчета.</p>

<p class="MsoNormalCxSpMiddle">В
формах редактирования отбора или условного оформления присутствуют команды
редактирования свойств элемента пользовательских настроек. Таким образом,
пользователь может перенести в состав быстрых пользовательских настроек те
элементы отбора или условного оформления, которые он изменяет постоянно в своей
работе.</p>

<p class="MsoNormalCxSpLast">Управлять
составом быстрых пользовательских настроек можно также из формы редактирования
настроек с помощью колонки <span class="Interface">Редактирование в форме
отчета</span>. Эта колонка по умолчанию не отображается в форме, и ее
необходимо включить с помощью команды Еще – Изменить форму… (<span class="Interface">Все действия – Изменить форму…</span>) окна редактирования настроек.</p>

<p class="Regularbeforepicture">В
этом случае нельзя добавлять новые настройки, но можно оперативно менять состав
существующих настроек.</p>

<p class="Picture"><IMG src="_img/img00392.gif?_=1496848987" WIDTH="608" ALT HEIGHT="255"></p>

<p class="MsoCaption">Рис.
394. Колонка «Редактирование в форме отчета»</p>

<a id="TI000000611" class="bookmark" name="issogl3_10.3.7.5_компоновщик_настроек"><h4>10.3.7.5. Компоновщик настроек</h4></a>

<p class="MsoNormalCxSpFirst">У
компоновщика настроек имеется свойство <span class="Term">ПользовательскиеНастройки</span>. В данном свойстве
находятся значения редактируемых пользовательских настроек. Свойство недоступно
для записи с помощью встроенного языка. Кроме того, у компоновщика настроек
имеется метод <span class="Term">ЗагрузитьПользовательскиеНастройки()</span>,
который загружает значения пользовательских настроек, переданные в качестве
параметра метода.</p>

<p class="MsoNormalCxSpMiddle">Метод
<span class="Term">ПолучитьНастройки()</span>
позволяет получить копию текущих настроек (с учетом пользовательских настроек).</p>

<p class="MsoNormalCxSpLast">Метод
<span class="Term">ЗагрузитьНастройки()</span> загружает
переданные настройки в компоновщик настроек (пользовательские настройки также
перезаполняются на основании переданных данных).</p>

<a id="TI000000612" class="bookmark" name="issogl3_10.3.7.6_заполнение_значений_пользовательских_настроек"><h4>10.3.7.6. Заполнение значений пользовательских настроек</h4></a>

<p class="MsoNormalCxSpFirst">При
заполнении значений пользовательских настроек для различных элементов настроек
в пользовательские настройки добавляются соответствующим образом заполненные
элементы.</p>

<p class="MsoNormalCxSpMiddle">Для
типов <span class="Term">ЭлементОтбораКомпоновкиДанных</span>,
<span class="Term">ГруппаЭлементовОтбораКомпоновкиДанных</span>,
<span class="Term">ЭлементУсловногоОформленияКомпоновкиДанных</span>,
<span class="Term">ЗначениеПараметраКомпоновкиДанных</span>,
<span class="Term">ГруппировкаКомпоновкиДанных</span>,
<span class="Term">ГруппировкаТаблицыКомпоновкиДанных</span>,
<span class="Term">ГруппировкаДиаграммыКомпоновкиДанных</span>,
<span class="Term">ТаблицаКомпоновкиДанных</span>,
<span class="Term">ДиаграммаКомпоновкиДанных</span>,
<span class="Term">ВложеннаяСхемаКомпоновкиДанных</span>
в соответствующих пользовательских элементах заполняется свойство <span class="Term">ИдентификаторПользовательскойНастройки</span> и
свойства, которые реально редактируются в пользовательских настройках.</p>

<p class="MsoNormalCxSpMiddle">Для
типов <span class="Term">ОтборКомпоновкиДанных</span>,
<span class="Term">УсловноеОформлениеКомпоновкиДанных</span>,
<span class="Term">ПорядокКомпоновкиДанных</span>,
<span class="Term">ВыбранныеПоляКомпоновкиДанных</span>
создается объект соответствующего типа. В его коллекцию добавляются элементы, у
которых свойство <span class="Term">РежимОтображения</span>
отлично от <span class="Term">Недоступный</span>.</p>

<p class="MsoNormalCxSpLast">Имеются
исключения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Не будут добавляться элементы, которые сами
отмечены как пользовательские. Например, в пользовательский отбор не будет
помещен элемент отбора, который отмечен как пользовательский.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Не будут добавлены элементы, содержащие
пользовательские элементы. Например, не будет добавлена группа условий, если в
этой группе присутствуют элементы, отмеченные как пользовательские.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для вложенных элементов свойство <span class="Term">РежимОтображения</span> не анализируется. Они
добавляются или не добавляются вместе с родительскими элементами.</p>

<p class="MsoNormal">Для
типов <span class="Term">КоллекцияЭлементовСтруктурыКомпоновкиДанных</span>,
<span class="Term">КоллекцияЭлементовСтруктурыТаблицыКомпоновкиДанных</span>,
<span class="Term">КоллекцияЭлементовСтруктурыДиаграммыКомпоновкиДанных</span>
создается объект <span class="Term">СтруктураНастроекКомпоновкиДанных</span>,
в который помещаются группировки, уже присутствующие в структуре. Помещаются
только группировки с установленными полями группировок (не помещаются детальные
записи). Помещение группировок происходит до того, как будут встречены
детальные записи, ветвление, таблица, диаграмма, вложенная схема,
неиспользуемая группировка, группировка с пользовательской структурой.</p>

<a id="TI000000613" class="bookmark" name="issogl3_10.3.7.7_применение_пользовательских_настроек"><h4>10.3.7.7. Применение пользовательских настроек</h4></a>

<p class="MsoNormal">Применение
пользовательских настроек к основным настройкам выполняется в методе <span class="Term">ПолучитьНастройки()</span> компоновщика настроек. При
этом выполняются описанные ниже действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Для типов <span class="Term">ЭлементОтбораКомпоновкиДанных</span>, <span class="Term">ЭлементУсловногоОформленияКомпоновкиДанных</span>, <span class="Term">ЗначениеПараметраКомпоновкиДанных</span> содержимое
элементов копируется в соответствующие пользовательские элементы настроек.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для типов <span class="Term">ОтборКомпоновкиДанных</span>, <span class="Term">УсловноеОформлениеКомпоновкиДанных</span>, <span class="Term">ПорядокКомпоновкиДанных</span>, <span class="Term">ВыбранныеПоляКомпоновкиДанных</span> элементы,
находящиеся в основных настройках и отмеченные как <span class="Term">Недоступный</span>, остаются без изменения. Элементы
из пользовательских настроек переносятся в основные. Они добавляются в конец
коллекции для <span class="Term">Отбора</span>,
<span class="Term">ВыбранныхПолей</span>
и <span class="Term">УсловногоОформления</span>
и в начало коллекции – для <span class="Term">Порядка</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Для типов <span class="Term">ГруппаЭлементовОтбораКомпоновкиДанных</span>, <span class="Term">ГруппировкаКомпоновкиДанных</span>, <span class="Term">ГруппировкаТаблицыКомпоновкиДанных</span>, <span class="Term">ГруппировкаДиаграммыКомпоновкиДанных</span>, <span class="Term">ТаблицаКомпоновкиДанных</span>, <span class="Term">ДиаграммаКомпоновкиДанных</span>, <span class="Term">НастройкиВложенногоОбъектаКомпоновкиДанных</span>
устанавливается свойство <span class="Term">Использование</span> в соответствующем элементе
основных настроек (на основании признака <span class="Interface">Использование элемента
пользовательских настроек</span>).</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для типа <span class="Term">СтруктураНастроекКомпоновкиДанных</span> в элементе
структуры основных настроек ищутся соответствующие группировки и располагаются
в правильном порядке. Недостающие группировки создаются. Не найденные в
пользовательских настройках группировки либо группировки, отключенные
пользователем, не удаляются, а помечаются особым образом. Это позволяет
сохранить их для возможного использования в будущем. Пользовательские
группировки с пустым набором полей (детальные записи) при применении
игнорируются.</p>

<a name="_ref215655387"></a><a id="TI000000614" class="bookmark" name="issogl1_10.4_макет_компоновки_данных"><h2>10.4. Макет компоновки данных</h2></a>

<p class="MsoNormal">Макет компоновки
данных представляется объектом встроенного языка системы «1С:Предприятие» <span class="Term">МакетКомпоновкиДанных</span> и состоит из множества
других вложенных объектов. Макет компоновки данных является инструкцией по выполнению
компоновки данных для системы компоновки данных. Макет компоновки уже содержит
в себе описание макетов областей, тексты исполняемых запросов, расположение
группировок и т. д.</p>

<a id="TI000000615" class="bookmark" name="issogl2_10.4.1_составные_части_макета_компоновки_данных"><h3>10.4.1. Составные части макета компоновки данных</h3></a>

<p class="Regularbeforepicture">Каждый
макет компоновки данных содержит множество объектов, описывающих ту или иную
часть. Рассмотрим эти составные части.</p>

<p class="Picture"><IMG src="_img/img00393.gif?_=1496848987" WIDTH="464" ALT HEIGHT="584"></p>

<p class="MsoCaption">Рис. 395. Составные части макета компоновки данных</p>

<p class="Lang">Источники
данных</p>

<p class="MsoNormalCxSpFirst">Макет
компоновки данных может содержать несколько описаний источников данных.</p>

<p class="MsoNormalCxSpMiddle">Под
источником данных подразумевается источник, из которого будут получаться
данные. В качестве источника данных выступает информационная база системы «1С:Предприятие».</p>

<p class="MsoNormalCxSpMiddle">Источники
данных описываются в свойстве <span class="Term">ИсточникиДанных</span>
макета, которое содержит коллекцию значений, состоящую из элементов <span class="Term">ИсточникДанных</span> <span class="Term">МакетаКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">Допускается
создание нескольких источников данных, указывающих при помощи строки соединения
на одну информационную базу.</p>

<p class="Lang">Наборы
данных</p>

<p class="MsoNormalCxSpFirst">Наборы
данных макета компоновки данных содержат описание того, какие данные необходимо
получать в компоновке данных.</p>

<p class="MsoNormalCxSpMiddle">Они
описываются в свойстве <span class="Term">НаборыДанных</span>
макета компоновки данных.</p>

<p class="MsoNormalCxSpMiddle">Допускается
наличие нескольких наборов данных.</p>

<p class="MsoNormalCxSpLast">Вложенный
набор данных рассматривается как обычный набор данных. Вложенный набор данных
всегда связан с его родительским набором данных. Если для вложенного набора
данных указано условие фильтра, тогда связь вложенного набора данных с
родительским набором данных считается внутренней.</p>

<p class="Lang">Поле
набора данных макета компоновки данных</p>

<p class="MsoNormalCxSpFirst">Набор
данных может содержать описания полей, которые будут доступны для этого набора
данных. Поля, описания которых в наборе данных отсутствуют, являются недоступными.
Если некоторое поле присутствует в запросе набора данных, но отсутствует в
описании полей набора данных, то поле не будет доступно для использования.</p>

<p class="MsoNormalCxSpLast">Поля набора
данных описываются в свойстве <span class="Interface">Поля</span> набора данных, которое содержит коллекцию значений,
состоящую из элементов <span class="Term">ПолеНабораДанныхМакетаКомпоновкиДанных</span>.</p>

<p class="Lang">Значения
параметров макета компоновки данных</p>

<p class="MsoNormalCxSpFirst">Макет
компоновки данных может содержать параметры в любых выражениях, присутствующих
в нем.</p>

<p class="MsoNormalCxSpLast">Значения
параметров описываются в свойстве <span class="Term">ЗначенияПараметров</span>
макета компоновки данных, которое содержит коллекцию значений, состоящую из
элементов <span class="Term">ЗначениеПараметраМакетаКомпоновкиДанных</span>.</p>

<p class="Lang">Связи
наборов данных макета компоновки данных</p>

<p class="MsoNormalCxSpFirst">Наборы
данных, присутствующие в макете компоновки данных, могут быть связаны друг с
другом. Связи между наборами данных описываются в макете компоновки данных.</p>

<p class="MsoNormalCxSpLast">Связи
наборов данных описываются в свойстве <span class="Term">СвязиНаборовДанных</span>
макета компоновки данных, которое содержит коллекцию значений, состоящую из
элементов <span class="Term">СвязьНаборовДанныхМакетаКомпоновкиДанных</span>.</p>

<p class="Lang">Макеты
областей макета компоновки данных</p>

<p class="MsoNormalCxSpFirst">При
исполнении компоновки в результат компоновки будут выводиться макеты областей.
Эти макеты областей также находятся в макете компоновки данных.</p>

<p class="MsoNormalCxSpLast">Описания
макетов находятся в свойстве <span class="Term">Макеты</span>
макета компоновки данных, которое содержит коллекцию значений, состоящую из
элементов <span class="Term">ОписаниеМакетаОбластиМакетаКомпоновкиДанных</span>.</p>

<p class="Lang">Тело
макета компоновки данных</p>

<p class="MsoNormalCxSpFirst">Предыдущие
составные части макета компоновки данных содержали информацию о том, откуда
получать информацию. Само же указание, как следует скомпоновать данные,
находится в теле макета компоновки данных. Тело макета компоновки данных
состоит из элементов.</p>

<p class="MsoNormalCxSpLast">Возможно
использование следующих типов элементов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
группировка – описывает выводимую в
результат группировку;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
детальные записи – описывает выводимые в
результат детальные записи набора данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
таблица – описывает таблицу, выводимую в
результат;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
диаграмма – описывает диаграмму, выводимую
в результат;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
макет – описывает макеты, используемые при
выводе.</p>

<p class="Lang">Группировка
таблицы</p>

<p class="MsoNormalCxSpFirst">Описывает
группировку таблицы и представляется объектом встроенного языка <span class="Term">ГруппировкаТаблицыМакетаКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">Группировка
таблицы содержит те же свойства, что и обычная группировка, со следующими
различиями:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Тело группировки таблицы и иерархическое тело
группировки таблицы могут содержать только те элементы, которые содержатся в
теле таблицы, т. е. только группировки таблицы, детальные записи таблицы,
макеты группировки таблицы. Иерархическое тело может дополнительно содержать
иерархическую группировку таблицы, обозначающую место, в которое будут
выводиться иерархические записи группировки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В качестве макетов заголовков и подвала используются
макеты группировки таблицы.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Возможно использование свойств:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">МакетОбщихИтогов</span> – указывает макет,
используемый при выводе общих итогов по группировке, типа <span class="Term">МакетГруппировкиТаблицыМакетаКомпоновкиДанных</span>;</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">РасположениеОбщихИтогов</span> – содержит
расположение общих итогов для группировки, типа <span class="Term">РасположениеИтоговКомпоновкиДанных</span>.</p>

<p class="Lang">Детальные
записи таблицы</p>

<p class="MsoNormal">Описывают детальные
записи таблицы, представляются объектом встроенного языка <span class="Term">ЗаписиТаблицыМакетаКомпоновкиДанных</span>.</p>

<p class="Lang">Макет
группировки таблицы</p>

<p class="MsoNormal">Макет группировки
таблицы описывает макеты, используемые при выводе группировки таблицы, и
представляется объектом встроенного языка <span class="Term">МакетГруппировкиТаблицыМакетаКомпоновкиДанных</span>.</p>

<p class="Lang">Группировка
диаграммы</p>

<p class="MsoNormalCxSpFirst">Описывает
группировку диаграммы и представляется объектом встроенного языка <span class="Term">ТелоГруппировкиДиаграммыМакетаКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">Группировка
диаграммы содержит те же свойства, что и обычная группировка, со следующими
различиями:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Тело группировки диаграммы и иерархическое тело
группировки диаграммы могут содержать только макеты группировки диаграммы и
группировки диаграммы. Иерархическое тело может дополнительно содержать иерархическую
группировку диаграммы, обозначающую место, в которое будут выводиться иерархические
записи группировки.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Отсутствуют макеты для заголовка и подвала.</p>

<p class="Lang">Макет
группировки диаграммы</p>

<p class="MsoNormal">Макет группировки
диаграммы описывает макеты, используемые при выводе группировки диаграммы, и
представляется объектом встроенного языка <span class="Term">МакетГруппировкиДиаграммыМакетаКомпоновкиДанных</span>.</p>

<a id="TI000000616" class="bookmark" name="issogl2_10.4.2_макеты_областей"><h3>10.4.2. Макеты областей</h3></a>

<p class="MsoNormalCxSpFirst">Макет
области представляет собой декларативное описание расположения выводимых
данных, а также их визуальное оформление, необходимое для вывода данных в
документы различных форматов.</p>

<p class="MsoNormalCxSpLast">Существуют
несколько принципиально различных макетов областей:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
собственно макет области,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
макеты областей диаграммы.</p>

<p class="Regularbeforepicture">Структура
макетов показана на <a href="#_ref212355792">рис.396</a>.</p>

<p class="Picture"><IMG src="_img/img00394.gif?_=1496848987" WIDTH="464" ALT HEIGHT="224"></p>

<p class="MsoCaption"><a name="_ref212355792">Рис. </a>396. Структура
макета</p>

<p class="MsoNormal">Во встроенном языке
системы «1С:Предприятие» макет области представляется объектом типа <span class="Term">МакетОбластиКомпоновкиДанных</span>. Данный объект
является коллекцией объектов <span class="Term">СтрокаТаблицыОбластиКомпоновкиДанных.</span></p>

<a id="TI000000617" class="bookmark" name="issogl3_10.4.2.1_структура_макета_области"><h4>10.4.2.1. Структура макета области</h4></a>

<p class="MsoNormal">Как было сказано
выше, макет области представляет собой коллекцию объектов типа <span class="Term">СтрокаТаблицыОбластиКомпоновкиДанных</span>. <span class="Term">Строка</span> таблицы представляет собой коллекцию
ячеек, расположенных горизонтально слева направо. Таким образом, несколько
идущих подряд строк таблицы области компоновки данных образуют прямоугольную таблицу.</p>

<p class="Lang">Коллекция
ячеек таблицы</p>

<p class="MsoNormalCxSpFirst">Данный
объект представляет собой коллекцию ячеек строки таблицы. Описывается объектом
встроенного языка <span class="Term">ЯчейкиТаблицыОбластиКомпоновкиДанных</span>.
Элементами коллекции являются ячейки таблицы – объекты типа <span class="Term">ЯчейкаТаблицыОбластиКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">Ячейка
таблицы представляет собой прямоугольную область, используемую для вывода
данных в документы различных форматов. Внутри ячейки могут содержаться выводимые
поля, текст и оформления.</p>

<p class="Lang">Коллекция
элементов макета</p>

<p class="MsoNormal">Коллекция элементов
макета (объект <span class="Term">ЭлементыМакетаОбластиКомпоновкиДанных</span>)
представляет собой коллекцию полей (объектов типа <span class="Term">ПолеОбластиКомпоновкиДанных</span>). Данные объекты
могут содержаться в коллекции в произвольном порядке. Данные, содержащиеся в
этих объектах, используются при выводе в документы различных форматов.</p>

<p class="Lang">Поле</p>

<p class="MsoNormal">Этот элемент
представляет собой поле, выводимое в ячейке таблицы или в элементе списка.
Внутри поля может содержаться произвольное значение и его оформление. Поле описывается
объектом встроенного языка <span class="Term">ПолеОбластиКомпоновкиДанных</span>.</p>

<p class="Lang">Оформление
ячейки таблицы</p>

<p class="MsoNormal">Оформление ячейки
таблицы представляет собой коллекцию объектов, описывающих оформление ячейки
таблицы. Описывается объектом встроенного языка <span class="Term">ОформлениеЯчейкиТаблицыОбластиКомпоновкиДанных</span>.</p>

<p class="Lang">Оформление
поля</p>

<p class="MsoNormal">Оформление поля
представляет собой коллекцию, содержащую всего один объект – элемент
оформления <span class="Term">Формат</span>. Описывается
объектом встроенного языка <span class="Term">ОформлениеПоляОбластиКомпоновкиДанных</span>.</p>

<a id="TI000000618" class="bookmark" name="issogl3_10.4.2.2_структура_макетов_областей_диаграммы"><h4>10.4.2.2. Структура макетов областей диаграммы</h4></a>

<p class="MsoNormal">Существует три типа
макетов областей диаграммы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
макет диаграммы – объект типа <span class="Term">МакетДиаграммыОбластиКомпоновкиДанных</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
макет ресурса диаграммы – объект типа <span class="Term">МакетРесурсаДиаграммыОбластиКомпоновкиДанных</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
макет группировки диаграммы – объект типа <span class="Term">МакетГруппировкиДиаграммыОбластиКомпоновкиДанных</span>.</p>

<p class="MsoNormal">При создании
макетов диаграммы формируется один макет диаграммы, один макет ресурса
диаграммы и несколько макетов группировок диаграммы. Количество макетов группировок
соответствует количеству точек и серий в диаграмме.</p>

<p class="Lang">Принцип
работы</p>

<p class="MsoNormalCxSpFirst">Макеты
областей используются при выводе отчетов в документы различных форматов. Макет
области является составной частью определения макета компоновки данных – объекта
типа <span class="Term">ОписаниеМакетаСхемыКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpLast">Для того
чтобы в ячейках или элементах списка макета области выводились значения
выводимых полей отчета, необходимо свойству <span class="Term">Значение</span>
поля области компоновки данных (объект типа <span class="Term">ПолеОбластиКомпоновкиДанных</span>)
присвоить значение типа <span class="Term">ПараметрСистемыКомпоновкиДанных</span>,
содержащее имя параметра. Сам параметр необходимо добавить к списку параметров
определения макета и в качестве имени присвоить имя параметра, а в качестве
выражения – имя выводимого поля или выражение в терминах языка выражений
системы компоновки данных.</p>

<p class="Lang">Макет
диаграммы</p>

<p class="MsoNormal">Макет диаграммы
используется для описания типа диаграммы. Описывается объектом встроенного
языка <span class="Term">МакетДиаграммыОбластиКомпоновкиДанных</span>.</p>

<p class="Lang">Макет
ресурса диаграммы</p>

<p class="MsoNormal">Макет ресурса
диаграммы используется для формирования значений диаграммы и описывается
объектом встроенного языка <span class="Term">МакетРесурсаДиаграммыОбластиКомпоновкиДанных</span>.</p>

<p class="Lang">Макет
группировки диаграммы</p>

<p class="MsoNormal">Макет группировки
диаграммы используется для формирования точек и серий диаграммы. Описывается объектом
встроенного языка <span class="Term">МакетГруппировкиДиаграммыОбластиКомпоновкиДанных</span>.</p>

<a name="_ref166301515"></a><a id="TI000000619" class="bookmark" name="issogl2_10.4.3_макеты_оформления"><h3>10.4.3. Макеты оформления</h3></a>

<p class="MsoNormal">Макет оформления
представляет собой декларативное описание предопределенных областей отчета.
Данные описания используются генератором областей макетов при формировании
макетов областей на основании элементов настройки компоновки данных.</p>

<p class="Regularbeforepicture">Для
интерактивного создания макета оформления необходимо при создании макета с
помощью конструктора макетов указать его тип <span class="Interface">Макет оформления компоновки данных</span>
и нажать кнопку <span class="Interface">Готово</span>. На экран выводится окно макета оформления.</p>

<p class="Picture"><IMG src="_img/img00395.gif?_=1496848987" WIDTH="680" ALT HEIGHT="473"></p>

<p class="MsoCaption">Рис. 397. Окно макета оформления</p>

<p class="MsoNormalCxSpFirst">Окно
конструктора состоит из списка областей оформления, таблицы настройки
оформления и поля табличного документа <span class="Term">Пример</span>
для показа результата выбранных настроек.</p>

<p class="MsoNormalCxSpMiddle">Непустые
области макета отображаются жирным шрифтом.</p>

<p class="MsoNormalCxSpMiddle">С помощью
контекстного меню перетаскивания параметры оформления могут быть скопированы
параметрами из одной области в другую или заменены.</p>

<p class="MsoNormalCxSpMiddle">С помощью
кнопки <span class="Interface">Стандартный
макет</span> можно загрузить уже подготовленный макет из списка стандартных макетов,
в который также войдут общие макеты конфигурации.</p>

<p class="MsoNormalCxSpMiddle">Кнопка <span class="Interface">Очистить макет</span>
удаляет оформление в макете.</p>

<p class="MsoNormalCxSpLast">Последовательность
действий для настройки оформления следующая:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
выбирается область оформления;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
в таблице настроек указываются (устанавливаются
пометки) параметры, оформление которых требуется изменить, и указываются
значения оформления;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
результат внесенных изменений контролируется в
поле <span class="Interface">Пример</span>.</p>

<p class="MsoNormal">Если
предполагается, что в отчет будет выведено несколько уровней группировки, то
нужно в списке областей для каждой области, в которой будут уровни, создать
подчиненные области по числу уровней группировки. Для создания уровня области нужно
указать область и нажать кнопку <span class="Interface">Добавить</span> командной панели. В список областей добавляется
строка, имя которой <span class="Interface">УровеньN</span>, где <span class="Interface">N</span> – номер уровня группировки. Выбор оформления
уровня группировки выполняется как описано выше.</p>

<p class="Note"><span class="Note">Примечание.</span>
Если было указано несколько уровней, то при удалении уровня группировки
всегда удаляется самый нижний уровень текущей области, независимо от того,
какой уровень в списке был выбран.</p>

<p class="Lang">Структура
макета оформления</p>

<p class="MsoNormalCxSpFirst">Каждый
макет оформления состоит из некоторого количества областей макета оформления.
Область макета оформления имеет имя – строку из перечня областей макетов
оформления, указывающую, к какой области применять данный макет, и коллекцию
элементов оформления.</p>

<p class="MsoNormalCxSpLast">Элемент
оформления имеет два свойства:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">Уровень</span> – положительное
число, причем если уровень равен 0, то считается, что оформление применяется по
умолчанию ко всем макетам области определенного типа;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Interface">Оформление</span> – коллекция,
содержащая имена свойств оформления и их значения.</p>

<p class="MsoNormal">Во встроенном языке
системы «1С:Предприятие» макет оформления представляется объектом типа <span class="Term">МакетОформленияКомпоновкиДанных</span>.</p>

<p class="Lang">Макет
оформления компоновки данных</p>

<p class="MsoNormal">Данный объект
представляет собой коллекцию областей макета оформления. Эта коллекция
реализована в виде значений параметров. Именем параметра является имя области.
Имя области является предопределенной строкой из перечня областей. Значением
параметра является объект типа <span class="Term">ОбластьМакетаОформленияКомпоновкиДанных</span>.</p>

<p class="Lang">Область
макета оформления компоновки данных</p>

<p class="MsoNormal">Данный объект
представляет собой описание предопределенной области и является коллекцией
элементов области макета оформления (объектов типа <span class="Term">ЭлементОбластиМакетаОформленияКомпоновкиДанных</span>).</p>

<p class="Lang">Элемент
области макета оформления компоновки данных</p>

<p class="MsoNormal">Данный объект
представляет собой описание области макета для определенного уровня иерархии.
Если в качестве номера уровня указан 0, то считается, что данный макет
оформления применяется ко всем областям данного типа.</p>

<a name="_ref216149343"></a><a id="TI000000620" class="bookmark" name="issogl2_10.4.4_генератор_областей_макетов"><h3>10.4.4. Генератор областей макетов</h3></a>

<p class="MsoNormalCxSpFirst">Генератор
областей макетов позволяет динамически формировать макеты областей компоновки
данных, используемых для вывода результата компоновки данных в документы различных
форматов. Под макетом области подразумевается декларативное описание
расположения выводимых данных и их оформление.</p>

<p class="MsoNormalCxSpLast">При работе
генератора областей макетов можно выделить следующие этапы:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
формирование общих макетов отчета,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
формирование макетов группировок,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
расположение группировок,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
расположение выводимых полей группировок,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
применение макета оформления,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
применение условных оформлений,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
объединение ячеек.</p>

<p class="MsoNormal">Рассмотрим каждый
этап работы генератора областей макетов.</p>

<p class="Lang">Формирование
общих макетов отчета</p>

<p class="MsoNormal">На данном этапе
генератором областей макетов на основании настройки компоновки данных создаются
общие макеты. Тип и количество макетов зависят от типа элемента настройки
компоновки данных.</p>

<p class="Lang">Макет
группировки</p>

<p class="Regularbeforetable">Для
группировки формируется специальный макет – шапка группировки. Данный
макет содержит названия выводимых полей в левой части макета и названия выводимых
ресурсных полей в правой части макета, например:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td colspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Количество</p>
  </td>
  
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Сумма</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
 
 <tr>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
 </tr>
 
</table>

<p class="Lang">Макет
таблицы</p>

<p class="MsoNormal">Для таблицы
формируется следующая группа макетов:</p>

<p class="MsoListBullet">&#9679; 
<span class="Bold">Макет шапки таблицы</span>.
Данный макет содержит названия выводимых полей строк таблицы, например:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td colspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.<br>
  Наименование</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Bold">Макет итогов по строкам</span>.
Данный макет содержит специальное слово <span class="Interface">Итого</span> и названия ресурсных полей, если они выводятся
горизонтально, например:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td colspan="2" valign="top">
  <p class="MsoNormalCxSpFirst">Итого</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Количество</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Сумма</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Bold">Макет итогов по колонкам</span>.
Данный макет содержит специальное слово <span class="Interface">Итого</span> и названия ресурсных полей, если они расположены
вертикально, например:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpFirst">Итого</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Количество</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Сумма</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Bold">Макет общих итогов</span>.
Данный макет содержит ресурсные поля, выводимые в таблице и необходимые для отображения
в таблице общих итогов, например:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Представление(</p>
  <p class="MsoNormalCxSpMiddle">Сумма(<br>
  Продажи.КоличествоОборот))</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Представление(</p>
  <p class="MsoNormalCxSpMiddle">Сумма( <br>
  Продажи.СуммаОборот))</p>
  </td>
  
 </tr>
</table>

<p class="Indentlist">Расположение
данных макетов внутри таблицы показано ниже.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Шапка
  таблицы</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  колонок</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  строк</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  ресурсов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  общих</p>
  <p class="MsoNormalCxSpMiddle">итогов</p>
  </td>
  
 </tr>
</table>

<p class="Indentlist">Расположение
макетов итогов по строкам и колонкам управляется свойствами <span class="Term">РасположениеОбщихИтоговПоГоризонтали</span> и <span class="Term">РасположениеОбщихИтоговПоВертикали</span> соответственно.
Возможны следующие варианты расположения общих итогов:</p>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Нет</span> – общие итоги не выводятся.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Шапка
  таблицы</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  колонок</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  строк</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  ресурсов</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Начало</span> – общие итоги выводятся в первой
колонке или в первой строке таблицы соответственно.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Шапка
  таблицы</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  колонок</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  общих</p>
  <p class="MsoNormalCxSpMiddle">итогов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  строк</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов по строкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  ресурсов</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Конец</span> – общие итоги выводятся в последней
колонке или в последней строке таблицы соответственно.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Шапка
  таблицы</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  колонок</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  строк</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  ресурсов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  общих</p>
  <p class="MsoNormalCxSpMiddle">итогов</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">НачалоИКонец</span> – общие итоги выводятся в
первой колонке/строке, а также в последней колонке/строке таблицы.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Шапка
  таблицы</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  колонок</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  общих</p>
  <p class="MsoNormalCxSpMiddle">итогов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  общих</p>
  <p class="MsoNormalCxSpMiddle">итогов</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  строк</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  ресурсов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  строкам</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  общих итогов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Область
  итогов</p>
  <p class="MsoNormalCxSpMiddle">по
  колонкам</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макет
  общих</p>
  <p class="MsoNormalCxSpMiddle">итогов</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Авто</span> – итоги по колонкам располагаются в
последней строке, а итоги по строкам – в последней колонке.</p>

<p class="Lang">Макет
диаграммы</p>

<p class="MsoNormal">В макете содержатся
оформительские свойства диаграммы.</p>

<p class="Lang">Формирование
макетов группировок</p>

<p class="MsoNormal">В настройке
компоновки данных существует три вида группировок:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
группировка,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
группировка таблицы,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
группировка диаграммы.</p>

<p class="MsoNormalCxSpFirst">Для
каждого вида группировок формируется свой набор макетов областей. Однако
расположение группировок друг относительно друга, расположение выводимых полей
внутри областей группировок и расположение ресурсных полей делаются единообразно.
При формировании любого макета области группировки можно выделить следующие
этапы.</p>

<p class="MsoNormalCxSpLast"><span class="Bold">Определение типа макета группировки</span>. Тип макета группировки
получается из параметра <span class="Term">ТипМакетаГруппировкиКомпоновкиДанных</span>
объекта <span class="Term">ЗначенияПараметровВыводаКомпоновкиДанных</span>.
Данное свойство имеет смысл только для простых группировок, т. е.
группировок, не входящих в таблицу и диаграмму. Возможны следующие варианты
расположения выбранных полей:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Авто</span> – автоматическое определение
расположения выбранных полей: если в группировке есть вложенная таблица, диаграмма,
вложенный отчет или группировка с типом макета группировки <span class="Term">Вертикальный</span>, то выбранные поля располагаются
вертикально, иначе – горизонтально.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Горизонтальный</span> – расположение выбранных
полей горизонтально, друг за другом слева направо.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td colspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Алекс-2002</p>
  </td>
  
  <td colspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">00009</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Бухгалтерия
  8</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00013</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Бухгалтерия
  8</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Term">Вертикальный</span> – расположение выбранных
полей вертикально, друг под другом.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Алекс-2002</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00009</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Бухгалтерия
  8</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00013</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Бухгалтерия
  8</p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpLast"><span class="Bold">Расположение группировок друг относительно друга</span>. Расположение
группировок друг относительно друга управляется параметром <span class="Term">РасположениеПолейГруппировки</span> объекта <span class="Term">ЗначенияПараметровВыводаКомпоновкиДанных</span>.
Возможны следующие варианты расположения:</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Вместе</span> – группировки располагаются друг
под другом. Например, для группировок по контрагенту и номенклатуре.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td colspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Алекс-2002</p>
  </td>
  
  <td colspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">00009</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Бухгалтерия
  8</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00013</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Бухгалтерия
  8</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Term">Отдельно</span> – каждая группировка
располагается в отдельной области. Группировки располагаются друг за другом
слева направо. Выводимые поля группировки выводятся также и во вложенных
группировках.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Алекс-2002</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00009</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Алекс-2002</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00009</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Аспект
  7.7</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00015</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Аспект
  7.7.</p>
  <p class="MsoNormalCxSpMiddle">Компактная
  торговая система</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Term">ОтдельноИТолькоВИтогах</span> – каждая
группировка располагается в отдельной области. Группировки располагаются друг
за другом слева направо. Выводимые поля выводятся только в данной группировке.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Алекс-2002</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00009</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Аспект
  7.7</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">00015</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">1С:Аспект
  7.7.</p>
  <p class="MsoNormalCxSpMiddle">Компактная
  торговая система</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Bold">Расположение выводимых полей</span>.
Существуют поля двух видов: собственно выводимые поля (поля-владельцы и/или их
реквизиты) и ресурсные поля. Вывод данных полей имеет существенные различия.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Bold">Вывод полей</span>. Как указано
выше, существуют поля-владельцы и поля-реквизиты. Поля-владельцы выводятся в
макет области в соответствии с их порядком следования в настройке компоновки
данных. Расположение полей-реквизитов управляется специальным параметром <span class="Term">РасположениеРеквизитов</span> объекта <span class="Term">ЗначенияПараметровВыводаКомпоновкиДанных</span>. Возможны
следующие варианты расположения:</p>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Вместе</span> – поля реквизитов располагаются
вместе в отдельной колонке и при выводе разделяются запятой.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент
  </p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код,
  Номенклатура.Наименование</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Отдельно</span> – каждое поле реквизита
располагается в отдельной колонке.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">ВместеСВладельцем</span> – поля реквизитов
располагаются в одной колонке с их полем-владельцем и при выводе разделяются
запятой.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент,
  Контрагент.Код</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура,
  Номенклатура.Код, Номенклатура.Наименование</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">ВСпециальнойПозиции</span> – поля-реквизиты
располагаются в специальной колонке, размещенной правее всех остальных колонок
группировки.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент
  </p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код,
  Номенклатура.Наименование</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Bold">Вывод полей, расположенных в
папках</span>. Расположение данных полей управляется свойством <span class="Interface">Расположение папки</span>.
Возможны следующие варианты расположения:</p>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Авто</span> – поля выводятся в зависимости от
типа группировки. Если группировка простая, то поля выводятся горизонтально;
если группировка табличная, то вертикально.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Реквизиты
  номенклатуры</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.ОснПост</p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpMiddle"> </p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td rowspan="4" valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Реквизиты
  номенклатуры</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.ОснПост</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Горизонтально</span> – поля выводятся
горизонтально слева направо.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Реквизиты
  номенклатуры</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.ОснПост</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">Вертикально</span> – поля выводятся вертикально
друг под другом.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td rowspan="4" valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Реквизиты
  номенклатуры</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.ОснПост</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet2">&#9679; 
<span class="Term">ВОтдельнойКолонке</span> – поля выводятся в
отдельной колонке, расположенной правее всех остальных колонок.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Контрагент.Код</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td colspan="2" rowspan="2" valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td colspan="3" valign="top">
  <p class="MsoNormalCxSpMiddle">Реквизиты
  номенклатуры</p>
  </td>
  
 </tr>
 <tr>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Наименование</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.ОснПост</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Term">Вместе</span> – поля выводятся вместе и при
выводе разделяются запятой.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Контрагент</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Реквизиты
  номенклатуры</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"> </p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Номенклатура.Код,
  Номенклатура.Наименование,</p>
  <p class="MsoNormalCxSpMiddle">Номенклатура.ОсновнойПоставщик</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
<span class="Bold">Вывод ресурсных полей</span>.
Специальное свойство <span class="Term">РасположениеРесурсов</span>
объекта <span class="Term">ПараметрыВывода</span>
управляет расположением ресурсных полей. Возможны следующие варианты
расположения:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
<span class="Term">Горизонтально</span> – поля ресурсов
располагаются горизонтально слева направо.</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
<span class="Term">Вертикально</span> – поля ресурсов располагаются
вертикально друг под другом.</p>

<p class="MsoNormal">Если для папки не
установлен заголовок, то место для заголовка в макете не выделяется. В этом
случае поля выводятся в соответствии со значением свойства <span class="Interface">Расположение папки</span>.</p>

<p class="Lang">Применение
макета оформления</p>

<p class="MsoNormal">После расположения
группировок и полей к сформированной области применяется макет оформления.
Смысл применения макета оформления состоит в том, что всем элементам макета
области добавляются ранее определенные свойства оформления, например, <span class="Term">ЦветФона</span> или <span class="Term">ЦветТекста</span>.
Стоит отметить, что существует большое количество макетов оформления областей.</p>

<p class="Lang">Применение
условных оформлений</p>

<p class="MsoNormal">После применения
макета оформления к макету области применяются условные оформления. Применение
условного оформления заключается в том, что в макет области добавляются
свойства оформления, содержащие логические выражения. В результате вычисления
логического выражения принимается решение, какое значение оформительского
свойства необходимо применить.</p>

<p class="Lang">Объединение
ячеек</p>

<p class="MsoNormal">После формирования
макета области в ней могут оказаться незаполненные ячейки. Такие ячейки
необходимо объединять для более наглядного представления макета области. Возможны
следующие варианты расположения ячеек.</p>

<p class="MsoListBullet">&#9679; 
Незаполненные ячейки расположены справа от заполненных
ячеек. Ячейки, расположенные справа, объединяются с ячейками слева.</p>

<p class="Picture"><IMG src="_img/img00396.gif?_=1496848987" WIDTH="321" ALT HEIGHT="119"></p>

<p class="MsoCaption">Рис. 398. Незаполненные ячейки справа</p>

<p class="MsoListBullet">&#9679; 
Незаполненные ячейки расположены под
заполненными ячейками. Ячейки, расположенные снизу, объединяются с ячейками
вверху.</p>

<p class="Picture"><IMG src="_img/img00397.gif?_=1496848987" WIDTH="326" ALT HEIGHT="117"></p>

<p class="MsoCaption">Рис. 399. Незаполненные ячейки снизу</p>

<p class="MsoListBullet">&#9679; 
Незаполненные ячейки расположены и справа, и под
заполненными ячейками. Ячейки, расположенные справа, объединяются с ячейками
слева. Затем ячейки, расположенные снизу, объединяются с ячейками вверху.</p>

<p class="Picture"><IMG src="_img/img00398.gif?_=1496848987" WIDTH="317" ALT HEIGHT="117"></p>

<p class="MsoCaption">Рис. 400. Незаполненные ячейки снизу и справа</p>

<a id="TI000000621" class="bookmark" name="issogl2_10.4.5_формирование_макета_компоновки_данных"><h3>10.4.5. Формирование макета компоновки данных</h3></a>

<p class="MsoNormalCxSpFirst">Формирование
макета компоновки данных осуществляется на основании схемы компоновки данных и
настроек. Схема компоновки данных создается разработчиком отчета, настройки
вводятся пользователем.</p>

<p class="MsoNormalCxSpMiddle">Формирование
макета компоновки осуществляется при помощи объекта встроенного языка <span class="Term">КомпоновщикМакетаКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpMiddle">Данный
объект не имеет свойств и имеет один метод <span class="Term">Выполнить()</span>,
в который передается схема компоновки данных, настройки компоновки данных,
переменная, в которую помещается объект <span class="Term">ДанныеРасшифровки</span>,
и макет оформления. Данный метод возвращает созданный макет компоновки данных.</p>

<p class="MsoNormalCxSpLast">В процессе
работы компоновщик макета:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Создает макет компоновки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Модифицирует запросы наборов данных для получения
нужной пользователю информации и помещает их в макет компоновки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Формирует фильтры в тексте запроса или описании
набора данных.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При необходимости создает наборы данных для получения
и проверки иерархии.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В макете компоновки данных создает нужные параметры
со значениями, установленными пользователем.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Заполняет элементы тела макета компоновки
данных, в которые помещает группировки, таблицы и т. д., заполняет их
параметры.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Использует генератор областей макета (см. <a href="#_ref216149343">здесь</a>). Если указан макет оформления (четвертый параметр),
данный макет будет использоваться для оформления генерируемого макета.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если указан третий параметр, создает объект <span class="Term">ДанныеРасшифровки</span> и помещает его в переданную
переменную. Созданный таким образом объект нужно использовать при работе
процессора компоновки и при отработке расшифровки.</p>

<p class="MsoNormalCxSpFirst">Компоновщик
макета при генерации макета компоновки данных анализирует значение параметра <span class="Term">Группировка</span> функции <span class="Term">ВычислитьВыражение()</span>. Если параметр содержит
имя группировки, которая присутствует в настройках, то компоновщик макета
оставляет данное имя без изменения. В противном случае компоновщик макета ищет
среди родительских группировок текущей группировки группировку, содержащую в
полях группировки все поля, указанные в параметре <span class="Term">Группировка</span> функции <span class="Term">ВычислитьВыражение()</span>, и проставляет в данный
параметр имя найденной группировки.</p>

<p class="MsoNormalCxSpMiddle">Например,
если в качестве параметра функции <span class="Term">ВычислитьВыражение()</span>
указана строка <span class="Term">Номенклатура,
ХарактеристикаНоменклатуры</span>, то при генерации макета компоновщик
макета найдет группировку по полям <span class="Term">Номенклатура</span>
и <span class="Term">ХарактеристикаНоменклатуры</span>
и в сгенерированный макет поместит имя найденной группировки. При этом
группировка ищется среди группировок, которые доступны в месте вычисления
группировки. Так, если компоновщик макета генерирует выражение для ячейки
таблицы, то поиск группировки будет осуществляться в группировках колонок, для
которых выводится ячейка, группировках строк, для которых выводится ячейка, и
группировках, в которые вложена таблица. Таким образом, ищутся группировки, к
которым может быть применена функция <span class="Term">ВычислитьВыражение()</span>.
Если найдено несколько, то выбирается группировка, которая ближе. В таблице
сначала ищется группировка в строке, после этого ищется группировка в колонке, затем
ищется группировка над таблицей.</p>

<p class="MsoNormalCxSpMiddle">Если
группировка не найдена, то выражение заменяется на <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpLast">Фактически
это позволяет использовать <span class="Term">ВычислитьВыражение()</span>
в пользовательских полях, указывая группировки не по именам группировок, а по
именам полей группировок.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СхемаКомпоновкиДанных <span class="operator">=</span> ПолучитьСхемуКомпоновкиДанных<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ИсполняемыеНастройки <span class="operator">=</span> ПолучитьИсполняемыеНастройки<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
КомпоновщикМакета <span class="operator">=</span> <span class="keyword">Новый</span> КомпоновщикМакетаКомпоновкиДанных<span class="operator">;</span>
МакетКомпоновки <span class="operator">=</span> КомпоновщикМакета<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span>СхемаКомпоновкиДанных<span class="operator">,</span> ИсполняемыеНастройки<span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">Созданный
макет компоновки данных может быть использован для исполнения, т. е.
для получения результата.</p>

<a id="TI000000622" class="bookmark" name="issogl1_10.5_процессор_компоновки_данных"><h2>10.5. Процессор компоновки данных</h2></a>

<p class="MsoNormalCxSpFirst">Исполнение
компоновки данных осуществляется при помощи объекта системы «1С:Предприятие» <span class="Term">ПроцессорКомпоновкиДанных</span>.</p>

<p class="MsoNormalCxSpMiddle">На вход
процессору компоновки данных передается макет компоновки данных.</p>

<p class="MsoNormalCxSpMiddle">Работа с
процессором компоновки данных предельно проста: после установки процессору компоновки
данных макета компоновки данных у данного объекта можно последовательно
получать элементы результата компоновки данных, которые в дальнейшем можно
использовать, например, для вывода в табличный документ или сохранить для
последующего использования.</p>

<p class="MsoNormalCxSpLast">Ниже
приведен пример работы с процессором компоновки данных.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЭлементыФормы<span class="operator">.</span>ТДРезультатТабличныйДокумент<span class="operator">.</span>Очистить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
МакетКД <span class="operator">=</span> ПолучитьМакетКомпоновки<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ПроцессорКД <span class="operator">=</span> <span class="keyword">Новый</span> ПроцессорКомпоновкиДанных<span class="operator">;</span>
ПроцессорКД<span class="operator">.</span>Инициализировать<span class="operator">(</span>МакетКД<span class="operator">)</span><span class="operator">;</span>
ПроцессорВывода <span class="operator">=</span>
<span class="keyword">Новый</span> ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент<span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>УстановитьДокумент<span class="operator">(</span>ЭлементыФормы<span class="operator">.</span>ТДРезультатТабличныйДокумент<span class="operator">)</span><span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>НачатьВывод<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Пока</span> <span class="keyword">Истина</span> <span class="keyword">Цикл</span>
    ЭлементРезультатаКД <span class="operator">=</span> ПроцессорКД<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Если</span> ЭлементРезультатаКД <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
        <span class="keyword">Прервать</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    ПроцессорВывода<span class="operator">.</span>ВывестиЭлемент<span class="operator">(</span>ЭлементРезультатаКД<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>ЗакончитьВывод<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">При инициализации
процессора компоновки данных можно дополнительно указать:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
объект – внешние наборы данных – структуру,
у которой в качестве ключа содержится имя внешнего набора данных, а в качестве
значения – набор данных;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
данные расшифровки – объект, в который
будет помещаться информация о расшифровке;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
возможность использования внешних функций –
признак, можно ли в выражениях использовать функции общих модулей конфигурации.</p>

<a name="_ref236810229"></a><a id="TI000000623" class="bookmark" name="issogl1_10.6_функциональные_опции_и_права_на_просмотр_поля_в_отчете"><h2>10.6. Функциональные опции и права на просмотр поля в отчете</h2></a>

<p class="MsoNormal">При получении настроек отчета по умолчанию
система компоновки данных автоматически выполняет следующие действия с
настройками:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Если у пользователя нет права на интерактивный
просмотр некоторого поля или данное поле связано с выключенными функциональными
опциями, это поле становится недоступным для настройки пользователем. То есть
оно не будет отображаться в списке доступных полей.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если поле связано с реквизитом, тип которого
выключен функциональной опцией, то это поле удаляется из списка доступных
полей.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Таблица запроса и реквизиты этой таблицы
становятся недоступными, если функциональная опция отключает объект конфигурации,
образующий эту таблицу.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если поле, на просмотр которого у пользователя
нет права, или поле, которое связано с выключенной функциональной опцией,
используется в пользовательском поле, то такое пользовательское поле удаляется
и по нему не устанавливается отбор.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Поле системы компоновки данных считается
недоступным, если все поля, используемые в выражении этого поля, связаны с
выключенными функциональными опциями или недоступными на просмотр полями. При
этом учитываются все поля, входящие в выражение поля в запросе, за исключением
полей, участвующих в условиях запросов и полей, участвующих в разделе <span class="Term">КОГДА</span>
операции выбора (<span class="Term">ВЫБОР</span> <span class="Term">КОГДА</span>
<span class="Term">ИНАЧЕ</span> <span class="Term">КОНЕЦ</span>),
а также выражения из объединений, если таковые присутствуют.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Из полей группировки удаляются все поля, на
которые у пользователя нет права на просмотр, и поля, которые связаны с выключенными
функциональными опциями. Если после удаления поля группировки у группировки не
остается ни одного поля группировки с установленным признаком использования, то
удаляется вся группировка, а ее содержимое (если, например, группировка
включает таблицу) помещается на место группировки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если после удаления из таблицы
группировки-строки или группировки-колонки таблица остается без группировок, то
таблица удаляется.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если после удаления из диаграммы
группировки-серии или группировки-точки диаграмма остается без группировок, то
диаграмма удаляется.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Из упорядочивания удаляются все поля, для
которых у пользователя нет права на просмотр и которые связаны с выключенными функциональными
опциями.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Из оформляемых полей элемента условного
оформления удаляются поля, на которые у пользователя нет права на просмотр и которые
связаны с выключенными функциональными опциями. Если после удаления
оформляемого поля из элемента условного оформления в элементе не остается ни
одного оформляемого поля с включенным признаком использования, то такой элемент
условного оформления также удаляется.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если в отборе элемента условного оформления
использовалось поле, для которого у пользователя нет права на просмотр, или
поле, которое связано с выключенными функциональными опциями, то такой элемент
условного оформления удаляется.</p>

<p class="MsoNormalCxSpFirst">Если поле ранее было доступно и пользователь
каким-либо образом сохранил настройку, а в дальнейшем (когда поле стало для
него недоступно) загрузит настройку, поля не будут автоматически удаляться из
настройки. Это сделано для того, чтобы пользователь имел возможность заменить
недоступные поля другими полями или самостоятельно удалил их использование из
настроек.</p>

<p class="MsoNormalCxSpLast">Если при выполнении метода <span class="Term">Выполнить()</span>
объекта <span class="Term">КомпоновщикМакетаКомпоновки</span> параметр <span class="Term">ПроверятьДоступностьПолей</span>
установлен в значение <span class="Term">Истина</span>, то будет
осуществляться проверка доступности полей для текущего пользователя и проверка
наличия поля во включенной функциональной опции. При использовании в настройках
недоступного поля будет выдаваться исключение. Если значение параметра <span class="Term">Ложь</span>,
то проверка осуществляться не будет.</p>

<p class="Note"><span class="Note">Примечание.</span> В случае выполнения
отчета из автоматически сгенерированной формы будет осуществляться проверка доступности
полей для текущего пользователя и проверка наличия поля во включенной
функциональной опции.</p>

<a id="TI000000624" class="bookmark" name="issogl1_10.7_результат_компоновки_данных"><h2>10.7. Результат компоновки данных</h2></a>

<p class="MsoNormalCxSpFirst">Результат
компоновки данных представляется набором элементов результата компоновки
данных. Как объект встроенного языка системы «1С:Предприятие» результат
компоновки данных не существует, существует лишь набор элементов результата
компоновки данных, которые и образуют результат.</p>

<p class="MsoNormalCxSpMiddle">При
необходимости элементы результата компоновки данных могут быть помещены в
некоторую универсальную коллекцию значений, например <span class="Term">Массив</span>, для того чтобы манипулировать
результатом как единым целым.</p>

<p class="MsoNormalCxSpMiddle">Элементы
результата могут быть получены при помощи объекта <span class="Term">ПроцессорКомпоновкиДанных</span>, а также могут быть
созданы и заполнены средствами встроенного языка.</p>

<p class="MsoNormalCxSpMiddle">Элементы
результата компоновки данных можно вывести в табличный документ при помощи
процессора вывода.</p>

<p class="MsoNormalCxSpLast">Рассмотрим
пример элементов данных.</p>

<p class="Lang">Элемент
1</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Начало</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Макеты</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗаголовокТаблицы,</p>
  <p class="MsoNormalCxSpMiddle">ЗаголовокКолонки,</p>
  <p class="MsoNormalCxSpMiddle">ЗаголовокСтроки,</p>
  <p class="MsoNormalCxSpMiddle">Ресурсы</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Расположение вложенных элементов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Вертикально</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
2</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Начало</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Расположение вложенных элементов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Горизонтально</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
3</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">НачалоКонец</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Имя макета</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗаголовокТаблицы</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
4</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">НачалоКонец</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Имя макета</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗаголовокКолонки</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
5</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Конец</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
6</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Начало</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Расположение вложенных элементов</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Горизонтально</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
7</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">НачалоКонец</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Имя макета</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗаголовокСтроки</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
8</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">НачалоКонец</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Имя макета</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Ресурсы</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
9</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Конец</p>
  </td>
  
 </tr>
</table>

<p class="Lang">Элемент
10</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">Свойство</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Значение</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Тип элемента</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Конец</p>
  </td>
  
 </tr>
</table>

<p class="Regularbeforetable">Результат
вывода таких элементов должен выглядеть следующим образом:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst">ЗаголовокТаблицы</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗаголовокКолонки</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">ЗаголовокСтроки</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Ресурсы</p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpMiddle">Если бы
элемент 2 содержал макеты <span class="Term">ЗаголовокТаблицы</span>
и <span class="Term">ЗаголовокСтроки</span>,
то при выводе элемента 3 использовался бы макет из этого элемента, однако при
выводе элемента 7 использовался бы макет из элемента 1, т. к. элемент
2 завершается элементом 5.</p>

<p class="MsoNormalCxSpLast">Элементы
результата могут быть сохранены в XML стандартными средствами, например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЗаписьXML <span class="operator">=</span> <span class="keyword">Новый</span> ЗаписьXML<span class="operator">;</span>
ЗаписьXML<span class="operator">.</span>УстановитьСтроку<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ЗаписьXML<span class="operator">.</span>ЗаписатьНачалоЭлемента<span class="operator">(</span><span class="string">&quot;result&quot;</span><span class="operator">)</span><span class="operator">;</span>
МакетКомпоновкиДанных <span class="operator">=</span> ПолучитьМакетКомпоновки<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ПроцессорКомпоновкиДанных <span class="operator">=</span> <span class="keyword">Новый</span> ПроцессорКомпоновкиДанных<span class="operator">;</span>
ПроцессорКомпоновкиДанных<span class="operator">.</span>Инициализировать<span class="operator">(</span>МакетКомпоновкиДанных<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Пока</span> <span class="keyword">Истина</span> <span class="keyword">Цикл</span>
    ЭлементРезультатаКомпоновкиДанных <span class="operator">=</span> ПроцессорКомпоновкиДанных<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Если</span> ЭлементРезультатаКомпоновкиДанных <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
        <span class="keyword">Прервать</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    СериализаторXDTO<span class="operator">.</span>ЗаписатьXML<span class="operator">(</span>ЗаписьXML<span class="operator">,</span> ЭлементРезультатаКомпоновкиДанных<span class="operator">,</span> <span class="string">&quot;item&quot;</span><span class="operator">,</span> <span class="string">&quot;http://v8.1c.ru/8/data-composition-system/result&quot;</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span>
ЗаписьXML<span class="operator">.</span>ЗаписатьКонецЭлемента<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ЭлементыФормы<span class="operator">.</span>РезультатКомпоновкиДанных<span class="operator">.</span>УстановитьТекст<span class="operator">(</span>ЗаписьXML<span class="operator">.</span>Закрыть<span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></pre>

<a name="_ref325454771"></a><a name="_ref325454770"></a><a id="TI000000625" class="bookmark" name="issogl2_10.7.1_вывод_результата_компоновки_в_табличный_документ"><h3>10.7.1. Вывод результата компоновки в табличный документ</h3></a>

<p class="MsoNormalCxSpFirst">Вывод
отчета в табличный документ осуществляется при помощи объекта <span class="Term">ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент</span>.</p>

<p class="MsoNormalCxSpMiddle">Элементы
результата компоновки могут быть получены при помощи процессора компоновки
данных либо сформированы любыми другими средствами.</p>

<p class="MsoNormalCxSpLast">Пример
вывода результата компоновки данных в табличный документ:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЭлементыФормы<span class="operator">.</span>ТДРезультатТабличныйДокумент<span class="operator">.</span>Очистить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
МакетКомпоновкиДанных <span class="operator">=</span> ПолучитьМакетКомпоновки<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ПроцессорКомпоновкиДанных <span class="operator">=</span> <span class="keyword">Новый</span> ПроцессорКомпоновкиДанных<span class="operator">;</span>
ПроцессорКомпоновкиДанных<span class="operator">.</span>Инициализировать<span class="operator">(</span>МакетКомпоновкиДанных<span class="operator">)</span><span class="operator">;</span>
ПроцессорВывода <span class="operator">=</span> <span class="keyword">Новый</span> ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент<span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>УстановитьДокумент<span class="operator">(</span>ЭлементыФормы<span class="operator">.</span>ТДРезультатТабличныйДокумент<span class="operator">)</span><span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>НачатьВывод<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Пока</span> <span class="keyword">Истина</span> <span class="keyword">Цикл</span>
    ЭлементРезультатаКомпоновкиДанных <span class="operator">=</span> ПроцессорКомпоновкиДанных<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Если</span> ЭлементРезультатаКомпоновкиДанных <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
        <span class="keyword">Прервать</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    ПроцессорВывода<span class="operator">.</span>ВывестиЭлемент<span class="operator">(</span>    ЭлементРезультатаКомпоновкиДанных<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>ЗакончитьВывод<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">Также имеется
возможность использовать метод <span class="Term">Вывести()</span>
объекта <span class="Term">ПроцессорВывода</span>. В
качестве параметра метода следует указать <span class="Term">ПроцессорКомпоновкиДанных</span>.
В этом случае вывод результата компоновки будет выглядеть так:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ПроцессорВывода<span class="operator">.</span>Вывести<span class="operator">(</span>ПроцессорКомпоновкиДанных<span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">Процессор
компоновки данных выполняет фиксацию заголовка таблицы, если в отчет выводится
одна таблица или одна группировка (возможно, с вложенными группировками).
Управлять возможностями фиксации (сверху и слева) можно с помощью настроек
параметров вывода <span class="Interface">Фиксация слева</span> и <span class="Interface">Фиксация сверху</span>.</p>

<a name="_ref393119245"></a><a id="TI000000626" class="bookmark" name="issogl2_10.7.2_вывод_результата_компоновки_в_таблицу_и_дерево_значений"><h3>10.7.2. Вывод результата компоновки в таблицу и дерево значений</h3></a>

<p class="MsoNormalCxSpFirst">Вывод
отчета в таблицу или дерево значений осуществляется при помощи объекта <span class="Term">ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений</span>.
Метод <span class="Term">УстановитьОбъект()</span>
является аналогом метода <span class="Term">УстановитьДокумент()</span>.
Если метод <span class="Term">УстановитьОбъект()</span>
не был вызван, результат будет выведен в таблицу значений.</p>

<p class="MsoNormalCxSpMiddle">Элементы
результата компоновки могут быть получены при помощи процессора компоновки
данных либо сформированы любыми другими средствами.</p>

<p class="MsoNormalCxSpLast">Пример
вывода результата компоновки данных в дерево значений:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">КомпоновщикМакета <span class="operator">=</span> <span class="keyword">Новый</span> КомпоновщикМакетаКомпоновкиДанных<span class="operator">;</span>
МакетКомпоновкиДанных <span class="operator">=</span> КомпоновщикМакета<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span>СхемаКомпоновкиДанных<span class="operator">,</span>КомпоновщикНастроек<span class="operator">.</span>Настройки<span class="operator">,</span> <span class="operator">,</span> <span class="operator">,</span> Тип<span class="operator">(</span><span class="string">&quot;ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений&quot;</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
ПроцессорКомпоновкиДанных <span class="operator">=</span> <span class="keyword">Новый</span> ПроцессорКомпоновкиДанных<span class="operator">;</span>
ПроцессорКомпоновкиДанных<span class="operator">.</span>Инициализировать<span class="operator">(</span>МакетКомпоновкиДанных<span class="operator">)</span><span class="operator">;</span>
ПроцессорВывода <span class="operator">=</span> <span class="keyword">Новый</span> ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений<span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>УстановитьОбъект<span class="operator">(</span>ДеревоРезультата<span class="operator">)</span><span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>НачатьВывод<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Пока</span> <span class="keyword">Истина</span> <span class="keyword">Цикл</span>
    ЭлементРезультатаКомпоновкиДанных <span class="operator">=</span> ПроцессорКомпоновкиДанных<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">Если</span> ЭлементРезультатаКомпоновкиДанных <span class="operator">=</span> <span class="keyword">Неопределено</span> <span class="keyword">Тогда</span>
        <span class="keyword">Прервать</span><span class="operator">;</span>
    <span class="keyword">КонецЕсли</span><span class="operator">;</span>
    ПроцессорВывода<span class="operator">.</span>ВывестиЭлемент<span class="operator">(</span>    ЭлементРезультатаКомпоновкиДанных<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span>
ПроцессорВывода<span class="operator">.</span>ЗакончитьВывод<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">При выводе
результата компоновки в таблицу или дерево значений существуют следующие
ограничения:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
В настройках должны присутствовать только группировки
и детальные записи. Использование таблиц и диаграмм не допускается.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Все папки, указанные в выбранных полях, игнорируются.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Не используется условное оформление, а также
оформление для поля, указанное в схеме компоновки данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Из параметров вывода используются только следующие:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
расположение общих итогов по вертикали,</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
тип заголовка полей,</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
количество записей,</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
процент записей.</p>

<p class="MsoListBullet">&#9679; 
Предопределенные макеты не используются.</p>

<p class="MsoNormal">Для вывода
результата в таблицу или дерево значения реализовано два вида макетов: макет
для заголовка (<span class="Term">МакетЗаголовкаКоллекцииЗначенийОбластиКомпоновкиДанных</span>)
и макет содержимого (<span class="Term">МакетКоллекцииЗначенийОбластиКомпоновкиДанных</span>).</p>

<a id="TI000000627" class="bookmark" name="issogl1_10.8_расчет_итогов_по_полям_остатка_в_системе_компоновки_данных"><h2>10.8. Расчет итогов по полям остатка в системе компоновки данных</h2></a>

<p class="MsoNormal">Полем остатка с
точки зрения макета компоновки данных является то, у которого в роли проставлен
признак <span class="Term">Остаток</span>.</p>

<a id="TI000000628" class="bookmark" name="issogl2_10.8.1_расчет_итогов_по_полям_остатка"><h3>10.8.1. Расчет итогов по полям остатка</h3></a>

<p class="MsoNormalCxSpFirst">Если в
макете компоновки данных в некотором наборе данных присутствует поле начального
остатка, то в наборе данных также должно присутствовать соответствующее ему поле
конечного остатка, и наоборот.</p>

<p class="MsoNormalCxSpMiddle">Все
поля-периоды, описанные в наборе данных, должны иметь непрерывную нумерацию,
начинающуюся с единицы.</p>

<p class="MsoNormalCxSpMiddle">Для
корректного расчета итогов по полям источника данных данные должны
удовлетворять следующему правилу: в данных должна соблюдаться уникальность значений
полей-периодов и полей-измерений, т. е. данные не должны содержать
строк с одинаковыми значениями полей-периодов и полей-измерений.</p>

<p class="MsoNormalCxSpLast">При расчете
итогов по полям-остаткам используется следующий алгоритм:</p>

<p class="MsoListBullet">&#9679; 
если требуется осуществить расчет итога поля
остатка для группировки по полю-периоду:</p>

<p class="MsoListBullet2">&#9679; 
если по всем полям-периодам уже была
осуществлена группировка:</p>

<p class="MsoListBullet3">&#9679; 
для каждой комбинации полей измерений, по которым
осуществлялась группировка:</p>

<p class="MsoListBullet5CxSpFirst">&#9679; 
получается запись, ближайшая к текущему периоду;</p>

<p class="MsoListBullet5CxSpMiddle">&#9679; 
если полученная запись была на текущий период,
то из данной записи будут получаться начальные и конечные остатки;</p>

<p class="MsoListBullet5CxSpMiddle">&#9679; 
иначе, если полученная запись имеет предыдущий
период, конечный остаток записи будет использован как начальный и конечный
остаток;</p>

<p class="MsoListBullet5CxSpLast">&#9679; 
иначе начальный остаток полученной записи будет
использоваться как начальный и конечный остаток;</p>

<p class="MsoListBullet">&#9679; 
иначе (группировка еще не произведена по всем полям-периодам):</p>

<p class="MsoListBullet2">&#9679; 
для каждой комбинации полей измерений, по
которым осуществлялась группировка:</p>

<p class="MsoListBullet3CxSpFirst">&#9679; 
получаются первая и последние записи, у которых
поля использованных периодов равны текущему периоду;</p>

<p class="MsoListBullet3CxSpMiddle">&#9679; 
если записи найдены, то первая запись будет
использоваться как начальный остаток, последняя – как конечный;</p>

<p class="MsoListBullet3CxSpLast">&#9679; 
если записи не найдены, то получается ближайшая
запись и ее остатки используются как начальные остатки и конченые остатки в
зависимости от того, предшествует ли найденная запись текущему периоду;</p>

<p class="MsoListBullet">&#9679; 
иначе (не группировка по полю-периоду):</p>

<p class="MsoListBullet2">&#9679; 
первые по хронологии записи для неиспользованных
полей-измерений будут использоваться в качестве записей начального остатка,
последние – в качестве конечного.</p>

<a id="TI000000629" class="bookmark" name="issogl2_10.8.2_расчет_итогов_по_полям_бухгалтерских_остатков"><h3>10.8.2. Расчет итогов по полям бухгалтерских остатков</h3></a>

<p class="MsoNormalCxSpFirst">Расчет
итогов по полям бухгалтерских остатков выполняется аналогично расчету итогов по
обычным полям-остаткам. Кроме того, при расчете итогов по таким полям используется
информация о поле-счете. Если итоги рассчитываются для группировки по
полю-счету или если до группировки, для которой считаются итоги, была
осуществлена группировка по полю-счету, при расчете итога используется вид
счета. В противном случае вид счета считается активно-пассивным.</p>

<p class="MsoNormalCxSpLast">В
зависимости от вида счета итоговый остаток будет вычисляться по следующим
формулам:</p>

<p class="MsoListBullet">&#9679; 
Если полученный остаток больше 0:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"> </p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дт</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кт</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Активный</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Остаток</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Пассивный</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">-Остаток</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">АП</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Остаток</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
 </tr>
</table>

<p class="MsoListBullet">&#9679; 
Если полученный остаток меньше 0:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"> </p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Дт</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Кт</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Активный</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Остаток</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Пассивный</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">-Остаток</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">АП</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">0</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">-Остаток</p>
  </td>
  
 </tr>
</table>

<a id="TI000000630" class="bookmark" name="issogl2_10.8.3_компоновка_макета"><h3>10.8.3. Компоновка макета</h3></a>

<p class="MsoNormal">Для обеспечения
расчета корректных итогов компоновщик макета при генерации макета выполняет
дополнительные действия:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
если используется начальный остаток,
автоматически добавит в запрос и поле конечного остатка, даже если он не используется,
и наоборот;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
если в отчете используется поле-реквизит измерения,
автоматически добавит в запрос само поле-измерение, даже если оно не
используется.</p>

<a id="TI000000631" class="bookmark" name="issogl1_10.9_работа_с_иерархией_в_системе_компоновки_данных"><h2>10.9. Работа с иерархией в системе компоновки данных</h2></a>

<p class="MsoNormal">В системе
компоновки данных имеются следующие аспекты использования иерархии:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
иерархические группировки,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
условие <span class="Term">В ИЕРАРХИИ</span>.</p>

<p class="MsoNormal">Рассмотрим
перечисленные аспекты подробнее.</p>

<a id="TI000000632" class="bookmark" name="issogl2_10.9.1_иерархические_группировки"><h3>10.9.1. Иерархические группировки</h3></a>

<p class="MsoNormalCxSpFirst">При
создании группировки пользователь может указать для некоторого поля группировки
необходимость выполнения иерархической группировки.</p>

<p class="MsoNormalCxSpMiddle">Для того
чтобы система выполнила иерархическую группировку, процессору компоновки данных
необходимо знать, откуда получать данные для построения иерархии. Реализуется
это путем создания набора данных с указанием связи набора данных самого к себе.</p>

<p class="MsoNormalCxSpMiddle">Рассмотрим
пример. Допустим, необходимо построить иерархию для поля типа <span class="Term">Справочник.Номенклатура</span>.</p>

<p class="MsoNormalCxSpLast">Набор
данных для построения иерархии будет выглядеть так:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Ссылка <span class="keyword">КАК</span> Ссылка<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>Родитель <span class="keyword">КАК</span> Родитель
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ
    Номенклатура<span class="operator">.</span>Ссылка В<span class="operator">(</span>&Ссылки<span class="operator">)</span></pre>

<p class="MsoNormalCxSpFirst">Для этого
набора данных должна быть определена связь от поля <span class="Term">Родитель</span> к полю <span class="Term">Номенклатура</span>
с параметром <span class="Term">Ссылка</span>. Таким
образом, набор данных позволит последовательно получить всех родителей
элемента.</p>

<p class="MsoNormalCxSpMiddle">Набор данных
для построения иерархии может быть либо явно описан в схеме компоновки данных,
либо автоматически сгенерирован компоновщиком макета компоновки данных.</p>

<p class="MsoNormalCxSpLast">В случае
указания набора данных иерархии в схеме компоновки необходимо добавить,
например, запрос следующего вида:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Ссылка <span class="keyword">КАК</span> Ссылка<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>Родитель <span class="keyword">КАК</span> Родитель
{ВЫБРАТЬ
    Ссылка<span class="operator">.</span><span class="operator">*</span><span class="operator">,</span>
    Родитель}
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ
    Номенклатура<span class="operator">.</span>Ссылка В<span class="operator">(</span>&Ссылки<span class="operator">)</span></pre>

<p class="MsoNormal">Этот набор данных
необходимо связать сам с собой, как было описано выше. Кроме того, к набору
данных нужно создать связь от поля, для которого требуется создать иерархию.</p>

<a id="TI000000633" class="bookmark" name="issogl2_10.9.2_иерархические_детальные_записи"><h3>10.9.2. Иерархические детальные записи</h3></a>

<p class="MsoNormalCxSpFirst">Существует
возможность выводить в отчет детальные записи с иерархией, используя настройки
связей наборов данных.</p>

<p class="MsoNormalCxSpLast">Например,
определим набор данных <span class="Term">Номенклатура</span>:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Ссылка<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>Родитель<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>Код<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>ЭтоГруппа
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ Номенклатура<span class="operator">.</span>Родитель В <span class="operator">(</span>&Родители<span class="operator">)</span></pre>

<p class="MsoNormalCxSpFirst">Определим
связь набора данных <span class="Term">Номенклатура</span>
с самим собой.</p>

<p class="MsoNormalCxSpMiddle">В
качестве поля выражения-источника установим поле <span class="Term">Ссылка</span>, в качестве выражения-приемника – поле
<span class="Term">Родитель</span>.
Параметр связи – поле <span class="Term">Родители</span>
с возможностью получения списка параметров. Таким образом, из каждой строки
набора данных система будет выбирать значение поля <span class="Term">Ссылка</span>, и для него будут получены записи, в
которых это значение содержится в поле <span class="Term">Родитель</span>. Для того чтобы дочерние элементы
выбирались только в группах, установим выражение условия связи, равное полю <span class="Term">ЭтоГруппа</span>. В качестве начального значения
иерархической связи будем использовать выражение <span class="Term">Значение(Справочник.Номенклатура.ПустаяСсылка)</span>.
Оно означает, что на первом уровне иерархического набора данных будут получены
записи, поле <span class="Term">Родитель</span>
в которых является пустой ссылкой на справочник <span class="Term">Номенклатура</span>.</p>

<p class="MsoNormalCxSpLast">Для
вывода такого набора данных в отчет в настройках схемы компоновки достаточно
вывести детальные записи (добавьте в список выбранных полей поля <span class="Term">Код</span> и <span class="Term">Наименование</span>).</p>

<p class="Regularbeforepicture">Полученный
результат приведен на <a href="#_ref212357897">рис.401</a>.</p>

<p class="Picture"><IMG src="_img/img00399.gif?_=1496848987" WIDTH="434" ALT HEIGHT="434"></p>

<p class="MsoCaption"><a name="_ref212357897">Рис. </a>401. Иерархические детальные записи</p>

<a id="TI000000634" class="bookmark" name="issogl2_10.9.3_вывод_одного_элемента_в_нескольких_родительских_записях"><h3>10.9.3. Вывод одного элемента в нескольких родительских записях</h3></a>

<p class="MsoNormalCxSpFirst">Система
компоновки данных позволяет выводить один элемент в нескольких родительских
записях при построении иерархии.</p>

<p class="MsoNormalCxSpMiddle">Приведем
пример.</p>

<p class="MsoNormalCxSpMiddle">В
конфигурации создадим два справочника: <span class="Term">Дети</span> и <span class="Term">Сотрудники</span>, а также регистр сведений <span class="Term">ДетиСотрудников</span> с измерениями <span class="Term">Ребенок</span> и <span class="Term">РодительРебенка</span>.</p>

<p class="MsoNormalCxSpLast">В
справочнике <span class="Term">Сотрудники</span>
создадим записи: <span class="Interface">Иванова Мария</span>, <span class="Interface">Иванов Иван</span>. В
справочнике <span class="Term">Дети</span>
создадим запись: <span class="Interface">Иванов Степан</span>.</p>

<p class="Regularbeforetable">Допустим,
в регистре сведений <span class="Term">ДетиСотрудников</span>
есть записи:</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Ребенок</b></p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Родитель</b></p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов
  Степан</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов
  Иван</p>
  </td>
  
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванов
  Степан</p>
  </td>
  
  <td valign="top">
  <p class="MsoNormalCxSpMiddle">Иванова
  Мария </p>
  </td>
  
 </tr>
</table>

<p class="MsoNormalCxSpLast">Создадим
запрос набора данных <span class="Term">Дети</span>,
который будет получать список детей:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Дети<span class="operator">.</span>Ссылка
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Дети <span class="keyword">как</span> Дети</pre>

<p class="MsoNormal">Создадим
также запрос набора данных <span class="Term">Иерархия</span>,
который будет получать иерархические записи:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
ДетиСотрудников<span class="operator">.</span>Ребенок <span class="keyword">КАК</span> Ссылка<span class="operator">,</span>
ДетиСотрудников<span class="operator">.</span>РодительРебенка <span class="keyword">КАК</span> Родитель
<span class="keyword">ИЗ</span>
РегистрСведений<span class="operator">.</span>ДетиСотрудников <span class="keyword">КАК</span> ДетиСотрудников
ГДЕ
ДетиСотрудников<span class="operator">.</span>Ребенок В<span class="operator">(</span>&Ссылка<span class="operator">)</span>
ОБЪЕДИНИТЬ ВСЕ
<span class="keyword">ВЫБРАТЬ</span>
Сотрудники<span class="operator">.</span>Ссылка<span class="operator">,</span>
<span class="keyword">NULL</span>
<span class="keyword">ИЗ</span>
Справочник<span class="operator">.</span>Сотрудники <span class="keyword">КАК</span> Сотрудники
ГДЕ
Сотрудники<span class="operator">.</span>Ссылка В<span class="operator">(</span>&Ссылка<span class="operator">)</span></pre>

<p class="MsoNormalCxSpFirst">Первое
объединение запроса выбирает родителей детей. Вторая часть запроса выбирает
сотрудников, так как иерархический набор должен содержать и сами иерархические
записи.</p>

<p class="MsoNormalCxSpMiddle">Опишем
связи между наборами данных.</p>

<p class="MsoNormalCxSpMiddle">В качестве
источника связки укажем набор данных <span class="Term">Дети</span>, приемника – набор данных <span class="Term">Иерархия</span>. Выражение-источник – поле <span class="Term">Ссылка</span>, выражение-приемник – поле <span class="Term">Ссылка</span>. Параметром связи укажем поле <span class="Term">Ссылка</span>. Укажем, что возможен список параметров.</p>

<p class="MsoNormalCxSpLast">Опишем
иерархическую связь. Набор данных <span class="Term">Иерархия</span>
свяжем сам с собой, поле-источник – <span class="Term">Родитель</span>, поле-приемник – <span class="Term">Ссылка</span>. Параметром связи укажем поле <span class="Term">Ссылка</span> и укажем возможность списка параметров.</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span> Поле иерархического набора данных, с которым
осуществляется связь набора данных, должно именоваться так же, как и в исходном
наборе данных. В противном случае система не сможет получать реквизиты полей
для иерархического набора, в том числе не сможет получать представление для
иерархических значений.</p>

<p class="Regularbeforepicture">В
настройках отчета создадим иерархическую группировку по полю <span class="Term">Ссылка</span>, представление которого изменим на <span class="Term">Родитель</span>, и выполним отчет:</p>

<p class="Picture"><IMG src="_img/img00400.gif?_=1496848987" WIDTH="151" ALT HEIGHT="112"></p>

<p class="MsoCaption">Рис.
402.
Результирующая таблица</p>

<p class="MsoNormal">В
результате запись <span class="Interface">Иванов Степан</span> выведена в обеих группировках.</p>

<a id="TI000000635" class="bookmark" name="issogl2_10.9.4_условие_в_иерархии"><h3>10.9.4. Условие «В ИЕРАРХИИ»</h3></a>

<p class="MsoNormalCxSpFirst">Пользователь
может указать для поля условие <span class="Term">В ИЕРАРХИИ</span>.
В этом случае пользователю должны выдаться записи, находящиеся в иерархии
указанной ссылки.</p>

<p class="MsoNormalCxSpMiddle">Если
такое условие наложено в глобальном фильтре, оно попадет в текст запроса в виде
условия <span class="Term">В ИЕРАРХИИ</span>. Если условие
используется не в глобальном фильтре, то, чтобы отработать условие, процессору
компоновки данных необходимо иметь набор данных, который будет содержать
ссылки, удовлетворяющие условиям.</p>

<p class="MsoNormalCxSpLast">Такой набор
данных может быть либо явно описан в схеме компоновки данных, либо будет
автоматически сгенерирован компоновщиком макета.</p>

<a id="TI000000636" class="bookmark" name="issogl1_10.10.использование_системы_компоновки_данных_при_разработке_прикладных_решений"><h2>10.10.Использование системы компоновки данных при разработке прикладных решений</h2></a>

<p class="MsoNormal">В процессе разработки
прикладных решений система компоновки данных может быть использована средствами
встроенного языка в соответствии с описанной выше объектной моделью.</p>

<p class="Regularbeforepicture">Кроме
этого, система компоновки данных может быть задействована при визуальном
конструировании отчетов. Например, после создания объекта конфигурации <span class="Interface">Отчет</span> можно
создать макет этого отчета, содержащий схему компоновки данных. Для этого
следует нажать кнопку открытия у поля ввода <span class="Interface">Основная схема компоновки данных</span>.</p>

<p class="Picture"><IMG src="_img/img00401.gif?_=1496848987" WIDTH="543" ALT HEIGHT="450"></p>

<p class="MsoCaption">Рис. 403. Создание схемы компоновки данных</p>

<p class="MsoNormal">Нажатие кнопки <span class="Interface">Открыть схему
компоновки данных</span> позволит открыть основную схему компоновки данных.
Если схемы нет, то будет создана новая и назначена основной.</p>

<p class="Regularbeforepicture">В
результате этих действий будет открыт конструктор макета, который позволит
создать макет, содержащий схему компоновки данных.</p>

<p class="Picture"><IMG src="_img/img00402.gif?_=1496848987" WIDTH="449" ALT HEIGHT="421"></p>

<p class="MsoCaption">Рис. 404. Конструктор макета</p>

<p class="MsoNormalCxSpFirst">После
нажатия кнопки <span class="Interface">Готово</span> будет открыт конструктор схемы компоновки данных,
с помощью которого можно создать схему компоновки данных (см. <a href="#_ref166301286">здесь</a>) или загрузить существующую схему компоновки из
документа XML.</p>

<p class="MsoNormalCxSpLast">После
создания схемы компоновки данных отчет готов к работе и может быть запущен в
режиме 1С:Предприятие. Система при запуске отчета автоматически сгенерирует
форму отчета и форму настроек.</p>

<p class="Regularbeforepicture">На
закладке <span class="Interface">Формы</span>
кроме основной формы отчета можно указать:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
форму настроек отчета, которая будет появляться
при выполнении команды <span class="Interface">Настройка…</span> в режиме 1С:Предприятие и которая
используется для задания параметров пользовательских настроек;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
форму редактирования варианта отчета (которая
будет открываться при выборе пункта меню Еще – Изменить
вариант… (<span class="Interface">Все действия – Изменить
вариант…</span>)
автоматической формы отчета), с помощью которой продвинутый пользователь сможет
редактировать текущий вариант отчета (см. <a href="#_ref215643147">здесь</a>).</p>

<p class="Picture"><IMG src="_img/img00403.gif?_=1496848987" WIDTH="510" ALT HEIGHT="450"></p>

<p class="MsoCaption">Рис. 405. Настройка форм отчета</p>

<p class="Regularbeforepicture">Если
формы, которые автоматически генерирует система при использовании отчета на
базе системы компоновки данных, не устраивают конечных пользователей системы,
то прикладной разработчик может создать свои формы. Для этого следует воспользоваться
возможностями конструктора форм отчета.</p>

<p class="Picture"><IMG src="_img/img00404.gif?_=1496848987" WIDTH="449" ALT HEIGHT="438"></p>

<p class="MsoCaption">Рис. 406. Конструктор формы отчета</p>

<a id="TI000000637" class="bookmark" name="issogl2_10.10.1_параметры_ввода"><h3>10.10.1. Параметры ввода</h3></a>

<p class="MsoNormalCxSpFirst">В схеме
компоновки данных для полей наборов данных, вычисляемых полей и параметров
имеется возможность указать параметры ввода. Данные параметры описывают, каким
образом следует вводить значения для полей в отборе и параметрах. Например, в
отчете <span class="Interface">Остатки
товаров на складах</span> можно указать, что для поля <span class="Term">Номенклатура</span> будет доступен <span class="Interface">Быстрый выбор</span>.
Тогда, задавая значение отбора по номенклатуре, мы сможем пользоваться этой
возможностью. Также можно указать особую форму выбора для поля <span class="Term">Склад</span> того же отчета.</p>

<p class="MsoNormalCxSpLast">Подробнее о
параметрах ввода можно посмотреть во встроенной справке.</p>

<a id="TI000000638" class="bookmark" name="issogl2_10.10.2_использование_в_отчетах_свойств_объектов_метаданных"><h3>10.10.2. Использование в отчетах свойств объектов метаданных</h3></a>

<p class="MsoNormalCxSpFirst">Если в
схеме компоновки данных используется набор данных – запрос, то для полей
запроса из объектов метаданных получается информация о параметрах ввода и некоторых
параметрах оформления. Таким образом, если в схеме компоновки данных не указан
некоторый параметр ввода или вывода, то его значение будет автоматически
получаться из соответствующего объекта метаданных.</p>

<p class="MsoNormalCxSpLast">Из объекта
метаданных получаются следующие параметры ввода:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
маска,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
связи параметров выбора,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
связь по типу,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
элемент связи по типу,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
форма выбора,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
формат редактирования,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
быстрый выбор.</p>

<p class="MsoNormal">Кроме того, из
объекта метаданных получаются следующие параметры вывода:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
формат,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
выделять отрицательные,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
многострочный режим.</p>

<a name="_ref384125579"></a><a id="TI000000639" class="bookmark" name="issogl2_10.10.3_фоновое_выполнение_отчетов"><h3>10.10.3. Фоновое выполнение отчетов</h3></a>

<p class="MsoNormalCxSpFirst">При эксплуатации системы могут возникать
ситуации, когда отчеты формируются долго. При этом желательно, чтобы пользователь
во время выполнения такого длительного отчета имел возможность выполнять другие
операции с системой. Такую возможность предоставляет механизм фонового выполнения
отчетов (с использованием механизма фоновых заданий).</p>

<p class="MsoNormalCxSpLast">Автоматически создаваемая форма отчета
использует фоновое выполнение отчета в клиент-серверном варианте работы системы,
а в файловом варианте – непосредственное формирование отчета. Если в
клиент-серверном варианте работы не требуется фоновое выполнения отчета, то можно
использовать метод расширения формы отчета <span class="Term">СкомпоноватьРезультат()</span>,
указав в качестве параметра признак непосредственного формирования отчета.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СкомпоноватьРезультат<span class="operator">(</span>РежимКомпоновкиРезультата<span class="operator">.</span>Непосредственно<span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">Если во время фонового выполнения отчета
будет выполнено интерактивное изменение пользовательских настроек, интерактивное
изменение или выбор варианта отчета, то выполнение отчета будет прекращено, а табличный
документ будет отображаться более светлыми цветами.</p>

<p class="MsoNormalCxSpMiddle">Если во время фонового выполнения будет
закрыта форма отчета, то выполнение отчета будет прекращено автоматически, даже
если в обработчике события формы отчета <span class="Term">ПередЗакрытием</span>
параметру <span class="Term">СтандартнаяОбработка</span> будет присвоено значение <span class="Term">Ложь</span>.
Остановка выполнения отчета (и соответствующего фонового задания) происходит
после вызова обработчика события формы отчета <span class="Term">ПриЗакрытии</span>.</p>

<p class="MsoNormalCxSpMiddle">При формировании отчета могут возникать
различные ошибки, например, отчет может занять больше оперативной памяти, чем
установлено в ограничениях сервера. В этом случае будет сформировано
исключение. Рекомендуется исключения, которые могут формироваться во время
формирования отчета, отображать пользователю, а не игнорировать.</p>

<p class="MsoNormalCxSpMiddle">Фоновое выполнение отчета может
сопровождаться отображением окна состояния. Окно состояния будет формироваться,
если это разрешено (свойство расширения формы отчета <span class="Term">РежимАвтоОтображенияСостояния</span>)
и если отчет выполняется дольше 2 секунд (4 секунды в режиме низкой скорости
соединения). Для отображения состояния отчета система компоновки данных использует
свойство <span class="Term">ОтображениеСостояния</span> поля табличного
документа. Если отчет сформировался за указанное время, то состояние не
отображается и сразу отображается результат.</p>

<p class="MsoNormalCxSpMiddle">Проверка завершения формирования отчета
выполняется клиентским приложением с определенной периодичностью. При этом
интервал между каждой следующей проверкой в 1,4 раза длиннее предыдущего (но не
длиннее 20 секунд).</p>

<p class="MsoNormalCxSpLast">Для управления возможностью отображения
состояния отчета предназначено свойство расширения формы отчета <span class="Term">РежимАвтоОтображенияСостояния</span>.
Свойство определяет, каким образом табличный документ, который отображает результат
работы отчета, будет отображать состояние отчета. По умолчанию (например, для
автоматически генерируемой формы) значение данного свойства равно <span class="Term">Авто</span>.
Это означает, что окно состояния будет отображать информацию и о неактуальности
отчета, и о том, что выполняется формирование отчета.</p>

<a name="_ref364156029"></a><a name="_ref364156028"></a><a name="_ref322715686"></a><a name="_ref322715685"></a><a name="_ref310422555"></a><a name="_ref310422554"></a><a name="_ref370310930"></a><a id="TI000000640" class="bookmark" name="issogl1_10.11.особенности_использования_системы_компоновки_данных"><h2>10.11.Особенности использования системы компоновки данных</h2></a>

<p class="MsoListBulletCxSpFirst">&#9679; 
В системе компоновки данных запрещено использовать
в качестве пути к данным имена, равные ключевым словам: <span class="Term">ВЫБОР</span>, <span class="Term">КОГДА</span>,
<span class="Term">ТОГДА</span>, <span class="Term">ИНАЧЕ</span>, <span class="Term">КОНЕЦ</span>,
<span class="Term">ЕСТЬ</span>, <span class="Term">НЕ</span>, <span class="Term">ПОДОБНО</span>,
<span class="Term">СПЕЦСИМВОЛ</span>, <span class="Term">РАЗЛИЧНЫЕ</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если у параметра – стандартный период дата
начала или дата окончания содержит пустую дату, считается, что вложенные
параметры <span class="Term">ДатаНачала</span> и <span class="Term">ДатаОкончания</span> не установлены. То есть если у
параметра <span class="Term">Период</span> дата начала
содержит пустую дату, то параметр <span class="Term">Период.ДатаНачала</span>
считается неустановленным. Аналогично для параметра <span class="Term">Период.ДатаОкончания</span> и даты окончания периода.
Соответственно, неустановленными считаются параметры, в выражениях которых используются
параметры <span class="Term">Период.ДатаНачала</span>
и <span class="Term">Период.ДатаОкончания</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Считается некорректным запрос, в котором указано
ключевое слово <span class="Term">РАЗЛИЧНЫЕ</span>
и в предложении <span class="Term">УПОРЯДОЧИТЬ ПО</span>
указано выражение, отсутствующее в списке выборки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Запрещена группировка по полям-реквизитам полей-периодов.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если у пользователя отсутствует право на
интерактивный просмотр объекта метаданных, то система компоновки считает
недоступными все поля таблицы объекта.</p>

<p class="Indentlist">Допустим, в
качестве набора данных используется следующий запрос:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> 
    Док<span class="operator">.</span>Ссылка<span class="operator">.</span>Дата<span class="operator">,</span> 
    Док<span class="operator">.</span>Ссылка<span class="operator">.</span>Номер<span class="operator">,</span>
    Док<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    Остатки<span class="operator">.</span>Остаток
    <span class="keyword">ИЗ</span> Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Док
ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления<span class="operator">.</span>УчетНоменклатуры<span class="operator">.</span>Остатки Остатки
    <span class="keyword">ПО</span> Док<span class="operator">.</span>Номенклатура <span class="operator">=</span> Остатки<span class="operator">.</span>Номенклатура</pre>

<p class="Indentlist">Если у пользователя
нет интерактивных прав на таблицу <span class="Term">РасходнаяНакладная</span>
или <span class="Term">РасходнаяНакладная.Состав</span>,
то ему не будут доступны поля <span class="Term">Дата</span>,
<span class="Term">Номер</span>, <span class="Term">Номенклатура</span>. Если нет прав на таблицу <span class="Term">РегистрНакопления.УчетНоменклатуры</span>, то не
будет доступно поле <span class="Term">Остаток</span>.
Если нет права ни на одну таблицу, то не будет доступно ни одно поле.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
В настройках компоновки данных не поддерживается
использование дочерних полей от поля составного типа в том случае, если
пользователь имеет права не на все типы из состава составного типа и дочернее
поле выбирается из списка полей того типа, на который у текущего пользователя
нет прав доступа.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При генерации макета компоновки данных из
предопределенных макетов удаляются выражения расшифровки, которые содержат
поля, недоступные по функциональным опциям.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Поле иерархического набора данных, с которым
осуществляется связь, должно иметь имя, как у поля в наборе данных – источнике.
В противном случае из иерархического набора данных не будут получаться
поля-реквизиты.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если в запросе набора данных в списке выборки
получается выражение, которое представляет собой применение функции <span class="Term">ПРЕДСТАВЛЕНИЕ()</span> к выражению, получаемому в
другом поле, то при автоматическом заполнении доступных полей поле, в котором
получается представление, не будет доступным для использования в настройках.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При выполнении компоновки данных будет выдана
ошибка, если выполняется группировка по вычисляемому полю, и в группировке
указана необходимость дополнения в периоде.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В макетах группировки системы компоновки данных
автоотступ выполняется только для верхней левой ячейки макета.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При использовании в системе компоновки данных
пакетного запроса, поля, которые не используются в последующих запросах пакета,
удаляются из списка выборки и полей группировки. Если запрос, формирующий
временную таблицу, не содержит в себе ни одного поля – такой запрос
удаляется из пакетного запроса. Также из результирующего макета компоновки
данных исключаются наборы данных, из которых не используется ни одно поле. Чтобы
исключить подобное удаление полей, следует либо использовать это поле или
установить флажок <span class="Interface">Обязательное</span> в роли поля схемы компоновки данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если поля временной таблицы, создаваемой в
запросе пакетного запроса системы компоновки данных, не используются последующими
запросами пакетного запроса, а также если создаваемая временная таблица не
находится в обязательных соединениях, то запрос, создающий временную таблицу,
удаляется из пакетного запроса макета компоновки данных.</p>

<p class="Indentlist">Допустим, в
качестве набора данных используется следующий запрос:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Товар
ПОМЕСТИТЬ 
    ВременнаяТаблица
<span class="keyword">ИЗ</span> РегистрНакопления<span class="operator">.</span>Продажи
СГРУППИРОВАТЬ <span class="keyword">ПО</span> Товар
<span class="operator">;</span>
<span class="keyword">ВЫБРАТЬ</span> Склад<span class="operator">,</span> Товар
<span class="keyword">ИЗ</span> РегистрНакопления<span class="operator">.</span>Остатки ЛЕВОЕ СОЕДИНЕНИЕ ВременнаяТаблица <span class="keyword">ПО</span> <span class="keyword">ИСТИНА</span></pre>

<p class="Indentlist">Если в настройках
компоновки данных не будет задействовано поле <span class="Term">Товар</span>,
то первый запроса пакета удаляться не будет, т. к. таблица <span class="Term">ВременнаяТаблица</span> находится в обязательном
соединении.</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
При выводе результатов компоновки данных в
коллекцию значений, поля различных группировок, ссылающихся на одно поле
компоновки данных, попадают в одну колонку коллекции.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При использовании в запросе набора данных
системы компоновки данных с автоматическим заполнением доступных настроек
конструкции <span class="Term">ОБЪЕДИНИТЬ</span> или <span class="Term">ОБЪЕДИНИТЬ ВСЕ</span>, и накладывании отбора на
реквизит поля, отбор применяется только в тех частях объединения, в которых
данный реквизит существует. При применении отбора к полю, отбор применяется
только в тех частях, где выражение поля не <span class="Term">NULL</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При формировании списка доступных полей
учитывается привилегированный режим работы в случае использования из
встроенного языка. Если требуется, чтобы состав доступных полей учитывал права
доступа пользователя, но при этом в результат компоновки попадали все данные,
то рекомендуется выполнять компоновку макета компоновки данных в обычном (не
привилегированном режиме), а саму компоновку данных выполнять в
привилегированном режиме.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Во время вычисления выражений системы компоновки
данных происходит переход в безопасный режим (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref378761017">здесь</a>).</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
При использовании в запросе системы компоновки
данных полей табличных частей, полученных через точку от других полей,
рекомендуется явно указывать псевдонимы для табличных частей и ее вложенных
полей. В противном случае возможны проблемы с доступностью полей при компоновке
макета компоновки данных.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если необходимо обеспечить отбор по реквизиту <span class="Term">ВерсияДанных</span> или <span class="Term">ИмяПредопределяемыхДанных</span> некоторого поля, с
видом сравнения отличным от равно/не равно, заполнено/не заполнено, больше (или
равно)/меньше (или равно), в списке/не в списке, то нужно обеспечить
доступность данного поля для выбора, а не только доступность для использования
в отборе.</p>

<p class="MsoNormalCxSpFirst"> </p>

<br>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>