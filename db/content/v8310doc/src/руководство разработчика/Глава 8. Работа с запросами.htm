<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
		<title>&#1043;&#1083;&#1072;&#1074;&#1072; 8. &#1056;&#1072;&#1073;&#1086;&#1090;&#1072; &#1089; &#1079;&#1072;&#1087;&#1088;&#1086;&#1089;&#1072;&#1084;&#1080;</title>
		<LINK REL="stylesheet" href="style.css?_=1496848987">
		<SCRIPT src="script.js?_=1496848987" TYPE="text/javascript"></script>		<!--[if !IE]>--><SCRIPT src="zeroclipboard.js?_=1496848987" TYPE="text/javascript"></script><!--<![endif]-->
	<meta name="robots" content="noarchive">
<meta name="googlebot" content="noarchive">
<link href="/db/content/v8310doc/src/руководство разработчика/глава 8. работа с запросами.htm" rel="canonical">
<link href="/static/its.content.css?_=1490872753" type="text/css" rel="stylesheet">
<script type="text/javascript" src="/static/its.content.js?_=1489758009"></script>
<!--[if lt IE 9]><script type="text/javascript" src="/static/html5shiv.js?_=1484636606"></script><![endif]-->

</head>
	<body class="v8310doc">
<a name="_ref422907131"></a><a name="_ref380403500"></a><a name="_ref237783412"></a><a id="TI000000453" class="bookmark"><h1>Глава 8.  Работа с запросами</h1></a>

<a id="TI000001743" class="bookmark" name="issogl1_8.1_общая_информация"><h2>8.1. Общая информация</h2></a>

<p class="MsoNormal">Для формирования и выполнения запросов к
таблицам базы данных в системе используется специальный объект <span class="Term">Запрос</span>.
Запрос удобно использовать, когда необходимо получить сложную выборку данных,
сгруппированную и отсортированную нужным образом. Одним из классических примеров
его применения может служить сводка по состоянию регистра учета на определенный
момент времени. Кроме того, механизм запросов позволяет легко получать
информацию в различных временных разрезах.</p>

<a name="_ref300323438"></a><a id="TI000000454" class="bookmark" name="issogl1_8.2_источники_данных_таблицы_запросов"><h2>8.2. Источники данных (таблицы) запросов</h2></a>

<p class="MsoNormalCxSpFirst">В качестве источников данных языка запросов
выступают таблицы базы данных. Таблицы подразделяются на два основных класса:
реальные и виртуальные.</p>

<p class="MsoNormalCxSpMiddle">Реальные таблицы хранятся в базе данных, то
есть интерпретируются из реально существующей таблицы базы данных. В случае
использования реальной таблицы могут присутствовать вычисляемые поля, значения
которых вычисляются как функция нескольких реальных полей.</p>

<p class="MsoNormalCxSpMiddle">Виртуальные таблицы не хранятся в базе
данных. При обращении к информации виртуальных таблиц система автоматически
собирает информацию реальных таблиц базы данных для выполнения запроса.
Виртуальная таблица может быть параметризована, то есть реальное наполнение
виртуальной таблицы может определяться значениями параметров, фактические
значения которых задаются в тексте запроса. Для каждой виртуальной таблицы
определяется имя, которое используется в запросах для идентификации таблицы.</p>

<p class="MsoNormalCxSpMiddle">Имя таблицы может быть задано на английском и
русском языках. Например, <span class="Term">Справочник.Товары</span>.
Имена таблиц и полей не могут совпадать с ключевыми словами языка запросов.</p>

<p class="MsoNormalCxSpMiddle">Отдельный подкласс таблиц образуют так
называемые объектные таблицы. В качестве объектной таблицы обязательно выступает
реальная таблица базы данных. Смысловое отличие объектных таблиц от прочих
следует из названия – объектные таблицы предназначены для хранения
состояния объектов системы «1С:Предприятие», таких как справочники, документы и т. п.
Каждой объектной таблице соответствует тип объектов системы «1С:Предприятие».
Например, объектам типа <span class="Term">Справочник.Товары</span>
соответствует одна таблица, объектам типа <span class="Term">Справочник.Контрагенты</span> –
другая. Каждая отдельная запись объектной таблицы хранит состояние отдельного
объекта соответствующего типа. В соответствии с этим у каждой объектной таблицы
определено поле типа <span class="Term">Cсылка</span>
на текущую запись. Кроме того, для объектных таблиц определен способ получения
пользовательского представления объекта из содержимого полей записи.</p>

<p class="MsoNormalCxSpMiddle">Объектные таблицы могут быть также
иерархическими. Для иерархических таблиц определяется специально выделенное
поле <span class="Term">Родитель</span>, содержащее ссылку на запись, которой
в соответствии с иерархией подчиняется текущая запись.</p>

<p class="MsoNormalCxSpMiddle">В качестве поля таблицы может фигурировать поле
таблицы или вложенная таблица. Основное отличие обычного поля от вложенной
таблицы состоит в том, что в рамках одной записи обычному полю соответствует
одно-единственное значение, а вложенной таблице соответствует значение типа <span class="Term">РезультатЗапроса</span>
с заранее заданным набором колонок. Примером вложенной таблицы может являться
табличная часть документа или справочника.</p>

<p class="MsoNormalCxSpLast">В качестве типов значения полей таблиц может
выступать значение типа <span class="Term">NULL</span>.
Такие значения содержатся в полях записей таблиц, для которых данное поле не
определено или не имеет смысла. Например, значения такого типа содержатся в
записях, относящихся к группам справочника, по полям, для которых установлено,
что они могут иметь значение только у элементов этого справочника.</p>

<a name="_ref437600210"></a><a id="TI000001778" class="bookmark" name="issogl1_8.3_виртуальные_и_обычные_поля"><h2>8.3. Виртуальные и обычные поля</h2></a>

<p class="MsoNormal">Обычное поле – поле, которое формируется
из данных, которые хранятся в СУБД, при этом данные могут быть дополнительно
обработаны средствами СУБД. Виртуальное поле – поле, которое формируется
из данных, которые хранятся в СУБД, но данные дополнительно обработаны
средствами сервера «1С:Предприятия» (в том числе в файловом варианте).
Следующие поля в таблицах запросов являются виртуальными:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Поля представлений, полученных как с помощью
поля <span class="Term">Представление</span> соответствующей таблицы, так и с
помощью функции языка запросов.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ВерсияДанных</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ИмяПредопределенныхДанных</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">МоментВремени</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ТипЗначения</span> таблицы плана видов характеристик;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Вид</span> таблицы плана счетов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Тип</span> таблицы журнала документов;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ВидДвижения</span> таблицы регистра бухгалтерии;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ВидДвижения</span> таблицы регистра накопления;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
любые поля со значениями следующих типов: <span class="Term">ХранилищеЗначения</span>,
<span class="Term">УникальныйИдентификатор</span> и ссылка внешнего
источника данных.</p>

<p class="MsoNormal">Виртуальные поля имеют следующие особенности:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Не все виртуальные поля можно преобразовать «обратно»
в значение, хранящееся в СУБД. Такими полями являются поля представления и поле
<span class="Term">ТипЗначения</span> для таблицы плана видов
характеристик.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Не все виртуальные поля с одинаковым
наименованием можно сравнивать между собой, если они получены из различных
таблиц. Такими полями являются <span class="Term">ВерсияДанных</span>,
<span class="Term">ИмяПредопределенныхДанных</span>, <span class="Term">МоментВремени</span>,
<span class="Term">Тип</span> таблицы журнала документов.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если в поле запроса получается значение системного
перечисления (ссылки на таблицу внешних источников данных или уникального
идентификатора), и полученное значение не комбинируется с другими типами, то
при использовании в запросе операции <span class="Term">СГРУППИРОВАТЬ
ПО</span> значения этого поля группируются вне зависимости, от того, из
каких таблиц получается значение.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Для виртуальных полей строкового типа не
поддерживается использование операций работы со строками и сравнение с данными
типа <span class="Term">Строка</span>.</p>

<a name="_ref331069975"></a><a name="_ref216234624"></a><a name="_ref214945083"></a><a id="TI000000455" class="bookmark" name="issogl1_8.4_язык_запросов"><h2>8.4. Язык запросов</h2></a>

<a id="TI000001914" class="bookmark" name="issogl2_8.4.1_общая_информация"><h3>8.4.1. Общая информация</h3></a>

<p class="MsoNormalCxSpFirst">Как было описано выше, для выполнения запроса
необходимо составить текст запроса. Текст запроса – это инструкция, в соответствии
с которой должен быть выполнен запрос. В тексте запроса описывается, какие
таблицы информационной базы используются в качестве источников данных запроса,
поля таблиц, которые требуется обрабатывать в запросе, правила группировки,
сортировки результатов и т. д.</p>

<p class="MsoNormalCxSpLast">Инструкция составляется на специальном языке
(языке запросов) и состоит из отдельных частей – секций, предложений,
слов, функций и комментариев. Далее в этой главе рассматривается назначение и
способы использования всех конструкций языка запросов.</p>

<a id="TI000000456" class="bookmark" name="issogl2_8.4.2_синтаксическая_диаграмма_конструкций_языка_запросов"><h3>8.4.2. Синтаксическая диаграмма конструкций языка запросов</h3></a>

<p class="MsoNormalCxSpFirst">В данной главе синтаксис языка запросов описывается
при помощи набора правил. Каждое правило описывает одну конструкцию языка.</p>

<p class="MsoNormalCxSpLast">Каждая конструкция языка может содержать в себе ключевые
слова; разделители (точки, запятые, круглые скобки), в свою очередь, другие
конструкции языка.</p>

<p class="Lang-subheader">&lt;Конструкция языка&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ЭТО_КЛЮЧЕВОЕ_СЛОВО
&lt;Это_конструкция_языка&gt;, &lt;Это_конструкция_языка&gt;
ЭТО_ФУНКЦИЯ ( &lt;Это_конструкция_языка&gt; )
</pre>

<p class="MsoNormalCxSpFirst">В правилах, описывающих язык запросов, конструкции
языка указываются в угловых скобках. Ключевые слова и названия функций
описываются заглавными буквами.</p>

<p class="MsoNormalCxSpLast">Конструкции языка могут содержать необязательные
элементы – ключевые слова и пр. В правилах, описывающих язык запросов,
необязательные элементы заключены в квадратные скобки.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
[ЭТО_НЕОБЯЗАТЕЛЬНОЕ_СЛОВО]
[&lt;Это_необязательная_конструкция&gt;]
</pre>

<p class="MsoNormal">В некоторых случаях в конструкции языка может использоваться
один из нескольких альтернативных элементов. Такие элементы в правилах
перечисляются через вертикальную черту.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ЛИБО_ЭТО_СЛОВО | ЛИБО_ЭТО_СЛОВО
&lt;Либо_эта_конструкция&gt; | &lt;Либо_эта_конструкция&gt;
</pre>

<p class="MsoNormal">Описания всех конструкций сопровождаются примерами,
поясняющими порядок их использования в языке запросов.</p>

<a id="TI000000457" class="bookmark" name="issogl2_8.4.3_комментарии_в_языке_запросов"><h3>8.4.3. Комментарии в языке запросов</h3></a>

<p class="MsoNormal">Текст запроса может включать комментарии. Комментарием считается
часть строки, начинающаяся с последовательности символов // и продолжающаяся до
конца строки.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Это комментарий</span></pre>

<p class="MsoNormal">При выполнении запроса комментарии игнорируются.</p>

<p class="Note"><span class="Note">Примечание.</span> Конструктор запросов
удаляет комментарии из текста.</p>

<a name="_ref219028495"></a><a id="TI000000458" class="bookmark" name="issogl2_8.4.4_использование_предопределенных_данных_конфигурации"><h3>8.4.4. Использование предопределенных данных конфигурации</h3></a>

<p class="MsoNormal">Текст запроса может содержать предопределенные данные
конфигурации, такие как:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
значения перечислений,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
предопределенные данные:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
справочников,</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
планов видов характеристик,</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
планов счетов,</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
планов видов расчетов,</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
пустые ссылки,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
значения точек маршрута бизнес-процессов.</p>

<p class="MsoNormalCxSpFirst">Также текст запроса может содержать значения системных
перечислений, которые могут быть присвоены полям в таблицах базы данных: <span class="Term">ВидДвиженияНакопления</span>,
<span class="Term">ВидСчета</span>
и <span class="Term">ВидДвиженияБухгалтерии</span>.</p>

<p class="MsoNormalCxSpLast">Обращение в запросах к предопределенным данным конфигурации
и значениям системных перечислений осуществляется с помощью литерала
функционального типа.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ЗНАЧЕНИЕ<span class="operator">(</span><span class="operator">&lt;</span>ПредставлениеЗначения<span class="operator">&gt;</span><span class="operator">)</span></pre>

<p class="MsoNormal">Для системных перечислений представление значения имеет вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="operator">&lt;</span>ИмяСистемногоПеречисления<span class="operator">&gt;</span><span class="operator">.</span><span class="operator">&lt;</span>Значение<span class="operator">&gt;</span></pre>

<p class="MsoNormalCxSpFirst">Допустимые имена системных перечислений приведены выше,
с перечнем допустимых для каждого из них значений можно ознакомиться в его
описании.</p>

<p class="MsoNormalCxSpLast">Для предопределенных данных конфигурации представление
значения имеет вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="operator">&lt;</span>ТипПредопределенногоЗначения<span class="operator">&gt;</span><span class="operator">.</span><span class="operator">&lt;</span>ИмяОбъектаМетаданных<span class="operator">&gt;</span><span class="operator">.</span><span class="operator">&lt;</span>Значение<span class="operator">&gt;</span></pre>

<p class="MsoNormal">Тип предопределенного значения может быть:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Справочник</span> (<span class="Term">Catalog</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПланВидовХарактеристик</span> (<span class="Term">ChartOfCharacteristicTypes</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПланСчетов</span> (<span class="Term">ChartOfAccounts</span>);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">ПланВидовРасчета</span> (<span class="Term">ChartOfCalculationTypes</span>);</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">Перечисление</span> (<span class="Term">Enum</span>).</p>

<p class="MsoNormalCxSpFirst">В качестве имени объекта метаданных указывается имя
объекта метаданных, как оно задано в конфигураторе.</p>

<p class="MsoNormalCxSpMiddle">Для определенных в конфигурации перечислений значение
указывается как имя соответствующего объекта метаданных типа <span class="Term">ЗначениеПеречисления</span>.
Для всех остальных типов предопределенных значений – как имя предопределенного
элемента данных, как оно указано в конфигураторе, или <span class="Term">ПустаяСсылка</span> (<span class="Term">EmptyRef</span>)
для указания пустой ссылки.</p>

<p class="MsoNormalCxSpLast">Для точек маршрутов бизнес-процессов представление
значения имеет вид:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">БизнесПроцесс<span class="operator">.</span><span class="operator">&lt;</span>ИмяОбъектаМетаданных<span class="operator">&gt;</span><span class="operator">.</span>ТочкаМаршрута<span class="operator">.</span><span class="operator">&lt;</span>ИмяТочкиМаршрута<span class="operator">&gt;</span></pre>

<p class="MsoNormal">Ниже приведено несколько фрагментов запросов, поясняющих
использование предопределенных данных в запросах.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">ГДЕ Город <span class="operator">=</span> ЗНАЧЕНИЕ<span class="operator">(</span>Справочник<span class="operator">.</span>Города<span class="operator">.</span>Москва<span class="operator">)</span>
ГДЕ Город <span class="operator">=</span> ЗНАЧЕНИЕ<span class="operator">(</span>Справочник<span class="operator">.</span>Города<span class="operator">.</span>ПустаяСсылка<span class="operator">)</span>
ГДЕ ТипТовара <span class="operator">=</span> ЗНАЧЕНИЕ<span class="operator">(</span>Перечисление<span class="operator">.</span>ВидыТоваров<span class="operator">.</span>Услуга<span class="operator">)</span>
ГДЕ ВидДвижения <span class="operator">=</span> ЗНАЧЕНИЕ<span class="operator">(</span>ВидДвиженияНакопления<span class="operator">.</span>Приход<span class="operator">)</span>
ГДЕ ТочкаМаршрута <span class="operator">=</span> ЗНАЧЕНИЕ<span class="operator">(</span>БизнесПроцесс<span class="operator">.</span>Согласование<span class="operator">.</span>ТочкаМаршрута<span class="operator">.</span>Согласие<span class="operator">)</span></pre>

<a name="_ref305601932"></a><a id="TI000000459" class="bookmark" name="issogl2_8.4.5_двуязычное_представление_ключевых_слов"><h3>8.4.5. Двуязычное представление ключевых слов</h3></a>

<p class="Regularbeforetable">Одной из существенных особенностей языка запросов
системы «1С:Предприятие» является то, что, как и во встроенном языке, все
ключевые слова имеют два варианта написания: на русском и английском языках.
Далее в этой главе указываются русские варианты написания ключевых слов. Ниже в
таблице приведены соответствия русского и английского вариантов написания ключевых
слов языка запросов.</p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0">
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpFirst"><b>Русское написание</b></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><b>Английское написание</b></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">АВТОУПОРЯДОЧИВАНИЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">AUTOORDER</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">БУЛЕВО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">BOOLEAN</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">В</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">IN</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВНЕШНЕЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">OUTER</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВНУТРЕННЕЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">INNER</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВОЗР</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ASC</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВСЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ALL</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВЫБОР</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">CASE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВЫБРАТЬ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">SELECT</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ВЫРАЗИТЬ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">CAST</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ГДЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">WHERE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ГОД</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">YEAR</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДАТА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DATE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДАТАВРЕМЯ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DATETIME</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЕКАДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">TENDAYS</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЕНЬ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DAY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЕНЬГОДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DAYOFYEAR</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЕНЬНЕДЕЛИ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">WEEKDAY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДЛЯ ИЗМЕНЕНИЯ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">FOR UPDATE [OF]</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ДОБАВИТЬКДАТЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DATEADD</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЕСТЬ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">IS</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЕСТЬNULL</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ISNULL</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЗНАЧЕНИЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">VALUE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">И</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">AND</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИЕРАРХИЯ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">HIERARCHY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИЗ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">FROM</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИЛИ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">OR</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИМЕЮЩИЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">HAVING</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИНАЧЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ELSE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИНДЕКСИРОВАТЬ ПО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">INDEX BY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Истина</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">TRUE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ИТОГИ … ПО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">TOTALS … BY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КАК</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">AS</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КВАРТАЛ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">QUARTER</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КОГДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">WHEN</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КОЛИЧЕСТВО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">COUNT</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КОНЕЦПЕРИОДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ENDOFPERIOD</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">КОНЕЦ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">END</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЛЕВОЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">LEFT</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">Ложь</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">FALSE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">МАКСИМУМ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">MAX</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">МЕЖДУ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">BETWEEN</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">МЕСЯЦ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">MONTH</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">МИНИМУМ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">MIN</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">МИНУТА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">MINUTE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">НАЧАЛОПЕРИОДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">BEGINOFPERIOD</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">НЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">NOT</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">НЕДЕЛЯ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">WEEK</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">НЕОПРЕДЕЛЕНО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">UNDEFINED</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ОБЩИЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">OVERALL</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ОБЪЕДИНИТЬ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">UNION</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПЕРВЫЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">TOP</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПЕРИОДАМИ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">PERIODS</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПОДОБНО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">LIKE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПОЛНОЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">FULL</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПОЛУГОДИЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">HALFYEAR</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПОМЕСТИТЬ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">INTO</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПРАВОЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">RIGHT</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПРЕДСТАВЛЕНИЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">PRESENTATION</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПУСТАЯТАБЛИЦА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">EMPTYTABLE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">РАЗЛИЧНЫЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DISTINCT</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">РАЗРЕШЕННЫЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ALLOWED</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СГРУППИРОВАТЬ ПО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">GROUP BY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СЕКУНДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">SECOND</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СОЕДИНЕНИЕ … ПО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">JOIN … ON</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СПЕЦСИМВОЛ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ESCAPE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ПОДСТРОКА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">SUBSTRING</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СЕКУНДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">SECOND</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СРЕДНЕЕ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">AVG</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ССЫЛКА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">REFS</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СТРОКА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">STRING</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">СУММА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">SUM</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТИП</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">TYPE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТИПЗНАЧЕНИЯ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">VALUETYPE</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТОГДА</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">THEN</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ТОЛЬКО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ONLY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">УБЫВ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DESC</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">УПОРЯДОЧИТЬ ПО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ORDER BY</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЧАС</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">HOUR</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">ЧИСЛО</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">NUMBER</span></p>
  </td>
 </tr>
 <tr>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">УНИЧТОЖИТЬ</span></p>
  </td>
  <td valign="top">
  <p class="MsoNormalCxSpMiddle"><span class="Term">DROP</span></p>
  </td>
 </tr>
</table>

<p class="Note"></a><a name="_toc16323384"><span class="Note">Примечание.</span>
Регистр букв (строчные или заглавные) при написании не имеет значения.</p>

<a id="TI000000460" class="bookmark" name="issogl2_8.4.6_основные_секции_текста_запроса"><h3>8.4.6. Основные секции текста запроса</h3></a>

<p class="MsoNormal">Текст запроса можно описать следующим правилом:</p>

<p class="Lang-subheader"><a name="_&lt;текст_запроса&gt;"></a>&lt;Текст
Запроса&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
&lt;Описание запроса&gt;
[&lt;Объединение запросов&gt;]
[&lt;Упорядочивание результатов&gt;]
[АВТОУПОРЯДОЧИВАНИЕ]
[&lt;Описание итогов&gt;]
</pre>

<p class="MsoNormal">Как видно из этого правила, текст запроса состоит из нескольких
частей, или секций:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Interface">&lt;Описание запроса&gt;</span> –
это единственная обязательная секция в тексте запроса, и во многих случаях
достаточно указать только ее. В секции определяются источники данных запроса,
поля выборки, группировки и т. д. Эта секция, в свою очередь, описывается
целым набором правил и подробно рассматривается ниже.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Interface">&lt;Объединение
запросов&gt;</span> – язык запросов позволяет объединять результаты
выполнения нескольких запросов. Описание объединения запросов см. <a href="#_ref15183231">здесь</a>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
В секции <span class="Interface">&lt;Упорядочивание
результатов&gt;</span> можно определить условия упорядочивания строк в
результате запроса. Описание упорядочивания результата запроса см. <a href="#_ref214882859">здесь</a>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Секция <span class="Term">АВТОУПОРЯДОЧИВАНИЕ</span> позволяет включить режим
автоматического упорядочивания строк в результате запроса. Описание данного
режима см. <a href="#_ref14178650">здесь</a>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
В секции <span class="Interface">&lt;Описание
итогов&gt;</span> можно указать, какие итоги необходимо рассчитывать в запросе.
Описание данной секции см. <a href="#_ref14178205">здесь</a>.</p>

<a name="_ref14176843"></a><a id="TI000000461" class="bookmark" name="issogl2_8.4.7_описание_запроса"><h3>8.4.7. Описание запроса</h3></a>

<a id="TI000001869" class="bookmark" name="issogl3_8.4.7.1_общая_информация"><h4>8.4.7.1. Общая информация</h4></a>

<p class="MsoNormal">Как уже было сказано, в тексте запроса должна обязательно
присутствовать секция описания запроса, в которой определяются:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
поля, которые будут содержаться в результате
запроса;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
источники данных запроса – исходные
таблицы;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
условия, влияющие на выборку данных в запросе;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
порядок группировки результатов запроса.</p>

<p class="MsoNormal">Секция описания запроса состоит из нескольких взаимосвязанных
предложений:</p>

<p class="Lang-subheader"><a name="_&lt;описание_запроса&gt;"></a>&lt;Описание
запроса&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> <span class="operator">[</span>РАЗРЕШЕННЫЕ<span class="operator">]</span> <span class="operator">[</span>РАЗЛИЧНЫЕ<span class="operator">]</span> <span class="operator">[</span>ПЕРВЫЕ <span class="operator">&lt;</span>Количество<span class="operator">&gt;</span><span class="operator">]</span>
    <span class="operator">&lt;</span>Список полей выборки<span class="operator">&gt;</span>
<span class="operator">[</span><span class="keyword">ИЗ</span> <span class="operator">&lt;</span>Список источников<span class="operator">&gt;</span><span class="operator">]</span>
<span class="operator">[</span>ГДЕ <span class="operator">&lt;</span>Условие отбора<span class="operator">&gt;</span><span class="operator">]</span>
<span class="operator">[</span>СГРУППИРОВАТЬ <span class="keyword">ПО</span> <span class="operator">&lt;</span>Поля группировки<span class="operator">&gt;</span><span class="operator">]</span>
<span class="operator">[</span>ИМЕЮЩИЕ <span class="operator">&lt;</span>Условие отбора<span class="operator">&gt;</span><span class="operator">]</span>
<span class="operator">[</span><span class="keyword">ДЛЯ</span> ИЗМЕНЕНИЯ <span class="operator">[</span><span class="operator">&lt;</span>Список таблиц верхнего уровня<span class="operator">&gt;</span><span class="operator">]</span><span class="operator">]</span></pre>

<p class="MsoNormalCxSpFirst"><a name="_&lt;количество&gt;"></a>Описание запроса
начинается с обязательного ключевого слова <span class="Term">ВЫБРАТЬ</span>.</p>

<p class="MsoNormalCxSpMiddle">Ключевое слово <span class="Term">РАЗРЕШЕННЫЕ</span> означает,
что запрос выберет только те записи, на которые у текущего пользователя есть
права. Если данное слово не указать, то запрос отработает с ошибкой, когда он
выберет записи, на которые у пользователя нет прав. Данное ключевое слово может
присутствовать только в предложении <span class="Term">ВЫБРАТЬ</span> верхнего уровня и распространяется на
весь запрос, включая вложенные запросы. Следует
учитывать, что использование ключевого слова <span class="Term">РАЗРЕШЕННЫЕ</span>
оказывает влияние на работу только в том случае, если на таблицы наложены
ограничения доступа к данным (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 5. объекты конфигурации.htm?_=1496848987#_ref73775184">здесь</a>). Права доступа на саму таблицу не учитываются при
использовании ключевого слова <span class="Term">РАЗРЕШЕННЫЕ</span>.
Например, если на таблицу отсутствует право <span class="Term">ЧТЕНИЕ</span>,
то запрос с использованием такой таблицы, будет выполнен с ошибкой вне
зависимости от использования в запросе ключевого слова <span class="Term">РАЗРЕШЕННЫЕ</span>.</p>

<p class="MsoNormalCxSpMiddle">С помощью ключевого слова <span class="Term">РАЗЛИЧНЫЕ</span> можно указать,
что в результат не должны попадать повторяющиеся строки.</p>

<p class="MsoNormalCxSpMiddle">Конструкция <span class="Term">ПЕРВЫЕ &lt;Количество&gt;</span>
позволяет задать предельное количество строк в результате запроса. Будут отобраны
самые первые (в соответствии с правилами упорядочивания результатов запроса) строки.
Количество задается целым числом. В языке запросов добавлена возможность исполнения
упорядочивания во вложенных запросах в случае, если вложенный запрос содержит
конструкцию <span class="Term">ПЕРВЫЕ</span>.</p>

<p class="MsoNormalCxSpMiddle">В секции <span class="Term">&lt;Список полей выборки&gt;</span> описываются поля,
которые должны содержаться в результате запроса (правила описания полей выборки
см. <a href="#_ref214882988">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">В предложении <span class="Term">ИЗ &lt;Список источников&gt;</span>
указываются источники данных – таблицы информационной базы, содержимое
которых обрабатывается в запросе. Описание источников может быть опущено только
в том случае, если они полностью определены в списке полей выборки (правила
описания источников данных запроса см. <a href="#_ref214883007">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Предложение <span class="Term">ГДЕ &lt;Условие отбора&gt;</span>
позволяет отфильтровать результат запроса. В результат попадают только те записи,
для которых указанное условие оказывается истинным (правила описания условий
отбора см. <a href="#_ref15212776">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Предложение <span class="Term">СГРУППИРОВАТЬ</span>
позволяет описать порядок группировки результатов запроса (см. <a href="#_ref14185884">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Предложение <span class="Term">ИМЕЮЩИЕ</span> позволяет
накладывать условия на результаты группировки (см. <a href="#_ref214883064">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Предложение <span class="Term">ДЛЯ ИЗМЕНЕНИЯ</span>
предназначено для указания необходимости блокировки считываемых в транзакции
данных. Считанные данные становятся недоступными для чтения в других сессиях.
Для файлового варианта блокируются указанные таблицы, а для клиент-серверного
варианта – только выбранные записи. Блокировка снимается после завершения транзакции.</p>

<p class="MsoNormalCxSpMiddle">Во всех примерах запросов в данной главе
приводится текст запроса и результат запроса. Подразумевается, что текст запроса
передается в качестве параметра методу <span class="Term">Выполнить()</span> объекта <span class="Term">Запрос</span>.</p>

<p class="MsoNormalCxSpLast">Приведем пример достаточно простого запроса, состоящего
из одного оператора <span class="Term">ВЫБРАТЬ</span>
и списка полей выборки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// В отчет необходимо вывести список товарных накладных.</span>
<span class="keyword">Выбрать</span>
Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Ссылка</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00317.gif?_=1496848987" WIDTH="353" ALT HEIGHT="368"></p>

<p class="MsoCaption">Рис. 318. Результат запроса</p>

<a id="TI000000462" class="bookmark" name="issogl3_8.4.7.2_использование_слова_различные"><h4>8.4.7.2. Использование слова «РАЗЛИЧНЫЕ»</h4></a>

<p class="MsoNormal">Во многих ситуациях желательно, чтобы одинаковые строки в
отчете не повторялись.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Необходимо узнать, каким вообще контрагентам</span>
<span class="comment">// отгружался товар за период.</span>
<span class="keyword">Выбрать</span>
Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Контрагент</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00318.gif?_=1496848987" WIDTH="353" ALT HEIGHT="368"></p>

<p class="MsoCaption">Рис. 319. Результат запроса</p>

<p class="MsoNormal">Видно, что в результате запроса много повторяющихся строк,
что снижает его наглядность. Чтобы избежать повторений, в описании запроса
следует указать ключевое слово <span class="Term">РАЗЛИЧНЫЕ</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Выбрать</span> Различные
Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Контрагент</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00319.gif?_=1496848987" WIDTH="353" ALT HEIGHT="244"></p>

<p class="MsoCaption">Рис. 320. Результат запроса</p>

<a id="TI000000463" class="bookmark" name="issogl3_8.4.7.3_использование_слова_первые"><h4>8.4.7.3. Использование слова «ПЕРВЫЕ»</h4></a>

<p class="MsoNormal">В некоторых случаях необходимо вывести в отчет ограниченное
количество строк. Для этого в описании запроса следует указать ключевое слово <span class="Term">ПЕРВЫЕ</span>
и после него – требуемое количество строк.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Необходимо отобрать пять самых дорогих товаров.</span>
<span class="comment">// Выборка должна осуществляться в порядке убывания цены товара.</span>
<span class="keyword">Выбрать</span> Первые <span class="number">5</span>
Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>ЗакупочнаяЦена
Упорядочить <span class="keyword">По</span>
Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>ЗакупочнаяЦена Убыв</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref14181896"></a><IMG src="_img/img00320.gif?_=1496848987" WIDTH="385" ALT HEIGHT="115"></p>

<p class="MsoCaption">Рис. 321. Результат запроса</p>

<a name="_ref214882988"></a><a name="_ref397081513"></a><a name="_ref397081512"></a><a id="TI000000464" class="bookmark" name="issogl2_8.4.8_описание_полей_выборки"><h3>8.4.8. Описание полей выборки</h3></a>

<p class="MsoNormal">После обязательного ключевого слова <span class="Term">ВЫБРАТЬ</span> (и уточняющих
слов <span class="Term">РАЗЛИЧНЫЕ</span>
и <span class="Term">ПЕРВЫЕ</span>)
в тексте запроса задается список полей выборки. Эти поля будут обрабатываться
при выборке данных в запросе. Результат запроса также будет иметь набор полей,
определенный в данном списке. Поля выборки описываются по следующим правилам:</p>

<p class="Lang-subheader"><a name="_&lt;список_полей_выборки&gt;"></a>&lt;Список полей выборки&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Поле выборки&gt;[, &lt;Поле выборки&gt;[, …]] | *</pre>

<p class="Lang-subheader"><a name="_&lt;элемент_выборки&gt;"></a>&lt;Поле
выборки&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Описание поля&gt; | &lt;Логическое выражение&gt; [[КАК] &lt;Псевдоним поля&gt;]</pre>

<p class="Lang-subheader">&lt;Описание поля&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Выражение&gt;[.&lt;Группа полей&gt;]|&lt;Описание пустой таблицы&gt;</pre>

<p class="Lang-subheader">&lt;Описание пустой таблицы&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ПУСТАЯТАБЛИЦА.(&lt;Список псевдонимов&gt;)</pre>

<p class="Lang-subheader">&lt;Список псевдонимов&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">[&lt;Псевдоним поля&gt;][,&lt;Список псевдонимов&gt;]</pre>

<p class="MsoNormalCxSpFirst"><a name="_&lt;псевдоним_поля&gt;"></a>Список полей
выборки состоит из одного или нескольких элементов, которые разделены запятыми.
Каждое поле выборки состоит из описания поля выборки и необязательного псевдонима
поля.</p>

<p class="MsoNormalCxSpLast">Вместо перечисления полей в списке выборки можно указать
звездочку (<span class="Term">*</span>).
Это будет означать, что результат запроса должен содержать все поля, которые
есть в исходных таблицах – источниках данных запроса, описанных в списке источников.</p>

<p class="NoteCxSpFirst"><span class="Note">Примечание 1.</span> При указании
звездочки (<span class="Term">*</span>)
в списке полей выборки в результат не включаются виртуальные поля исходных
таблиц.</p>

<p class="NoteCxSpLast"><span class="Note">Примечание 2.</span> Получение
выборок очень большого размера (более <span class="Bold">64 Мб</span>) требует
наличия достаточного количества свободного места на диске, используемом для размещения
временных файлов сервера и клиента.</p>

<p class="MsoNormalCxSpFirst"><a name="_ref14353769"></a>Описание поля определяет,
каким образом должны формироваться значения поля. В простейшем случае поле выборки
является ссылкой на поле исходной таблицы. Ссылка может задаваться с указанием
таблицы, содержащей это поле, или без указания самой таблицы. Разыменование
полей см. <a href="#_ref15295173">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">В общем
случае поле выборки может представлять собой не только ссылку на поле исходной
таблицы, а некоторое выражение (подробнее см. <a href="#_ref397081585">здесь</a>) или логическое выражение (см. <a href="#_ref397081526">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Результаты
запроса могут быть сгруппированы (см. <a href="#_ref14185884">здесь</a>) с помощью агрегатных функций (см. <a href="#_ref14592889">здесь</a>), указанных в качестве выражений в полях выборки.</p>

<p class="MsoNormalCxSpMiddle">Каждому
полю выборки может быть назначен псевдоним (см. <a href="#_ref14429640">здесь</a>). В дальнейшем псевдоним поля может использоваться
для более удобного обращения к данному полю.</p>

<p class="MsoNormalCxSpLast">Группа полей
может указываться только тогда, когда поле выборки указывает на вложенную
таблицу (см. <a href="#_ref14273121">здесь</a>). В этом случае можно указать, какие поля должны
обрабатываться в выборке по вложенной таблице. Если группа полей не указана, в
выборке будут обрабатываться все поля вложенной таблицы.</p>

<a name="_ref14429640"></a><a id="TI000000465" class="bookmark" name="issogl3_8.4.8.1_псевдонимы_полей_в_списке_выборки"><h4>8.4.8.1. Псевдонимы полей в списке выборки</h4></a>

<p class="MsoNormalCxSpFirst">Если полю выборки назначить псевдоним, то в дальнейшем
к этому полю можно будет обращаться, используя его псевдоним, в предложениях <span class="Term">УПОРЯДОЧИТЬ ПО</span>
и <span class="Term">ИТОГИ</span>,
а также при работе с результатом запроса. Такое обращение может быть более
удобным и наглядным, а в некоторых случаях единственно возможным.</p>

<p class="MsoNormalCxSpMiddle">Ключевое слово <span class="Term">КАК</span> может
предшествовать псевдониму поля. Это слово можно не указывать вообще, но если
оно указано, повышается наглядность и удобочитаемость текста запроса.</p>

<p class="MsoNormalCxSpMiddle">Псевдонимы полей задаются в соответствии с
правилами назначения идентификаторов переменных. Псевдонимы в запросе не могут
совпадать.</p>

<p class="MsoNormalCxSpLast">Назначение псевдонимов полям само по себе никак не
влияет на выборку данных в запросе.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Необходимо выбрать из справочника товаров</span>
<span class="comment">// наименования товаров и наименования групп.</span>
<span class="keyword">Выбрать</span>
Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование <span class="keyword">Как</span> Товар<span class="operator">,</span>
Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>Родитель<span class="operator">.</span>Наименование <span class="keyword">Как</span> Группа
<span class="keyword">Из</span>
Справочник<span class="operator">.</span>Номенклатура</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref14429256"></a><IMG src="_img/img00321.gif?_=1496848987" WIDTH="430" ALT HEIGHT="232"></p>

<p class="MsoCaption">Рис. 322. Результат запроса (фрагмент)</p>

<p class="MsoNormal">Следует обратить
внимание, что поля в результате запроса называются <span class="Term">Товар</span> и <span class="Term">Группа</span>.
Если бы псевдонимы полей не были указаны, поля в результате запроса назывались
бы <span class="Term">Наименование</span> и <span class="Term">Наименование1</span> (названия полей в результате запроса
не могут совпадать, поэтому к названию второго поля автоматически добавлено «<span class="Term">1</span>»), что менее наглядно.</p>

<a name="_ref14273121"></a><a name="_&lt;значение_выборки&gt;_1"></a><a name="_&lt;разыменование_ссылки&gt;_1"></a><a name="_&lt;разыменование_ссыки&gt;"></a><a name="_это_заголовок"></a><a name="_&lt;разыменование_поля&gt;"></a><a name="_&lt;разыменование_ссылки&gt;"></a><a id="TI000000466" class="bookmark" name="issogl3_8.4.8.2_вложенные_таблицы_в_списке_полей_выборки"><h4>8.4.8.2. Вложенные таблицы в списке полей выборки</h4></a>

<p class="MsoNormalCxSpFirst">Поле в списке выборки может ссылаться на вложенную
таблицу источника данных запроса. В этом случае поле результата запроса будет
иметь тип <span class="Term">РезультатЗапроса</span>,
то есть содержать вложенный результат запроса, сформированный на основе вложенной
таблицы – источника.</p>

<p class="MsoNormalCxSpLast">По умолчанию во вложенный результат включаются все
поля вложенной таблицы – источника данных. Имеется возможность явно
определить группу полей, которые должны содержаться во вложенном результате
запроса. Группа полей вложенного результата описывается по следующему правилу:</p>

<p class="Lang-subheader"><a name="_&lt;группа_полей&gt;"></a>&lt;Группа
полей&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">( &lt;Список вложенных полей&gt; ) | *</pre>

<p class="Lang-subheader"><a name="_&lt;список_вложенных_элементов&gt;"></a>&lt;Список вложенных полей&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Вложенное поле&gt;[, &lt;Вложенное поле&gt;[, …]]</pre>

<p class="Lang-subheader"><a name="_&lt;вложенный_элемент&gt;"></a>&lt;Вложенное
поле&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Выражение&gt; [[КАК] &lt;Псевдоним поля&gt;]</pre>

<p class="MsoNormalCxSpFirst">Список вложенных полей состоит из одного или нескольких
элементов, разделенных запятыми. Если список состоит из одного элемента, его не
обязательно заключать в скобки.</p>

<p class="MsoNormalCxSpMiddle">Вместо перечисления вложенных полей можно указать
звездочку (*); это будет означать, что результат запроса должен содержать все
поля, которые есть во вложенной таблице.</p>

<p class="MsoNormalCxSpMiddle">Вложенное поле может представлять некоторое выражение
(см. <a href="#_ref217373027">здесь</a>). В простейшем случае выражение – это ссылка на
поле вложенной таблицы.</p>

<p class="MsoNormalCxSpMiddle">Каждому вложенному полю может быть назначен псевдоним.
В дальнейшем псевдоним поля может использоваться для более удобного обращения к
данному полю, аналогично псевдонимам полей списка выборки – см. <a href="#_ref14429640">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Псевдонимы вложенным полям могут быть назначены независимо
от того, задан ли псевдоним самой вложенной таблице.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// В отчет необходимо вывести спецификацию товарных накладных -</span>
<span class="comment">// сам документ, номенклатуру и количество.</span>
<span class="keyword">Выбрать</span>
Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Ссылка<span class="operator">,</span>
Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав<span class="operator">.</span><span class="operator">(</span>Номенклатура <span class="keyword">Как</span> Товар<span class="operator">,</span>
                    Количество<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref14252125"></a><IMG src="_img/img00322.gif?_=1496848987" WIDTH="435" ALT HEIGHT="292"></p>

<p class="MsoCaption">Рис. 323. Результат запроса (фрагмент)</p>

<p class="MsoNormal">Следует обратить
внимание, что поле <span class="Term">Состав</span>
результата запроса представляет собой вложенную таблицу, имеющую поля <span class="Term">Номенклатура</span> и <span class="Term">Количество</span>.</p>

<a name="_ref14694096"></a><a name="_ref14182559"></a><a id="TI000000467" class="bookmark" name="issogl3_8.4.8.3_пустые_вложенные_таблицы_в_списке_выборки"><h4>8.4.8.3. Пустые вложенные таблицы в списке выборки</h4></a>

<p class="MsoNormal">Если в запросе используется объединение и в
некоторых частях объединения присутствуют вложенные таблицы, а в некоторых –
нет, возникает необходимость дополнения списка выборки полями – пустыми
вложенными таблицами. Делается это при помощи ключевого слова <span class="Term">ПУСТАЯТАБЛИЦА</span>.
После него в скобках указываются псевдонимы полей, из которых будет состоять вложенная
таблица.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> Ссылка<span class="operator">.</span>Номер<span class="operator">,</span> ПУСТАЯТАБЛИЦА<span class="operator">.</span><span class="operator">(</span>Ном<span class="operator">,</span> Тов<span class="operator">,</span> Кол<span class="operator">)</span> <span class="keyword">КАК</span> Состав
<span class="keyword">ИЗ</span> Документ<span class="operator">.</span>РасходнаяНакладная
ОБЪЕДИНИТЬ ВСЕ
<span class="keyword">ВЫБРАТЬ</span> Ссылка<span class="operator">.</span>Номер<span class="operator">,</span> Состав<span class="operator">.</span><span class="operator">(</span>НомерСтроки<span class="operator">,</span> Номенклатура<span class="operator">,</span> Количество<span class="operator">)</span>
<span class="keyword">ИЗ</span> Документ<span class="operator">.</span>РасходнаяНакладная</pre>

<a name="_ref331073133"></a><a name="_ref261867556"></a><a name="_ref214883693"></a><a name="_ref214883396"></a><a name="_ref214883007"></a><a id="TI000000468" class="bookmark" name="issogl2_8.4.9_описание_источников_запроса"><h3>8.4.9. Описание источников запроса</h3></a>

<p class="MsoNormalCxSpFirst">Задача предложения <span class="Term">ИЗ</span> состоит в том,
чтобы обозначить список исходных таблиц – источников данных, используемых
в данном операторе <span class="Term">ВЫБРАТЬ</span>.</p>

<p class="MsoNormalCxSpMiddle">Следует отметить, что предложение <span class="Term">ИЗ</span>
в языке запросов является опциональным. Оно может быть опущено в том случае,
если источники данных полностью квалифицированы в описании списка полей
выборки, содержащегося в предложении <span class="Term">ВЫБРАТЬ</span>. Следует обратить внимание, что ряд
примеров в предыдущих разделах не содержал предложения <span class="Term">ИЗ</span>.</p>

<p class="MsoNormalCxSpLast">После ключевого слова <span class="Term">ИЗ</span> указывается
список источников. В общем случае список источников описывается следующим набором
правил:</p>

<p class="Lang-subheader"><a name="_&lt;список_источников&gt;"></a>&lt;Список
источников&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Источник&gt;[, &lt;Источник&gt;[, …]]</pre>

<p class="Lang-subheader"><a name="_&lt;элемент_источник&gt;"></a>&lt;Источник&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Описание источника&gt; [ &lt;Перечень соединений&gt; ]</pre>

<p class="Lang-subheader"><a name="_&lt;описание_источника&gt;"></a>&lt;Описание
источника&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Таблица&gt; [[КАК] &lt;Псевдоним источника&gt;]</pre>

<p class="Lang-subheader"><a name="_&lt;таблица&gt;"></a>&lt;Таблица&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Имя таблицы&gt;[(&lt;Параметры&gt;)] | (&lt;Описание запроса&gt;)</pre>

<p class="MsoNormalCxSpFirst"><a name="_&lt;разыменование_таблицы&gt;_1"></a>Источники
данных запроса перечисляются в списке источников через запятую. Каждый источник
в списке источников обязательно включает в себя описание источника; кроме того,
может быть указан перечень соединений – правила соединений источника с
другими источниками. Описание спецификации соединений см. <a href="#_ref15197333">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">Если в качестве источника данных выступает таблица
информационной базы, описание источника содержит имя таблицы.</p>

<p class="MsoNormalCxSpMiddle">Если исходная таблица виртуальная, могут быть
указаны параметры ее формирования. Подробно параметры виртуальных таблиц
описаны в разделе <span class="Interface">Встроенный язык – Работа с
запросами – Таблицы запросов</span> встроенной справки.</p>

<p class="MsoNormalCxSpMiddle">В качестве источника данных запроса может
выступать также вложенный запрос. В этом случае описание источника содержит
описание запроса. Описание использования вложенных запросов см. <a href="#_ref14438026">здесь</a>.</p>

<p class="MsoNormalCxSpLast"><a name="_ref14422854"></a>В описании источника данных
может быть также назначен его псевдоним (см. <a href="#_ref214883652">здесь</a>). В дальнейшем псевдоним источника может
использоваться для более удобного обращения к данному источнику.</p>

<a name="_ref15197333"></a><a id="TI000000469" class="bookmark" name="issogl3_8.4.9.1_спецификации_соединений"><h4>8.4.9.1. Спецификации соединений</h4></a>

<a id="TI000001870" class="bookmark" name="issogl4_8.4.9.1.1_общая_информация"><h5>8.4.9.1.1. Общая информация</h5></a>

<p class="MsoNormal">При определении нескольких источников в списке для каждой
записи из первой таблицы-источника осуществляется выборка из второй
таблицы-источника и т. д. Таким образом, в результате запроса
формируются все возможные комбинации всех записей из всех указанных источников.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
Контрагенты<span class="operator">.</span>Ссылка <span class="keyword">как</span> Контрагент<span class="operator">,</span>
ТипыЦен<span class="operator">.</span>Ссылка <span class="keyword">КАК</span> ТипЦены
<span class="keyword">ИЗ</span>
Справочник<span class="operator">.</span>Контрагенты <span class="keyword">КАК</span> Контрагенты<span class="operator">,</span>
Справочник<span class="operator">.</span>ТипыЦен <span class="keyword">КАК</span> ТипыЦенРезультат</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00323.gif?_=1496848987" WIDTH="523" ALT HEIGHT="282"></p>

<p class="MsoCaption">Рис. 324. Результат запроса (фрагмент)</p>

<p class="MsoNormalCxSpFirst">Результат запроса содержит комбинации всех контрагентов
со всеми типами цен. Как правило, такой результат сам по себе смысла не имеет.
Обычно комбинации записей из разных исходных таблиц требуется ограничить
какими-либо условиями. В языке запросов имеется возможность описать такое
соединение источников, указывая сами источники и определяя условия, в соответствии
с которыми комбинации записей из этих источников требуется включить в результат
запроса.</p>

<p class="MsoNormalCxSpLast">Соединения бывают нескольких видов; они описываются
следующими правилами:</p>

<p class="Lang-subheader"><a name="_&lt;перечень_соединений&gt;"></a>&lt;Перечень
соединений&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Соединение&gt; [&lt;Перечень соединений&gt;]</pre>

<p class="Lang-subheader"><a name="_&lt;соединение&gt;"></a>&lt;Соединение&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
[ВНУТРЕННЕЕ] СОЕДИНЕНИЕ &lt;Описание источника&gt; ПО &lt;Условие отбора&gt; |
ЛЕВОЕ [ВНЕШНЕЕ] СОЕДИНЕНИЕ &lt;Описание источника&gt; ПО &lt;Условие отбора&gt; |
ПРАВОЕ [ВНЕШНЕЕ] СОЕДИНЕНИЕ &lt;Описание источника&gt; ПО &lt;Условие отбора&gt; |
ПОЛНОЕ [ВНЕШНЕЕ] СОЕДИНЕНИЕ &lt;Описание источника&gt; ПО &lt;Условие отбора&gt;
</pre>

<p class="MsoNormalCxSpFirst">В общем случае перечень соединений может содержать
и описывать не только одно соединение (двух источников), но и несколько
соединений нескольких источников сразу.</p>

<p class="MsoNormalCxSpMiddle"><span class="Interface">Описание источника</span>
содержит описание исходной таблицы (см. <a href="#_ref214883693">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Условие отбора содержит условия, в соответствии с
которыми в выборке необходимо соединить данные из исходных таблиц – источников
запроса. Правила описания условий в языке запросов см. <a href="#_ref214883737">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">Ключевые слова <span class="Term">ЛЕВОЕ</span>, <span class="Term">ПРАВОЕ</span>
и <span class="Term">ПОЛНОЕ</span>
уточняют характер соединения. Слова <span class="Term">ВНУТРЕНЕЕ</span> или <span class="Term">ВНЕШНЕЕ</span> можно не
указывать вообще, они повышают наглядность и удобочитаемость текста запроса.</p>

<p class="MsoNormalCxSpLast">Соединяемые источники не равнозначны между собой, и
в некоторых случаях результат зависит от того, какая таблица указана первой, до
ключевого слова <span class="Term">СОЕДИНЕНИЕ</span>
(слева от него), а какая – второй (справа).</p>

<p class="Regularbeforepicture">Для описания соединений будем использовать две простые
таблицы. Одна таблица называется <span class="Term">Компании</span>, состоит из двух полей: <span class="Term">Наименование</span>
и <span class="Term">Телефон</span>
и содержит следующие данные:</p>

<p class="Picture"><IMG src="_img/img00324.gif?_=1496848987" WIDTH="311" ALT HEIGHT="63"></p>

<p class="MsoCaption">Рис. 325. Таблица «Компании»</p>

<p class="Regularbeforepicture">Другая таблица называется <span class="Term">Контакты</span>, состоит
из трех полей: <span class="Term">Наименование</span>,
<span class="Term">Телефон</span>
и <span class="Term">Компания</span>
(ссылка на элемент таблицы <span class="Term">Компании</span>). Таблица содержит следующие данные:</p>

<p class="Picture"><IMG src="_img/img00325.gif?_=1496848987" WIDTH="368" ALT HEIGHT="77"></p>

<p class="MsoCaption">Рис. 326. Таблица «Контакты»</p>

<p class="Note"><a name="_ref15197283"></a><span class="Note">Примечание.</span>
В терминах «1С:Предприятия» обе таблицы являются справочниками.</p>

<a id="TI000000470" class="bookmark" name="issogl4_8.4.9.1.2_внутреннее_соединение"><h5>8.4.9.1.2. Внутреннее соединение</h5></a>

<p class="MsoNormal">Внутреннее соединение означает, что из обеих исходных таблиц –
источников данных в результат запроса необходимо включить только те комбинации
записей, которые соответствуют указанному условию. Остальные записи в результат
не попадают.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Компании<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Компания<span class="operator">,</span>
    Контакты<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Контакт
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Контакты <span class="keyword">КАК</span> Контакты
        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник<span class="operator">.</span>Компании <span class="keyword">КАК</span> Компании
        <span class="keyword">ПО</span> Контакты<span class="operator">.</span>Компания <span class="operator">=</span> Компании<span class="operator">.</span>Ссылка</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00326.gif?_=1496848987" WIDTH="440" ALT HEIGHT="71"></p>

<p class="MsoCaption">Рис. 327. Результат запроса</p>

<a id="TI000000471" class="bookmark" name="issogl4_8.4.9.1.3_левое_внешнее_соединение"><h5>8.4.9.1.3. Левое внешнее соединение</h5></a>

<p class="MsoNormalCxSpFirst">Левое внешнее соединение означает, что в результат
запроса нужно включить комбинации записей из обеих исходных таблиц, которые
соответствуют указанному условию. Но, в отличие от внутреннего соединения, в
результат запроса нужно включить также еще и записи из первого (указанного
слева от слова <span class="Term">СОЕДИНЕНИЕ</span>)
источника, для которых не найдено соответствующих условию записей из второго источника.</p>

<p class="MsoNormalCxSpLast">Таким образом, в результат запроса будут включены
все записи из первого источника; они будут соединены с записями из второго
источника при выполнении указанного условия. Строки результата запроса, для
которых не найдено соответствующих условию записей из второго источника, будут
содержать <span class="Term">NULL</span>
в полях, формируемых на основании записей из этого источника.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Контакты<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Контакт<span class="operator">,</span>
    Компании<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Компания
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Контакты <span class="keyword">КАК</span> Контакты
        ЛЕВОЕ СОЕДИНЕНИЕ Справочник<span class="operator">.</span>Компании <span class="keyword">КАК</span> Компании
        <span class="keyword">ПО</span> Контакты<span class="operator">.</span>Компания <span class="operator">=</span> Компании<span class="operator">.</span>Ссылка</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00327.gif?_=1496848987" WIDTH="440" ALT HEIGHT="75"></p>

<p class="MsoCaption">Рис. 328. Результат запроса</p>

<a id="TI000000472" class="bookmark" name="issogl4_8.4.9.1.4_правое_внешнее_соединение"><h5>8.4.9.1.4. Правое внешнее соединение</h5></a>

<p class="MsoNormalCxSpFirst">Правое внешнее соединение означает, что в результат
запроса нужно включить комбинации записей из обеих исходных таблиц, которые
соответствуют указанному условию. Кроме того, в результат запроса нужно также
включить и записи из второго (указанного справа от слова <span class="Term">СОЕДИНЕНИЕ</span>) источника,
для которых не найдено соответствующих условию записей из первого источника.</p>

<p class="MsoNormalCxSpLast">Таким образом, в результат запроса будут включены
все записи из второго источника; они будут соединены с записями из первого
источника при выполнении указанного условия. Строки результата запроса, для
которых не найдено соответствующих условию записей из первого источника, будут
содержать <span class="Term">NULL</span>
в полях, формируемых на основании записей из этого источника.</p>

<p class="Note"><span class="Note">Примечание.</span> Фактически правое
внешнее соединение можно выразить через левое внешнее соединение. Именно так
делает конструктор запросов конфигуратора.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Контакты<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Контакт<span class="operator">,</span>
    Компании<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Компания
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Контакты <span class="keyword">КАК</span> Контакты
        ПРАВОЕ СОЕДИНЕНИЕ Справочник<span class="operator">.</span>Компании <span class="keyword">КАК</span> Компании
        <span class="keyword">ПО</span> Контакты<span class="operator">.</span>Телефон <span class="operator">=</span> Компании<span class="operator">.</span>Телефон</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00328.gif?_=1496848987" WIDTH="440" ALT HEIGHT="75"></p>

<p class="MsoCaption">Рис. 329. Результат запроса</p>

<a id="TI000000473" class="bookmark" name="issogl4_8.4.9.1.5_полное_внешнее_соединение"><h5>8.4.9.1.5. Полное внешнее соединение</h5></a>

<p class="MsoNormalCxSpFirst">Полное внешнее соединение означает, что в результат
запроса нужно включить комбинации записей из обеих исходных таблиц, которые
соответствуют указанному условию. Кроме того, в результат запроса нужно также
включить и те записи из обоих источников, для которых не найдено соответствий.</p>

<p class="MsoNormalCxSpLast">Таким образом, в результат запроса будут включены
все записи из обоих источников; они будут соединены друг с другом при
выполнении указанного условия. Строки результата запроса, для которых не
найдено соответствующих условию записей из какого-либо источника, будут содержать
<span class="Term">NULL</span>
в полях, формируемых на основании записей из этого источника.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Контакты<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Контакт<span class="operator">,</span>
    Компании<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Компания
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Компании <span class="keyword">КАК</span> Компании
        ПОЛНОЕ СОЕДИНЕНИЕ Справочник<span class="operator">.</span>Контакты <span class="keyword">КАК</span> Контакты
        <span class="keyword">ПО</span> <span class="operator">(</span>Контакты<span class="operator">.</span>Телефон <span class="operator">=</span> Компании<span class="operator">.</span>Телефон<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref14432662"></a><IMG src="_img/img00329.gif?_=1496848987" WIDTH="451" ALT HEIGHT="86"></p>

<p class="MsoCaption">Рис. 330. Результат запроса</p>

<a name="_ref214883652"></a><a id="TI000000474" class="bookmark" name="issogl3_8.4.9.2_псевдонимы_источников_данных"><h4>8.4.9.2. Псевдонимы источников данных</h4></a>

<p class="MsoNormalCxSpFirst">Если источнику данных назначить псевдоним, то в дальнейшем
к этому источнику можно будет обращаться, используя этот псевдоним (и уже
нельзя будет обращаться через указание имени таблицы). Такое обращение может быть
более удобным и наглядным, а в некоторых случаях единственно возможным.</p>

<p class="MsoNormalCxSpMiddle">Псевдоним задается в соответствии с правилами назначения
идентификаторов переменных. Псевдонимы в запросе не могут совпадать.</p>

<p class="MsoNormalCxSpMiddle">Ключевое слово <span class="Term">КАК</span> может
предшествовать псевдониму источника. Это слово можно не указывать вообще, но
если оно указано, повышается наглядность и удобочитаемость текста запроса.</p>

<p class="MsoNormalCxSpLast">Назначение псевдонимов источникам само по себе никак
не влияет на выборку данных в запросе.</p>

<p class="Lang-subheader"><a name="_ref14432979"></a>Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Товар<span class="operator">.</span>Наименование<span class="operator">,</span>
    Товар<span class="operator">.</span>Родитель
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Товар</pre>

<p class="MsoNormal">Данный пример
демонстрирует использование в списке полей выборки псевдонима <span class="Term">Товар</span>, назначенного исходной таблице <span class="Term">Справочник.Номенклатура</span>.</p>

<a id="TI000000475" class="bookmark" name="issogl3_8.4.9.3_вложенные_таблицы_в_списке_источников"><h4>8.4.9.3. Вложенные таблицы в списке источников</h4></a>

<p class="MsoNormal">В списке источников
могут фигурировать и вложенные таблицы – табличные части справочников и
документов.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// В отчет необходимо вывести спецификацию товарных накладных -</span>
<span class="comment">// показать сам документ, номенклатуру и количество.</span>
<span class="comment">// В списке источников указана вложенная таблица &quot;Состав&quot; -</span>
<span class="comment">// табличная часть накладной.</span>
<span class="comment">// Выборка ограничена восемью записями, чтобы не перегружать пример.</span>
<span class="keyword">ВЫБРАТЬ</span> ПЕРВЫЕ <span class="number">8</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Ссылка<span class="operator">,</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Количество
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00330.gif?_=1496848987" WIDTH="592" ALT HEIGHT="172"></p>

<p class="MsoCaption">Рис. 331. Результат запроса</p>

<p class="MsoNormal">Следует обратить
внимание, что при указании вложенной таблицы в списке источников допускается
обращение как к полям самой вложенной таблицы, так и к полям таблицы верхнего
уровня (той, которая содержит вложенную таблицу) через поле <span class="Term">Ссылка</span>. В данном случае происходит обращение к
полю <span class="Term">Ссылка.НаименованиеПоля</span>
самого документа.</p>

<a name="_ref14438026"></a><a name="_&lt;разыменование_таблицы&gt;"></a><a id="TI000000476" class="bookmark" name="issogl3_8.4.9.4_вложенные_запросы_в_списке_источников"><h4>8.4.9.4. Вложенные запросы в списке источников</h4></a>

<p class="MsoNormalCxSpFirst">В списке источников запроса в качестве
таблицы-источника может использоваться вложенный запрос. В этом случае описание
источника содержит описание вложенного запроса. Описание вложенного запроса составляется
точно так же, как и обычного (см. <a href="#_ref14176843">здесь</a>).</p>

<p class="MsoNormalCxSpLast">Использование вложенного запроса в качестве
источника данных ничем не отличается от использования таблицы информационной
базы. В качестве полей такого источника доступны все поля, описанные в списке
полей выборки вложенного запроса.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    ВложенныйЗапрос<span class="operator">.</span>Ссылка<span class="operator">,</span>
    ВложенныйЗапрос<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    ВложенныйЗапрос<span class="operator">.</span>Количество
<span class="keyword">ИЗ</span>
    <span class="operator">(</span><span class="keyword">ВЫБРАТЬ</span> ПЕРВЫЕ <span class="number">8</span>
        РасходнаяНакладнаяСостав<span class="operator">.</span>Ссылка <span class="keyword">КАК</span> Ссылка<span class="operator">,</span>
        РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
        РасходнаяНакладнаяСостав<span class="operator">.</span>Количество <span class="keyword">КАК</span> Количество
    <span class="keyword">ИЗ</span>
Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав<span class="operator">)</span> <span class="keyword">КАК</span> ВложенныйЗапрос</pre>

<p class="MsoNormal">Результат будет точно таким же, как и в предыдущем примере.</p>

<a name="_ref15212776"></a><a name="_ref14185417"></a><a name="_&lt;условия_отбора&gt;"></a><a name="_ref444251360"></a><a name="_ref444251359"></a><a id="TI000000477" class="bookmark" name="issogl2_8.4.10_фильтрация_результатов_запроса"><h3>8.4.10. Фильтрация результатов запроса</h3></a>

<p class="MsoNormal">Предложение <span class="Term">ГДЕ &lt;Условие отбора&gt;</span> позволяет задать
условие отбора данных из исходных таблиц – источников запроса; в запросе
будут обрабатываться только те записи, для которых данное условие оказывается
истинным.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Необходимо выяснить, какие контрагенты являются частными лицами.</span>
<span class="keyword">ВЫБРАТЬ</span>
    Контрагенты<span class="operator">.</span>Наименование
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Контрагенты <span class="keyword">КАК</span> Контрагенты
ГДЕ Контрагенты<span class="operator">.</span>Вид <span class="operator">=</span> ЗНАЧЕНИЕ<span class="operator">(</span>Перечисление<span class="operator">.</span>ВидыКонтрагентов<span class="operator">.</span>ЧастноеЛицо<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00331.gif?_=1496848987" WIDTH="307" ALT HEIGHT="128"></p>

<p class="MsoCaption">Рис. 332. Результат запроса</p>

<p class="Note"><span class="Note">Примечание.</span> Совершенно не обязательно,
чтобы поле, фигурирующее в предложении <span class="Term">ГДЕ</span>, входило в список выборки.</p>

<p class="MsoNormalCxSpFirst">Условие отбора может определяться и как простое логическое
выражение, и как более сложное, в котором простые логические выражения
соединяются между собой логическими операторами <span class="Term">И</span>, <span class="Term">ИЛИ</span>,
<span class="Term">НЕ</span>.
Описание условий в языке запросов см. <a href="#_ref214883887">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">При выборке данных из таблицы, имеющей табличные
части, условия на записи табличной части действуют как на состав записей,
выбираемых из таблицы, так и на состав записей табличных частей.</p>

<p class="MsoNormalCxSpLast">В общем виде: выборка записей, содержащих табличные
части, выполняется в следующем порядке:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
К каждой таблице из списка источников левым
внешним соединением присоединяются ее табличные части.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Выполняются все соединения, определенные в
списке источников.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Отбираются записи, удовлетворяющие условию из
раздела <span class="Term">ГДЕ</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Выполняется группировка записей по полям таблиц
из списка источников, включая поля ссылок, с помещением записей табличных
частей в качестве значений соответствующих полей записей таблиц из списка
выборки.</p>

<a name="_ref14185884"></a><a name="_ref399327730"></a><a name="_ref399327729"></a><a id="TI000000478" class="bookmark" name="issogl2_8.4.11_группировка_результатов_запроса"><h3>8.4.11. Группировка результатов запроса</h3></a>

<p class="MsoNormalCxSpFirst">Исходные данные в запросе могут быть сгруппированы
с помощью агрегатных функций, указанных в качестве полей в списке выборки. Это
означает, что строки в результате запроса будут содержать результаты вычисления
указанных агрегатных функций, рассчитанные (сгруппированные) по записям
исходных таблиц.</p>

<p class="MsoNormalCxSpMiddle">Сами агрегатные функции указываются в списке полей
выборки. В предложении <span class="Term">СГРУППИРОВАТЬ
ПО &lt;Поля группировки&gt;</span> необходимо указать список полей, по которым
следует произвести группировку. В запросе будут группироваться записи исходных
таблиц, содержащие одинаковые значения указанных полей.</p>

<p class="MsoNormalCxSpLast">Список полей группировки содержит ссылки на поля
исходных таблиц – источников запроса, указанные через запятую:</p>

<p class="Lang-subheader"><a name="_&lt;поля_группировки&gt;"></a>&lt;Поля
группировки&gt;</p>

<p class="Lang-subheader">&lt;Разыменование поля&gt; [,
&lt;Разыменование поля&gt; [, …]]</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span> При группировке
результатов запроса в списке полей выборки обязательно должны быть указаны агрегатные
функции, а помимо них допускается указывать только поля, по которым
осуществляется группировка. В запросах, содержащих группировку по какому-либо
полю, не следует использовать это поле внутри агрегатных функций. Использование
поля одновременно для группировки и внутри агрегатной функции – следует
считать ошибкой. Такие запросы могут трактоваться по-разному, в зависимости от
того, какая СУБД используется. При нарушении данного правила возможны ошибки,
приводящие к завершению программы.</p>

<p class="MsoNormalCxSpFirst">Исключение составляют ситуации, когда агрегатные
функции применены к полям вложенной таблицы. В этом случае в списке полей
выборки возможны обращения к полям таблицы верхнего уровня, без группировки
результатов по этим полям.</p>

<p class="MsoNormalCxSpLast">При использовании агрегатных функций предложение <span class="Term">СГРУППИРОВАТЬ
ПО</span> может быть и не указано совсем; при этом все результаты
запроса будут сгруппированы в одну-единственную строку.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Требуется получить статистику по продаже товаров:</span>
<span class="comment">// максимальную, минимальную и среднюю цены в расходных накладных.</span>
<span class="keyword">Выбрать</span>
    Накладная<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    Среднее <span class="operator">(</span>Накладная<span class="operator">.</span>Цена<span class="operator">)</span> <span class="keyword">Как</span> Среднее<span class="operator">,</span>
    Максимум<span class="operator">(</span>Накладная<span class="operator">.</span>Цена<span class="operator">)</span> <span class="keyword">Как</span> Максимум<span class="operator">,</span>
    Минимум <span class="operator">(</span>Накладная<span class="operator">.</span>Цена<span class="operator">)</span> <span class="keyword">Как</span> Минимум
<span class="keyword">Из</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">Как</span> Накладная
Сгруппировать <span class="keyword">По</span>
    Накладная<span class="operator">.</span>Номенклатура</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref15183374"></a><IMG src="_img/img00332.gif?_=1496848987" WIDTH="542" ALT HEIGHT="163"></p>

<p class="MsoCaption">Рис. 333. Результат запроса
(фрагмент)</p>

<a name="_ref214883064"></a><a id="TI000000479" class="bookmark" name="issogl2_8.4.12_условия_на_значения_агрегатных_функций"><h3>8.4.12. Условия на значения агрегатных функций</h3></a>

<p class="MsoNormal">Предложение <span class="Term">ИМЕЮЩИЕ &lt;Условие отбора&gt;</span> позволяет накладывать
условия на значения агрегатных функций. В других конструкциях языка запросов,
например, в предложении <span class="Term">ГДЕ</span>, указывать в условиях агрегатные функции
нельзя.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Необходимо выбрать товары, которых продали более 20 штук.</span>
<span class="keyword">ВЫБРАТЬ</span>
    Накладная<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    СУММА<span class="operator">(</span>Накладная<span class="operator">.</span>Количество<span class="operator">)</span> <span class="keyword">КАК</span> Количество
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Накладная
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    Накладная<span class="operator">.</span>Номенклатура
ИМЕЮЩИЕ
    СУММА<span class="operator">(</span>Накладная<span class="operator">.</span>Количество<span class="operator">)</span> <span class="operator">&gt;</span> <span class="number">20</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00333.gif?_=1496848987" WIDTH="556" ALT HEIGHT="163"></p>

<p class="MsoCaption">Рис. 334. Результат запроса</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span> В условии отбора можно
использовать только агрегатные функции и поля, по которым осуществляется группировка.</p>

<a name="_ref15183231"></a><a id="TI000000480" class="bookmark" name="issogl2_8.4.13_объединение_запросов"><h3>8.4.13. Объединение запросов</h3></a>

<p class="MsoNormalCxSpFirst">В языке запросов имеется возможность объединять несколько
запросов. При этом записи, полученные с помощью каждого из объединяемых
запросов, будут собраны в один результат запроса.</p>

<p class="MsoNormalCxSpMiddle">При объединении каждый запрос собирает данные независимо,
а такие операции, как упорядочивание результатов и расчет итогов, выполняются
уже над результатом объединения запросов.</p>

<p class="MsoNormalCxSpMiddle">Поля результата запроса будут называться так, как
описано в списке полей выборки первого из объединяемых запросов. Поля выборки
остальных запросов сопоставляются с полями результата в соответствии с порядком
их следования в списке полей выборки. Объединяемые запросы должны иметь одинаковое
количество полей в списке полей выборки.</p>

<p class="MsoNormalCxSpMiddle">Если поля выборки объединяемых запросов имеют разный
тип, то поля результата запроса будут иметь составной тип.</p>

<p class="MsoNormalCxSpLast">Объединение запросов описывается по следующему правилу:</p>

<p class="Lang-subheader">&lt;Объединение запросов&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ОБЪЕДИНИТЬ [ВСЕ]
&lt;Описание запроса&gt;
[&lt;Объединение запросов&gt;]
</pre>

<p class="MsoNormalCxSpFirst">Объединение запросов начинается с обязательного ключевого
слова <span class="Term">ОБЪЕДИНИТЬ</span>,
после которого следует описание присоединяемого запроса. Далее может присоединяться
еще один запрос и т. д.</p>

<p class="MsoNormalCxSpLast">По умолчанию при объединении запросов полностью одинаковые
строки в результате запроса, сформированные разными запросами, заменяются
одной. Если требуется, чтобы были оставлены разные строки, необходимо указать
ключевое слово <span class="Term">ВСЕ</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Приход<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Товар<span class="operator">,</span>
    СУММА<span class="operator">(</span>Приход<span class="operator">.</span>Количество<span class="operator">)</span> <span class="keyword">КАК</span> Приход<span class="operator">,</span>
    СУММА<span class="operator">(</span><span class="number">0</span><span class="operator">)</span> <span class="keyword">КАК</span> Расход
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>ПриходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Приход
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    Приход<span class="operator">.</span>Номенклатура
ОБЪЕДИНИТЬ
<span class="keyword">ВЫБРАТЬ</span>
    Расход<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    СУММА<span class="operator">(</span><span class="number">0</span><span class="operator">)</span><span class="operator">,</span>
    СУММА<span class="operator">(</span>Расход<span class="operator">.</span>Количество<span class="operator">)</span>
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Расход
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    Расход<span class="operator">.</span>Номенклатура</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref14178566"></a><a name="_ref14177232"></a><a name="_&lt;объединение_запросов&gt;"></a><a name="_&lt;дополнение_запроса&gt;"></a><a name="_&lt;дополнение_результатов&gt;"></a><a name="_&lt;поля_для_обработки_дополнения&gt;"></a><a name="_&lt;поля_для_дополнения&gt;"></a><a name="_&lt;список_значений&gt;"></a><IMG src="_img/img00334.gif?_=1496848987" WIDTH="578" ALT HEIGHT="189"></p>

<p class="MsoCaption">Рис. 335. Результат запроса (фрагмент)</p>

<a name="_ref214882859"></a><a id="TI000000481" class="bookmark" name="issogl2_8.4.14_упорядочивание_результатов_запроса"><h3>8.4.14. Упорядочивание результатов запроса</h3></a>

<p class="MsoNormal">Предложение <span class="Term">УПОРЯДОЧИТЬ ПО</span> позволяет сортировать строки в
результате запроса.</p>

<p class="Lang-subheader"><a name="_&lt;упорядочивание_результатов&gt;"></a>&lt;Упорядочивание
результатов&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">УПОРЯДОЧИТЬ ПО &lt;Условия упорядочивания&gt;</pre>

<p class="Lang-subheader"><a name="_&lt;условия_упорядочивания&gt;"></a>&lt;Условия упорядочивания&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
&lt;Поле упорядочивания&gt; [&lt;Порядок&gt;]
[, &lt;Поле упорядочивания&gt; [&lt;Порядок&gt;][, …]]
</pre>

<p class="Lang-subheader"><a name="_&lt;условие_упорядочивания&gt;"></a><a name="_&lt;поле_упорядочивания&gt;"></a>&lt;Поле
упорядочивания&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Выражение&gt; &lt;Порядок&gt; ВОЗР | УБЫВ | ИЕРАРХИЯ | ИЕРАРХИЯ УБЫВ</pre>

<p class="MsoNormalCxSpFirst">В предложении <span class="Term">УПОРЯДОЧИТЬ ПО</span>
через запятую перечисляются условия, в соответствии с которыми необходимо упорядочить
результат запроса. Выборки упорядочиваются сначала по первому условию, потом по
второму и т. д.</p>

<p class="MsoNormalCxSpMiddle">Условие упорядочивания в общем случае может представлять
собой некоторое выражение (см. <a href="#_ref397080846">здесь</a>). Строки результата запроса будут упорядочены по
значениям этого выражения, рассчитанным для каждой строки.</p>

<p class="MsoNormalCxSpMiddle">Упорядочивание может осуществляться в порядке возрастания
или убывания значений, а для таблиц, для которых задано свойство
иерархичности, – также и по иерархии (см. <a href="#_ref214883950">здесь</a>). Порядок может задаваться для каждого поля независимо.
Описание правил сравнения значений см. <a href="#_ref15271527">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Поле, фигурирующее в условиях упорядочивания, совсем
не обязательно должно попадать в результат запроса.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Требуется отобрать 5 самых дорогих товаров,</span>
<span class="comment">// расположив их в порядке убывания цены.</span>
<span class="keyword">ВЫБРАТЬ</span> ПЕРВЫЕ <span class="number">5</span>
    Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>ЗакупочнаяЦена
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    Номенклатура<span class="operator">.</span>ЗакупочнаяЦена УБЫВ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref15207118"></a><IMG src="_img/img00335.gif?_=1496848987" WIDTH="500" ALT HEIGHT="112"></p>

<p class="MsoCaption">Рис. 336. Результат запроса</p>

<a name="_ref214883950"></a><a id="TI000000482" class="bookmark" name="issogl3_8.4.14.1_упорядочивание_по_иерархии"><h4>8.4.14.1. Упорядочивание по иерархии</h4></a>

<p class="MsoNormal">Для справочников можно назначать упорядочивание по иерархии
справочника.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>ПолноеНаименование
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    Справочник<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование Иерархия</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00336.gif?_=1496848987" WIDTH="647" ALT HEIGHT="163"></p>

<p class="MsoCaption">Рис. 337. Результат запроса (фрагмент)</p>

<p class="MsoNormal">Иерархически сортировать можно только по полю, но не по
некоторой операции над ним: поле упорядочивания должно содержать ссылку на поле
исходной таблицы – источника данных запроса.</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span> Упорядочивание по
иерархии имеет смысл задавать в том случае, если в качестве источника определена
именно таблица справочника, а не какая-либо другая таблица, содержащая только
ссылку на справочник.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    РасходнаяНакладная<span class="operator">.</span>Контрагент<span class="operator">.</span>Наименование<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Номер<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Склад<span class="operator">,</span>
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> РасходнаяНакладная</pre>

<p class="MsoNormalCxSpFirst">В данном примере иерархического упорядочивания не
получится, поскольку нет связи со справочником, и группы из этого справочника в
результат запроса не попадут.</p>

<p class="MsoNormalCxSpLast">Для упорядочивания по иерархии необходимо организовать
соединение со справочником.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Контрагенты<span class="operator">.</span>Наименование <span class="keyword">КАК</span> Наименование<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Номер<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Склад
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Контрагенты <span class="keyword">КАК</span> Контрагенты
ЛЕВОЕ СОЕДИНЕНИЕ Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> РасходнаяНакладная
<span class="keyword">ПО</span> Контрагенты<span class="operator">.</span>Ссылка <span class="operator">=</span> РасходнаяНакладная<span class="operator">.</span>Контрагент
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    Наименование ИЕРАРХИЯ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00337.gif?_=1496848987" WIDTH="428" ALT HEIGHT="293"></p>

<p class="MsoCaption">Рис. 338. Результат запроса
(фрагмент)</p>

<a id="TI000000483" class="bookmark" name="issogl3_8.4.14.2_упорядочивание_во_вложенных_таблицах"><h4>8.4.14.2. Упорядочивание во вложенных таблицах</h4></a>

<p class="MsoNormalCxSpFirst">В предложении <span class="Term">УПОРЯДОЧИТЬ ПО</span>
можно определять также и условия упорядочивания записей из вложенных таблиц;
причем их можно комбинировать с условиями упорядочивания по таблице верхнего
уровня.</p>

<p class="MsoNormalCxSpLast">При этом важен порядок указания полей таблицы одного
уровня (вложенной или верхнего уровня) относительно друг друга, но не важно, в
каком порядке указаны поля таблицы одного уровня относительно полей таблицы
другого уровня: упорядочивание выполняется всегда сначала по таблице верхнего
уровня, а потом по вложенной таблице.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// В отчет необходимо вывести спецификацию товарных накладных -</span>
<span class="comment">// показать сам документ, номенклатуру и количество.</span>
<span class="comment">// Документы требуется упорядочить по номеру,</span>
<span class="comment">// а состав – по наименованию товара.</span>
<span class="keyword">Выбрать</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Ссылка<span class="operator">,</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав<span class="operator">.</span><span class="operator">(</span>Номенклатура <span class="keyword">Как</span> Товар<span class="operator">,</span> Количество<span class="operator">)</span>
Упорядочить <span class="keyword">По</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Номер<span class="operator">,</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование</pre>

<a name="_ref14178650"></a><a name="_ref14177852"></a><a id="TI000000484" class="bookmark" name="issogl2_8.4.15_автоупорядочивание_результатов"><h3>8.4.15. Автоупорядочивание результатов</h3></a>

<p class="MsoNormalCxSpFirst">Предложение <span class="Term">АВТОУПОРЯДОЧИВАНИЕ</span>
позволяет включить режим автоматического формирования полей для упорядочивания
результата запроса.</p>

<p class="MsoNormalCxSpLast">Автоупорядочивание работает по следующим принципам:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Если в запросе было указано предложение <span class="Term">УПОРЯДОЧИТЬ ПО</span>,
то каждая ссылка на таблицу, находящаяся в этом предложении, будет заменена
полями, по которым по умолчанию сортируется таблица (для справочников это код
или наименование, для документов – дата документа). Если поле для
упорядочивания ссылается на иерархический справочник, то будет применена
иерархическая сортировка по этому справочнику.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если в запросе отсутствует предложение <span class="Term">УПОРЯДОЧИТЬ ПО</span>,
но есть предложение <span class="Term">ИТОГИ</span>,
тогда результат запроса будет упорядочен по полям, присутствующим в предложении
<span class="Term">ИТОГИ</span>
после ключевого слова <span class="Term">ПО</span>,
в той же последовательности; и если итоги рассчитывались по полям-ссылкам, то
по полям сортировки по умолчанию таблиц, на которые были ссылки.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Если в запросе отсутствуют предложения <span class="Term">УПОРЯДОЧИТЬ ПО</span>
и <span class="Term">ИТОГИ</span>,
но есть предложение <span class="Term">СГРУППИРОВАТЬ
ПО</span>, тогда результат запроса будет упорядочен по полям,
присутствующим в предложении, в той же последовательности; и если группировка велась
по полям-ссылкам, то по полям сортировки по умолчанию таблиц, на которые были
ссылки.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Если в запросе отсутствуют предложения <span class="Term">УПОРЯДОЧИТЬ ПО</span>,
<span class="Term">ИТОГИ</span>
и <span class="Term">СГРУППИРОВАТЬ
ПО</span>, результат будет упорядочен по полям сортировки по умолчанию
для таблиц, из которых выбираются данные, в порядке их появления в запросе.</p>

<a name="_ref14178205"></a><a id="TI000000485" class="bookmark" name="issogl2_8.4.16_расчет_итогов_запроса"><h3>8.4.16. Расчет итогов запроса</h3></a>

<p class="MsoNormalCxSpFirst">Предложение <span class="Term">ИТОГИ</span> позволяет
определить, расчет каких итогов необходим в запросе. При расчете итогов вычисляются
значения агрегатных функций по выборкам с одинаковыми значениями полей – контрольных
точек. Итоги добавляются в результат запроса как итоговые строки.</p>

<p class="MsoNormalCxSpLast">Порядок расчета итогов запроса описывается в соответствии
со следующими правилами:</p>

<p class="Lang-subheader"><a name="_&lt;описание_итогов&gt;"></a>&lt;Описание
итогов&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Итоги&gt; [&lt;Описание итогов&gt;]</pre>

<p class="Lang-subheader"><a name="_&lt;итоги&gt;"></a>&lt;Итоги&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ИТОГИ [&lt;Список итоговых полей&gt;] ПО [ОБЩИЕ] &lt;Список контрольных точек&gt;</pre>

<p class="Lang-subheader"><a name="_&lt;список_агрегатных_функций&gt;"></a>&lt;Список итоговых полей&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Итоговое поле&gt; [,&lt;Список итоговых полей&gt; [, …]]</pre>

<p class="Lang-subheader">&lt;Итоговое поле&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Агрегатная функция&gt; | &lt;Выражение&gt; [[КАК] &lt;Псевдоним поля&gt;]</pre>

<p class="Lang-subheader">&lt;Список контрольных
точек&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Контрольная точка&gt; [, &lt;Контрольная точка&gt; [, …]]</pre>

<p class="Lang-subheader"><a name="_&lt;контрольная_точка&gt;"></a>&lt;Контрольная
точка&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
&lt;Выражение&gt; [[ТОЛЬКО] ИЕРАРХИЯ] | [ПЕРИОДАМИ(Секунда | Минута | Час | День | Неделя | Месяц | Квартал | Год | Декада | Полугодие
[,&lt;Литерал типа DATE&gt; | &lt;Идентификатор параметра&gt;]
[,&lt;Литерал типа DATE&gt; | &lt;Идентификатор параметра&gt;])] [[КАК] Псевдоним поля]
</pre>

<p class="MsoNormalCxSpFirst">Описание итогов начинается с обязательного
ключевого слова <span class="Term">ИТОГИ</span>.</p>

<p class="MsoNormalCxSpMiddle">Список агрегатных функций содержит перечень агрегатных
функций (см. <a href="#_ref14592889">здесь</a>), которые необходимо рассчитывать в итогах.</p>

<p class="MsoNormalCxSpMiddle">Ключевое слово <span class="Term">ОБЩИЕ</span> означает,
что необходимо сформировать итоговую строку по всему результату запроса. Описание
расчета общих итогов см. <a href="#_ref214884073">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">Помимо общих итогов можно задать расчет итогов по
контрольным точкам. Для этого после обязательного ключевого слова <span class="Term">ПО</span>
необходимо указать <span class="Term">&lt;Список
контрольных точек&gt;</span>. Каждая контрольная точка содержит
выражение, вычисляемое при выполнении запроса. По каждой комбинации значений
этих выражений будут рассчитаны и добавлены в результат запроса итоговые
строки.</p>

<p class="MsoNormalCxSpLast">Если контрольная точка является ссылкой на справочник,
возможен расчет итогов по иерархии справочника (см. <a href="#_ref214884087">здесь</a>). Для этого после такой ссылки нужно указать обязательное
ключевое слово <span class="Term">ИЕРАРХИЯ</span>.</p>

<a name="_ref15207417"></a><a id="TI000000486" class="bookmark" name="issogl3_8.4.16.1_расчет_итогов_во_вложенных_таблицах"><h4>8.4.16.1. Расчет итогов во вложенных таблицах</h4></a>

<p class="MsoNormal">В настоящей версии программы не
поддерживается расчет итогов по вложенным таблицам.</p>

<a name="_ref214884087"></a><a id="TI000000487" class="bookmark" name="issogl3_8.4.16.2_итоги_по_иерархии"><h4>8.4.16.2. Итоги по иерархии</h4></a>

<p class="MsoNormal">Есть возможность рассчитать итоги по иерархии. Для этого
после имени поля, для которого вычисляются итоги, необходимо указать ключевое
слово <span class="Term">ИЕРАРХИЯ</span><span class="Bold">. </span>В результате будут рассчитаны итоги по контрольным точкам и
итоги по иерархии для контрольных точек.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Документ<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
    Документ<span class="operator">.</span>Количество <span class="keyword">КАК</span> Количество<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Номер<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Контрагент
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Документ
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    Документ<span class="operator">.</span>Номенклатура
ИТОГИ
    СУММА<span class="operator">(</span>Количество<span class="operator">)</span>
<span class="keyword">ПО</span>
    Номенклатура ИЕРАРХИЯ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref15206944"></a><IMG src="_img/img00338.gif?_=1496848987" WIDTH="561" ALT HEIGHT="238"></p>

<p class="MsoCaption">Рис. 339. Результат запроса (фрагмент)</p>

<p class="MsoNormal">При необходимости
можно рассчитать только итоги значений по иерархии, без расчета итогов в
контрольных точках. Для этого перед ключевым словом <span class="Term">ИЕРАРХИЯ</span> нужно указать ключевое слово <span class="Term">ТОЛЬКО</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Документ<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
    Документ<span class="operator">.</span>Количество <span class="keyword">КАК</span> Количество<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Номер<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Контрагент
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Документ
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    Документ<span class="operator">.</span>Номенклатура
ИТОГИ
    СУММА<span class="operator">(</span>Количество<span class="operator">)</span>
<span class="keyword">ПО</span>
    Номенклатура ТОЛЬКО ИЕРАРХИЯ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00339.gif?_=1496848987" WIDTH="561" ALT HEIGHT="238"></p>

<p class="MsoCaption">Рис. 340. Результат запроса (фрагмент)</p>

<a name="_ref214883133"></a><a id="TI000000488" class="bookmark" name="issogl3_8.4.16.3_дополнение_дат"><h4>8.4.16.3. Дополнение дат</h4></a>

<p class="MsoNormal">В
случае если поле, по которому рассчитываем итоги, является полем типа <span class="Term">Дата</span>, возможно дополнение результатов датами в
заданном периоде. Делается это при помощи ключевого слова <span class="Term">ПЕРИОДАМИ</span>, после которого в скобках указывается
вид периода (<span class="Term">Секунда</span>, <span class="Term">Минута</span>, <span class="Term">Час</span>, <span class="Term">День</span>, <span class="Term">Неделя</span>, <span class="Term">Месяц</span>, <span class="Term">Квартал</span>, <span class="Term">Год</span>, <span class="Term">Декада</span>, <span class="Term">Полугодие</span>), начальная и конечная даты интересуемого
периода. Если начальная и конечная даты не указаны, будут использованы первая и
последняя даты, участвующие в результате.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Получить количество покупок по клиентам по часам выбранного дня</span>
<span class="keyword">ВЫБРАТЬ</span>
    ПриходнаяНакладная<span class="operator">.</span>Контрагент<span class="operator">,</span>
    НАЧАЛОПЕРИОДА<span class="operator">(</span>ПриходнаяНакладная<span class="operator">.</span>Дата<span class="operator">,</span> ЧАС<span class="operator">)</span> <span class="keyword">КАК</span> Период<span class="operator">,</span>
    КОЛИЧЕСТВО<span class="operator">(</span>ПриходнаяНакладная<span class="operator">.</span>Ссылка<span class="operator">)</span> <span class="keyword">КАК</span> КоличествоПокупок
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>ПриходнаяНакладная <span class="keyword">КАК</span> ПриходнаяНакладная
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    ПриходнаяНакладная<span class="operator">.</span>Контрагент<span class="operator">,</span>
    НАЧАЛОПЕРИОДА<span class="operator">(</span>ПриходнаяНакладная<span class="operator">.</span>Дата<span class="operator">,</span> ЧАС<span class="operator">)</span>
ИТОГИ
    СУММА<span class="operator">(</span>КоличествоПокупок<span class="operator">)</span>
<span class="keyword">ПО</span>
Период ПЕРИОДАМИ<span class="operator">(</span>МИНУТА<span class="operator">,</span> ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2006</span><span class="operator">,</span><span class="number">6</span><span class="operator">,</span><span class="number">28</span><span class="operator">)</span><span class="operator">,</span> ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2006</span><span class="operator">,</span><span class="number">6</span><span class="operator">,</span><span class="number">28</span><span class="operator">)</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00340.gif?_=1496848987" WIDTH="436" ALT HEIGHT="171"></p>

<p class="MsoCaption">Рис. 341. Результат запроса</p>

<p class="MsoNormal">Такое
представление результата получится, только если при обходе результата по
группировке <span class="Term">Период</span> использовать в качестве источника
измерения все записи периода.</p>

<a name="_ref214884073"></a><a id="TI000000489" class="bookmark" name="issogl3_8.4.16.4_расчет_общих_итогов"><h4>8.4.16.4. Расчет общих итогов</h4></a>

<p class="MsoNormal">Для расчета итогов по всей таблице в предложении <span class="Term">ИТОГИ</span>
следует указать слово <span class="Term">ОБЩИЕ</span>.
В этом случае будут вычислены значения агрегатных функций для всех записей таблицы.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Документ<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    Документ<span class="operator">.</span>Количество <span class="keyword">КАК</span> Количество<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Номер<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Контрагент
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Документ
ИТОГИ
    СУММА<span class="operator">(</span>Количество<span class="operator">)</span>
<span class="keyword">ПО</span>
    ОБЩИЕ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00341.gif?_=1496848987" WIDTH="578" ALT HEIGHT="189"></p>

<p class="MsoCaption">Рис. 342. Результат запроса
(фрагмент)</p>

<a id="TI000000490" class="bookmark" name="issogl3_8.4.16.5_совместное_использование_итогов_и_группировки"><h4>8.4.16.5. Совместное использование итогов и группировки</h4></a>

<p class="MsoNormal">Если итоги используются совместно с группировкой и для
итогов не указан список агрегатных функций, он будет автоматически
формироваться из агрегатных полей списка выборки. Если запрос содержит
объединение, агрегатные функции будут браться из первого запроса.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Документ<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Контрагент <span class="keyword">КАК</span> Контрагент<span class="operator">,</span>
    СУММА<span class="operator">(</span>Документ<span class="operator">.</span>Количество<span class="operator">)</span> <span class="keyword">КАК</span> Количество
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Документ
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    Документ<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Контрагент
ИТОГИ <span class="keyword">ПО</span>
    Номенклатура<span class="operator">,</span>
    Контрагент</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref14252131"></a><IMG src="_img/img00342.gif?_=1496848987" WIDTH="462" ALT HEIGHT="238"></p>

<p class="MsoCaption">Рис. 343. Результат запроса (фрагмент)</p>

<a id="TI000000491" class="bookmark" name="issogl3_8.4.16.6_псевдонимы_итогов"><h4>8.4.16.6. Псевдонимы итогов</h4></a>

<p class="MsoNormal">Полям итогов – контрольным точкам, для
которых считаются итоги, можно назначить псевдоним, для последующего обращения
к ним из встроенного языка предприятия. Для этого после выражения – контрольной
точки необходимо указать имя псевдонима аналогично тому, как это делается в
списке полей выборки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Документ<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
    Документ<span class="operator">.</span>Количество <span class="keyword">КАК</span> Количество<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Номер<span class="operator">,</span>
    Документ<span class="operator">.</span>Ссылка<span class="operator">.</span>Контрагент
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Документ
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    Документ<span class="operator">.</span>Номенклатура
ИТОГИ
    СУММА<span class="operator">(</span>Количество<span class="operator">)</span>
<span class="keyword">ПО</span>
    Номенклатура ТОЛЬКО ИЕРАРХИЯ <span class="keyword">КАК</span> Товары</pre>

<p class="MsoNormal">В случае, если псевдоним не указан, система
сама даст имя итогу так, чтобы оно было уникально. В приведенном выше примере
итог будет иметь имя <span class="Term">Товары</span>.</p>

<a name="_ref217373027"></a><a name="_ref397081585"></a><a name="_ref397080846"></a><a id="TI000000492" class="bookmark" name="issogl2_8.4.17_выражения_в_языке_запросов"><h3>8.4.17. Выражения в языке запросов</h3></a>

<a name="_ref473128578"></a><a id="TI000001596" class="bookmark" name="issogl3_8.4.17.1_общая_информация"><h4>8.4.17.1. Общая информация</h4></a>

<p class="MsoNormal">Во многих конструкциях языка запросов могут использоваться
выражения. Выражения языка запросов описываются следующим набором правил:</p>

<p class="Lang-subheader"><a name="_&lt;выражение&gt;"></a>&lt;Выражение&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
&lt;Разыменование поля&gt; |
&lt;Агрегатная функция&gt; |
&lt;Встроенная функция&gt; |
&lt;Операция выбора&gt; |
&lt;Приведение типа&gt;[.&lt;Разыменование поля&gt;] |
&lt;Значение&gt; |
&lt;Выражение&gt; &lt;Бинарная операция&gt; &lt;Выражение&gt; |
&lt;Унарная операция&gt; &lt;Выражение&gt; |
( &lt;Выражение&gt; )
</pre>

<p class="Lang-subheader"><a name="_&lt;бинарная_операция&gt;"></a>&lt;Бинарная
операция&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">+ | – | * | /</pre>

<p class="Lang-subheader"><a name="_&lt;унарная_операция&gt;"></a>&lt;Унарная
операция&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">– | +</pre>

<p class="MsoNormalCxSpFirst">В простейшем случае выражение является ссылкой на
поле исходной таблицы – источника данных запроса. Ссылка может задаваться
с указанием таблицы, содержащей это поле, или без указания самой таблицы. Описание
разыменования полей см. <a href="#_ref15295173">здесь</a>.</p>

<p class="MsoNormalCxSpMiddle">Выражения в списке полей выборки, в предложениях <span class="Term">ИМЕЮЩИЕ</span>,
<span class="Term">ИТОГИ</span>,
<span class="Term">УПОРЯДОЧИТЬ
ПО</span>, могут быть агрегатными функциями (см. <a href="#_ref14592889">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">Выражение может быть встроенной функцией языка запросов
(см. <a href="#_ref214884138">здесь</a>). Могут использоваться операции выбора (см. <a href="#_ref214884151">здесь</a>) и операции приведения типа значения (см. <a href="#_ref15211858">здесь</a>).</p>

<p class="MsoNormalCxSpMiddle">В выражениях могут непосредственно указываться значения
логических, числовых, строковых и др. констант; также могут использоваться
значения параметров запроса (см. <a href="#_ref15212187">здесь</a>). В выражениях к значениям соответствующих типов
могут применяться бинарные и унарные операции. При использовании операции
деления рекомендуется делать проверку делителя на отличие от нуля.</p>

<p class="MsoNormalCxSpLast">Типом операций <span class="Term">СУММА()</span>, <span class="Term">СРЕДНЕЕ()</span>,
<span class="Term">ВЫРАЗИТЬ()</span>,
<span class="Term">*</span>,
<span class="Term">+</span>,
<span class="Term">-</span>,
применяемым к числовым типам будет являться число с произвольной точностью и
разрядностью.</p>

<a name="_ref15295173"></a><a name="_ref14265441"></a><a id="TI000000493" class="bookmark" name="issogl3_8.4.17.2_разыменование_полей"><h4>8.4.17.2. Разыменование полей</h4></a>

<p class="MsoNormal">Выражения языка запросов в простейшем случае представляют
собой ссылки на поля таблиц информационной базы. В общем виде ссылки
описываются следующими правилами:</p>

<p class="Lang-subheader">&lt;Разыменование поля&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">[&lt;Таблица&gt;.]&lt;Имя поля&gt;[.&lt;Имя поля&gt;[…]]</pre>

<p class="Lang-subheader">&lt;Таблица&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Имя таблицы&gt; | &lt;Псевдоним источника&gt;</pre>

<p class="MsoNormalCxSpFirst">Разыменование поля начинается с имени таблицы, содержащей
это поле. Если имя поля уникально – существует только у одной из таблиц
среди указанных в списке источников, таблица может быть опущена.</p>

<p class="MsoNormalCxSpMiddle">Если поле имеет ссылочный тип, язык запросов
позволяет обращаться к полям таблицы, на которую ссылается поле, и так далее.
Имена полей указываются через точку.</p>

<p class="MsoNormalCxSpLast">Если исходной таблице в списке источников присвоен
псевдоним источника, он может использоваться вместо имени таблицы в
разыменовании полей этой таблицы. В противном случае указывается имя таблицы (см. <a href="#_ref261867556">здесь</a>).</p>

<a name="_ref15211507"></a><a name="_ref14592889"></a><a name="_ref370832081"></a><a id="TI000000494" class="bookmark" name="issogl3_8.4.17.3_агрегатные_функции_языка_запросов"><h4>8.4.17.3. Агрегатные функции языка запросов</h4></a>

<p class="MsoNormal">В языке запросов предусмотрены агрегатные
функции, которые используются при группировке результатов запроса и при подсчете
итогов. Агрегатные функции предназначены для обобщения значений указанного
параметра. Определены следующие агрегатные функции:</p>

<p class="Lang-subheader"><a name="_&lt;агрегатная_функция&gt;_1"></a>&lt;Агрегатная
функция&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
СУММА ( &lt;Выражение&gt; ) |
СРЕДНЕЕ ( &lt;Выражение&gt; ) |
МИНИМУМ ( &lt;Выражение&gt; ) |
МАКСИМУМ ( &lt;Выражение&gt; ) |
КОЛИЧЕСТВО ( [РАЗЛИЧНЫЕ] &lt;Выражение&gt; | * )
</pre>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Накладная<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    СУММА<span class="operator">(</span>Накладная<span class="operator">.</span>Сумма<span class="operator">)</span> <span class="keyword">КАК</span> Сумма<span class="operator">,</span>
    СРЕДНЕЕ<span class="operator">(</span>Накладная<span class="operator">.</span>Сумма<span class="operator">)</span> <span class="keyword">КАК</span> Среднее<span class="operator">,</span>
    МАКСИМУМ<span class="operator">(</span>Накладная<span class="operator">.</span>Сумма<span class="operator">)</span> <span class="keyword">КАК</span> Максимум<span class="operator">,</span>
    МИНИМУМ<span class="operator">(</span>Накладная<span class="operator">.</span>Сумма<span class="operator">)</span> <span class="keyword">КАК</span> Минимум<span class="operator">,</span>
    КОЛИЧЕСТВО<span class="operator">(</span>Накладная<span class="operator">.</span>Сумма<span class="operator">)</span> <span class="keyword">КАК</span> Колич
<span class="keyword">ИЗ</span>
 Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Накладная
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    Накладная<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    Накладная<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование
ИТОГИ <span class="keyword">ПО</span>
    ОБЩИЕ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00343.gif?_=1496848987" WIDTH="701" ALT HEIGHT="189"></p>

<p class="MsoCaption">Рис. 344. Результат запроса
(фрагмент)</p>

<p class="MsoNormal">Агрегатные функции могут использоваться в
списке полей выборки, в предложениях <span class="Term">ИМЕЮЩИЕ</span>, <span class="Term">ИТОГИ</span>,
<span class="Term">УПОРЯДОЧИТЬ ПО</span>.
В списке полей выборки агрегатные функции следует использовать только для
получения результата. Не рекомендуется использовать агрегатные функции в списке
полей выборки для сравнения.</p>

<p class="Lang-subheader">Корректный запрос:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
        КОЛИЧЕСТВО<span class="operator">(</span><span class="operator">*</span><span class="operator">)</span><span class="operator">,</span>
   Поставщик
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> Накладная
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    Поставщик
ИМЕЮЩИЕ
    КОЛИЧЕСТВО<span class="operator">(</span><span class="operator">*</span><span class="operator">)</span> <span class="operator">&gt;</span> <span class="number">1</span></pre>

<p class="Lang-subheader">Некорректный запрос:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
        <span class="keyword">КОГДА</span> КОЛИЧЕСТВО<span class="operator">(</span><span class="operator">*</span><span class="operator">)</span> <span class="operator">&gt;</span> <span class="number">1</span> <span class="keyword">ТОГДА</span> <span class="keyword">Истина</span> <span class="keyword">ИНАЧЕ</span> <span class="keyword">Ложь</span> <span class="keyword">КОНЕЦ</span><span class="operator">,</span>
        Поставщик
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> Накладная
СГРУППИРОВАТЬ <span class="keyword">ПО</span>
    Поставщик</pre>

<p class="MsoNormal">Несмотря на то, что некорректный
запрос может работать успешно, такие конструкции (участие агрегатной функции не
для получения результата,<br>
а для проверки условия) в разделе <span class="Term">ВЫБРАТЬ</span>
имеют свою специфику на разных СУБД и могут приводить к ошибкам.</p>

<p class="Lang">СУММА</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция вычисляет арифметическую сумму всех попавших
в выборку значений поля.</p>

<p class="MsoNormalCxSpMiddle">В качестве параметра функции можно указывать
только поля, содержащие числовое значение.</p>

<p class="MsoNormalCxSpLast">Если поле не может содержать числовых
значений, то применение функции <span class="Term">СУММА</span> к такому полю вызовет ошибку. Данная функция
может быть применена к такому полю, только если поле может содержать числовые
значения (имеет составной тип данных). Но если среди значений поля в выборке
встретится нечисловое значение (помимо значений <span class="Term">NULL</span>),
это вызовет ошибку.</p>

<p class="Lang">СРЕДНЕЕ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция вычисляет среднее значение всех
попавших в выборку значений поля.</p>

<p class="MsoNormalCxSpMiddle">В качестве параметра функции можно указывать
только ссылки на поля, содержащие числовое значение.</p>

<p class="MsoNormalCxSpLast">Если поле не может содержать числовых
значений, то применение функции <span class="Term">СРЕДНЕЕ</span> к такому полю вызовет ошибку. Данная
функция может быть применена к такому полю в том случае, если поле может
содержать числовые значения (имеет составной тип данных). Но если среди
значений поля в выборке встретится нечисловое значение (помимо значений <span class="Term">NULL</span>),
это вызовет ошибку.</p>

<p class="Lang">МИНИМУМ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция вычисляет минимальное значение из всех
попавших в выборку значений поля.</p>

<p class="MsoNormalCxSpMiddle">В качестве параметра функции можно указывать
ссылки на поля, содержащие значения любого типа.</p>

<p class="MsoNormalCxSpLast">При определении минимального значения
применяются правила сравнения значений, описанные в разделе «Правила сравнения
значений».</p>

<p class="Lang">МАКСИМУМ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция вычисляет максимальное значение из
всех попавших в выборку значений поля.</p>

<p class="MsoNormalCxSpMiddle">В качестве параметра функции можно указывать
выражения, содержащие значения любого типа. Не может применяться к выражениям с
типом <span class="Term">ХранилищеЗначения</span>, <span class="Term">МоментВремени</span>
и строкам неограниченной длины.</p>

<p class="MsoNormalCxSpLast">При определении максимального значения
применяются правила сравнения значений, описанные в разделе «Правила сравнения
значений».</p>

<p class="Lang">КОЛИЧЕСТВО</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция подсчитывает количество значений
параметра, попавших в выборку. В отличие от других агрегатных функций, функция <span class="Term">КОЛИЧЕСТВО</span>
допускает три способа использования:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Функция позволяет подсчитать количество значений
указанного поля, не равных <span class="Term">NULL</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Функция позволяет подсчитать количество различных
значений указанного поля, не равных <span class="Term">NULL</span>. Для этого
перед спецификацией поля нужно указать ключевое слово <span class="Term">РАЗЛИЧНЫЕ</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Функция позволяет подсчитать количество строк в
результате запроса. Для этого в качестве параметра функции нужно указать
звездочку «<span class="Interface">*</span>».</p>

<p class="MsoNormal">В качестве параметра функции можно указывать
ссылки на поля, содержащие значения любого типа.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    КОЛИЧЕСТВО<span class="operator">(</span><span class="operator">*</span><span class="operator">)</span> <span class="keyword">КАК</span> Всего<span class="operator">,</span>
    КОЛИЧЕСТВО<span class="operator">(</span>РАЗЛИЧНЫЕ Накладная<span class="operator">.</span>Номенклатура<span class="operator">)</span> <span class="keyword">КАК</span> Разные
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Накладная</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><a name="_ref15294290"></a><IMG src="_img/img00344.gif?_=1496848987" WIDTH="369" ALT HEIGHT="50"></p>

<p class="MsoCaption">Рис. 345. Результат запроса</p>

<a name="_ref214884138"></a><a name="_ref409711588"></a><a id="TI000000495" class="bookmark" name="issogl3_8.4.17.4_встроенные_функции_языка_запросов"><h4>8.4.17.4. Встроенные функции языка запросов</h4></a>

<p class="MsoNormalCxSpFirst">В языке запросов определены встроенные функции, которые
могут использоваться в выражениях в списке полей выборки (см. <a href="#_ref214882988">здесь</a>) и в условии отбора в предложении <span class="Term">ГДЕ</span> (см. <a href="#_ref15212776">здесь</a>).</p>

<p class="MsoNormalCxSpLast">Определены следующие встроенные функции:</p>

<p class="Lang-subheader"><a name="_&lt;встроенная_функция&gt;"></a>&lt;Встроенная
функция&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ПОДСТРОКА ( &lt;Выражение&gt;, &lt;Значение&gt;, &lt;Значение&gt; ) |
ГОД ( &lt;Выражение&gt; ) |
КВАРТАЛ ( &lt;Выражение&gt; ) |
МЕСЯЦ ( &lt;Выражение&gt; ) |
ДЕНЬГОДА ( &lt;Выражение&gt; ) |
ДЕНЬ ( &lt;Выражение&gt; ) |
НЕДЕЛЯ ( &lt;Выражение&gt; ) |
ДЕНЬНЕДЕЛИ ( &lt;Выражение&gt; ) |
ЧАС ( &lt;Выражение&gt; ) |
МИНУТА ( &lt;Выражение&gt; ) |
СЕКУНДА ( &lt;Выражение&gt; ) |
НАЧАЛОПЕРИОДА(&lt;Выражение&gt;, Минута | Час | День | Неделя | Месяц | Квартал | Год | Декада | Полугодие) |
КОНЕЦПЕРИОДА(&lt;Выражение&gt;, Минута | Час | День | Неделя | Месяц | Квартал | Год | Декада | Полугодие) |
ДОБАВИТЬКДАТЕ (&lt;Выражение&gt;, Минута | Час | День | Неделя | Месяц | Квартал | Год | Декада | Полугодие, &lt;Выражение&gt;) |
РАЗНОСТЬДАТ(&lt;Выражение&gt;, &lt;Выражение&gt;, Секунда | Минута | Час | День | Месяц | Квартал | Год) |
ТИПЗНАЧЕНИЯ(&lt;Выражение&gt;) |
ПРЕДСТАВЛЕНИЕ(&lt;Выражение&gt;) |
ЕСТЬNULL(&lt;Выражение&gt;, &lt;Выражение&gt;)
</pre>

<p class="Lang">ПОДСТРОКА</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Данная функция предназначена для выделения подстроки из
строки. В функцию передаются три параметра:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Строка, из которой необходимо выделить
подстроку. Выражение, имеющее тип <span class="Term">Строка</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Позиция символа, с которого начинается
выделяемая из строки подстрока. Значение типа <span class="Term">Число</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Длина выделяемой подстроки. Значение типа <span class="Term">Число</span>.</p>

<p class="MsoNormal">Если в качестве первого параметра фигурирует строка, то
результатом функции будет строка (возможно, нулевой длины). Если в качестве
первого параметра будет использовано значение <span class="Term">NULL</span>, то результатом
функции также будет значение <span class="Term">NULL</span>. Другие значения считаются недопустимыми
и вызывают состояние ошибки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> ПЕРВЫЕ <span class="number">8</span>
    Контрагенты<span class="operator">.</span>Наименование<span class="operator">,</span>
    ПОДСТРОКА<span class="operator">(</span>Контрагенты<span class="operator">.</span>Наименование<span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">5</span><span class="operator">)</span> <span class="keyword">КАК</span> Подстрока
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Контрагенты <span class="keyword">КАК</span> Контрагенты</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00345.gif?_=1496848987" WIDTH="483" ALT HEIGHT="182"></p>

<p class="MsoCaption">Рис. 346. Результат запроса</p>

<p class="Lang">ГОД</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления номера
года из значения типа <span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">КВАРТАЛ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления номера
квартала из значения типа <span class="Term">Дата</span>. Номер квартала находится в диапазоне 1–4.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">МЕСЯЦ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления номера
месяца из значения типа <span class="Term">Дата</span>. Номер месяца находится в диапазоне 1–12.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">ДЕНЬГОДА</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления дня года
из значения типа <span class="Term">Дата</span>.
День года находится в диапазоне 1–366.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">ДЕНЬ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления дня месяца
из значения типа <span class="Term">Дата</span>.
День месяца находится в диапазоне 1–31.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">НЕДЕЛЯ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления номера
недели года из значения типа <span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки. При вычислении
учитывается значение свойства <span class="Interface">Первый день недели</span> региональных
установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>).</p>

<p class="Lang">ДЕНЬНЕДЕЛИ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления дня недели
из значения типа <span class="Term">Дата</span>.
День недели находится в диапазоне 1 (понедельник) – 7 (воскресенье).</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">ЧАС</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления часа
суток из значения типа <span class="Term">Дата</span>.
Час суток находится в диапазоне 0–23.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">МИНУТА</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления минуты
часа из значения типа <span class="Term">Дата</span>.
Минута часа находится в диапазоне 0–59.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то
результатом функции также будет значение <span class="Term">NULL</span>. Другие
значения считаются недопустимыми и вызывают состояние ошибки.</p>

<p class="Lang">СЕКУНДА</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная функция предназначена для вычисления секунды
минуты из значения типа <span class="Term">Дата</span>. Секунда минуты находится в диапазоне 0–59.</p>

<p class="MsoNormalCxSpMiddle">Параметр функции – это выражение, имеющее тип
<span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpLast">Если в качестве параметра фигурирует значение типа <span class="Term">Дата</span>,
то результатом функции будет значение типа <span class="Term">Число</span>. Если в
качестве параметра будет использовано значение <span class="Term">NULL</span>, то результатом
функции также будет значение <span class="Term">NULL</span>. Другие значения считаются недопустимыми
и вызывают состояние ошибки.</p>

<p class="Lang">НАЧАЛОПЕРИОДА</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst"></a><a name="_ref27740306"></a><a name="_toc16323416">Функция предназначена для выделения
определенной даты из заданной даты.</p>

<p class="MsoNormalCxSpLast">Параметры
функции – это выражение, имеющее тип <span class="Term">Дата</span> и тип периода – одно из значений: <span class="Term">Минута</span>, <span class="Term">Час</span>, <span class="Term">День</span>, <span class="Term">Неделя</span>, <span class="Term">Месяц</span>, <span class="Term">Квартал</span>, <span class="Term">Год</span>, <span class="Term">Декада</span>, <span class="Term">Полугодие</span>. Если тип периода указан <span class="Term">Неделя</span>, то учитывается значение свойства <span class="Interface">Первый день недели</span>
региональных установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>).</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> НАЧАЛОПЕРИОДА<span class="operator">(</span>ДАТАВРЕМЯ <span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> МЕСЯЦ<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00346.gif?_=1496848987" WIDTH="283" ALT HEIGHT="60"></p>

<p class="MsoCaption">Рис. 347. Результат запроса</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> НАЧАЛОПЕРИОДА<span class="operator">(</span>ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> ДЕНЬ<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00347.gif?_=1496848987" WIDTH="283" ALT HEIGHT="62"></p>

<p class="MsoCaption">Рис. 348. Результат запроса</p>

<p class="Lang">КОНЕЦПЕРИОДА</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
предназначена для выделения определенной даты из заданной даты.</p>

<p class="MsoNormalCxSpLast">Параметры
функции – это выражение, имеющее тип <span class="Term">Дата</span> и тип периода – одно из значений: <span class="Term">Минута</span>, <span class="Term">Час</span>, <span class="Term">День</span>, <span class="Term">Неделя</span>, <span class="Term">Месяц</span>, <span class="Term">Квартал</span>, <span class="Term">Год</span>, <span class="Term">Декада</span>, <span class="Term">Полугодие</span>. Если тип периода указан <span class="Term">Неделя</span>, то учитывается значение свойства <span class="Interface">Первый день недели</span>
региональных установок информационной базы (подробнее см. <a href="/db/v8310doc/bookmark/adm/TI000000135" target="_top">здесь</a>).</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> КОНЕЦПЕРИОДА<span class="operator">(</span>ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> МЕСЯЦ<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00348.gif?_=1496848987" WIDTH="283" ALT HEIGHT="56"></p>

<p class="MsoCaption">Рис. 349. Результат запроса</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> КОНЕЦПЕРИОДА<span class="operator">(</span>ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> ГОД<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00349.gif?_=1496848987" WIDTH="283" ALT HEIGHT="45"></p>

<p class="MsoCaption">Рис. 350. Результат запроса</p>

<p class="Lang">ДОБАВИТЬКДАТЕ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
предназначена для прибавления к дате некоторой величины.</p>

<p class="MsoNormalCxSpMiddle">Первый
параметр – исходная дата, к значению которой требуется добавить заданную
величину, определяемую вторым и третьим параметрами; выражение, имеющее тип <span class="Term">Дата</span>.</p>

<p class="MsoNormalCxSpMiddle">Второй
параметр – тип увеличения, одно из значений: <span class="Term">Секунда</span>, <span class="Term">Минута</span>, <span class="Term">Час</span>, <span class="Term">День</span>, <span class="Term">Неделя</span>, <span class="Term">Месяц</span>, <span class="Term">Квартал</span>, <span class="Term">Год</span>, <span class="Term">Декада</span>, <span class="Term">Полугодие</span>. Следует учитывать, что под термином
<span class="Term">Декада</span>
понимается строго 10 дней, вне зависимости от даты, указанной в первом
параметре функции.</p>

<p class="MsoNormalCxSpMiddle">Третий
параметр – величина, на которую требуется увеличить дату, задаваемую
первым параметром; тип <span class="Term">Число</span> (дробная часть игнорируется).</p>

<p class="MsoNormalCxSpLast">Рекомендуется
третий параметр (размерность увеличения) указывать так, чтобы он соответствовал
решаемой прикладной задаче. Так, если прикладная задача оперирует днями или
месяцами, то следует добавлять к дате именно дни и месяцы. Данная рекомендация
обусловлена тем, что добавление к дате значения с очень высокой дискретностью
(секунды, минуты, часы) может по-разному учитывать переходы на зимнее/летнее
время на разных СУБД.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>    ДОБАВИТЬКДАТЕ<span class="operator">(</span>ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> МЕСЯЦ<span class="operator">,</span> <span class="number">1</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00350.gif?_=1496848987" WIDTH="283" ALT HEIGHT="51"></p>

<p class="MsoCaption">Рис. 351. Результат запроса</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> ДобавитьКДате<span class="operator">(</span>ДатаВремя<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> День<span class="operator">,</span> <span class="number">5</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00351.gif?_=1496848987" WIDTH="283" ALT HEIGHT="54"></p>

<p class="MsoCaption">Рис. 352. Результат запроса</p>

<p class="Lang">РАЗНОСТЬДАТ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
предназначена для получения разницы между двумя датами.</p>

<p class="MsoNormalCxSpMiddle">Первый
параметр – выражение типа <span class="Term">Дата</span>. Второй параметр – выражение типа <span class="Term">Дата</span>. Третий параметр – тип разности,
одно из значений: <span class="Term">Секунда</span>, <span class="Term">Минута</span>, <span class="Term">Час</span>, <span class="Term">День</span>, <span class="Term">Месяц</span>, <span class="Term">Квартал</span>, <span class="Term">Год</span>.</p>

<p class="MsoNormalCxSpMiddle">Рекомендуется
третий параметр (тип разности) указывать так, чтобы он соответствовал решаемой
прикладной задаче. Так, если прикладная задача оперирует днями или месяцами, то
следует вычислять разность дат именно в днях или месяцах. Не рекомендуется
получать неадекватную (с точки зрения прикладной задачи) разность дат, а потом
средствами языка запросов или встроенного языка приводить ее к желаемой
разнице. Данная рекомендация обусловлена тем, что расчет разницы с очень
высокой дискретностью (секунды, минуты, часы) может по-разному учитывать
переходы на зимнее/летнее время на разных СУБД.</p>

<p class="MsoNormalCxSpLast">Не
поддерживается использование данной функции при задании значения параметра
виртуальной таблицы <span class="Term">Период</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> РАЗНОСТЬДАТ<span class="operator">(</span>ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">15</span><span class="operator">,</span> <span class="number">34</span><span class="operator">)</span><span class="operator">,</span> ДАТАВРЕМЯ<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">14</span><span class="operator">,</span> <span class="number">9</span><span class="operator">,</span> <span class="number">18</span><span class="operator">,</span> <span class="number">06</span><span class="operator">)</span><span class="operator">,</span> ДЕНЬ<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00352.gif?_=1496848987" WIDTH="283" ALT HEIGHT="50"></p>

<p class="MsoCaption">Рис. 353. Результат запроса</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span> РАЗНОСТЬДАТ<span class="operator">(</span>ДатаВремя<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">12</span><span class="operator">)</span><span class="operator">,</span> ДатаВремя<span class="operator">(</span><span class="number">2002</span><span class="operator">,</span> <span class="number">11</span><span class="operator">,</span> <span class="number">03</span><span class="operator">)</span><span class="operator">,</span> МЕСЯЦ<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00353.gif?_=1496848987" WIDTH="283" ALT HEIGHT="51"></p>

<p class="MsoCaption">Рис. 354. Результат запроса</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span>
Функция рассчитывает календарную разницу между двумя датами, поэтому ее нельзя
использовать там, где необходимо рассчитать количество банковских или рабочих
дней между двумя датами.</p>

<p class="Lang">Функция
ТИПЗНАЧЕНИЯ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormal">Функция
определения типа значения в запросе.</p>

<p class="Lang-subheader">Параметры:</p>

<p class="MsoNormalCxSpFirst">Параметр
функции – выражение любого типа.</p>

<p class="MsoNormalCxSpMiddle">Возвращаемое
значение – значение типа <span class="Term">Тип</span>.</p>

<p class="MsoNormalCxSpLast">Если
параметром функции является значение <span class="Term">Неопределено</span>, то возвращаемое значение также
будет <span class="Term">Неопределено</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    ТИПЗНАЧЕНИЯ<span class="operator">(</span>УчетНоменклатуры<span class="operator">.</span>Регистратор<span class="operator">)</span> <span class="keyword">КАК</span> Документ
<span class="keyword">ИЗ</span>
    РегистрНакопления<span class="operator">.</span>УчетНоменклатуры <span class="keyword">КАК</span> УчетНоменклатуры</pre>

<p class="Lang">Функция
ПРЕДСТАВЛЕНИЕ</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Данная
функция предназначена для получения строкового представления значения
произвольного типа.</p>

<p class="MsoNormalCxSpMiddle">Параметр
функции – выражение любого типа.</p>

<p class="MsoNormalCxSpMiddle">Возвращаемое
значение – представление значения, тип <span class="Term">Строка</span>.</p>

<p class="MsoNormalCxSpLast">Результат
работы функции не может быть использован внутри других функций, за исключением
функции <span class="Term">ПРЕДСТАВЛЕНИЕ</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    ПРЕДСТАВЛЕНИЕ<span class="operator">(</span>Документ<span class="operator">.</span>Контрагент<span class="operator">)</span> <span class="keyword">КАК</span> Получатель<span class="operator">,</span>
    ПРЕДСТАВЛЕНИЕ<span class="operator">(</span>Документ<span class="operator">.</span>Дата<span class="operator">)</span> <span class="keyword">КАК</span> Дата
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> Документ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00354.gif?_=1496848987" WIDTH="408" ALT HEIGHT="182"></p>

<p class="MsoCaption">Рис. 355. Результат запроса</p>

<p class="Lang">Функция
ЕСТЬNULL (ISNULL)</p>

<p class="Lang-subheader">Описание:</p>

<p class="MsoNormalCxSpFirst">Функция
предназначена для замены значения <span class="Term">NULL</span> на другое значение.</p>

<p class="MsoNormalCxSpLast">Параметры
функции:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
первый параметр – выражение любого типа;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
второй параметр – выражение любого типа.</p>

<p class="MsoNormalCxSpFirst">Возвращаемое
значение: значение первого параметра, если первый параметр не содержит значение
<span class="Term">NULL</span>;
значение второго параметра в противном случае.</p>

<p class="MsoNormalCxSpLast">Второй
параметр будет преобразован к типу первого в том случае, если тип первого
параметра является строкой или числом.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Получить сумму по полю Количество. В случае, если нет </span>
<span class="comment">// записей, получить 0</span>
<span class="keyword">ВЫБРАТЬ</span>
    ЕСТЬNULL<span class="operator">(</span>СУММА<span class="operator">(</span>РасходнаяНакладнаяСостав<span class="operator">.</span>Количество<span class="operator">)</span><span class="operator">,</span> <span class="number">0</span><span class="operator">)</span>
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав</pre>

<a name="_ref214884151"></a><a id="TI000000496" class="bookmark" name="issogl3_8.4.17.5_операции_выбора_в_языке_запросов"><h4>8.4.17.5. Операции выбора в языке запросов</h4></a>

<p class="MsoNormalCxSpFirst">В выражениях языка запросов могут применяться операции
выбора, которые позволяют получить одно из возможных значений в соответствии с
указанными условиями.</p>

<p class="MsoNormalCxSpLast">Операция выбора описывается следующим набором правил:</p>

<p class="Lang-subheader"><a name="_&lt;операция_выбора&gt;"></a>&lt;Операция
выбора&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ВЫБОР
&lt;Альтернативы выбора&gt;
[ИНАЧЕ &lt;Выражение&gt;]
КОНЕЦ
</pre>

<p class="Lang-subheader"><a name="_&lt;альтернативы_выбора&gt;"></a>&lt;Альтернативы
выбора&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
&lt;Одиночный выбор&gt;
[&lt;Альтернативы выбора&gt;]
</pre>

<p class="Lang-subheader"><a name="_&lt;одиночный_выбор&gt;"></a>&lt;Одиночный
выбор&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
КОГДА &lt;Логическое выражение&gt;
ТОГДА &lt;Выражение&gt;
</pre>

<p class="MsoNormalCxSpFirst"><a name="_&lt;предикат&gt;"></a><a name="_&lt;иначе_выбор&gt;"></a><a name="_&lt;предикат&gt;_1"></a>В операции
выбора может указываться неограниченное количество альтернативных одиночных
выборов <span class="Term">КОГДА
… ТОГДА</span>. Они обрабатываются в запросе последовательно. Если
логическое выражение имеет значение <span class="Term">Истина</span>, обработка операции выбора завершается.
Результатом операции является значение выражения, указанного после слова <span class="Term">ТОГДА</span>.
Описание логических выражений см. <a href="#_ref15220433">здесь</a>.</p>

<p class="MsoNormalCxSpLast">Значение выражения, указанного после слова <span class="Term">ИНАЧЕ</span>,
используется в качестве результата операции выбора в том случае, если во всех
ранее указанных альтернативных одиночных выборах предикат имел значение <span class="Term">Ложь</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    <span class="keyword">ВЫБОР</span>
        <span class="keyword">КОГДА</span> Номенклатура<span class="operator">.</span>ЭтоГруппа <span class="operator">=</span> <span class="keyword">ИСТИНА</span>
            <span class="keyword">ТОГДА</span> <span class="string">&quot;Это группа&quot;</span>
        <span class="keyword">КОГДА</span> Номенклатура<span class="operator">.</span>ЗакупочнаяЦена <span class="operator">&gt;</span> <span class="number">1000</span>
            <span class="keyword">ТОГДА</span> <span class="string">&quot;1000 -&quot;</span>
        <span class="keyword">КОГДА</span> Номенклатура<span class="operator">.</span>ЗакупочнаяЦена <span class="operator">&gt;</span> <span class="number">100</span>
            <span class="keyword">ТОГДА</span> <span class="string">&quot;100 – 1000&quot;</span>
        <span class="keyword">КОГДА</span> Номенклатура<span class="operator">.</span>ЗакупочнаяЦена <span class="operator">&gt;</span> <span class="number">10</span>
            <span class="keyword">ТОГДА</span> <span class="string">&quot;10 – 100&quot;</span>
        <span class="keyword">КОГДА</span> Номенклатура<span class="operator">.</span>ЗакупочнаяЦена <span class="operator">&gt;</span> <span class="number">0</span>
            <span class="keyword">ТОГДА</span> <span class="string">&quot;0 – 10&quot;</span>
        <span class="keyword">ИНАЧЕ</span> <span class="string">&quot;Не задана&quot;</span>
    <span class="keyword">КОНЕЦ</span> <span class="keyword">КАК</span> Цена
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00355.gif?_=1496848987" WIDTH="444" ALT HEIGHT="214"></p>

<p class="MsoCaption">Рис. 356. Результат запроса (фрагмент)</p>

<a name="_ref15211858"></a><a id="TI000000497" class="bookmark" name="issogl3_8.4.17.6_приведение_типа_в_языке_запросов"><h4>8.4.17.6. Приведение типа в языке запросов</h4></a>

<p class="MsoNormal">Поля исходных таблиц могут иметь составной тип. Для таких
полей возникает необходимость привести значения поля к какому-либо
определенному типу. В языке запросов предусмотрена возможность приведения типа.
Ею можно пользоваться в списке полей выборки и в условии отбора в предложении <span class="Term">ГДЕ</span>.</p>

<p class="Lang-subheader"><a name="_&lt;приведение_типа&gt;"></a>&lt;Приведение
типа&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ВЫРАЗИТЬ ( &lt;Выражение&gt; КАК &lt;Тип значения&gt; )</pre>

<p class="Lang-subheader"><a name="_&lt;базовый_тип&gt;"></a>&lt;Тип
значения&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
Булево |
Число [(Длина[, Точность])]|
Строка [(Длина)]|
Дата |
&lt;Имя таблицы&gt;
</pre>

<p class="Lang-subheader">&lt;Длина&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">Число</pre>

<p class="Lang-subheader">&lt;Точность&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">Число</pre>

<p class="MsoNormalCxSpFirst">Выражение приводится к одному из примитивных типов
или к ссылочному типу данных. В последнем случае имя таблицы указывает на
соответствующую таблицу информационной базы.</p>

<p class="MsoNormalCxSpMiddle">Если выражение содержит в составном типе требуемый
тип значения, то приведение типа считается осуществимым, и для каждого значения
указанного типа результатом будет это самое значение. Для значений других типов
результатом приведения типа будет значение <span class="Term">NULL</span>.</p>

<p class="MsoNormalCxSpLast">Если выражение не содержит в составном типе требуемый
тип значения, то выполнение данного запроса завершится ошибкой из-за
принципиальной невозможности совершить приведение типов.</p>

<a name="_ref15212187"></a><a id="TI000000498" class="bookmark" name="issogl3_8.4.17.7_константы_и_параметры_в_языке_запросов"><h4>8.4.17.7. Константы и параметры в языке запросов</h4></a>

<p class="MsoNormal">В выражениях языка запросов могут напрямую указываться
значения типа <span class="Term">Булево</span>,
<span class="Term">Число</span>,
<span class="Term">Строка</span>
или <span class="Term">Дата</span>.
Также могут использоваться значения параметров запроса.</p>

<p class="Lang-subheader"><a name="_&lt;значение&gt;"></a>&lt;Значение&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ИСТИНА |
ЛОЖЬ |
&lt;Литерал типа ЧИСЛО&gt; |
&lt;Литерал типа СТРОКА&gt; |
&lt;Литерал типа ДАТА&gt; |
&lt;Литерал типа ТИП&gt; |
&lt;Имя параметра&gt; |
НЕОПРЕДЕЛЕНО |
NULL
</pre>

<p class="Lang-subheader"><a name="_&lt;литерал_типа_number&gt;"></a>&lt;Литерал
типа Число&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Целое число&gt;[.&lt;Целое число&gt;]</pre>

<p class="Lang-subheader"><a name="_&lt;целоечисло&gt;"></a><a name="_&lt;литерал_типа_string&gt;"></a>&lt;Литерал типа Строка&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&quot;&lt;Последовательность символов&gt;&quot;</pre>

<p class="Lang-subheader"><a name="_&lt;строкасимволов&gt;"></a><a name="_&lt;литерал_типа_date&gt;"></a>&lt;Литерал типа Дата&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ДАТАВРЕМЯ ( &lt;Целое число&gt;, &lt;Целое число&gt;, &lt;Целое число&gt;[,
            &lt;Целое число&gt;, &lt;Целое число&gt;, &lt;Целое число&gt;] )
</pre>

<p class="MsoNormalCxSpFirst">Значения типа <span class="Term">Булево</span>, <span class="Term">Число</span>,
<span class="Term">Строка</span>
в языке запросов задаются так же, как и во встроенном языке.</p>

<p class="MsoNormalCxSpLast">Значения типа <span class="Term">Дата</span> задаются с помощью
ключевого слова <span class="Term">ДАТАВРЕМЯ</span>,
после которого в скобках последовательно указываются год, месяц, день, час,
минута, секунда. Последние три указывать необязательно.</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span> Максимальная дата,
которую возможно задать при помощи литерала <span class="Term">ДАТАВРЕМЯ</span> – <span class="Term">31.12.3999
23:59:59</span>.</p>

<p class="MsoNormal">В запрос могут передаваться параметры (см. описание объекта <span class="Term">Запрос</span>).
Значения параметров могут использоваться в выражениях языка запросов. Для этого
необходимо указать символ &quot;<span class="Term">&amp;</span>&quot; и после него имя параметра.</p>

<p class="Lang-subheader"><a name="_ref14764123"></a><a name="_&lt;идентификатор_параметра&gt;"></a>&lt;Литерал
типа Тип&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">ТИП(&lt;Имя типа&gt;)</pre>

<p class="MsoNormal"><span class="Term">&lt;Имя
типа&gt;</span> – имя примитивного типа либо имя таблицы, тип
ссылки которой нужно получить. Результатом данной конструкции будет значение
типа <span class="Term">Тип</span> для указанного типа.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Получение типа &quot;Строка&quot;</span>
ТИП<span class="operator">(</span>Строка<span class="operator">)</span>
<span class="comment">// Получение типа – ссылка на справочник &quot;Номенклатура&quot;</span>
ТИП<span class="operator">(</span>Справочник<span class="operator">.</span>Номенклатура<span class="operator">)</span> </pre>

<p class="MsoNormal">Значения
типа <span class="Term">Тип</span> в языке запросов можно использовать в
операциях сравнения, упорядочивания, группировки.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    ТИПЗНАЧЕНИЯ<span class="operator">(</span>Остатки<span class="operator">.</span>Регистратор<span class="operator">)</span>
<span class="keyword">ИЗ</span>
    РегистрНакопления<span class="operator">.</span>УчетНоменклатуры <span class="keyword">КАК</span> Остатки
ГДЕ
ТИПЗНАЧЕНИЯ<span class="operator">(</span>Остатки<span class="operator">.</span>Регистратор<span class="operator">)</span> <span class="operator">=</span> ТИП<span class="operator">(</span>Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">)</span></pre>

<p class="MsoNormal">Возможна
передача значения типа <span class="Term">Тип</span> как параметр запроса.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    ТИПЗНАЧЕНИЯ<span class="operator">(</span>Остатки<span class="operator">.</span>Регистратор<span class="operator">)</span>
<span class="keyword">ИЗ</span>
    РегистрНакопления<span class="operator">.</span>УчетНоменклатуры <span class="keyword">КАК</span> Остатки
ГДЕ
    ТИПЗНАЧЕНИЯ<span class="operator">(</span>Остатки<span class="operator">.</span>Регистратор<span class="operator">)</span> <span class="operator">=</span> &Тип</pre>

<p class="MsoNormal">При
сравнении значения типа <span class="Term">Тип</span> значения упорядочиваются в следующем
порядке (первый тип считается самым малым):</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">NULL</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Неопределено</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Булево</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Число</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Дата</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">Строка</span>,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
ссылка на таблицу,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
другие типы.</p>

<a name="_ref214883887"></a><a name="_ref214883737"></a><a id="TI000000499" class="bookmark" name="issogl2_8.4.18_условия_в_языке_запросов"><h3>8.4.18. Условия в языке запросов</h3></a>

<a id="TI000001819" class="bookmark" name="issogl3_8.4.18.1_общая_информация"><h4>8.4.18.1. Общая информация</h4></a>

<p class="MsoNormal">В языке запросов используются условия отбора, в соответствии
с которыми осуществляется отбор данных в предложениях <span class="Term">ГДЕ</span>, <span class="Term">ИМЕЮЩИЕ</span>
и <span class="Term">СОЕДИНЕНИЕ</span>.
Условия описываются по следующим правилам:</p>

<p class="Lang-subheader"><a name="_&lt;условие_отбора&gt;"></a>&lt;Условие
отбора&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Логическое слагаемое&gt; [ИЛИ &lt;Логическое слагаемое&gt;]</pre>

<p class="Lang-subheader"><a name="_&lt;логическое_слагаемое&gt;"></a>&lt;Логическое слагаемое&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Логический сомножитель&gt; [И &lt;Логический сомножитель&gt;]</pre>

<p class="Lang-subheader"><a name="_&lt;логический_сомножитель&gt;"></a>&lt;Логический сомножитель&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
НЕ &lt;Логический сомножитель&gt; |
( &lt;Условие отбора&gt; ) |
&lt;Логическое выражение&gt;
</pre>

<p class="MsoNormalCxSpFirst">В простейшем случае условие является выражением, результат
которого имеет значение логического типа. Логические выражения описаны в следующем
разделе.</p>

<p class="MsoNormalCxSpMiddle">Условия могут определяться и как более сложные логические
выражения, где фигурируют простые логические выражения, соединенные между собой
с помощью логических операторов <span class="Term">И</span>, <span class="Term">ИЛИ</span>, <span class="Term">НЕ</span>.</p>

<p class="MsoNormalCxSpLast">Логические операторы имеют приоритет:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
Самый высокий приоритет имеет логический оператор
<span class="Term">НЕ</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Следующим по приоритету является оператор <span class="Term">И</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Самый низкий приоритет у оператора <span class="Term">ИЛИ</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
В условиях сначала вычисляются простые логические
выражения, затем операции <span class="Term">НЕ</span>, затем операции <span class="Term">И</span>, в последнюю очередь –
операции <span class="Term">ИЛИ</span>.
Для того чтобы обеспечить другой порядок вычислений, можно использовать круглые
скобки <span class="Term">()</span>.</p>

<a name="_ref15220433"></a><a name="_ref397081526"></a><a id="TI000000500" class="bookmark" name="issogl3_8.4.18.2_логические_выражения_в_языке_запросов"><h4>8.4.18.2. Логические выражения в языке запросов</h4></a>

<p class="MsoNormal">В языке запросов в операциях выбора и в условиях отборов
используются логические выражения.</p>

<p class="Lang-subheader"><a name="_&lt;сравнение&gt;"></a>&lt;Логическое
выражение&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
&lt;Выражение&gt; |
(&lt;Выражение&gt; | &lt;Логическое выражение&gt;) &lt;Операция сравнения&gt; (&lt;Выражение&gt; | &lt;Логическое выражение&gt;) |
&lt;Выражение&gt; [НЕ] В [ИЕРАРХИИ] (&lt;Список значений&gt;) |
&lt;Выражение&gt; [НЕ] В [ИЕРАРХИИ](&lt;Описание запроса&gt;) |
&lt;Выражение&gt; [НЕ] МЕЖДУ &lt;Выражение&gt; И &lt;Выражение&gt; |
&lt;Выражение&gt; ЕСТЬ [НЕ] NULL |
&lt;Выражение&gt; ССЫЛКА &lt;Имя таблицы&gt; |
&lt;Выражение&gt; [НЕ] ПОДОБНО &lt;Литерал типа СТРОКА&gt;
            [СПЕЦСИМВОЛ &lt;Литерал типа СТРОКА&gt;]
</pre>

<p class="Lang-subheader"><a name="_&lt;операция_сравнения&gt;"></a>&lt;Операция
сравнения&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&gt; | &lt; | = | &gt;= | &lt;= | &lt;&gt;</pre>

<p class="Lang-subheader"><a name="_&lt;перечень_значений&gt;"></a>&lt;Список
значений&gt;</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&lt;Выражение&gt;[, &lt;Выражение&gt; [, …]]</pre>

<p class="MsoNormal">Логическим выражением может быть:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
обычное выражение языка запросов, если его результат
имеет логический тип;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
операция сравнения двух выражений языка запросов;
выполняется в соответствии с правилами сравнения значений, описанными в разделе
«Правила сравнения значений»;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
оператор проверки совпадения/несовпадения значения
выражения с одним из перечисленных или со значениями, содержащимися в
результате другого запроса;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
оператор проверки вхождения значения выражения в
диапазон;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
оператор проверки значения выражения на <span class="Term">NULL</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
оператор проверки ссылочного значения выражения
на ссылку на определенную таблицу;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
оператор проверки строкового значения наподобие
шаблону.</p>

<p class="MsoNormal">При сравнении значений используются правила сравнения
значений, описанные ниже.</p>

<a name="_ref15271527"></a><a name="_ref459893151"></a><a id="TI000000501" class="bookmark" name="issogl3_8.4.18.3_правила_сравнения_значений"><h4>8.4.18.3. Правила сравнения значений</h4></a>

<p class="MsoNormalCxSpFirst">Поскольку в языке запросов могут сравниваться значения
разных типов, определены правила, по которым выполняется сравнение двух значений.</p>

<p class="MsoNormalCxSpLast">Данные правила используются:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
для сравнения значений в операторах сравнения;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
для определения максимального и минимального
значений в агрегатных функциях <span class="Term">МИНИМУМ</span> и <span class="Term">МАКСИМУМ</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
для упорядочивания записей результата запроса в
соответствии с порядком, заданным в предложении <span class="Term">УПОРЯДОЧИТЬ ПО</span>.</p>

<p class="MsoNormal">Если типы значений отличаются друг от друга, то отношения
между значениями определяются на основании приоритета типов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
тип <span class="Term">NULL</span> (самый низший);</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
тип <span class="Term">Булево</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
тип <span class="Term">Число</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
тип <span class="Term">Дата</span>;</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
тип <span class="Term">Строка</span>;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
ссылочные типы.</p>

<p class="MsoNormalCxSpFirst">Отношения между различными ссылочными типами определяются
на основе внутренних ссылочных номеров таблиц, соответствующих тому или иному
типу.</p>

<p class="MsoNormalCxSpLast">Если типы данных совпадают, то производится сравнение
значений по следующим правилам:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
У типа <span class="Term">Булево</span> значение <span class="Term">Истина</span> больше
значения <span class="Term">Ложь</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
У типа <span class="Term">Число</span> обычные правила сравнения для чисел.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
У типа <span class="Term">Дата</span> более ранние даты меньше более поздних.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
У типа <span class="Term">Строка</span> сравнение производится в соответствии с
установленными национальными особенностями базы данных и указанным порядком
сортировки. Сравнение выполняется без учета регистра символов. Операция
сравнения строк не учитывает концевые пробелы, в отличие от сравнения строк на
встроенном языке, где концевые пробелы участвуют в операции сравнения.
Например, сравнение строк «<span class="Interface">bb</span>» и «<span class="Interface">bb </span>» на встроенном языке вернет <span class="Term">Ложь</span> (строки не
равны), и <span class="Term">Истина</span>
в языке запросов (строки равны). При этом не гарантируется, что сортировка
одного и того же набора данных, выполненного на разных СУБД, вернет одинаковый
результат.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Ссылочные типы и значения типа <span class="Term">УникальныйИдентификатор</span>
сравниваются на основе своих значений. При этом гарантируется повторяемость
результата сравнения только в рамках одной базы данных.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
Не поддерживается сравнение полей типа <span class="Term">УникальныйИдентификатор</span> с полями других типов;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
Не допускается сравнение полей неограниченной
длины (строки неограниченной длины, <span class="Term">ХранилищеЗначения</span>, поле <span class="Term">ТипЗначения</span> из
таблицы планов видов характеристик).</p>

<p class="Note"><span class="Note">ВНИМАНИЕ!</span> Любая операция сравнения
двух значений, в которой участвует хотя бы одно значение <span class="Term">NULL</span>, дает результат,
аналогичный значению <span class="Term">Ложь</span>.</p>

<a name="_ref452133512"></a><a id="TI000000502" class="bookmark" name="issogl3_8.4.18.4_оператор_проверки_совпадения_значения"><h4>8.4.18.4. Оператор проверки совпадения значения</h4></a>

<p class="Lang">Форма оператора «В» для проверки
совпадения с одним из перечисленных</p>

<p class="MsoNormal">Оператор <span class="Term">В</span> позволяет проверить, совпадает ли значение выражения,
указанного справа от него, с одним из значений, описанных слева. Если совпадает
хотя бы с одним, результатом оператора будет <span class="Term">Истина</span>,
иначе – <span class="Term">Ложь</span>.
Применение <span class="Term">НЕ</span>
изменяет действие оператора на обратное. Сравнение значений производится по
правилам, описанным в разделе «Правила сравнения значений».</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Наименование
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ
    Номенклатура<span class="operator">.</span>Родитель<span class="operator">.</span>Наименование В
                        <span class="operator">(</span><span class="string">&quot;Бытовая техника&quot;</span><span class="operator">,</span> <span class="string">&quot;Оргтехника&quot;</span><span class="operator">)</span></pre>

<p class="Lang">Форма оператора «В» для проверки
принадлежности по иерархии</p>

<p class="MsoNormal">Для справочников проверка может осуществляться и на принадлежность
по иерархии. Результатом оператора <span class="Term">В ИЕРАРХИИ</span> будет <span class="Term">Истина</span>, если
значение выражения слева является ссылкой на элемент справочника и входит во множество
значений справа или иерархически принадлежит какой-нибудь группе, содержащейся
в этом множестве.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// В качестве параметра Группа в запрос передается ссылка</span>
<span class="comment">// на какую-либо группу справочника Номенклатура.</span>
<span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Наименование
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ
    Номенклатура<span class="operator">.</span>Ссылка В ИЕРАРХИИ<span class="operator">(</span>&Группа<span class="operator">)</span></pre>

<p class="MsoNormal">В качестве множества значений, на совпадение с которыми
выполняется проверка, может фигурировать и результат запроса. В этом случае
справа от оператора <span class="Term">В</span>
необходимо указать описание запроса.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Наименование
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ
    Номенклатура<span class="operator">.</span>Ссылка В ИЕРАРХИИ
            <span class="operator">(</span><span class="keyword">ВЫБРАТЬ</span>
                Номенклатура<span class="operator">.</span>Ссылка
            <span class="keyword">ИЗ</span>
                Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
            ГДЕ
                Номенклатура<span class="operator">.</span>Наименование <span class="operator">=</span> <span class="string">&quot;Одежда&quot;</span><span class="operator">)</span></pre>

<p class="Lang">Форма оператора «В» для проверки
совпадения значения с одним из результатов запроса</p>

<p class="MsoNormal">Пример применения данного оператора:</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Выбрать названия товаров, которые присутствовали</span>
<span class="comment">// в расходных накладных </span>
<span class="keyword">ВЫБРАТЬ</span>
    Товары<span class="operator">.</span>Наименование
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Товары
ГДЕ
    Товары<span class="operator">.</span>Ссылка В
        <span class="operator">(</span><span class="keyword">ВЫБРАТЬ</span>
            РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура
        <span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00356.gif?_=1496848987" WIDTH="444" ALT HEIGHT="214"></p>

<p class="MsoCaption">Рис. 357. Результат запроса (фрагмент)</p>

<p class="MsoNormal">Для получения противоположного результата, то есть если
нужно определить, что значение не совпадает ни с одним из результатов запроса,
запрос выглядит следующим образом.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Выбрать названия товаров, которые присутствовали</span>
<span class="comment">// в расходных накладных </span>
<span class="keyword">ВЫБРАТЬ</span>
    Товары<span class="operator">.</span>Наименование
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Товары
ГДЕ
    <span class="operator">(</span><span class="keyword">НЕ</span> Товары<span class="operator">.</span>Ссылка В
        <span class="operator">(</span><span class="keyword">ВЫБРАТЬ</span>
            РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура
        <span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав<span class="operator">)</span><span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00357.gif?_=1496848987" WIDTH="279" ALT HEIGHT="214"></p>

<p class="MsoCaption">Рис. 358. Результат запроса (фрагмент)</p>

<p class="MsoNormal">Заметим, что из запроса операции <span class="Term">В</span> возможно обращение
к полям таблиц, которые встречались во внешнем запросе до появления операции.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Выбрать названия товаров, которые присутствовали</span>
<span class="comment">// в расходных накладных</span>
<span class="keyword">ВЫБРАТЬ</span>
    Товары<span class="operator">.</span>Наименование
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Товары
ГДЕ
    Товары<span class="operator">.</span>Ссылка В
    <span class="operator">(</span><span class="keyword">ВЫБРАТЬ</span>
        РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура
    <span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав
    ГДЕ
        РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура <span class="operator">=</span> Товары<span class="operator">.</span>Ссылка<span class="operator">)</span></pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00358.gif?_=1496848987" WIDTH="291" ALT HEIGHT="214"></p>

<p class="MsoCaption">Рис. 359. Результат запроса (фрагмент)</p>

<p class="MsoNormalCxSpFirst">Результат
выражения оператора <span class="Term">В</span> с подзапросом может быть двузначным (<span class="Term">ИСТИНА</span>/<span class="Term">ЛОЖЬ</span>). Это
означает, что третий вариант результата (<span class="Term">NULL</span> – результат сравнения с <span class="Term">NULL</span>) может быть
трактован как ложный результат.</p>

<p class="MsoNormalCxSpLast">В случае,
если у оператора <span class="Term">В</span> с подзапросом аргумент, стоящий слева от <span class="Term">В</span> и аргумент,
находящийся в подзапросе, имеют разные типы, результат <span class="Term">NULL</span> исключается из возможных результатов оператора
<span class="Term">В</span>. Результат <span class="Term">NULL</span> в этом случае трактуется как ложный
результат.</p>

<p class="Lang">Использование операции «В» («НЕ В») по
нескольким полям</p>

<p class="Lang-subheader">Синтаксис для вложенного
запроса:</p>

<p class="MsoNormal"><span class="Term">(выражение1,
выражение2, …, выражениеN) В (ВЫБРАТЬ выражение1, выражение2, …, выражениеN …)</span></p>

<p class="Lang-subheader">Синтаксис для таблицы значений:</p>

<p class="MsoNormalCxSpFirst"><span class="Term">(выражение1, выражение2, …, выражениеN) В (&amp;Параметр)</span></p>

<p class="MsoNormalCxSpLast">В качестве параметра следует передавать таблицу значений,
первые N колонок которой будут использоваться для операции <span class="Term">В</span>.</p>

<a id="TI000000503" class="bookmark" name="issogl3_8.4.18.5_оператор_проверки_вхождения_значения_в_диапазон"><h4>8.4.18.5. Оператор проверки вхождения значения в диапазон</h4></a>

<p class="MsoNormal">Оператор <span class="Term">МЕЖДУ</span> позволяет проверить, входит ли значение
выражения, указанного слева от него, в диапазон, указанный справа. Если входит,
результатом оператора будет <span class="Term">Истина</span>, иначе – <span class="Term">Ложь</span>. Применение <span class="Term">НЕ</span>
изменяет действие оператора на обратное. Правила сравнения значений см. <a href="#_ref15271527">здесь</a>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>ЗакупочнаяЦена
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ
    Номенклатура<span class="operator">.</span>ЗакупочнаяЦена МЕЖДУ <span class="number">100</span> <span class="keyword">И</span> <span class="number">1000</span></pre>

<a id="TI000000504" class="bookmark" name="issogl3_8.4.18.6_оператор_проверки_значения_на_null"><h4>8.4.18.6. Оператор проверки значения на NULL</h4></a>

<p class="MsoNormal">Оператор <span class="Term">ЕСТЬNULL</span> позволяет проверить значение выражения
слева от него на <span class="Term">NULL</span>.
Если значение равно <span class="Term">NULL</span>,
результатом оператора будет <span class="Term">Истина</span>, иначе – <span class="Term">Ложь</span>. Применение <span class="Term">НЕ</span>
изменяет действие оператора на обратное.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>ЗакупочнаяЦена
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ГДЕ
    Номенклатура<span class="operator">.</span>ЗакупочнаяЦена ЕСТЬ <span class="keyword">NULL</span></pre>

<a id="TI000000505" class="bookmark" name="issogl3_8.4.18.7_оператор_проверки_ссылочного_значения"><h4>8.4.18.7. Оператор проверки ссылочного значения</h4></a>

<p class="MsoNormal">Оператор <span class="Term">ССЫЛКА</span> позволяет проверить, является ли значение
выражения, указанного слева от него, ссылкой на таблицу, указанную справа. Если
да, результатом оператора будет <span class="Term">Истина</span>, иначе – <span class="Term">Ложь</span>. Описание разыменования
таблиц см. <a href="#_ref15295173">здесь</a>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    РасходнаяНакладная<span class="operator">.</span>Номер<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Дата
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> РасходнаяНакладная
ГДЕ
    РасходнаяНакладная<span class="operator">.</span>Контрагент ССЫЛКА Справочник<span class="operator">.</span>Контрагенты</pre>

<a name="_ref436144880"></a><a id="TI000000506" class="bookmark" name="issogl3_8.4.18.8_оператор_проверки_строки_на_подобие_шаблону"><h4>8.4.18.8. Оператор проверки строки на подобие шаблону</h4></a>

<p class="MsoNormalCxSpFirst">Оператор <span class="Term">ПОДОБНО</span> позволяет сравнить значение выражения,
указанного слева от него, со строкой шаблона, указанной справа. Значение
выражения должно иметь тип <span class="Term">Строка</span>. Если значение выражения удовлетворяет
шаблону, результатом оператора будет <span class="Term">Истина</span>, иначе – <span class="Term">Ложь</span>.</p>

<p class="MsoNormalCxSpLast">Следующие символы в строке шаблона являются служебными
и имеют смысл, отличный от символа строки:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
«<span class="Interface">%</span>» (процент): последовательность,
содержащая любое количество произвольных символов.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">_</span>»
(подчеркивание): один произвольный символ.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
«<span class="Interface">[…]</span>» (в квадратных
скобках один или несколько символов): любой одиночный символ из перечисленных
внутри квадратных скобок. В перечислении могут встречаться диапазоны, например,
a-z, означающие произвольный символ, входящий в диапазон, включая концы
диапазона.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
«<span class="Interface">[^…]</span>» (в
квадратных скобках значок отрицания, за которым следует один или несколько
символов): любой одиночный символ, кроме тех, которые перечислены следом за
значком отрицания.</p>

<p class="MsoNormalCxSpFirst">Любой другой символ означает сам себя и не несет
никакой дополнительной нагрузки.</p>

<p class="MsoNormalCxSpMiddle">Если в качестве самого себя необходимо записать
один из перечисленных символов, то ему должен предшествовать спецсимвол. Сам
спецсимвол (любой подходящий символ) определяется в этом же операторе после
ключевого слова <span class="Term">СПЕЦСИМВОЛ</span>.</p>

<p class="MsoNormalCxSpLast">Например, шаблон:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">&quot;%АБВ[0-9][абвг]\_абв%&quot; СПЕЦСИМВОЛ &quot;\&quot;</pre>

<p class="MsoNormal">означает подстроку, состоящую из последовательности символов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
буквы А,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы Б,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы В,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
одной цифры,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
одной из букв а, б, в или г,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
символа подчеркивания,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы а,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
буквы б,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
буквы в.</p>

<p class="MsoNormalCxSpFirst">Причем перед этой последовательностью может располагаться
произвольный набор символов.</p>

<p class="MsoNormalCxSpLast">При работе в клиент-серверном варианте, возможна
ситуация, когда запрос, содержащий оператор <span class="Term">ПОДОБНО</span>, не может
быть выполнен. Такая ситуация возможна в том случае, когда длина строки с шаблоном
превышает некоторое число, зависимое от используемой СУБД.</p>

<a id="TI000000507" class="bookmark" name="issogl1_8.5_выполнение_и_работа_с_запросами_во_встроенном_языке"><h2>8.5. Выполнение и работа с запросами во встроенном языке</h2></a>

<p class="MsoNormalCxSpFirst">Для формирования запросов, выборки и обработки результатов
запросов в языке предусмотрен специальный набор объектов. С помощью этих
объектов выполняется формирование запроса, обход записей запроса и т. д.</p>

<p class="MsoNormalCxSpLast">Тип колонки результата запроса определяется на
основе типов значений выражений, входящих в колонку и всегда включает тип <span class="Term">NULL</span>.</p>

<a id="TI000000508" class="bookmark" name="issogl2_8.5.1_основные_приемы_работы"><h3>8.5.1. Основные приемы работы</h3></a>

<p class="MsoNormal">Основные приемы работы с запросами во встроенном языке
системы «1С:Предприятие» удобнее всего рассматривать на примерах. Приведем
типичный пример использования запроса.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="comment">// Создадим Запрос</span>
Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">(</span><span class="string">&quot;ВЫБРАТЬ Товар.Наименование Наименование,</span>
<span class="string">    |Товар.Родитель.Наименование НаименованиеРодителя</span>
<span class="string">    |ИЗ Справочник.Товары Товар&quot;</span><span class="operator">)</span><span class="operator">;</span>
<span class="comment">// Выполним запрос и запишем результат в переменную РезультатЗапроса.</span>
РезультатЗапроса <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="comment">// Получим выборку из результата запроса.</span>
Выборка <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="comment">// Пока в выборке есть записи ...</span>
<span class="keyword">Пока</span> Выборка<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Цикл</span>
    <span class="comment">// ... выведем в окно сообщений поля из результата.</span>
    Товар <span class="operator">=</span> Выборка<span class="operator">.</span>Наименование<span class="operator">;</span>
    Родитель <span class="operator">=</span> Выборка<span class="operator">.</span>НаименованиеРодителя<span class="operator">;</span>
    Сообщить<span class="operator">(</span><span class="string">&quot;Товар: &quot;</span> <span class="operator">+</span> Товар <span class="operator">+</span> <span class="string">&quot; Родитель: &quot;</span> <span class="operator">+</span> Родитель<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span></pre>

<p class="MsoNormal">Как видно из этого примера, работа с запросом ведется при
помощи трех основных объектов:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Запрос</span> – объект, выполняющий сам запрос.
Представлен в примере переменной с именем <span class="Term">Запрос</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">РезультатЗапроса</span> – объект, содержащий
полученные при выполнении запроса данные. Представлен в примере переменной с
именем <span class="Term">РезультатЗапроса</span>.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ВыборкаИзРезультатаЗапроса</span> – объект,
позволяющий обходить (т. е. перебирать) записи из результата. Представлен
в примере переменной с именем <span class="Term">Выборка</span>.</p>

<p class="MsoNormalCxSpFirst">Рассмотрим подробнее объект <span class="Term">ВыборкаИзРезультатаЗапроса</span>.</p>

<p class="MsoNormalCxSpLast">Для этого нам понадобится следующий запрос:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Количество <span class="keyword">КАК</span> Количество
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура
ИТОГИ
    СУММА<span class="operator">(</span>Количество<span class="operator">)</span>
<span class="keyword">ПО</span>
    Номенклатура ИЕРАРХИЯ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00359.gif?_=1496848987" WIDTH="212" ALT HEIGHT="318"></p>

<p class="MsoCaption">Рис. 360. Рабочая выборка</p>

<p class="MsoNormal">В этой таблице мы добавили первый столбец, которого нет в
тексте запроса, но он будет использоваться нами в дальнейшем для идентификации
записи в результате. Итоговые записи в таблице выделены курсивом, итоговые
записи для иерархических уровней справочника выделены жирным шрифтом.</p>

<a id="TI000000509" class="bookmark" name="issogl3_8.5.1.1_способы_обхода_результата_запроса"><h4>8.5.1.1. Способы обхода результата запроса</h4></a>

<a id="TI000000510" class="bookmark" name="issogl4_8.5.1.1.1_линейный_обход_результата"><h5>8.5.1.1.1. Линейный обход результата</h5></a>

<p class="MsoNormalCxSpFirst">Первый и самый простой способ обхода – линейный.
При линейном обходе выборка будет выдавать записи в той последовательности, в
которой они располагаются в результате запроса. В нашем примере это будут
записи с номерами 1, 2, 3, 4, 5 и так далее до записи с номером 20.</p>

<p class="MsoNormalCxSpLast">Для получения линейной выборки из результата необходимо
вызвать метод <span class="Term">Выбрать()</span>
объекта <span class="Term">РезультатЗапроса</span>
без параметров либо с параметром <span class="Term">ОбходРезультатаЗапроса.Прямой</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СпособВыборки <span class="operator">=</span> ОбходРезультатаЗапроса<span class="operator">.</span>Прямой<span class="operator">;</span>
Выборка1 <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span>СпособВыборки<span class="operator">)</span><span class="operator">;</span>
<span class="comment">// что равнозначно записи</span>
Выборка1 <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<a id="TI000000511" class="bookmark" name="issogl4_8.5.1.1.2_иерархический_обход_результата"><h5>8.5.1.1.2. Иерархический обход результата</h5></a>

<p class="MsoNormal">Следующий способ обхода результата – иерархический. При
данном способе обходятся только записи, находящиеся на одном уровне. Для
получения иерархической выборки из результата необходимо вызвать метод <span class="Term">Выбрать()</span>
объекта <span class="Term">РезультатЗапроса</span>
с параметром <span class="Term">ОбходРезультатаЗапроса.ПоГруппировкамСИерархией</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СпособВыборки <span class="operator">=</span> ОбходРезультатаЗапроса<span class="operator">.</span>ПоГруппировкамСИерархией<span class="operator">;</span>
Выборка2 <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span>СпособВыборки<span class="operator">)</span><span class="operator">;</span></pre>

<p class="Regularbeforepicture">Выборка из результата с иерархическим обходом в нашем
примере обойдет только записи с номерами 1 и 11, так как только эти две записи
находятся на самом верхнем уровне. Проиллюстрируем это, представив наш результат
в виде дерева, где узлами будут итоговые записи, а листьями дерева – детальные
записи. Вот что у нас получится:</p>

<p class="Picture"><IMG src="_img/img00360.gif?_=1496848987" WIDTH="371" ALT HEIGHT="623"></p>

<p class="MsoCaption">Рис. 361. Иерархический обход
результата запроса</p>

<p class="MsoNormalCxSpFirst">Из этого рисунка видно, что именно записи с
номерами 1 и 11 и только они находятся на первом уровне дерева, в результате
чего только они и попадают в первый проход иерархической выборки.</p>

<p class="MsoNormalCxSpMiddle">Возникает вопрос: как получать остальные записи результата
запроса? Для этого у объекта <span class="Term">ВыборкаИзРезультатаЗапроса</span> можно получить еще
одну выборку, которая будет обходить подчиненные записи текущей записи выборки.
В нашем примере в момент, когда объект <span class="Term">Выборка2</span> будет позиционирован на запись с
номером 1, мы запросим у него иерархическую выборку. Таким образом мы получим
выборку, которая нам вернет записи с номерами 2, 7. А когда <span class="Term">Выборка2</span> будет позиционирована
на записи с номером 11, полученная у нее иерархическая выборка вернет записи с
номерами 12, 16. Так реализуется иерархический обход результатов запроса.</p>

<p class="MsoNormalCxSpLast">Заметим, что у выборки можно получать вложенные выборки
любого типа. Так, если бы мы запросили у объекта <span class="Term">Выборка2</span>, позиционированной
на записи 1, линейную выборку, то с ее помощью мы бы получили записи с номерами
со 2-го по 10-й. Проиллюстрируем описанную методику на примере.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ВыполнитьЗапрос<span class="operator">(</span><span class="operator">)</span>
    <span class="comment">// Создадим запрос.</span>
    Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
    <span class="comment">// Установим текст запроса</span>
    Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;ВЫБРАТЬ</span>
<span class="string">    |РасходнаяНакладнаяСостав.Номенклатура КАК Номенклатура,</span>
<span class="string">    |РасходнаяНакладнаяСостав.Количество КАК Количество</span>
<span class="string">    |ИЗ</span>
<span class="string">    |Документ.РасходнаяНакладная.Состав КАК РасходнаяНакладнаяСостав</span>
<span class="string">    |УПОРЯДОЧИТЬ ПО</span>
<span class="string">    |РасходнаяНакладнаяСостав.Номенклатура</span>
<span class="string">    |ИТОГИ</span>
<span class="string">    |СУММА(Количество)</span>
<span class="string">    |ПО</span>
<span class="string">    |Номенклатура ИЕРАРХИЯ&quot;</span><span class="operator">;</span>
    <span class="comment">// Выполним запрос и запишем результат в переменную</span>
    <span class="comment">// РезультатЗапроса.</span>
 РезультатЗапроса <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="comment">// Получим выборку из результата запроса.</span>
    СпособВыборки <span class="operator">=</span> ОбходРезультатаЗапроса<span class="operator">.</span>ПоГруппировкамСИерархией<span class="operator">;</span>
    Выборка <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span>СпособВыборки<span class="operator">)</span><span class="operator">;</span>
    ВыдатьРекурсивно<span class="operator">(</span>Выборка<span class="operator">)</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="keyword">Процедура</span> ВыдатьРекурсивно<span class="operator">(</span>Выборка<span class="operator">)</span>
    <span class="comment">// Пока в выборке есть записи ...</span>
    <span class="keyword">Пока</span> Выборка<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Цикл</span>
        <span class="comment">// ... выведем в окно сообщений поля из результата</span>
        Товар <span class="operator">=</span> Выборка<span class="operator">.</span>Наименование<span class="operator">;</span>
        Количество <span class="operator">=</span> Выборка<span class="operator">.</span>Количество<span class="operator">;</span>
        Сообщить<span class="operator">(</span><span class="string">&quot;Товар: &quot;</span> <span class="operator">+</span> Товар <span class="operator">+</span> <span class="string">&quot; Количество: &quot;</span> <span class="operator">+</span> Количество<span class="operator">)</span><span class="operator">;</span>
        <span class="comment">// Продолжим выборку подчиненных записей</span>
        СпособВыборки <span class="operator">=</span> ОбходРезультатаЗапроса<span class="operator">.</span>ПоГруппировкамСИерархией<span class="operator">;</span>
        ВыдатьРекурсивно<span class="operator">(</span>Выборка<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span>СпособВыборки<span class="operator">,</span> Выборка<span class="operator">.</span>Группировка<span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<a id="TI000000512" class="bookmark" name="issogl4_8.5.1.1.3_обход_результата_по_группам"><h5>8.5.1.1.3. Обход результата по группам</h5></a>

<p class="MsoNormal">Третий и последний способ обхода результата – по
группам. Он сходен с иерархическим обходом, но с одним различием: записи с
иерархическими итогами при обходе в нем рассматриваются как детальные, а не как
итоговые. Для получения выборки по группам из результата запроса необходимо вызвать
метод <span class="Term">Выбрать()</span>
объекта <span class="Term">РезультатЗапроса</span>
с параметром <span class="Term">ОбходРезультатаЗапроса.ПоГруппировкам</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">СпособВыборки <span class="operator">=</span> ОбходРезультатаЗапроса<span class="operator">.</span>ПоГруппировкам<span class="operator">;</span>
Выборка2 <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span>СпособВыборки<span class="operator">)</span><span class="operator">;</span>
<span class="comment">// Перебрав в ней все, мы получим записи с номерами:</span>
<span class="comment">// 1, 2, 7, 11, 12, 16.</span></pre>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">Процедура</span> ВыполнитьЗапрос<span class="operator">(</span><span class="operator">)</span>
    <span class="comment">// Создадим запрос.</span>
    Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
    <span class="comment">// Установим текст запроса</span>
    Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;ВЫБРАТЬ</span>
<span class="string">    |РасходнаяНакладнаяСостав.Номенклатура КАК Номенклатура,</span>
<span class="string">    |РасходнаяНакладнаяСостав.Количество КАК Количество</span>
<span class="string">    |ИЗ</span>
<span class="string">    |Документ.РасходнаяНакладная.Состав КАК РасходнаяНакладнаяСостав</span>
<span class="string">    |УПОРЯДОЧИТЬ ПО</span>
<span class="string">    |РасходнаяНакладнаяСостав.Номенклатура</span>
<span class="string">    |ИТОГИ</span>
<span class="string">    |СУММА(Количество)</span>
<span class="string">    |ПО</span>
<span class="string">    |Номенклатура ИЕРАРХИЯ&quot;</span><span class="operator">;</span>
    <span class="comment">// Выполним запрос и запишем результат в переменную</span>
    <span class="comment">// РезультатЗапроса.</span>
    РезультатЗапроса <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
    <span class="comment">// Получим выборку из результата запроса</span>
    СпособВыборки <span class="operator">=</span> ОбходРезультатаЗапроса<span class="operator">.</span>ПоГруппировкам<span class="operator">;</span>
    Выборка <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span>СпособВыборки<span class="operator">)</span><span class="operator">;</span>
    <span class="comment">// Пока в выборке есть записи ...</span>
    <span class="keyword">Пока</span> Выборка<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Цикл</span>
        <span class="comment">// ... выведем в окно сообщений поля из результата</span>
        Товар <span class="operator">=</span> Выборка<span class="operator">.</span>Наименование<span class="operator">;</span>
        Количество <span class="operator">=</span> Выборка<span class="operator">.</span>Количество<span class="operator">;</span>
        Сообщить<span class="operator">(</span><span class="string">&quot;Товар: &quot;</span><span class="operator">+</span>Товар<span class="operator">+</span><span class="string">&quot; Итого по товару: &quot;</span><span class="operator">+</span>Количество<span class="operator">)</span><span class="operator">;</span>
        ВыдатьДочерниеЗаписи<span class="operator">(</span>Выборка<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span>
<span class="keyword">Процедура</span> ВыдатьДочерниеЗаписи <span class="operator">(</span>Выборка<span class="operator">)</span>
    <span class="comment">// Пока в выборке есть записи ...</span>
    <span class="keyword">Пока</span> Выборка<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Цикл</span>
        <span class="comment">// ... выведем в окно сообщений поля из результата</span>
        Товар <span class="operator">=</span> Выборка<span class="operator">.</span>Наименование<span class="operator">;</span>
        Количество <span class="operator">=</span> Выборка<span class="operator">.</span>Количество<span class="operator">;</span>
        Сообщить<span class="operator">(</span><span class="string">&quot;Товар: &quot;</span><span class="operator">+</span>Товар<span class="operator">+</span><span class="string">&quot; Количество: &quot;</span><span class="operator">+</span>Количество<span class="operator">)</span><span class="operator">;</span>
    <span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">КонецПроцедуры</span></pre>

<a id="TI000000513" class="bookmark" name="issogl3_8.5.1.2_работа_с_выборкой"><h4>8.5.1.2. Работа с выборкой</h4></a>

<p class="MsoNormal">Объект <span class="Term">ВыборкаИзРезультатаЗапроса</span> предназначен для
обхода записей результата запроса. Можно представить себе выборку как некоторый
объект, который содержит указатель на текущую запись в результате и предоставляет
программе доступ ко всем полям текущей записи. Для навигации по записям запроса
используются три метода:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Следующий()</span> – перейти к следующей записи
результата в соответствии с порядком обхода выборки. При первом вызове
позиционирует выборку на первую запись. Когда будут выбраны все записи, данный
метод просигнализирует об этом, вернув значение <span class="Term">Ложь</span>.</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
<span class="Term">СледующийПоЗначениюПоля()</span> – получить
следующую запись со значением в заданном поле, отличающимся от значения в этом
поле текущей записи.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">НайтиСледующий()</span> – найти запись с
заданными значениями некоторых полей.</p>

<a id="TI000000514" class="bookmark" name="issogl4_8.5.1.2.1_использование_метода_следующийпозначениюполя"><h5>8.5.1.2.1. Использование метода «СледующийПоЗначениюПоля()»</h5></a>

<p class="MsoNormal">Метод позволяет сгруппировать записи результата по значениям
полей.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Док<span class="operator">.</span>Номенклатура<span class="operator">,</span>
    Док<span class="operator">.</span>Ссылка<span class="operator">.</span>Контрагент <span class="keyword">КАК</span> Контрагент<span class="operator">,</span>
    Док<span class="operator">.</span>Количество
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> Док
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    Док<span class="operator">.</span>Номенклатура<span class="operator">.</span>Наименование<span class="operator">,</span>
    Контрагент</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00361.gif?_=1496848987" WIDTH="365" ALT HEIGHT="277"></p>

<p class="MsoCaption">Рис. 362. Результат запроса</p>

<p class="MsoNormal">Получим линейную выборку из результата запроса и обойдем
выборку при помощи метода <span class="Term">СледующийПоЗначениюПоля()</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Выборка <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Пока</span> Выборка<span class="operator">.</span>СледующийПоЗначениюПоля<span class="operator">(</span><span class="string">&quot;Товар&quot;</span><span class="operator">)</span> <span class="keyword">Цикл</span>
    <span class="comment">// здесь мы получим записи с номерами 1, 5, 9, 12</span>
    <span class="keyword">Пока</span> Выборка<span class="operator">.</span>СледующийПоЗначениюПоля<span class="operator">(</span><span class="string">&quot;Контрагент&quot;</span><span class="operator">)</span> <span class="keyword">Цикл</span>
        <span class="comment">// здесь мы сначала получим записи с номерами 1, 2, 3, 4</span>
        <span class="comment">// затем 5, 6, 7</span>
        <span class="comment">// затем 9, 10, 11</span>
        <span class="comment">// затем 12, 13, 14, 15</span>
    <span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">Следует обратить внимание на то, что во внутреннем
цикле не была выбрана запись с номером 8, т. к. в ней такое же значение
поля <span class="Term">Получатель</span>,
как и в предыдущей записи.</p>

<p class="MsoNormalCxSpLast">Заметим, что если в цикле получения по значению поля
получать записи при помощи метода <span class="Term">Следующий()</span>, то будут выбраны все записи с
равным значением поля, заданного в предыдущем вызове метода <span class="Term">СледующийПоЗначениюПоля()</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Выборка <span class="operator">=</span> РезультатЗапроса<span class="operator">.</span><span class="keyword">Выбрать</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
<span class="keyword">Пока</span> Выборка<span class="operator">.</span>СледующийПоЗначениюПоля<span class="operator">(</span><span class="string">&quot;Товар&quot;</span><span class="operator">)</span> <span class="keyword">Цикл</span>
    <span class="comment">// здесь мы получим записи с номерами 1, 5, 9, 12</span>
    <span class="keyword">Пока</span> Выборка<span class="operator">.</span>Следующий<span class="operator">(</span><span class="operator">)</span> <span class="keyword">Цикл</span>
        <span class="comment">// здесь мы сначала получим записи с номерами 1, 2, 3, 4</span>
        <span class="comment">// затем 5, 6, 7, 8</span>
        <span class="comment">// затем 9, 10, 11</span>
        <span class="comment">// затем 12, 13, 14, 15</span>
    <span class="keyword">КонецЦикла</span><span class="operator">;</span>
<span class="keyword">КонецЦикла</span><span class="operator">;</span></pre>

<a id="TI000000515" class="bookmark" name="issogl4_8.5.1.2.2_методы_определения_типа_текущей_записи"><h5>8.5.1.2.2. Методы определения типа текущей записи</h5></a>

<p class="MsoNormal">В тот момент, когда выборка позиционирована на записи, мы
можем у выборки узнать характеристики этой записи. Получение характеристик
записи осуществляется следующими методами:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
<span class="Term">Уровень()</span> – определяет уровень записи в
результате запроса.</p>

<p class="MsoListBulletCxSpLast">&#9679; 
<span class="Term">ТипЗаписи()</span> – определяет принадлежность
записи к одному из следующих типов:</p>

<p class="MsoListBullet2CxSpFirst">&#9679; 
групповой итог,</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
итого по иерархии,</p>

<p class="MsoListBullet2CxSpMiddle">&#9679; 
детальная запись,</p>

<p class="MsoListBullet2CxSpLast">&#9679; 
общий итог.</p>

<p class="MsoListBullet">&#9679; 
<span class="Term">Группировка()</span> – определяет имя поля, по
которому были рассчитаны итоги.</p>

<p class="MsoNormal">Для иллюстрации работы этих методов посмотрим, что они будут
возвращать в виде записей для запроса, рассматриваемого в начале главы.</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура<span class="operator">,</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Количество <span class="keyword">КАК</span> Количество
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная<span class="operator">.</span>Состав <span class="keyword">КАК</span> РасходнаяНакладнаяСостав
УПОРЯДОЧИТЬ <span class="keyword">ПО</span>
    РасходнаяНакладнаяСостав<span class="operator">.</span>Номенклатура
ИТОГИ
    СУММА<span class="operator">(</span>Количество<span class="operator">)</span>
<span class="keyword">ПО</span>
    Номенклатура ИЕРАРХИЯ</pre>

<p class="Lang-subheader">Результат:</p>

<p class="Picture"><IMG src="_img/img00362.gif?_=1496848987" WIDTH="544" ALT HEIGHT="378"></p>

<p class="MsoCaption">Рис.
363.
Иерархия записей</p>

<a name="_ref216162283"></a><a id="TI000000516" class="bookmark" name="issogl2_8.5.2_работа_с_временными_таблицами"><h3>8.5.2. Работа с временными таблицами</h3></a>

<a id="TI000001758" class="bookmark" name="issogl3_8.5.2.1_общая_информация"><h4>8.5.2.1. Общая информация</h4></a>

<p class="MsoNormalCxSpFirst">Язык запросов системы «1С:Предприятие» позволяет использовать
временные таблицы в запросах. Использование временных таблиц помогает повысить
производительность запросов и сделать текст сложных запросов более легким для
восприятия.</p>

<p class="MsoNormalCxSpLast">Работа с временными таблицами обеспечивается двумя составляющими:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
объектом встроенного языка <span class="Term">МенеджерВременныхТаблиц</span>,
который хранит в себе данные временных таблиц;</p>

<p class="MsoListBulletCxSpLast">&#9679; 
синтаксисом языка запросов, позволяющим создавать
новые временные таблицы и использовать существующие временные таблицы.</p>

<a name="_ref450905083"></a><a id="TI000000517" class="bookmark" name="issogl3_8.5.2.2_менеджер_временных_таблиц"><h4>8.5.2.2. Менеджер временных таблиц</h4></a>

<p class="MsoNormalCxSpFirst">Менеджер временных таблиц предназначен для управления
временем существования временных таблиц, создаваемых в процессе работы прикладного
решения.</p>

<p class="MsoNormalCxSpLast">В одном прикладном решении может быть создано произвольное
количество экземпляров менеджера временных таблиц, каждый из которых хранит
свой набор временных таблиц. Каждая временная таблица однозначно идентифицируется
своим именем, и в пределах одного менеджера временных таблиц все временные
таблицы должны иметь уникальные имена.</p>

<p class="Note"><span class="Note">Примечание.</span> Имена временных таблиц
должны соответствовать требованиям, предъявляемым к именам переменных встроенного
языка (см. <A href="/db/content/v8310doc/src/руководство разработчика/глава 4. встроенный язык.htm?_=1496848987#_ref216101998">здесь</a>).</p>

<p class="MsoNormal">Экземпляр менеджера временных таблиц может быть создан с
помощью конструктора <span class="Term">Новый</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">МенеджерВременныхТаблиц <span class="operator">=</span> <span class="keyword">Новый</span> МенеджерВременныхТаблиц<span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">При откате транзакции из менеджера временных таблиц
удаляются все временные таблицы, которые были созданы в рамках транзакции и
обращение к ним становится невозможным.</p>

<p class="MsoNormalCxSpMiddle">Все временные таблицы, созданные в данном
экземпляре менеджера, существуют до тех пор, пока существует сам экземпляр менеджера
временных таблиц. При уничтожении экземпляра менеджера все временные таблицы, которые
содержатся в нем, также удаляются.</p>

<p class="MsoNormalCxSpLast">Менеджер временных таблиц можно закрыть принудительно
при помощи метода <span class="Term">Закрыть()</span>.
При этом будут удалены все созданные в нем таблицы. Дальнейшая работа с данным
экземпляром менеджера будет невозможна.</p>

<a id="TI000000518" class="bookmark" name="issogl3_8.5.2.3_создание_временных_таблиц"><h4>8.5.2.3. Создание временных таблиц</h4></a>

<p class="MsoNormalCxSpFirst">Создание временных таблиц осуществляется с помощью
объекта <span class="Term">Запрос</span>
встроенного языка системы «1С:Предприятие».</p>

<p class="MsoNormalCxSpLast">Связь запроса с менеджером временных таблиц осуществляется
с помощью свойства <span class="Term">МенеджерВременныхТаблиц</span>
запроса, в котором указывается тот экземпляр менеджера, в котором должны
создаваться временные таблицы.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">МенеджерВременныхТаблиц <span class="operator">=</span> <span class="keyword">Новый</span> МенеджерВременныхТаблиц<span class="operator">;</span>
Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
Запрос<span class="operator">.</span>МенеджерВременныхТаблиц <span class="operator">=</span> МенеджерВременныхТаблиц<span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">Временная таблица может быть создана на основе данных
базы данных или на основе внешнего источника данных (например, таблицы
значений).</p>

<p class="MsoNormalCxSpLast">Для того чтобы создать временную таблицу на основе
данных базы данных, следует установить объекту <span class="Term">Запрос</span> менеджер временных
таблиц, а затем выполнить запрос к базе данных, используя ключевое слово <span class="Term">ПОМЕСТИТЬ</span>,
после которого указать имя создаваемой временной таблицы. Ключевое слово <span class="Term">ПОМЕСТИТЬ</span>
располагается после списка выборки запроса.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Код<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>Наименование
ПОМЕСТИТЬ ВременнаяТаблица
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура</pre>

<p class="MsoNormalCxSpFirst">Результат исполнения такого запроса будет содержать
одну строку с одной колонкой <span class="Term">Количество</span>, в которой будут находиться записи,
помещенные в созданную таблицу.</p>

<p class="MsoNormalCxSpMiddle">Если менеджер временных таблиц не установлен или
был закрыт, или в установленном менеджере временных таблиц уже существует
таблица с указанным именем, будет выдана ошибка.</p>

<p class="MsoNormalCxSpLast">При создании временных таблиц не на основании
внешнего источника можно использовать
конструкцию <span class="Term">ДЛЯ
ИЗМЕНЕНИЯ</span>. Это необходимо в тех случаях, когда требуется получить данные во временную таблицу и одновременно
заблокировать их от чтения другими транзакциями.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    РасходнаяНакладная<span class="operator">.</span>Ссылка<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Номер<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Дата
ПОМЕСТИТЬ ВременнаяТаблица
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> РасходнаяНакладная
ГДЕ
    РасходнаяНакладная<span class="operator">.</span>Ссылка В<span class="operator">(</span>&Документы<span class="operator">)</span>
<span class="keyword">ДЛЯ</span> ИЗМЕНЕНИЯ</pre>

<p class="MsoNormal">При необходимости создания индекса для временной таблицы
следует в запросе указать ключевое слово <span class="Term">ИДЕКСИРОВАТЬ ПО</span>,
после которого перечислить поля, по которым нужно построить индекс.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Номенклатура<span class="operator">.</span>Код <span class="keyword">КАК</span> Код<span class="operator">,</span>
    Номенклатура<span class="operator">.</span>Наименование
ПОМЕСТИТЬ ВременнаяТаблица
<span class="keyword">ИЗ</span>
    Справочник<span class="operator">.</span>Номенклатура <span class="keyword">КАК</span> Номенклатура
ИНДЕКСИРОВАТЬ <span class="keyword">ПО</span>
    Код</pre>

<p class="MsoNormalCxSpFirst">Поля, по которым происходит индексирование, должны
находиться в списке выборки.</p>

<p class="MsoNormalCxSpMiddle">Если в качестве источника используется таблица
значений, то у этой таблицы значений должны быть явно указаны типы значений,
содержащихся в колонках.</p>

<p class="MsoNormalCxSpLast">Для того чтобы создать временную таблицу и заблокировать
данные таблиц, на основании которых создается временная таблица, следует
использовать конструкцию <span class="Term">ДЛЯ ИЗМЕНЕНИЯ</span>.</p>

<p class="Lang-subheader">Пример:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    РасходнаяНакладная<span class="operator">.</span>Ссылка<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Номер<span class="operator">,</span>
    РасходнаяНакладная<span class="operator">.</span>Дата
ПОМЕСТИТЬ ВременнаяТаблица
<span class="keyword">ИЗ</span>
    Документ<span class="operator">.</span>РасходнаяНакладная <span class="keyword">КАК</span> РасходнаяНакладная
ГДЕ
    РасходнаяНакладная<span class="operator">.</span>Ссылка В<span class="operator">(</span>&Документы<span class="operator">)</span>
<span class="keyword">ДЛЯ</span> ИЗМЕНЕНИЯ</pre>

<p class="MsoNormalCxSpFirst">Для того чтобы создать временную таблицу на основании
внешнего источника, следует в тексте запроса в списке источников указать имя
параметра, в который будет помещен внешний источник. Остальной синтаксис идентичен
обычному созданию временной таблицы.</p>

<p class="MsoNormalCxSpLast">В качестве внешнего источника могут выступать:</p>

<p class="MsoListBulletCxSpFirst">&#9679; 
таблица значений,</p>

<p class="MsoListBulletCxSpMiddle">&#9679; 
табличная часть,</p>

<p class="MsoListBulletCxSpLast">&#9679; 
результат запроса.</p>

<p class="MsoNormal">Ниже приведен пример создания временной таблицы на основе
внешнего источника:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev"><span class="keyword">ВЫБРАТЬ</span>
    Источник<span class="operator">.</span>Код<span class="operator">,</span>
    Источник<span class="operator">.</span>Наименование
ПОМЕСТИТЬ ВременнаяТаблица
<span class="keyword">ИЗ</span>
<span class="preprocessor">    &amp;ВнешнийИсточник КАК Источник</span></pre>

<p class="MsoNormal">В данном примере во временную таблицу <span class="Term">ВременнаяТаблица</span>
будет помещено содержимое колонок <span class="Term">Код</span> и <span class="Term">Наименование</span> из внешнего источника, например,
таблицы значений, переданной в качестве параметра <span class="Term">ВнешнийИсточник</span>.</p>

<p class="NoteCxSpFirst"><span class="Note">Внимание! </span>Создание
временной таблицы невозможно, если она создается на основании таблицы значений,
которая содержит в колонках значение типа <span class="Term">УникальныйИдентификатор</span>.</p>

<p class="NoteCxSpLast"><span class="Note">ВНИМАНИЕ!</span> Если временная
таблица создается на основании внешнего источника, в запросе нельзя использовать
объединения и соединения, а также поля, являющиеся реквизитами полей таблиц, на
основании которых создается временная таблица.</p>

<a id="TI000000519" class="bookmark" name="issogl3_8.5.2.4_использование_временных_таблиц"><h4>8.5.2.4. Использование временных таблиц</h4></a>

<p class="MsoNormal">Для использования существующих временных таблиц в запросе
следует установить объекту <span class="Term">Запрос</span> менеджер временных таблиц, после чего к
временным таблицам, содержащимся в данном менеджере временных таблиц, можно
обращаться по имени, как к обычным таблицам запроса.</p>

<a id="TI000000520" class="bookmark" name="issogl3_8.5.2.5_удаление_временных_таблиц"><h4>8.5.2.5. Удаление временных таблиц</h4></a>

<p class="MsoNormal">Для удаления временной таблицы из менеджера временных таблиц
следует воспользоваться ключевым словом языка запроса <span class="Term">УНИЧТОЖИТЬ</span>, после
которого указывается имя уничтожаемой таблицы, например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">УНИЧТОЖИТЬ ВременнаяТаблица</pre>

<p class="MsoNormal">Если уничтожаемой таблицы не существует, будет выдана
ошибка.</p>

<a name="_ref436242593"></a><a id="TI000001759" class="bookmark" name="issogl3_8.5.2.6_отладка_запроса_с_временными_таблицами"><h4>8.5.2.6. Отладка запроса с временными таблицами</h4></a>

<p class="MsoNormal">При отладке сложных запросов, содержащих
временные таблицы, возникает необходимость анализировать их (временных таблиц)
содержимое. Для этого можно воспользоваться методом <span class="Term">Запрос.ВыполнитьПакетСПромежуточнымиДанными()</span>
(см. <a href="#_ref436242743">здесь</a>) или воспользоваться менеджером временных таблиц.</p>

<p class="Note"><span class="Note">Примечание.</span> Рассматриваемый запрос
не имеет никакого прикладного смысла, а служит исключительно для демонстрации
работы с временными таблицами в процессе отладки запроса.</p>

<p class="MsoNormal">Рассмотрим пример такого использования:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
Запрос<span class="operator">.</span>МенеджерВременныхТаблиц <span class="operator">=</span> <span class="keyword">Новый</span> МенеджерВременныхТаблиц<span class="operator">;</span>
Запрос<span class="operator">.</span>Текст <span class="operator">=</span> <span class="string">&quot;ВЫБРАТЬ</span>
<span class="string">    |    ПродажиОбороты.Товар,</span>
<span class="string">    |    ПродажиОбороты.КоличествоОборот</span>
<span class="string">    |ПОМЕСТИТЬ Продажи</span>
<span class="string">    |ИЗ</span>
<span class="string">    |    РегистрНакопления.Продажи.Обороты КАК ПродажиОбороты</span>
<span class="string">    |;</span>
<span class="string">    |</span>
<span class="string">    |/////////////////////////////////</span>
<span class="string">    |ВЫБРАТЬ</span>
<span class="string">    |    ТоварныеЗапасыОстатки.Товар,</span>
<span class="string">    |    ТоварныеЗапасыОстатки.КоличествоОстаток</span>
<span class="string">    |ПОМЕСТИТЬ Остатки</span>
<span class="string">    |ИЗ</span>
<span class="string">    |    РегистрНакопления.ТоварныеЗапасы.Остатки КАК ТоварныеЗапасыОстатки</span>
<span class="string">    |;</span>
<span class="string">    |</span>
<span class="string">    |/////////////////////////////////</span>
<span class="string">    |ВЫБРАТЬ</span>
<span class="string">    |    Товары.Наименование,</span>
<span class="string">    |    Продажи.КоличествоОборот,</span>
<span class="string">    |    Остатки.КоличествоОстаток</span>
<span class="string">    |ИЗ</span>
<span class="string">    |    Справочник.Товары КАК Товары</span>
<span class="string">    |        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Остатки КАК Остатки</span>
<span class="string">    |        ПО Товары.Ссылка = Остатки.Товар</span>
<span class="string">    |        ВНУТРЕННЕЕ СОЕДИНЕНИЕ Продажи КАК Продажи</span>
<span class="string">    |        ПО Товары.Ссылка = Продажи.Товар&quot;</span><span class="operator">;</span>
Результат <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ПродажиТЗ <span class="operator">=</span> Запрос<span class="operator">.</span>МенеджерВременныхТаблиц<span class="operator">.</span>Таблицы<span class="operator">[</span><span class="string">&quot;Продажи&quot;</span><span class="operator">]</span><span class="operator">.</span>ПолучитьДанные<span class="operator">(</span><span class="operator">)</span><span class="operator">.</span>Выгрузить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ОстаткиТЗ <span class="operator">=</span> Запрос<span class="operator">.</span>МенеджерВременныхТаблиц<span class="operator">.</span>Таблицы<span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">.</span>ПолучитьДанные<span class="operator">(</span><span class="operator">)</span><span class="operator">.</span>Выгрузить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">В результате выполнения запроса свойство <span class="Term">Запрос.МенеджерВременныхТаблиц.Таблицы</span>
станет содержать коллекцию временных таблиц, содержащих результаты исполнения
пакетного запроса. С помощью свойства <span class="Term">Таблицы</span>
можно получать доступ к каждой временной таблице, причем делать это можно как
по имени, так и по индексу временной таблицы. Например, таблица значений <span class="Term">ПродажиТЗ</span>
получена в результате доступа к временной таблице <span class="Term">Продажи</span>
по имени (<span class="Term">Таблицы[&quot;Продажи&quot;]</span>). В то же время
формирование таблицы значений <span class="Term">ОстаткиТЗ</span>
осуществляется доступом по индексу (<span class="Term">Таблицы[1]</span>).</p>

<a name="_ref436242743"></a><a name="_ref436242065"></a><a name="_ref436242064"></a><a id="TI000000521" class="bookmark" name="issogl2_8.5.3_работа_с_пакетными_запросами"><h3>8.5.3. Работа с пакетными запросами</h3></a>

<p class="MsoNormal">Платформа системы «1С:Предприятие» позволяет работать с
пакетами запросов. В пакетном запросе тексты запросов разделяются символом «<span class="Interface">;</span>». Запросы исполняются последовательно, при этом
временные таблицы, которые были созданы во время исполнения какого-либо
запроса, будут существовать до окончания исполнения всего пакета запроса или до
исполнения в пакете запроса, уничтожающего данную временную таблицу, например:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
Запрос<span class="operator">.</span>Текст <span class="operator">=</span>
    <span class="string">&quot;ВЫБРАТЬ</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.Номенклатура,</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.КоличествоПриход,</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.КоличествоРасход,</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.КоличествоКонечныйОстаток</span>
<span class="string">    |ПОМЕСТИТЬ УчетНоменклатуры</span>
<span class="string">    |ИЗ</span>
<span class="string">    |РегистрНакопления.УчетНоменклатуры.ОстаткиИОбороты(, , Авто, , ) КАК УчетНоменклатурыОстаткиИОбороты</span>
<span class="string">    |;</span>
<span class="string">    |</span>
<span class="string">    |ВЫБРАТЬ</span>
<span class="string">    |УчетНоменклатуры.Номенклатура,</span>
<span class="string">    |УчетНоменклатуры.КоличествоРасход,</span>
<span class="string">    |УчетНоменклатуры.КоличествоКонечныйОстаток</span>
<span class="string">    |ИЗ</span>
<span class="string">    |УчетНоменклатуры КАК УчетНоменклатуры</span>
<span class="string">    |&quot;</span><span class="operator">;</span>
Результат <span class="operator">=</span> Запрос<span class="operator">.</span><span class="keyword">Выполнить</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormalCxSpFirst">Первый запрос создает временную таблицу, данные из
которой используются во втором запросе.</p>

<p class="MsoNormalCxSpMiddle">Если объекту <span class="Term">Запрос</span>,
исполняющему пакетный запрос, установлен менеджер временных таблиц, временные
таблицы, которые не были уничтожены в рамках пакетного запроса, сохранятся в
установленном менеджере. В тексте пакетного запроса возможно использование и
уничтожение временных таблиц, которые существовали в установленном менеджере
временных таблиц на момент запуска пакета на исполнение.</p>

<p class="MsoNormalCxSpMiddle">Кроме метода <span class="Term">Выполнить()</span>,
последовательно выполняющего все запросы пакета и возвращающего результат
последнего запроса в пакете, платформа системы «1С:Предприятие» предоставляет
еще один метод – <span class="Term">ВыполнитьПакет()</span>.
Этот метод последовательно выполняет все запросы и возвращает массив
результатов для каждого запроса из пакета в последовательности расположения
запросов в тексте пакета. Результатом выполнения запроса на уничтожение
временной таблицы является значение <span class="Term">Неопределено</span>, которое также помещается в
массив результатов.</p>

<p class="MsoNormalCxSpMiddle">При необходимости отладки пакетного запроса, предоставляется
возможность использовать метод <span class="Term">ВыполнитьПакетСПромежуточнымиДанными()</span>. В этом
случае результат работы аналогичен методу <span class="Term">ВыполнитьПакет()</span> с
тем отличием, что временные таблицы, сформированные в пакете запросов, будут
представлены не количеством записей в соответствующей временной таблице (как
при вызове метода <span class="Term">ВыполнитьПакет()</span>),
а содержимым этой временной таблицы.</p>

<p class="MsoNormalCxSpLast">Таким образом, можно переработать вышеприведенный
пример следующим образом:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_dev">Запрос <span class="operator">=</span> <span class="keyword">Новый</span> Запрос<span class="operator">;</span>
Запрос<span class="operator">.</span>Текст <span class="operator">=</span> 
    <span class="string">&quot;ВЫБРАТЬ</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.Номенклатура,</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.КоличествоПриход,</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.КоличествоРасход,</span>
<span class="string">    |УчетНоменклатурыОстаткиИОбороты.КоличествоКонечныйОстаток</span>
<span class="string">    |ПОМЕСТИТЬ УчетНоменклатуры</span>
<span class="string">    |ИЗ</span>
<span class="string">    |РегистрНакопления.УчетНоменклатуры.ОстаткиИОбороты(, , Авто, , ) КАК УчетНоменклатурыОстаткиИОбороты</span>
<span class="string">    |;</span>
<span class="string">    |</span>
<span class="string">    |ВЫБРАТЬ</span>
<span class="string">    |УчетНоменклатуры.Номенклатура,</span>
<span class="string">    |УчетНоменклатуры.КоличествоРасход,</span>
<span class="string">    |УчетНоменклатуры.КоличествоКонечныйОстаток</span>
<span class="string">    |ИЗ</span>
<span class="string">    |УчетНоменклатуры КАК УчетНоменклатуры</span>
<span class="string">    |&quot;</span><span class="operator">;</span>
РезультатПакета <span class="operator">=</span> Запрос<span class="operator">.</span>ВыполнитьПакетСПромежуточнымиДанными<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
ВременнаяТаблица <span class="operator">=</span> РезультатПакета<span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">.</span>Выгрузить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span>
Результат <span class="operator">=</span> РезультатПакета<span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">.</span>Выгрузить<span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></pre>

<p class="MsoNormal">В этом случае в переменной <span class="Term">ВременнаяТаблица</span>
будет доступна таблица значений, которая содержит данные временной таблицы <span class="Term">УчетНоменклатуры</span>,
а в переменной <span class="Term">Результат</span>
будет доступна временная таблица с результатом работы последнего запроса пакета
(фактический результат работы пакета).</p>

<a name="_ref380663816"></a><a name="_ref380663815"></a><a id="TI000002676" class="bookmark" name="issogl2_8.5.4_программная_работа_с_запросами"><h3>8.5.4. Программная работа с запросами</h3></a>

<p class="MsoNormalCxSpFirst">Система «1С:Предприятие» предоставляет возможность
формировать или модифицировать запрос из встроенного языка. Для этого
существует специальный объект <span class="Term">СхемаЗапроса</span>. С помощью свойства <span class="Term">ПакетЗапросов</span>
разработчик получает доступ ко всем запросам, которые в данный момент
редактируются с помощью объекта <span class="Term">СхемаЗапроса</span>. Методы <span class="Term">УстановитьТекстЗапроса()</span>
предназначен для заполнения объекта <span class="Term">СхемаЗапроса</span> на основании переданного текста запроса,
а метод <span class="Term">ПолучитьТекстЗапроса()</span>
служит для обратной операции.</p>

<p class="MsoNormalCxSpLast">В качестве примера использования объектной модели
работы с запросами будет приведен программный код, необходимый для формирования
следующего запроса:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
ВЫБРАТЬ
    ТоварныеЗапасыОстатки.Товар КАК Товар,
    ТоварныеЗапасыОстатки.Склад КАК Склад,
    ТоварныеЗапасыОстатки.КоличествоОстаток КАК КоличествоОстаток,
    ВЫБОР
        КОГДА ТоварныеЗапасыОстатки.КоличествоОстаток &gt; 0
            ТОГДА &quot;Достаточно&quot;
        ИНАЧЕ &quot;Недостаточно&quot;
    КОНЕЦ КАК Состояние
ИЗ
    РегистрНакопления.ТоварныеЗапасы.Остатки КАК ТоварныеЗапасыОстатки
ГДЕ
    ТоварныеЗапасыОстатки.Склад = &amp;Склад
УПОРЯДОЧИТЬ ПО
    Товар,
    Склад,
    КоличествоОстаток
ИТОГИ
    СУММА(КоличествоОстаток)
ПО
    ОБЩИЕ,
    Товар,
    Склад
</pre>

<p class="MsoNormal">Код на встроенном языке:</p>

<a class="copy_source" href="#_top" onClick="return false">Копировать в буфер обмена</a>
<pre class="src_res">
Конструктор = Новый СхемаЗапроса;
Пакет1 = Конструктор.ПакетЗапросов[0];
Оператор1 = Пакет1.Операторы[0];
// добавим источник в запрос
ТаблицаРегистра = Оператор1.Источники.Добавить(&quot;РегистрНакопления.ТоварныеЗапасы.Остатки&quot;, &quot;ТоварныеЗапасыОстатки&quot;);
// добавим поля в запрос
ПолеТовар = Оператор1.ВыбираемыеПоля.Добавить(&quot;ТоварныеЗапасыОстатки.Товар&quot;, 0);
ДоступноеПолеСклад = ТаблицаРегистра.Источник.ДоступныеПоля.Найти(&quot;Склад&quot;);
ПолеСклад = Оператор1.ВыбираемыеПоля.Добавить(ДоступноеПолеСклад, 1);
ПолеКоличество = Оператор1.ВыбираемыеПоля.Добавить(&quot;КоличествоОстаток&quot;, 2);
ВыражениеВыбора = Новый ВыражениеСхемыЗапроса(&quot;ВЫБОР
                |    КОГДА ТоварныеЗапасыОстатки.КоличествоОстаток &gt; 0
                |        ТОГДА &quot;&quot;Достаточно&quot;&quot;
                |    ИНАЧЕ &quot;&quot;Недостаточно&quot;&quot;
                |КОНЕЦ&quot;);
ПолеВыбора = Оператор1.ВыбираемыеПоля.Добавить(Строка(ВыражениеВыбора), 3);
// зададим псевдонимы
Результат = Пакет1.Колонки.Найти(ПолеКоличество);
Результат.Псевдоним = &quot;КоличествоОстаток&quot;;
Результат = Пакет1.Колонки[1];
Результат.Псевдоним = &quot;Склад&quot;;
Результат = Пакет1.Колонки.Найти(ВыражениеВыбора);
Результат.Псевдоним = &quot;Состояние&quot;;
// добавим условие
Оператор1.Отбор.Добавить(Строка(ПолеСклад) + &quot; = &amp;Склад&quot;);
// добавим упорядочивание
Пакет1.Порядок.Добавить(ПолеТовар);
Пакет1.Порядок.Добавить(&quot;Склад&quot;);
Пакет1.Порядок.Добавить(&quot;КоличествоОстаток&quot;);
// зададим контрольные точки итогов
Пакет1.ОбщиеИтоги = Истина;
Пакет1.КонтрольныеТочкиИтогов.Добавить(ПолеТовар);
Пакет1.КонтрольныеТочкиИтогов.Добавить(&quot;Склад&quot;);
// зададим агрегатные функции для итогов
КолонкаКоличество = Пакет1.Колонки.Найти(ПолеКоличество);
Пакет1.ВыраженияИтогов.Добавить(&quot;Сумма(&quot; + КолонкаКоличество.Псевдоним +&quot;)&quot;);
Текст = Конструктор.ПолучитьТекстЗапроса();
</pre>

<p class="MsoNormalCxSpFirst"> </p>

<br>		<script type="text/javascript">listenCopy('zeroclipboard.swf');</script>
	</body>
</html>